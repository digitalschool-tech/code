/******/ (() => { // webpackBootstrap
/******/ 	var __webpack_modules__ = ({

/***/ "./resources/js/blockly/blockly_compressed.js":
/*!****************************************************!*\
  !*** ./resources/js/blockly/blockly_compressed.js ***!
  \****************************************************/
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;function _wrapNativeSuper(Class){var _cache=typeof Map==="function"?new Map():undefined;_wrapNativeSuper=function _wrapNativeSuper(Class){if(Class===null||!_isNativeFunction(Class))return Class;if(typeof Class!=="function"){throw new TypeError("Super expression must either be null or a function");}if(typeof _cache!=="undefined"){if(_cache.has(Class))return _cache.get(Class);_cache.set(Class,Wrapper);}function Wrapper(){return _construct(Class,arguments,_getPrototypeOf(this).constructor);}Wrapper.prototype=Object.create(Class.prototype,{constructor:{value:Wrapper,enumerable:false,writable:true,configurable:true}});return _setPrototypeOf(Wrapper,Class);};return _wrapNativeSuper(Class);}function _construct(Parent,args,Class){if(_isNativeReflectConstruct()){_construct=Reflect.construct.bind();}else{_construct=function _construct(Parent,args,Class){var a=[null];a.push.apply(a,args);var Constructor=Function.bind.apply(Parent,a);var instance=new Constructor();if(Class)_setPrototypeOf(instance,Class.prototype);return instance;};}return _construct.apply(null,arguments);}function _isNativeFunction(fn){return Function.toString.call(fn).indexOf("[native code]")!==-1;}function _get(){if(typeof Reflect!=="undefined"&&Reflect.get){_get=Reflect.get.bind();}else{_get=function _get(target,property,receiver){var base=_superPropBase(target,property);if(!base)return;var desc=Object.getOwnPropertyDescriptor(base,property);if(desc.get){return desc.get.call(arguments.length<3?target:receiver);}return desc.value;};}return _get.apply(this,arguments);}function _superPropBase(object,property){while(!Object.prototype.hasOwnProperty.call(object,property)){object=_getPrototypeOf(object);if(object===null)break;}return object;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function");}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});Object.defineProperty(subClass,"prototype",{writable:false});if(superClass)_setPrototypeOf(subClass,superClass);}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(o,p){o.__proto__=p;return o;};return _setPrototypeOf(o,p);}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget);}else{result=Super.apply(this,arguments);}return _possibleConstructorReturn(this,result);};}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call;}else if(call!==void 0){throw new TypeError("Derived constructors may only return object or undefined");}return _assertThisInitialized(self);}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return self;}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));return true;}catch(e){return false;}}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o);};return _getPrototypeOf(o);}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);Object.defineProperty(Constructor,"prototype",{writable:false});return Constructor;}function _createForOfIteratorHelper(o,allowArrayLike){var it=typeof Symbol!=="undefined"&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&typeof o.length==="number"){if(it)o=it;var i=0;var F=function F(){};return{s:F,n:function n(){if(i>=o.length)return{done:true};return{done:false,value:o[i++]};},e:function e(_e14){throw _e14;},f:F};}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}var normalCompletion=true,didErr=false,err;return{s:function s(){it=it.call(o);},n:function n(){var step=it.next();normalCompletion=step.done;return step;},e:function e(_e15){didErr=true;err=_e15;},f:function f(){try{if(!normalCompletion&&it["return"]!=null)it["return"]();}finally{if(didErr)throw err;}}};}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest();}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}function _iterableToArrayLimit(arr,i){var _i=arr==null?null:typeof Symbol!=="undefined"&&arr[Symbol.iterator]||arr["@@iterator"];if(_i==null)return;var _arr=[];var _n=true;var _d=false;var _s,_e;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done);_n=true){_arr.push(_s.value);if(i&&_arr.length===i)break;}}catch(err){_d=true;_e=err;}finally{try{if(!_n&&_i["return"]!=null)_i["return"]();}finally{if(_d)throw _e;}}return _arr;}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr;}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_unsupportedIterableToArray(arr)||_nonIterableSpread();}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}function _unsupportedIterableToArray(o,minLen){if(!o)return;if(typeof o==="string")return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if(n==="Object"&&o.constructor)n=o.constructor.name;if(n==="Map"||n==="Set")return Array.from(o);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen);}function _iterableToArray(iter){if(typeof Symbol!=="undefined"&&iter[Symbol.iterator]!=null||iter["@@iterator"]!=null)return Array.from(iter);}function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr);}function _arrayLikeToArray(arr,len){if(len==null||len>arr.length)len=arr.length;for(var i=0,arr2=new Array(len);i<len;i++){arr2[i]=arr[i];}return arr2;}function _typeof(obj){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj;}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;},_typeof(obj);}// Do not edit this file; automatically generated.
/* eslint-disable */;(function(root,factory){if(true){// AMD
!(__WEBPACK_AMD_DEFINE_ARRAY__ = [], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),
		__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?
		(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),
		__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));}else { var factoryExports; }})(this,function(){var $={};var longStart$$module$build$src$core$touch=function longStart$$module$build$src$core$touch(a,b){longStop$$module$build$src$core$touch();a.changedTouches&&1!==a.changedTouches.length||(longPid_$$module$build$src$core$touch=setTimeout(function(){a.changedTouches&&(a.button=2,a.clientX=a.changedTouches[0].clientX,a.clientY=a.changedTouches[0].clientY);b&&b.handleRightClick(a);},LONGPRESS$$module$build$src$core$touch));},longStop$$module$build$src$core$touch=function longStop$$module$build$src$core$touch(){longPid_$$module$build$src$core$touch&&(clearTimeout(longPid_$$module$build$src$core$touch),longPid_$$module$build$src$core$touch=0);},clearTouchIdentifier$$module$build$src$core$touch=function clearTouchIdentifier$$module$build$src$core$touch(){touchIdentifier_$$module$build$src$core$touch=null;},shouldHandleEvent$$module$build$src$core$touch=function shouldHandleEvent$$module$build$src$core$touch(a){return!isMouseOrTouchEvent$$module$build$src$core$touch(a)||checkTouchIdentifier$$module$build$src$core$touch(a);},getTouchIdentifierFromEvent$$module$build$src$core$touch=function getTouchIdentifierFromEvent$$module$build$src$core$touch(a){return a instanceof PointerEvent?String(a.pointerId):a instanceof MouseEvent?"mouse":a.changedTouches&&a.changedTouches[0]&&void 0!==a.changedTouches[0].identifier&&null!==a.changedTouches[0].identifier?String(a.changedTouches[0].identifier):"mouse";},checkTouchIdentifier$$module$build$src$core$touch=function checkTouchIdentifier$$module$build$src$core$touch(a){var b=getTouchIdentifierFromEvent$$module$build$src$core$touch(a);return void 0!==touchIdentifier_$$module$build$src$core$touch&&null!==touchIdentifier_$$module$build$src$core$touch?touchIdentifier_$$module$build$src$core$touch===b:"mousedown"===a.type||"touchstart"===a.type||"pointerdown"===a.type?(touchIdentifier_$$module$build$src$core$touch=b,!0):!1;},setClientFromTouch$$module$build$src$core$touch=function setClientFromTouch$$module$build$src$core$touch(a){if(a.type.startsWith("touch")&&a.changedTouches){var b=a.changedTouches[0];a.clientX=b.clientX;a.clientY=b.clientY;}},isMouseOrTouchEvent$$module$build$src$core$touch=function isMouseOrTouchEvent$$module$build$src$core$touch(a){return a.type.startsWith("touch")||a.type.startsWith("mouse")||a.type.startsWith("pointer");},isTouchEvent$$module$build$src$core$touch=function isTouchEvent$$module$build$src$core$touch(a){return a.type.startsWith("touch")||a.type.startsWith("pointer");},splitEventByTouches$$module$build$src$core$touch=function splitEventByTouches$$module$build$src$core$touch(a){var b=[];if(a.changedTouches)for(var c=0;c<a.changedTouches.length;c++){b[c]={type:a.type,changedTouches:[a.changedTouches[c]],target:a.target,stopPropagation:function stopPropagation(){a.stopPropagation();},preventDefault:function preventDefault(){a.preventDefault();}};}else b.push(a);return b;},conditionalBind$$module$build$src$core$browser_events=function conditionalBind$$module$build$src$core$browser_events(a,b,c,d,e,f){function g(n){var p=!e;n=splitEventByTouches$$module$build$src$core$touch(n);for(var r=0;r<n.length;r++){var q=n[r];if(!p||shouldHandleEvent$$module$build$src$core$touch(q))setClientFromTouch$$module$build$src$core$touch(q),c?d.call(c,q):d(q),h=!0;}}var h=!1;var k=[];if(globalThis.PointerEvent&&b in TOUCH_MAP$$module$build$src$core$touch)for(var l=0;l<TOUCH_MAP$$module$build$src$core$touch[b].length;l++){var m=TOUCH_MAP$$module$build$src$core$touch[b][l];a.addEventListener(m,g,!1);k.push([a,m,g]);}else if(a.addEventListener(b,g,!1),k.push([a,b,g]),b in TOUCH_MAP$$module$build$src$core$touch)for(l=function l(n){g(n);var p=!f;h&&p&&n.preventDefault();},m=0;m<TOUCH_MAP$$module$build$src$core$touch[b].length;m++){var n=TOUCH_MAP$$module$build$src$core$touch[b][m];a.addEventListener(n,l,!1);k.push([a,n,l]);}return k;},bind$$module$build$src$core$browser_events=function bind$$module$build$src$core$browser_events(a,b,c,d){function e(k){c?d.call(c,k):d(k);}var f=[];if(globalThis.PointerEvent&&b in TOUCH_MAP$$module$build$src$core$touch)for(var g=0;g<TOUCH_MAP$$module$build$src$core$touch[b].length;g++){var h=TOUCH_MAP$$module$build$src$core$touch[b][g];a.addEventListener(h,e,!1);f.push([a,h,e]);}else if(a.addEventListener(b,e,!1),f.push([a,b,e]),b in TOUCH_MAP$$module$build$src$core$touch)for(g=function g(k){if(k instanceof TouchEvent&&k.changedTouches&&1===k.changedTouches.length){var l=k.changedTouches[0];k.clientX=l.clientX;k.clientY=l.clientY;}e(k);k.preventDefault();},h=0;h<TOUCH_MAP$$module$build$src$core$touch[b].length;h++){var k=TOUCH_MAP$$module$build$src$core$touch[b][h];a.addEventListener(k,g,!1);f.push([a,k,g]);}return f;},unbind$$module$build$src$core$browser_events=function unbind$$module$build$src$core$browser_events(a){var b=a[a.length-1][2];for(;a.length;){var c=a.pop();c[0].removeEventListener(c[1],c[2],!1);}return b;},isTargetInput$$module$build$src$core$browser_events=function isTargetInput$$module$build$src$core$browser_events(a){if(a.target instanceof HTMLElement){if(a.target.isContentEditable||"true"===a.target.getAttribute("data-is-text-input"))return!0;if(a.target instanceof HTMLInputElement)return a=a.target,"text"===a.type||"number"===a.type||"email"===a.type||"password"===a.type||"search"===a.type||"tel"===a.type||"url"===a.type;if(a.target instanceof HTMLTextAreaElement)return!0;}return!1;},isRightButton$$module$build$src$core$browser_events=function isRightButton$$module$build$src$core$browser_events(a){return a.ctrlKey&&MAC$$module$build$src$core$utils$useragent?!0:2===a.button;},mouseToSvg$$module$build$src$core$browser_events=function mouseToSvg$$module$build$src$core$browser_events(a,b,c){var d=b.createSVGPoint();d.x=a.clientX;d.y=a.clientY;c||(c=b.getScreenCTM().inverse());return d.matrixTransform(c);},getScrollDeltaPixels$$module$build$src$core$browser_events=function getScrollDeltaPixels$$module$build$src$core$browser_events(a){switch(a.deltaMode){default:return{x:a.deltaX,y:a.deltaY};case 1:return{x:a.deltaX*LINE_MODE_MULTIPLIER$$module$build$src$core$browser_events,y:a.deltaY*LINE_MODE_MULTIPLIER$$module$build$src$core$browser_events};case 2:return{x:a.deltaX*PAGE_MODE_MULTIPLIER$$module$build$src$core$browser_events,y:a.deltaY*PAGE_MODE_MULTIPLIER$$module$build$src$core$browser_events};}},getWorkspaceById$$module$build$src$core$common=function getWorkspaceById$$module$build$src$core$common(a){return WorkspaceDB_$$module$build$src$core$common[a]||null;},getAllWorkspaces$$module$build$src$core$common=function getAllWorkspaces$$module$build$src$core$common(){var a=[];for(var b in WorkspaceDB_$$module$build$src$core$common){a.push(WorkspaceDB_$$module$build$src$core$common[b]);}return a;},registerWorkspace$$module$build$src$core$common=function registerWorkspace$$module$build$src$core$common(a){WorkspaceDB_$$module$build$src$core$common[a.id]=a;},unregisterWorkpace$$module$build$src$core$common=function unregisterWorkpace$$module$build$src$core$common(a){delete WorkspaceDB_$$module$build$src$core$common[a.id];},getMainWorkspace$$module$build$src$core$common=function getMainWorkspace$$module$build$src$core$common(){return mainWorkspace$$module$build$src$core$common;},setMainWorkspace$$module$build$src$core$common=function setMainWorkspace$$module$build$src$core$common(a){mainWorkspace$$module$build$src$core$common=a;},getSelected$$module$build$src$core$common=function getSelected$$module$build$src$core$common(){return selected$$module$build$src$core$common;},setSelected$$module$build$src$core$common=function setSelected$$module$build$src$core$common(a){selected$$module$build$src$core$common=a;},getParentContainer$$module$build$src$core$common=function getParentContainer$$module$build$src$core$common(){return parentContainer$$module$build$src$core$common;},setParentContainer$$module$build$src$core$common=function setParentContainer$$module$build$src$core$common(a){parentContainer$$module$build$src$core$common=a;},svgResize$$module$build$src$core$common=function svgResize$$module$build$src$core$common(a){for(;a.options.parentWorkspace;){a=a.options.parentWorkspace;}var b=a.getParentSvg(),c=a.getCachedParentSvgSize();var d=b.parentElement;if(d instanceof HTMLElement){var e=d.offsetWidth;d=d.offsetHeight;c.width!==e&&(b.setAttribute("width",e+"px"),a.setCachedParentSvgSize(e,null));c.height!==d&&(b.setAttribute("height",d+"px"),a.setCachedParentSvgSize(null,d));a.resize();}},getBlockTypeCounts$$module$build$src$core$common=function getBlockTypeCounts$$module$build$src$core$common(a,b){var c=Object.create(null),d=a.getDescendants(!0);b&&(a=a.getNextBlock())&&(a=d.indexOf(a),d.splice(a,d.length-a));for(var e=0,f;f=d[e];e++){c[f.type]?c[f.type]++:c[f.type]=1;}return c;},jsonInitFactory$$module$build$src$core$common=function jsonInitFactory$$module$build$src$core$common(a){return function(){this.jsonInit(a);};},defineBlocksWithJsonArray$$module$build$src$core$common=function defineBlocksWithJsonArray$$module$build$src$core$common(a){TEST_ONLY$$module$build$src$core$common.defineBlocksWithJsonArrayInternal(a);},defineBlocksWithJsonArrayInternal$$module$build$src$core$common=function defineBlocksWithJsonArrayInternal$$module$build$src$core$common(a){defineBlocks$$module$build$src$core$common(createBlockDefinitionsFromJsonArray$$module$build$src$core$common(a));},createBlockDefinitionsFromJsonArray$$module$build$src$core$common=function createBlockDefinitionsFromJsonArray$$module$build$src$core$common(a){var b={};for(var c=0;c<a.length;c++){var d=a[c];if(!d){console.warn("Block definition #".concat(c," in JSON array is ").concat(d,". Skipping"));continue;}var e=d.type;e?b[e]={init:jsonInitFactory$$module$build$src$core$common(d)}:console.warn("Block definition #".concat(c," in JSON array is missing a type attribute. ")+"Skipping.");}return b;},defineBlocks$$module$build$src$core$common=function defineBlocks$$module$build$src$core$common(a){for(var _i=0,_Object$keys=Object.keys(a);_i<_Object$keys.length;_i++){var b=_Object$keys[_i];var c=a[b];b in Blocks$$module$build$src$core$blocks&&console.warn("Block definiton \"".concat(b,"\" overwrites previous definition."));Blocks$$module$build$src$core$blocks[b]=c;}},createSvgElement$$module$build$src$core$utils$dom=function createSvgElement$$module$build$src$core$utils$dom(a,b,c){a=document.createElementNS(SVG_NS$$module$build$src$core$utils$dom,String(a));for(var d in b){a.setAttribute(d,"".concat(b[d]));}c&&c.appendChild(a);return a;},addClass$$module$build$src$core$utils$dom=function addClass$$module$build$src$core$utils$dom(a,b){var _a$classList;b=b.split(" ");if(b.every(function(c){return a.classList.contains(c);}))return!1;(_a$classList=a.classList).add.apply(_a$classList,_toConsumableArray(b));return!0;},removeClasses$$module$build$src$core$utils$dom=function removeClasses$$module$build$src$core$utils$dom(a,b){var _a$classList2;(_a$classList2=a.classList).remove.apply(_a$classList2,_toConsumableArray(b.split(" ")));},removeClass$$module$build$src$core$utils$dom=function removeClass$$module$build$src$core$utils$dom(a,b){var _a$classList3;b=b.split(" ");if(b.every(function(c){return!a.classList.contains(c);}))return!1;(_a$classList3=a.classList).remove.apply(_a$classList3,_toConsumableArray(b));return!0;},hasClass$$module$build$src$core$utils$dom=function hasClass$$module$build$src$core$utils$dom(a,b){return a.classList.contains(b);},removeNode$$module$build$src$core$utils$dom=function removeNode$$module$build$src$core$utils$dom(a){return a&&a.parentNode?a.parentNode.removeChild(a):null;},insertAfter$$module$build$src$core$utils$dom=function insertAfter$$module$build$src$core$utils$dom(a,b){var c=b.nextSibling;b=b.parentNode;if(!b)throw Error("Reference node has no parent.");c?b.insertBefore(a,c):b.appendChild(a);},containsNode$$module$build$src$core$utils$dom=function containsNode$$module$build$src$core$utils$dom(a,b){return!!(a.compareDocumentPosition(b)&NodeType$$module$build$src$core$utils$dom.DOCUMENT_POSITION_CONTAINED_BY);},setCssTransform$$module$build$src$core$utils$dom=function setCssTransform$$module$build$src$core$utils$dom(a,b){a.style.transform=b;a.style["-webkit-transform"]=b;},startTextWidthCache$$module$build$src$core$utils$dom=function startTextWidthCache$$module$build$src$core$utils$dom(){cacheReference$$module$build$src$core$utils$dom++;cacheWidths$$module$build$src$core$utils$dom||(cacheWidths$$module$build$src$core$utils$dom=Object.create(null));},stopTextWidthCache$$module$build$src$core$utils$dom=function stopTextWidthCache$$module$build$src$core$utils$dom(){cacheReference$$module$build$src$core$utils$dom--;cacheReference$$module$build$src$core$utils$dom||(cacheWidths$$module$build$src$core$utils$dom=null);},getTextWidth$$module$build$src$core$utils$dom=function getTextWidth$$module$build$src$core$utils$dom(a){var b=a.textContent+"\n"+a.className.baseVal;var c;if(cacheWidths$$module$build$src$core$utils$dom&&(c=cacheWidths$$module$build$src$core$utils$dom[b]))return c;try{c=a.getComputedTextLength();}catch(d){return 8*a.textContent.length;}cacheWidths$$module$build$src$core$utils$dom&&(cacheWidths$$module$build$src$core$utils$dom[b]=c);return c;},getFastTextWidth$$module$build$src$core$utils$dom=function getFastTextWidth$$module$build$src$core$utils$dom(a,b,c,d){return getFastTextWidthWithSizeString$$module$build$src$core$utils$dom(a,b+"pt",c,d);},getFastTextWidthWithSizeString$$module$build$src$core$utils$dom=function getFastTextWidthWithSizeString$$module$build$src$core$utils$dom(a,b,c,d){var e=a.textContent;a=e+"\n"+a.className.baseVal;var f;if(cacheWidths$$module$build$src$core$utils$dom&&(f=cacheWidths$$module$build$src$core$utils$dom[a]))return f;canvasContext$$module$build$src$core$utils$dom||(f=document.createElement("canvas"),f.className="blocklyComputeCanvas",document.body.appendChild(f),canvasContext$$module$build$src$core$utils$dom=f.getContext("2d"));canvasContext$$module$build$src$core$utils$dom.font=c+" "+b+" "+d;f=e?canvasContext$$module$build$src$core$utils$dom.measureText(e).width:0;cacheWidths$$module$build$src$core$utils$dom&&(cacheWidths$$module$build$src$core$utils$dom[a]=f);return f;},measureFontMetrics$$module$build$src$core$utils$dom=function measureFontMetrics$$module$build$src$core$utils$dom(a,b,c,d){var e=document.createElement("span");e.style.font=c+" "+b+" "+d;e.textContent=a;a=document.createElement("div");a.style.width="1px";a.style.height="0";b=document.createElement("div");b.setAttribute("style","position: fixed; top: 0; left: 0; display: flex;");b.appendChild(e);b.appendChild(a);document.body.appendChild(b);c={height:0,baseline:0};try{b.style.alignItems="baseline",c.baseline=a.offsetTop-e.offsetTop,b.style.alignItems="flex-end",c.height=a.offsetTop-e.offsetTop;}finally{document.body.removeChild(b);}return c;},toRadians$$module$build$src$core$utils$math=function toRadians$$module$build$src$core$utils$math(a){return a*Math.PI/180;},toDegrees$$module$build$src$core$utils$math=function toDegrees$$module$build$src$core$utils$math(a){return 180*a/Math.PI;},clamp$$module$build$src$core$utils$math=function clamp$$module$build$src$core$utils$math(a,b,c){if(c<a){var d=c;c=a;a=d;}return Math.max(a,Math.min(b,c));},warn$$module$build$src$core$utils$deprecation=function warn$$module$build$src$core$utils$deprecation(a,b,c,d){a=a+" was deprecated in "+b+" and will be deleted in "+c+".";d&&(a+="\nUse "+d+" instead.");console.warn(a);},getSize$$module$build$src$core$utils$style=function getSize$$module$build$src$core$utils$style(a){return TEST_ONLY$$module$build$src$core$utils$style.getSizeInternal(a);},getSizeInternal$$module$build$src$core$utils$style=function getSizeInternal$$module$build$src$core$utils$style(a){if("none"!==getComputedStyle$$module$build$src$core$utils$style(a,"display"))return getSizeWithDisplay$$module$build$src$core$utils$style(a);var b=a.style,c=b.display,d=b.visibility,e=b.position;b.visibility="hidden";b.position="absolute";b.display="inline";var f=a.offsetWidth;a=a.offsetHeight;b.display=c;b.position=e;b.visibility=d;return new Size$$module$build$src$core$utils$size(f,a);},getSizeWithDisplay$$module$build$src$core$utils$style=function getSizeWithDisplay$$module$build$src$core$utils$style(a){return new Size$$module$build$src$core$utils$size(a.offsetWidth,a.offsetHeight);},getComputedStyle$$module$build$src$core$utils$style=function getComputedStyle$$module$build$src$core$utils$style(a,b){a=window.getComputedStyle(a);return a[b]||a.getPropertyValue(b);},getCascadedStyle$$module$build$src$core$utils$style=function getCascadedStyle$$module$build$src$core$utils$style(a,b){warn$$module$build$src$core$utils$deprecation("Blockly.utils.style.getCascadedStyle","version 9","version 10");return a.currentStyle?a.currentStyle[b]:"";},getPageOffset$$module$build$src$core$utils$style=function getPageOffset$$module$build$src$core$utils$style(a){var b=new Coordinate$$module$build$src$core$utils$coordinate(0,0);a=a.getBoundingClientRect();var c=document.documentElement;c=new Coordinate$$module$build$src$core$utils$coordinate(window.pageXOffset||c.scrollLeft,window.pageYOffset||c.scrollTop);b.x=a.left+c.x;b.y=a.top+c.y;return b;},getViewportPageOffset$$module$build$src$core$utils$style=function getViewportPageOffset$$module$build$src$core$utils$style(){var a=document.body,b=document.documentElement;return new Coordinate$$module$build$src$core$utils$coordinate(a.scrollLeft||b.scrollLeft,a.scrollTop||b.scrollTop);},getBorderBox$$module$build$src$core$utils$style=function getBorderBox$$module$build$src$core$utils$style(a){var b=parseFloat(getComputedStyle$$module$build$src$core$utils$style(a,"borderLeftWidth")),c=parseFloat(getComputedStyle$$module$build$src$core$utils$style(a,"borderRightWidth")),d=parseFloat(getComputedStyle$$module$build$src$core$utils$style(a,"borderTopWidth"));a=parseFloat(getComputedStyle$$module$build$src$core$utils$style(a,"borderBottomWidth"));return new Rect$$module$build$src$core$utils$rect(d,a,b,c);},scrollIntoContainerView$$module$build$src$core$utils$style=function scrollIntoContainerView$$module$build$src$core$utils$style(a,b,c){a=getContainerOffsetToScrollInto$$module$build$src$core$utils$style(a,b,c);b.scrollLeft=a.x;b.scrollTop=a.y;},getContainerOffsetToScrollInto$$module$build$src$core$utils$style=function getContainerOffsetToScrollInto$$module$build$src$core$utils$style(a,b,c){var d=getPageOffset$$module$build$src$core$utils$style(a),e=getPageOffset$$module$build$src$core$utils$style(b),f=getBorderBox$$module$build$src$core$utils$style(b);var g=d.x-e.x-f.left;d=d.y-e.y-f.top;e=getSizeWithDisplay$$module$build$src$core$utils$style(a);a=b.clientWidth-e.width;e=b.clientHeight-e.height;f=b.scrollLeft;b=b.scrollTop;c?(f+=g-a/2,b+=d-e/2):(f+=Math.min(g,Math.max(g-a,0)),b+=Math.min(d,Math.max(d-e,0)));return new Coordinate$$module$build$src$core$utils$coordinate(f,b);},createDom$$module$build$src$core$dropdowndiv=function createDom$$module$build$src$core$dropdowndiv(){div$$module$build$src$core$dropdowndiv||(div$$module$build$src$core$dropdowndiv=document.createElement("div"),div$$module$build$src$core$dropdowndiv.className="blocklyDropDownDiv",(getParentContainer$$module$build$src$core$common()||document.body).appendChild(div$$module$build$src$core$dropdowndiv),content$$module$build$src$core$dropdowndiv=document.createElement("div"),content$$module$build$src$core$dropdowndiv.className="blocklyDropDownContent",div$$module$build$src$core$dropdowndiv.appendChild(content$$module$build$src$core$dropdowndiv),arrow$$module$build$src$core$dropdowndiv=document.createElement("div"),arrow$$module$build$src$core$dropdowndiv.className="blocklyDropDownArrow",div$$module$build$src$core$dropdowndiv.appendChild(arrow$$module$build$src$core$dropdowndiv),div$$module$build$src$core$dropdowndiv.style.opacity="0",div$$module$build$src$core$dropdowndiv.style.transition="transform "+ANIMATION_TIME$$module$build$src$core$dropdowndiv+"s, opacity "+ANIMATION_TIME$$module$build$src$core$dropdowndiv+"s",div$$module$build$src$core$dropdowndiv.addEventListener("focusin",function(){addClass$$module$build$src$core$utils$dom(div$$module$build$src$core$dropdowndiv,"blocklyFocused");}),div$$module$build$src$core$dropdowndiv.addEventListener("focusout",function(){removeClass$$module$build$src$core$utils$dom(div$$module$build$src$core$dropdowndiv,"blocklyFocused");}));},setBoundsElement$$module$build$src$core$dropdowndiv=function setBoundsElement$$module$build$src$core$dropdowndiv(a){boundsElement$$module$build$src$core$dropdowndiv=a;},getContentDiv$$module$build$src$core$dropdowndiv=function getContentDiv$$module$build$src$core$dropdowndiv(){return content$$module$build$src$core$dropdowndiv;},clearContent$$module$build$src$core$dropdowndiv=function clearContent$$module$build$src$core$dropdowndiv(){content$$module$build$src$core$dropdowndiv.textContent="";content$$module$build$src$core$dropdowndiv.style.width="";},setColour$$module$build$src$core$dropdowndiv=function setColour$$module$build$src$core$dropdowndiv(a,b){div$$module$build$src$core$dropdowndiv.style.backgroundColor=a;div$$module$build$src$core$dropdowndiv.style.borderColor=b;},showPositionedByBlock$$module$build$src$core$dropdowndiv=function showPositionedByBlock$$module$build$src$core$dropdowndiv(a,b,c,d){return showPositionedByRect$$module$build$src$core$dropdowndiv(getScaledBboxOfBlock$$module$build$src$core$dropdowndiv(b),a,c,d);},showPositionedByField$$module$build$src$core$dropdowndiv=function showPositionedByField$$module$build$src$core$dropdowndiv(a,b,c){positionToField$$module$build$src$core$dropdowndiv=!0;return showPositionedByRect$$module$build$src$core$dropdowndiv(getScaledBboxOfField$$module$build$src$core$dropdowndiv(a),a,b,c);},getScaledBboxOfBlock$$module$build$src$core$dropdowndiv=function getScaledBboxOfBlock$$module$build$src$core$dropdowndiv(a){var b=a.getSvgRoot();var c=a.workspace.scale,d=a.height*c;a=a.width*c;b=getPageOffset$$module$build$src$core$utils$style(b);return new Rect$$module$build$src$core$utils$rect(b.y,b.y+d,b.x,b.x+a);},getScaledBboxOfField$$module$build$src$core$dropdowndiv=function getScaledBboxOfField$$module$build$src$core$dropdowndiv(a){a=a.getScaledBBox();return new Rect$$module$build$src$core$utils$rect(a.top,a.bottom,a.left,a.right);},showPositionedByRect$$module$build$src$core$dropdowndiv=function showPositionedByRect$$module$build$src$core$dropdowndiv(a,b,c,d){var e=a.left+(a.right-a.left)/2,f=a.bottom;a=a.top;d&&(a+=d);d=b.getSourceBlock();var g=d.workspace;for(;g.options.parentWorkspace;){g=g.options.parentWorkspace;}setBoundsElement$$module$build$src$core$dropdowndiv(g.getParentSvg().parentNode);return show$$module$build$src$core$dropdowndiv(b,d.RTL,e,f,e,a,c);},show$$module$build$src$core$dropdowndiv=function show$$module$build$src$core$dropdowndiv(a,b,c,d,e,f,g){owner$$module$build$src$core$dropdowndiv=a;onHide$$module$build$src$core$dropdowndiv=g||null;div$$module$build$src$core$dropdowndiv.style.direction=b?"rtl":"ltr";a=getMainWorkspace$$module$build$src$core$common();renderedClassName$$module$build$src$core$dropdowndiv=a.getRenderer().getClassName();themeClassName$$module$build$src$core$dropdowndiv=a.getTheme().getClassName();renderedClassName$$module$build$src$core$dropdowndiv&&addClass$$module$build$src$core$utils$dom(div$$module$build$src$core$dropdowndiv,renderedClassName$$module$build$src$core$dropdowndiv);themeClassName$$module$build$src$core$dropdowndiv&&addClass$$module$build$src$core$utils$dom(div$$module$build$src$core$dropdowndiv,themeClassName$$module$build$src$core$dropdowndiv);return positionInternal$$module$build$src$core$dropdowndiv(c,d,e,f);},getPositionBelowMetrics$$module$build$src$core$dropdowndiv=function getPositionBelowMetrics$$module$build$src$core$dropdowndiv(a,b,c,d){a=getPositionX$$module$build$src$core$dropdowndiv(a,c.left,c.right,d.width);return{initialX:a.divX,initialY:b,finalX:a.divX,finalY:b+PADDING_Y$$module$build$src$core$dropdowndiv,arrowX:a.arrowX,arrowY:-(ARROW_SIZE$$module$build$src$core$dropdowndiv/2+BORDER_SIZE$$module$build$src$core$dropdowndiv),arrowAtTop:!0,arrowVisible:!0};},getPositionAboveMetrics$$module$build$src$core$dropdowndiv=function getPositionAboveMetrics$$module$build$src$core$dropdowndiv(a,b,c,d){a=getPositionX$$module$build$src$core$dropdowndiv(a,c.left,c.right,d.width);return{initialX:a.divX,initialY:b-d.height,finalX:a.divX,finalY:b-d.height-PADDING_Y$$module$build$src$core$dropdowndiv,arrowX:a.arrowX,arrowY:d.height-2*BORDER_SIZE$$module$build$src$core$dropdowndiv-ARROW_SIZE$$module$build$src$core$dropdowndiv/2,arrowAtTop:!1,arrowVisible:!0};},getPositionTopOfPageMetrics$$module$build$src$core$dropdowndiv=function getPositionTopOfPageMetrics$$module$build$src$core$dropdowndiv(a,b,c){a=getPositionX$$module$build$src$core$dropdowndiv(a,b.left,b.right,c.width);return{initialX:a.divX,initialY:0,finalX:a.divX,finalY:0,arrowAtTop:null,arrowX:null,arrowY:null,arrowVisible:!1};},getPositionX$$module$build$src$core$dropdowndiv=function getPositionX$$module$build$src$core$dropdowndiv(a,b,c,d){b=clamp$$module$build$src$core$utils$math(b,a-d/2,c-d);a=a-ARROW_SIZE$$module$build$src$core$dropdowndiv/2-b;c=ARROW_HORIZONTAL_PADDING$$module$build$src$core$dropdowndiv;a=clamp$$module$build$src$core$utils$math(c,a,d-c-ARROW_SIZE$$module$build$src$core$dropdowndiv);return{arrowX:a,divX:b};},isVisible$$module$build$src$core$dropdowndiv=function isVisible$$module$build$src$core$dropdowndiv(){return!!owner$$module$build$src$core$dropdowndiv;},hideIfOwner$$module$build$src$core$dropdowndiv=function hideIfOwner$$module$build$src$core$dropdowndiv(a,b){return owner$$module$build$src$core$dropdowndiv===a?(b?hideWithoutAnimation$$module$build$src$core$dropdowndiv():hide$$module$build$src$core$dropdowndiv(),!0):!1;},hide$$module$build$src$core$dropdowndiv=function hide$$module$build$src$core$dropdowndiv(){div$$module$build$src$core$dropdowndiv.style.transform="translate(0, 0)";div$$module$build$src$core$dropdowndiv.style.opacity="0";animateOutTimer$$module$build$src$core$dropdowndiv=setTimeout(function(){hideWithoutAnimation$$module$build$src$core$dropdowndiv();},1E3*ANIMATION_TIME$$module$build$src$core$dropdowndiv);onHide$$module$build$src$core$dropdowndiv&&(onHide$$module$build$src$core$dropdowndiv(),onHide$$module$build$src$core$dropdowndiv=null);},hideWithoutAnimation$$module$build$src$core$dropdowndiv=function hideWithoutAnimation$$module$build$src$core$dropdowndiv(){isVisible$$module$build$src$core$dropdowndiv()&&(animateOutTimer$$module$build$src$core$dropdowndiv&&clearTimeout(animateOutTimer$$module$build$src$core$dropdowndiv),div$$module$build$src$core$dropdowndiv.style.transform="",div$$module$build$src$core$dropdowndiv.style.left="",div$$module$build$src$core$dropdowndiv.style.top="",div$$module$build$src$core$dropdowndiv.style.opacity="0",div$$module$build$src$core$dropdowndiv.style.display="none",div$$module$build$src$core$dropdowndiv.style.backgroundColor="",div$$module$build$src$core$dropdowndiv.style.borderColor="",onHide$$module$build$src$core$dropdowndiv&&(onHide$$module$build$src$core$dropdowndiv(),onHide$$module$build$src$core$dropdowndiv=null),clearContent$$module$build$src$core$dropdowndiv(),owner$$module$build$src$core$dropdowndiv=null,renderedClassName$$module$build$src$core$dropdowndiv&&(removeClass$$module$build$src$core$utils$dom(div$$module$build$src$core$dropdowndiv,renderedClassName$$module$build$src$core$dropdowndiv),renderedClassName$$module$build$src$core$dropdowndiv=""),themeClassName$$module$build$src$core$dropdowndiv&&(removeClass$$module$build$src$core$utils$dom(div$$module$build$src$core$dropdowndiv,themeClassName$$module$build$src$core$dropdowndiv),themeClassName$$module$build$src$core$dropdowndiv=""),getMainWorkspace$$module$build$src$core$common().markFocused());},positionInternal$$module$build$src$core$dropdowndiv=function positionInternal$$module$build$src$core$dropdowndiv(a,b,c,d){a=internal$$module$build$src$core$dropdowndiv.getPositionMetrics(a,b,c,d);a.arrowVisible?(arrow$$module$build$src$core$dropdowndiv.style.display="",arrow$$module$build$src$core$dropdowndiv.style.transform="translate("+a.arrowX+"px,"+a.arrowY+"px) rotate(45deg)",arrow$$module$build$src$core$dropdowndiv.setAttribute("class",a.arrowAtTop?"blocklyDropDownArrow blocklyArrowTop":"blocklyDropDownArrow blocklyArrowBottom")):arrow$$module$build$src$core$dropdowndiv.style.display="none";b=Math.floor(a.initialX);c=Math.floor(a.initialY);d=Math.floor(a.finalX);var e=Math.floor(a.finalY);div$$module$build$src$core$dropdowndiv.style.left=b+"px";div$$module$build$src$core$dropdowndiv.style.top=c+"px";div$$module$build$src$core$dropdowndiv.style.display="block";div$$module$build$src$core$dropdowndiv.style.opacity="1";div$$module$build$src$core$dropdowndiv.style.transform="translate("+(d-b)+"px,"+(e-c)+"px)";return!!a.arrowAtTop;},repositionForWindowResize$$module$build$src$core$dropdowndiv=function repositionForWindowResize$$module$build$src$core$dropdowndiv(){if(owner$$module$build$src$core$dropdowndiv){var a=owner$$module$build$src$core$dropdowndiv.getSourceBlock();a=positionToField$$module$build$src$core$dropdowndiv?getScaledBboxOfField$$module$build$src$core$dropdowndiv(owner$$module$build$src$core$dropdowndiv):getScaledBboxOfBlock$$module$build$src$core$dropdowndiv(a);var b=a.left+(a.right-a.left)/2;positionInternal$$module$build$src$core$dropdowndiv(b,a.bottom,b,a.top);}else hide$$module$build$src$core$dropdowndiv();},register$$module$build$src$core$registry=function register$$module$build$src$core$registry(a,b,c,d){if(!(a instanceof Type$$module$build$src$core$registry)&&"string"!==typeof a||""===String(a).trim())throw Error('Invalid type "'+a+'". The type must be a non-empty string or a Blockly.registry.Type.');a=String(a).toLowerCase();if("string"!==typeof b||""===b.trim())throw Error('Invalid name "'+b+'". The name must be a non-empty string.');var e=b.toLowerCase();if(!c)throw Error("Can not register a null value");var f=typeMap$$module$build$src$core$registry[a],g=nameMap$$module$build$src$core$registry[a];f||(f=typeMap$$module$build$src$core$registry[a]=Object.create(null),g=nameMap$$module$build$src$core$registry[a]=Object.create(null));validate$$module$build$src$core$registry(a,c);if(!d&&f[e])throw Error('Name "'+e+'" with type "'+a+'" already registered.');f[e]=c;g[e]=b;},validate$$module$build$src$core$registry=function validate$$module$build$src$core$registry(a,b){switch(a){case String(Type$$module$build$src$core$registry.FIELD):if("function"!==typeof b.fromJson)throw Error('Type "'+a+'" must have a fromJson function');}},unregister$$module$build$src$core$registry=function unregister$$module$build$src$core$registry(a,b){a=String(a).toLowerCase();b=b.toLowerCase();var c=typeMap$$module$build$src$core$registry[a];c&&c[b]?(delete typeMap$$module$build$src$core$registry[a][b],delete nameMap$$module$build$src$core$registry[a][b]):console.warn("Unable to unregister ["+b+"]["+a+"] from the registry.");},getItem$$module$build$src$core$registry=function getItem$$module$build$src$core$registry(a,b,c){a=String(a).toLowerCase();b=b.toLowerCase();var d=typeMap$$module$build$src$core$registry[a];if(!d||!d[b]){b="Unable to find ["+b+"]["+a+"] in the registry.";if(c)throw Error(b+" You must require or register a "+a+" plugin.");console.warn(b);return null;}return d[b];},hasItem$$module$build$src$core$registry=function hasItem$$module$build$src$core$registry(a,b){a=String(a).toLowerCase();b=b.toLowerCase();return(a=typeMap$$module$build$src$core$registry[a])?!!a[b]:!1;},getClass$$module$build$src$core$registry=function getClass$$module$build$src$core$registry(a,b,c){return getItem$$module$build$src$core$registry(a,b,c);},getObject$$module$build$src$core$registry=function getObject$$module$build$src$core$registry(a,b,c){return getItem$$module$build$src$core$registry(a,b,c);},getAllItems$$module$build$src$core$registry=function getAllItems$$module$build$src$core$registry(a,b,c){a=String(a).toLowerCase();var d=typeMap$$module$build$src$core$registry[a];if(!d){d="Unable to find [".concat(a,"] in the registry.");if(c)throw Error("".concat(d," You must require or register a ").concat(a," plugin."));console.warn(d);return null;}if(!b)return d;a=nameMap$$module$build$src$core$registry[a];c=Object.create(null);b=Object.keys(d);for(var e=0;e<b.length;e++){var f=b[e];c[a[f]]=d[f];}return c;},getClassFromOptions$$module$build$src$core$registry=function getClassFromOptions$$module$build$src$core$registry(a,b,c){b=b.plugins[a.toString()]||DEFAULT$$module$build$src$core$registry;return"function"===typeof b?b:getClass$$module$build$src$core$registry(a,b,c);},getNextUniqueId$$module$build$src$core$utils$idgenerator=function getNextUniqueId$$module$build$src$core$utils$idgenerator(){return"blockly-"+(nextId$$module$build$src$core$utils$idgenerator++).toString(36);},genUid$$module$build$src$core$utils$idgenerator=function genUid$$module$build$src$core$utils$idgenerator(){return internal$$module$build$src$core$utils$idgenerator.genUid();},setRecordUndo$$module$build$src$core$events$utils=function setRecordUndo$$module$build$src$core$events$utils(a){recordUndo$$module$build$src$core$events$utils=a;},getRecordUndo$$module$build$src$core$events$utils=function getRecordUndo$$module$build$src$core$events$utils(){return recordUndo$$module$build$src$core$events$utils;},fire$$module$build$src$core$events$utils=function fire$$module$build$src$core$events$utils(a){TEST_ONLY$$module$build$src$core$events$utils.fireInternal(a);},fireInternal$$module$build$src$core$events$utils=function fireInternal$$module$build$src$core$events$utils(a){isEnabled$$module$build$src$core$events$utils()&&(FIRE_QUEUE$$module$build$src$core$events$utils.length||setTimeout(fireNow$$module$build$src$core$events$utils,0),FIRE_QUEUE$$module$build$src$core$events$utils.push(a));},fireNow$$module$build$src$core$events$utils=function fireNow$$module$build$src$core$events$utils(){var a=filter$$module$build$src$core$events$utils(FIRE_QUEUE$$module$build$src$core$events$utils,!0);FIRE_QUEUE$$module$build$src$core$events$utils.length=0;for(var b=0,c;c=a[b];b++){if(!c.workspaceId)continue;var d=getWorkspaceById$$module$build$src$core$common(c.workspaceId);d&&d.fireChangeListener(c);}},filter$$module$build$src$core$events$utils=function filter$$module$build$src$core$events$utils(a,b){a=a.slice();b||a.reverse();var c=[],d=Object.create(null);for(var g=0,h;h=a[g];g++){if(!h.isNull()){var e=[h.isUiEvent?UI$$module$build$src$core$events$utils:h.type,h.blockId,h.workspaceId].join(" "),f=d[e];var k=f?f.event:null;if(!f)d[e]={event:h,index:g},c.push(h);else if(h.type===MOVE$$module$build$src$core$events$utils&&f.index===g-1)e=h,k.newParentId=e.newParentId,k.newInputName=e.newInputName,k.newCoordinate=e.newCoordinate,f.index=g;else if(h.type===CHANGE$$module$build$src$core$events$utils&&h.element===k.element&&h.name===k.name)k.newValue=h.newValue;else if(h.type===VIEWPORT_CHANGE$$module$build$src$core$events$utils)f=h,k.viewTop=f.viewTop,k.viewLeft=f.viewLeft,k.scale=f.scale,k.oldScale=f.oldScale;else if(h.type!==CLICK$$module$build$src$core$events$utils||k.type!==BUBBLE_OPEN$$module$build$src$core$events$utils)d[e]={event:h,index:g},c.push(h);}}a=c.filter(function(g){return!g.isNull();});b||a.reverse();for(var _g=1,_h;_h=a[_g];_g++){_h.type===CHANGE$$module$build$src$core$events$utils&&"mutation"===_h.element&&a.unshift(a.splice(_g,1)[0]);}return a;},clearPendingUndo$$module$build$src$core$events$utils=function clearPendingUndo$$module$build$src$core$events$utils(){for(var a=0,b;b=FIRE_QUEUE$$module$build$src$core$events$utils[a];a++){b.recordUndo=!1;}},disable$$module$build$src$core$events$utils=function disable$$module$build$src$core$events$utils(){disabled$$module$build$src$core$events$utils++;},enable$$module$build$src$core$events$utils=function enable$$module$build$src$core$events$utils(){disabled$$module$build$src$core$events$utils--;},isEnabled$$module$build$src$core$events$utils=function isEnabled$$module$build$src$core$events$utils(){return 0===disabled$$module$build$src$core$events$utils;},getGroup$$module$build$src$core$events$utils=function getGroup$$module$build$src$core$events$utils(){return group$$module$build$src$core$events$utils;},setGroup$$module$build$src$core$events$utils=function setGroup$$module$build$src$core$events$utils(a){TEST_ONLY$$module$build$src$core$events$utils.setGroupInternal(a);},setGroupInternal$$module$build$src$core$events$utils=function setGroupInternal$$module$build$src$core$events$utils(a){group$$module$build$src$core$events$utils="boolean"===typeof a?a?genUid$$module$build$src$core$utils$idgenerator():"":a;},getDescendantIds$$module$build$src$core$events$utils=function getDescendantIds$$module$build$src$core$events$utils(a){var b=[];a=a.getDescendants(!1);for(var c=0,d;d=a[c];c++){b[c]=d.id;}return b;},fromJson$$module$build$src$core$events$utils=function fromJson$$module$build$src$core$events$utils(a,b){var c=get$$module$build$src$core$events$utils(a.type);if(!c)throw Error("Unknown event type.");c=new c();c.fromJson(a);c.workspaceId=b.id;return c;},get$$module$build$src$core$events$utils=function get$$module$build$src$core$events$utils(a){var b=getClass$$module$build$src$core$registry(Type$$module$build$src$core$registry.EVENT,a);if(!b)throw Error("Event type ".concat(a," not found in registry."));return b;},disableOrphans$$module$build$src$core$events$utils=function disableOrphans$$module$build$src$core$events$utils(a){if((a.type===MOVE$$module$build$src$core$events$utils||a.type===CREATE$$module$build$src$core$events$utils)&&a.workspaceId){var b=getWorkspaceById$$module$build$src$core$common(a.workspaceId);if(!a.blockId)throw Error("Encountered a blockEvent without a proper blockId");if(a=b.getBlockById(a.blockId)){var c=recordUndo$$module$build$src$core$events$utils;try{recordUndo$$module$build$src$core$events$utils=!1;var d=a.getParent();if(d&&d.isEnabled()){var e=a.getDescendants(!1);for(var f=0,g;g=e[f];f++){g.setEnabled(!0);}}else if((a.outputConnection||a.previousConnection)&&!b.isDragging()){do{a.setEnabled(!1),a=a.getNextBlock();}while(a);}}finally{recordUndo$$module$build$src$core$events$utils=c;}}}},getDocument$$module$build$src$core$utils$xml=function getDocument$$module$build$src$core$utils$xml(){return xmlDocument$$module$build$src$core$utils$xml;},setDocument$$module$build$src$core$utils$xml=function setDocument$$module$build$src$core$utils$xml(a){xmlDocument$$module$build$src$core$utils$xml=a;},createElement$$module$build$src$core$utils$xml=function createElement$$module$build$src$core$utils$xml(a){return xmlDocument$$module$build$src$core$utils$xml.createElementNS(NAME_SPACE$$module$build$src$core$utils$xml,a);},createTextNode$$module$build$src$core$utils$xml=function createTextNode$$module$build$src$core$utils$xml(a){return xmlDocument$$module$build$src$core$utils$xml.createTextNode(a);},textToDomDocument$$module$build$src$core$utils$xml=function textToDomDocument$$module$build$src$core$utils$xml(a){return new DOMParser().parseFromString(a,"text/xml");},domToText$$module$build$src$core$utils$xml=function domToText$$module$build$src$core$utils$xml(a){return new XMLSerializer().serializeToString(a);},alert$$module$build$src$core$dialog=function alert$$module$build$src$core$dialog(a,b){alertImplementation$$module$build$src$core$dialog(a,b);},setAlert$$module$build$src$core$dialog=function setAlert$$module$build$src$core$dialog(a){alertImplementation$$module$build$src$core$dialog=a;},confirm$$module$build$src$core$dialog=function confirm$$module$build$src$core$dialog(a,b){TEST_ONLY$$module$build$src$core$dialog.confirmInternal(a,b);},confirmInternal$$module$build$src$core$dialog=function confirmInternal$$module$build$src$core$dialog(a,b){confirmImplementation$$module$build$src$core$dialog(a,b);},setConfirm$$module$build$src$core$dialog=function setConfirm$$module$build$src$core$dialog(a){confirmImplementation$$module$build$src$core$dialog=a;},prompt$$module$build$src$core$dialog=function prompt$$module$build$src$core$dialog(a,b,c){promptImplementation$$module$build$src$core$dialog(a,b,c);},setPrompt$$module$build$src$core$dialog=function setPrompt$$module$build$src$core$dialog(a){promptImplementation$$module$build$src$core$dialog=a;},allUsedVarModels$$module$build$src$core$variables=function allUsedVarModels$$module$build$src$core$variables(a){a=a.getAllBlocks(!1);var b=new Set();for(var c=0;c<a.length;c++){var d=a[c].getVarModels();if(d)for(var e=0;e<d.length;e++){var f=d[e];f.getId()&&b.add(f);}}return Array.from(b.values());},allDeveloperVariables$$module$build$src$core$variables=function allDeveloperVariables$$module$build$src$core$variables(a){a=a.getAllBlocks(!1);var b=new Set();for(var d=0,e;e=a[d];d++){var c=e.getDeveloperVariables;if(c){c=c();for(var f=0;f<c.length;f++){b.add(c[f]);}}}return Array.from(b.values());},flyoutCategory$$module$build$src$core$variables=function flyoutCategory$$module$build$src$core$variables(a){var b=[];var c=document.createElement("button");c.setAttribute("text","%{BKY_NEW_VARIABLE}");c.setAttribute("callbackKey","CREATE_VARIABLE");a.registerButtonCallback("CREATE_VARIABLE",function(d){createVariableButtonHandler$$module$build$src$core$variables(d.getTargetWorkspace());});b.push(c);a=flyoutCategoryBlocks$$module$build$src$core$variables(a);return b=b.concat(a);},flyoutCategoryBlocks$$module$build$src$core$variables=function flyoutCategoryBlocks$$module$build$src$core$variables(a){a=a.getVariablesOfType("");var b=[];if(0<a.length){var c=a[a.length-1];if(Blocks$$module$build$src$core$blocks.variables_set){var d=createElement$$module$build$src$core$utils$xml("block");d.setAttribute("type","variables_set");d.setAttribute("gap",Blocks$$module$build$src$core$blocks.math_change?"8":"24");d.appendChild(generateVariableFieldDom$$module$build$src$core$variables(c));b.push(d);}Blocks$$module$build$src$core$blocks.math_change&&(d=createElement$$module$build$src$core$utils$xml("block"),d.setAttribute("type","math_change"),d.setAttribute("gap",Blocks$$module$build$src$core$blocks.variables_get?"20":"8"),d.appendChild(generateVariableFieldDom$$module$build$src$core$variables(c)),c=textToDom$$module$build$src$core$xml('<value name="DELTA"><shadow type="math_number"><field name="NUM">1</field></shadow></value>'),d.appendChild(c),b.push(d));if(Blocks$$module$build$src$core$blocks.variables_get){a.sort(VariableModel$$module$build$src$core$variable_model.compareByName);for(var e=0,f;f=a[e];e++){c=createElement$$module$build$src$core$utils$xml("block"),c.setAttribute("type","variables_get"),c.setAttribute("gap","8"),c.appendChild(generateVariableFieldDom$$module$build$src$core$variables(f)),b.push(c);}}}return b;},generateUniqueName$$module$build$src$core$variables=function generateUniqueName$$module$build$src$core$variables(a){return TEST_ONLY$$module$build$src$core$variables.generateUniqueNameInternal(a);},generateUniqueNameInternal$$module$build$src$core$variables=function generateUniqueNameInternal$$module$build$src$core$variables(a){return generateUniqueNameFromOptions$$module$build$src$core$variables(VAR_LETTER_OPTIONS$$module$build$src$core$variables.charAt(0),a.getAllVariableNames());},generateUniqueNameFromOptions$$module$build$src$core$variables=function generateUniqueNameFromOptions$$module$build$src$core$variables(a,b){if(!b.length)return a;var c=VAR_LETTER_OPTIONS$$module$build$src$core$variables;var d="",e=c.indexOf(a);for(;;){var f=!1;for(var g=0;g<b.length;g++){if(b[g].toLowerCase()===a){f=!0;break;}}if(!f)return a;e++;e===c.length&&(e=0,d="".concat(Number(d)+1));a=c.charAt(e)+d;}},createVariableButtonHandler$$module$build$src$core$variables=function createVariableButtonHandler$$module$build$src$core$variables(a,b,c){function d(f){promptName$$module$build$src$core$variables(Msg$$module$build$src$core$msg.NEW_VARIABLE_TITLE,f,function(g){if(g){var h=nameUsedWithAnyType$$module$build$src$core$variables(g,a);if(h){var k;h.type===e?k=Msg$$module$build$src$core$msg.VARIABLE_ALREADY_EXISTS.replace("%1",h.name):(k=Msg$$module$build$src$core$msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE,k=k.replace("%1",h.name).replace("%2",h.type));alert$$module$build$src$core$dialog(k,function(){d(g);});}else a.createVariable(g,e),b&&b(g);}else b&&b(null);});}var e=c||"";d("");},renameVariable$$module$build$src$core$variables=function renameVariable$$module$build$src$core$variables(a,b,c){function d(e){var f=Msg$$module$build$src$core$msg.RENAME_VARIABLE_TITLE.replace("%1",b.name);promptName$$module$build$src$core$variables(f,e,function(g){if(g){var h=nameUsedWithOtherType$$module$build$src$core$variables(g,b.type,a);h?(h=Msg$$module$build$src$core$msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE.replace("%1",h.name).replace("%2",h.type),alert$$module$build$src$core$dialog(h,function(){d(g);})):(a.renameVariableById(b.getId(),g),c&&c(g));}else c&&c(null);});}d("");},promptName$$module$build$src$core$variables=function promptName$$module$build$src$core$variables(a,b,c){prompt$$module$build$src$core$dialog(a,b,function(d){d&&(d=d.replace(/[\s\xa0]+/g," ").trim(),d===Msg$$module$build$src$core$msg.RENAME_VARIABLE||d===Msg$$module$build$src$core$msg.NEW_VARIABLE)&&(d=null);c(d);});},nameUsedWithOtherType$$module$build$src$core$variables=function nameUsedWithOtherType$$module$build$src$core$variables(a,b,c){c=c.getVariableMap().getAllVariables();a=a.toLowerCase();for(var d=0,e;e=c[d];d++){if(e.name.toLowerCase()===a&&e.type!==b)return e;}return null;},nameUsedWithAnyType$$module$build$src$core$variables=function nameUsedWithAnyType$$module$build$src$core$variables(a,b){b=b.getVariableMap().getAllVariables();a=a.toLowerCase();for(var c=0,d;d=b[c];c++){if(d.name.toLowerCase()===a)return d;}return null;},generateVariableFieldDom$$module$build$src$core$variables=function generateVariableFieldDom$$module$build$src$core$variables(a){var b=createElement$$module$build$src$core$utils$xml("field");b.setAttribute("name","VAR");b.setAttribute("id",a.getId());b.setAttribute("variabletype",a.type);a=createTextNode$$module$build$src$core$utils$xml(a.name);b.appendChild(a);return b;},getOrCreateVariablePackage$$module$build$src$core$variables=function getOrCreateVariablePackage$$module$build$src$core$variables(a,b,c,d){var e=getVariable$$module$build$src$core$variables(a,b,c,d);e||(e=createVariable$$module$build$src$core$variables(a,b,c,d));return e;},getVariable$$module$build$src$core$variables=function getVariable$$module$build$src$core$variables(a,b,c,d){var e=a.getPotentialVariableMap();var f=null;if(b&&(f=a.getVariableById(b),!f&&e&&(f=e.getVariableById(b)),f))return f;if(c){if(void 0===d)throw Error("Tried to look up a variable by name without a type");f=a.getVariable(c,d);!f&&e&&(f=e.getVariable(c,d));}return f;},createVariable$$module$build$src$core$variables=function createVariable$$module$build$src$core$variables(a,b,c,d){var e=a.getPotentialVariableMap();c||(c=generateUniqueName$$module$build$src$core$variables(a.isFlyout?a.targetWorkspace:a));return e?e.createVariable(c,d,b):a.createVariable(c,d,b);},getAddedVariables$$module$build$src$core$variables=function getAddedVariables$$module$build$src$core$variables(a,b){a=a.getAllVariables();var c=[];if(b.length!==a.length)for(var d=0;d<a.length;d++){var e=a[d];-1===b.indexOf(e)&&c.push(e);}return c;},register$$module$build$src$core$css=function register$$module$build$src$core$css(a){if(injected$$module$build$src$core$css)throw Error("CSS already injected");content$$module$build$src$core$css+="\n"+a;},inject$$module$build$src$core$css=function inject$$module$build$src$core$css(a,b){injected$$module$build$src$core$css||(injected$$module$build$src$core$css=!0,a&&(a=b.replace(/[\\/]$/,""),b=content$$module$build$src$core$css.replace(/<<<PATH>>>/g,a),content$$module$build$src$core$css="",a=document.createElement("style"),a.id="blockly-common-style",b=document.createTextNode(b),a.appendChild(b),document.head.insertBefore(a,document.head.firstChild)));},getRelativeXY$$module$build$src$core$utils$svg_math=function getRelativeXY$$module$build$src$core$utils$svg_math(a){var b=new Coordinate$$module$build$src$core$utils$coordinate(0,0);var c=a.x&&a.getAttribute("x");var d=a.y&&a.getAttribute("y");c&&(b.x=parseInt(c));d&&(b.y=parseInt(d));if(c=(c=a.getAttribute("transform"))&&c.match(XY_REGEX$$module$build$src$core$utils$svg_math))b.x+=Number(c[1]),c[3]&&(b.y+=Number(c[3]));(a=a.getAttribute("style"))&&-1<a.indexOf("translate")&&(a=a.match(XY_STYLE_REGEX$$module$build$src$core$utils$svg_math))&&(b.x+=Number(a[1]),a[3]&&(b.y+=Number(a[3])));return b;},getInjectionDivXY$$module$build$src$core$utils$svg_math=function getInjectionDivXY$$module$build$src$core$utils$svg_math(a){var b=0,c=0;for(;a;){var d=getRelativeXY$$module$build$src$core$utils$svg_math(a);b+=d.x;c+=d.y;if(-1!==(" "+(a.getAttribute("class")||"")+" ").indexOf(" injectionDiv "))break;a=a.parentNode;}return new Coordinate$$module$build$src$core$utils$coordinate(b,c);},is3dSupported$$module$build$src$core$utils$svg_math=function is3dSupported$$module$build$src$core$utils$svg_math(){warn$$module$build$src$core$utils$deprecation("Blockly.utils.svgMath.is3dSupported","version 9","version 10");return!0;},getViewportBBox$$module$build$src$core$utils$svg_math=function getViewportBBox$$module$build$src$core$utils$svg_math(){var a=getViewportPageOffset$$module$build$src$core$utils$style();return new Rect$$module$build$src$core$utils$rect(a.y,document.documentElement.clientHeight+a.y,a.x,document.documentElement.clientWidth+a.x);},getDocumentScroll$$module$build$src$core$utils$svg_math=function getDocumentScroll$$module$build$src$core$utils$svg_math(){var a=document.documentElement,b=window;return new Coordinate$$module$build$src$core$utils$coordinate(b.pageXOffset||a.scrollLeft,b.pageYOffset||a.scrollTop);},screenToWsCoordinates$$module$build$src$core$utils$svg_math=function screenToWsCoordinates$$module$build$src$core$utils$svg_math(a,b){var c=b.x;b=b.y;var d=a.getInjectionDiv().getBoundingClientRect();c=new Coordinate$$module$build$src$core$utils$coordinate(c-d.left,b-d.top);b=a.getOriginOffsetInPixels();return Coordinate$$module$build$src$core$utils$coordinate.difference(c,b).scale(1/a.scale);},workspaceToDom$$module$build$src$core$xml=function workspaceToDom$$module$build$src$core$xml(a,b){var c=createElement$$module$build$src$core$utils$xml("xml");var d=variablesToDom$$module$build$src$core$xml(allUsedVarModels$$module$build$src$core$variables(a));d.hasChildNodes()&&c.appendChild(d);d=a.getTopComments(!0);for(var e=0;e<d.length;e++){c.appendChild(d[e].toXmlWithXY(b));}a=a.getTopBlocks(!0);for(d=0;d<a.length;d++){c.appendChild(blockToDomWithXY$$module$build$src$core$xml(a[d],b));}return c;},variablesToDom$$module$build$src$core$xml=function variablesToDom$$module$build$src$core$xml(a){var b=createElement$$module$build$src$core$utils$xml("variables");for(var c=0;c<a.length;c++){var d=a[c],e=createElement$$module$build$src$core$utils$xml("variable");e.appendChild(createTextNode$$module$build$src$core$utils$xml(d.name));d.type&&e.setAttribute("type",d.type);e.id=d.getId();b.appendChild(e);}return b;},blockToDomWithXY$$module$build$src$core$xml=function blockToDomWithXY$$module$build$src$core$xml(a,b){if(a.isInsertionMarker()&&(a=a.getChildren(!1)[0],!a))return new DocumentFragment();var c=0;a.workspace.RTL&&(c=a.workspace.getWidth());b=blockToDom$$module$build$src$core$xml(a,b);var d=a.getRelativeToSurfaceXY();b.setAttribute("x",Math.round(a.workspace.RTL?c-d.x:d.x));b.setAttribute("y",Math.round(d.y));return b;},fieldToDom$$module$build$src$core$xml=function fieldToDom$$module$build$src$core$xml(a){if(a.isSerializable()){var b=createElement$$module$build$src$core$utils$xml("field");b.setAttribute("name",a.name||"");return a.toXml(b);}return null;},allFieldsToDom$$module$build$src$core$xml=function allFieldsToDom$$module$build$src$core$xml(a,b){for(var c=0;c<a.inputList.length;c++){var d=a.inputList[c];for(var e=0;e<d.fieldRow.length;e++){var f=fieldToDom$$module$build$src$core$xml(d.fieldRow[e]);f&&b.appendChild(f);}}},blockToDom$$module$build$src$core$xml=function blockToDom$$module$build$src$core$xml(a,b){if(a.isInsertionMarker())return(b=a.getChildren(!1)[0])?blockToDom$$module$build$src$core$xml(b):new DocumentFragment();var c=createElement$$module$build$src$core$utils$xml(a.isShadow()?"shadow":"block");c.setAttribute("type",a.type);b||c.setAttribute("id",a.id);if(a.mutationToDom){var d=a.mutationToDom();d&&(d.hasChildNodes()||d.hasAttributes())&&c.appendChild(d);}allFieldsToDom$$module$build$src$core$xml(a,c);if(d=a.getCommentText()){var e=a.commentModel.size,f=a.commentModel.pinned,g=createElement$$module$build$src$core$utils$xml("comment");g.appendChild(createTextNode$$module$build$src$core$utils$xml(d));g.setAttribute("pinned",f);g.setAttribute("h",e.height);g.setAttribute("w",e.width);c.appendChild(g);}a.data&&(d=createElement$$module$build$src$core$utils$xml("data"),d.appendChild(createTextNode$$module$build$src$core$utils$xml(a.data)),c.appendChild(d));for(d=0;d<a.inputList.length;d++){e=a.inputList[d];var h=void 0;f=!0;if(e.type!==inputTypes$$module$build$src$core$input_types.DUMMY){g=e.connection.targetBlock();e.type===inputTypes$$module$build$src$core$input_types.VALUE?h=createElement$$module$build$src$core$utils$xml("value"):e.type===inputTypes$$module$build$src$core$input_types.STATEMENT&&(h=createElement$$module$build$src$core$utils$xml("statement"));var l=e.connection.getShadowDom();!l||g&&g.isShadow()||h.appendChild(cloneShadow$$module$build$src$core$xml(l,b));g&&(g=blockToDom$$module$build$src$core$xml(g,b),g.nodeType===NodeType$$module$build$src$core$utils$dom.ELEMENT_NODE&&(h.appendChild(g),f=!1));h.setAttribute("name",e.name);f||c.appendChild(h);}}void 0!==a.inputsInline&&a.inputsInline!==a.inputsInlineDefault&&c.setAttribute("inline",a.inputsInline.toString());a.isCollapsed()&&c.setAttribute("collapsed","true");a.isEnabled()||c.setAttribute("disabled","true");a.isDeletable()||a.isShadow()||c.setAttribute("deletable","false");a.isMovable()||a.isShadow()||c.setAttribute("movable","false");a.isEditable()||c.setAttribute("editable","false");h=a.getNextBlock();var k;h&&(d=blockToDom$$module$build$src$core$xml(h,b),d.nodeType===NodeType$$module$build$src$core$utils$dom.ELEMENT_NODE&&(k=createElement$$module$build$src$core$utils$xml("next"),k.appendChild(d),c.appendChild(k)));a=a.nextConnection&&a.nextConnection.getShadowDom();!a||h&&h.isShadow()||k.appendChild(cloneShadow$$module$build$src$core$xml(a,b));return c;},cloneShadow$$module$build$src$core$xml=function cloneShadow$$module$build$src$core$xml(a,b){var c=a=a.cloneNode(!0),d;for(;c;){if(b&&"shadow"===c.nodeName&&c.removeAttribute("id"),c.firstChild)c=c.firstChild;else{for(;c&&!c.nextSibling;){d=c;c=c.parentNode;var e=void 0;d.nodeType===NodeType$$module$build$src$core$utils$dom.TEXT_NODE&&""===d.data.trim()&&(null==(e=c)?void 0:e.firstChild)!==d&&removeNode$$module$build$src$core$utils$dom(d);}c&&(d=c,c=c.nextSibling,d.nodeType===NodeType$$module$build$src$core$utils$dom.TEXT_NODE&&""===d.data.trim()&&removeNode$$module$build$src$core$utils$dom(d));}}return a;},domToText$$module$build$src$core$xml=function domToText$$module$build$src$core$xml(a){return domToText$$module$build$src$core$utils$xml(a).replace(/<(\w+)([^<]*)\/>/g,"<$1$2></$1>");},domToPrettyText$$module$build$src$core$xml=function domToPrettyText$$module$build$src$core$xml(a){a=domToText$$module$build$src$core$xml(a).split("<");var b="";for(var c=1;c<a.length;c++){var d=a[c];"/"===d[0]&&(b=b.substring(2));a[c]=b+"<"+d;"/"!==d[0]&&"/>"!==d.slice(-2)&&(b+="  ");}a=a.join("\n");a=a.replace(/(<(\w+)\b[^>]*>[^\n]*)\n *<\/\2>/g,"$1</$2>");return a.replace(/^\n/,"");},textToDom$$module$build$src$core$xml=function textToDom$$module$build$src$core$xml(a){var b=textToDomDocument$$module$build$src$core$utils$xml(a);if(!b||!b.documentElement||b.getElementsByTagName("parsererror").length)throw Error("textToDom was unable to parse: "+a);return b.documentElement;},clearWorkspaceAndLoadFromXml$$module$build$src$core$xml=function clearWorkspaceAndLoadFromXml$$module$build$src$core$xml(a,b){b.setResizesEnabled(!1);b.clear();a=domToWorkspace$$module$build$src$core$xml(a,b);b.setResizesEnabled(!0);return a;},domToWorkspace$$module$build$src$core$xml=function domToWorkspace$$module$build$src$core$xml(a,b){var c=0;b.RTL&&(c=b.getWidth());var d=[];startTextWidthCache$$module$build$src$core$utils$dom();var e=getGroup$$module$build$src$core$events$utils();e||setGroup$$module$build$src$core$events$utils(!0);b.setResizesEnabled&&b.setResizesEnabled(!1);var f=!0;try{for(var g=0,h;h=a.childNodes[g];g++){var k=h.nodeName.toLowerCase(),l=h;if("block"===k||"shadow"===k&&!getRecordUndo$$module$build$src$core$events$utils()){var m=domToBlock$$module$build$src$core$xml(l,b);d.push(m.id);var n=l.hasAttribute("x")?parseInt(l.getAttribute("x")):10,p=l.hasAttribute("y")?parseInt(l.getAttribute("y")):10;isNaN(n)||isNaN(p)||m.moveBy(b.RTL?c-n:n,p);f=!1;}else{if("shadow"===k)throw TypeError("Shadow block cannot be a top-level block.");if("comment"===k)b.rendered?WorkspaceCommentSvg$$module$build$src$core$workspace_comment_svg.fromXmlRendered(l,b,c):WorkspaceComment$$module$build$src$core$workspace_comment.fromXml(l,b);else if("variables"===k){if(f)domToVariables$$module$build$src$core$xml(l,b);else throw Error("'variables' tag must exist once before block and shadow tag elements in the workspace XML, but it was found in another location.");f=!1;}}}}finally{e||setGroup$$module$build$src$core$events$utils(!1),stopTextWidthCache$$module$build$src$core$utils$dom();}b.setResizesEnabled&&b.setResizesEnabled(!0);fire$$module$build$src$core$events$utils(new(get$$module$build$src$core$events$utils(FINISHED_LOADING$$module$build$src$core$events$utils))(b));return d;},appendDomToWorkspace$$module$build$src$core$xml=function appendDomToWorkspace$$module$build$src$core$xml(a,b){if(!b.getBlocksBoundingBox)return domToWorkspace$$module$build$src$core$xml(a,b);var c=b.getBlocksBoundingBox();a=domToWorkspace$$module$build$src$core$xml(a,b);if(c&&c.top!==c.bottom){var d=c.bottom;c=b.RTL?c.right:c.left;var e=Infinity;var f=-Infinity,g=Infinity;for(var h=0;h<a.length;h++){var k=b.getBlockById(a[h]).getRelativeToSurfaceXY();k.y<g&&(g=k.y);k.x<e&&(e=k.x);k.x>f&&(f=k.x);}d=d-g+10;c=b.RTL?c-f:c-e;for(e=0;e<a.length;e++){b.getBlockById(a[e]).moveBy(c,d);}}return a;},domToBlock$$module$build$src$core$xml=function domToBlock$$module$build$src$core$xml(a,b){disable$$module$build$src$core$events$utils();var c=b.getAllVariables();var d;try{if(d=domToBlockHeadless$$module$build$src$core$xml(a,b),b.rendered){var e=d,f=d.getDescendants(!1);e.setConnectionTracking(!1);for(var g=f.length-1;0<=g;g--){f[g].initSvg();}for(var _g2=f.length-1;0<=_g2;_g2--){f[_g2].render(!1);}setTimeout(function(){e.disposed||e.setConnectionTracking(!0);},1);e.updateDisabled();b.resizeContents();}else{var _e=d.getDescendants(!1);for(var _f=_e.length-1;0<=_f;_f--){_e[_f].initModel();}}}finally{enable$$module$build$src$core$events$utils();}if(isEnabled$$module$build$src$core$events$utils()){a=getAddedVariables$$module$build$src$core$variables(b,c);for(b=0;b<a.length;b++){c=a[b],fire$$module$build$src$core$events$utils(new(get$$module$build$src$core$events$utils(VAR_CREATE$$module$build$src$core$events$utils))(c));}fire$$module$build$src$core$events$utils(new(get$$module$build$src$core$events$utils(CREATE$$module$build$src$core$events$utils))(d));}return d;},domToVariables$$module$build$src$core$xml=function domToVariables$$module$build$src$core$xml(a,b){for(var c=0;c<a.children.length;c++){var d=a.children[c],e=d.getAttribute("type"),f=d.getAttribute("id");b.createVariable(d.textContent,e,f);}},mapSupportedXmlTags$$module$build$src$core$xml=function mapSupportedXmlTags$$module$build$src$core$xml(a){var b={mutation:[],comment:[],data:[],field:[],input:[],next:[]};for(var c=0;c<a.children.length;c++){var d=a.children[c];if(d.nodeType!==NodeType$$module$build$src$core$utils$dom.TEXT_NODE)switch(d.nodeName.toLowerCase()){case"mutation":b.mutation.push(d);break;case"comment":b.comment.push(d);break;case"data":b.data.push(d);break;case"title":case"field":b.field.push(d);break;case"value":case"statement":b.input.push(d);break;case"next":b.next.push(d);break;default:console.warn("Ignoring unknown tag: "+d.nodeName);}}return b;},applyMutationTagNodes$$module$build$src$core$xml=function applyMutationTagNodes$$module$build$src$core$xml(a,b){var c=!1;for(var d=0;d<a.length;d++){var e=a[d];b.domToMutation&&(b.domToMutation(e),b.initSvg&&(c=!0));}return c;},applyCommentTagNodes$$module$build$src$core$xml=function applyCommentTagNodes$$module$build$src$core$xml(a,b){for(var d=0;d<a.length;d++){var c=a[d];var e=c.textContent,f="true"===c.getAttribute("pinned"),g=parseInt(c.getAttribute("w"));c=parseInt(c.getAttribute("h"));b.setCommentText(e);b.commentModel.pinned=f;isNaN(g)||isNaN(c)||(b.commentModel.size=new Size$$module$build$src$core$utils$size(g,c));if(f&&b.getCommentIcon&&!b.isInFlyout){(function(){var h=b;setTimeout(function(){h.getCommentIcon().setVisible(!0);},1);})();}}},applyDataTagNodes$$module$build$src$core$xml=function applyDataTagNodes$$module$build$src$core$xml(a,b){for(var c=0;c<a.length;c++){b.data=a[c].textContent;}},applyFieldTagNodes$$module$build$src$core$xml=function applyFieldTagNodes$$module$build$src$core$xml(a,b){for(var c=0;c<a.length;c++){var d=a[c],e=d.getAttribute("name");domToField$$module$build$src$core$xml(b,e,d);}},findChildBlocks$$module$build$src$core$xml=function findChildBlocks$$module$build$src$core$xml(a){var b={childBlockElement:null,childShadowElement:null};for(var c=0;c<a.childNodes.length;c++){var d=a.childNodes[c];d.nodeType===NodeType$$module$build$src$core$utils$dom.ELEMENT_NODE&&("block"===d.nodeName.toLowerCase()?b.childBlockElement=d:"shadow"===d.nodeName.toLowerCase()&&(b.childShadowElement=d));}return b;},applyInputTagNodes$$module$build$src$core$xml=function applyInputTagNodes$$module$build$src$core$xml(a,b,c,d){for(var f=0;f<a.length;f++){var e=a[f];var g=e.getAttribute("name"),h=c.getInput(g);if(!h){console.warn("Ignoring non-existent input "+g+" in block "+d);break;}e=findChildBlocks$$module$build$src$core$xml(e);if(e.childBlockElement){if(!h.connection)throw TypeError("Input connection does not exist.");domToBlockHeadless$$module$build$src$core$xml(e.childBlockElement,b,h.connection,!1);}if(e.childShadowElement){var k=void 0;null==(k=h.connection)||k.setShadowDom(e.childShadowElement);}}},applyNextTagNodes$$module$build$src$core$xml=function applyNextTagNodes$$module$build$src$core$xml(a,b,c){for(var d=0;d<a.length;d++){var e=findChildBlocks$$module$build$src$core$xml(a[d]);if(e.childBlockElement){if(!c.nextConnection)throw TypeError("Next statement does not exist.");if(c.nextConnection.isConnected())throw TypeError("Next statement is already connected.");domToBlockHeadless$$module$build$src$core$xml(e.childBlockElement,b,c.nextConnection,!0);}e.childShadowElement&&c.nextConnection&&c.nextConnection.setShadowDom(e.childShadowElement);}},domToBlockHeadless$$module$build$src$core$xml=function domToBlockHeadless$$module$build$src$core$xml(a,b,c,d){var e=a.getAttribute("type");if(!e)throw TypeError("Block type unspecified: "+a.outerHTML);var f=a.getAttribute("id");f=b.newBlock(e,f);var g=mapSupportedXmlTags$$module$build$src$core$xml(a),h=applyMutationTagNodes$$module$build$src$core$xml(g.mutation,f);applyCommentTagNodes$$module$build$src$core$xml(g.comment,f);applyDataTagNodes$$module$build$src$core$xml(g.data,f);if(c)if(d){if(f.previousConnection)c.connect(f.previousConnection);else throw TypeError("Next block does not have previous statement.");}else if(f.outputConnection)c.connect(f.outputConnection);else if(f.previousConnection)c.connect(f.previousConnection);else throw TypeError("Child block does not have output or previous statement.");applyFieldTagNodes$$module$build$src$core$xml(g.field,f);applyInputTagNodes$$module$build$src$core$xml(g.input,b,f,e);applyNextTagNodes$$module$build$src$core$xml(g.next,b,f);h&&f.initSvg();(b=a.getAttribute("inline"))&&f.setInputsInline("true"===b);(b=a.getAttribute("disabled"))&&f.setEnabled("true"!==b&&"disabled"!==b);(b=a.getAttribute("deletable"))&&f.setDeletable("true"===b);(b=a.getAttribute("movable"))&&f.setMovable("true"===b);(b=a.getAttribute("editable"))&&f.setEditable("true"===b);(b=a.getAttribute("collapsed"))&&f.setCollapsed("true"===b);if("shadow"===a.nodeName.toLowerCase()){a=f.getChildren(!1);for(b=0;b<a.length;b++){if(!a[b].isShadow())throw TypeError("Shadow block not allowed non-shadow child.");}if(f.getVarModels().length)throw TypeError("Shadow blocks cannot have variable references.");f.setShadow(!0);}return f;},domToField$$module$build$src$core$xml=function domToField$$module$build$src$core$xml(a,b,c){var d=a.getField(b);d?d.fromXml(c):console.warn("Ignoring non-existent field "+b+" in block "+a.type);},deleteNext$$module$build$src$core$xml=function deleteNext$$module$build$src$core$xml(a){for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];if("next"===c.nodeName.toLowerCase()){a.removeChild(c);break;}}},startsWith$$module$build$src$core$utils$string=function startsWith$$module$build$src$core$utils$string(a,b){warn$$module$build$src$core$utils$deprecation("Blockly.utils.string.startsWith()","April 2022","April 2023","Use built-in string.startsWith");return a.startsWith(b);},shortestStringLength$$module$build$src$core$utils$string=function shortestStringLength$$module$build$src$core$utils$string(a){return a.length?a.reduce(function(b,c){return b.length<c.length?b:c;}).length:0;},commonWordPrefix$$module$build$src$core$utils$string=function commonWordPrefix$$module$build$src$core$utils$string(a,b){if(!a.length)return 0;if(1===a.length)return a[0].length;var c=0;b=b||shortestStringLength$$module$build$src$core$utils$string(a);var d;for(d=0;d<b;d++){var e=a[0][d];for(var f=1;f<a.length;f++){if(e!==a[f][d])return c;}" "===e&&(c=d+1);}for(e=1;e<a.length;e++){if((f=a[e][d])&&" "!==f)return c;}return b;},commonWordSuffix$$module$build$src$core$utils$string=function commonWordSuffix$$module$build$src$core$utils$string(a,b){if(!a.length)return 0;if(1===a.length)return a[0].length;var c=0;b=b||shortestStringLength$$module$build$src$core$utils$string(a);var d;for(d=0;d<b;d++){var e=a[0].substr(-d-1,1);for(var f=1;f<a.length;f++){if(e!==a[f].substr(-d-1,1))return c;}" "===e&&(c=d+1);}for(e=1;e<a.length;e++){if((f=a[e].charAt(a[e].length-d-1))&&" "!==f)return c;}return b;},wrap$$module$build$src$core$utils$string=function wrap$$module$build$src$core$utils$string(a,b){a=a.split("\n");for(var c=0;c<a.length;c++){a[c]=wrapLine$$module$build$src$core$utils$string(a[c],b);}return a.join("\n");},wrapLine$$module$build$src$core$utils$string=function wrapLine$$module$build$src$core$utils$string(a,b){if(a.length<=b)return a;var c=a.trim().split(/\s+/);for(var d=0;d<c.length;d++){c[d].length>b&&(b=c[d].length);}var e=-Infinity;var f,g=1;do{d=e;f=a;a=[];e=c.length/g;var h=1;for(var k=0;k<c.length-1;k++){h<(k+1.5)/e?(h++,a[k]=!0):a[k]=!1;}a=wrapMutate$$module$build$src$core$utils$string(c,a,b);e=wrapScore$$module$build$src$core$utils$string(c,a,b);a=wrapToText$$module$build$src$core$utils$string(c,a);g++;}while(e>d);return f;},wrapScore$$module$build$src$core$utils$string=function wrapScore$$module$build$src$core$utils$string(a,b,c){var d=[0],e=[];for(var f=0;f<a.length;f++){d[d.length-1]+=a[f].length,!0===b[f]?(d.push(0),e.push(a[f].charAt(a[f].length-1))):!1===b[f]&&d[d.length-1]++;}a=Math.max.apply(Math,d);b=0;for(f=0;f<d.length;f++){b-=2*Math.pow(Math.abs(c-d[f]),1.5),b-=Math.pow(a-d[f],1.5),-1!==".?!".indexOf(e[f])?b+=c/3:-1!==",;)]}".indexOf(e[f])&&(b+=c/4);}1<d.length&&d[d.length-1]<=d[d.length-2]&&(b+=.5);return b;},wrapMutate$$module$build$src$core$utils$string=function wrapMutate$$module$build$src$core$utils$string(a,b,c){var d=wrapScore$$module$build$src$core$utils$string(a,b,c),e;for(var f=0;f<b.length-1;f++){if(b[f]===b[f+1])continue;var g=[].concat(b);g[f]=!g[f];g[f+1]=!g[f+1];var h=wrapScore$$module$build$src$core$utils$string(a,g,c);h>d&&(d=h,e=g);}return e?wrapMutate$$module$build$src$core$utils$string(a,e,c):b;},wrapToText$$module$build$src$core$utils$string=function wrapToText$$module$build$src$core$utils$string(a,b){var c=[];for(var d=0;d<a.length;d++){c.push(a[d]),void 0!==b[d]&&c.push(b[d]?"\n":" ");}return c.join("");},isNumber$$module$build$src$core$utils$string=function isNumber$$module$build$src$core$utils$string(a){return /^\s*-?\d+(\.\d+)?\s*$/.test(a);},setCustomTooltip$$module$build$src$core$tooltip=function setCustomTooltip$$module$build$src$core$tooltip(a){customTooltip$$module$build$src$core$tooltip=a;},getCustomTooltip$$module$build$src$core$tooltip=function getCustomTooltip$$module$build$src$core$tooltip(){return customTooltip$$module$build$src$core$tooltip;},isVisible$$module$build$src$core$tooltip=function isVisible$$module$build$src$core$tooltip(){return visible$$module$build$src$core$tooltip;},getDiv$$module$build$src$core$tooltip=function getDiv$$module$build$src$core$tooltip(){return containerDiv$$module$build$src$core$tooltip;},getTooltipOfObject$$module$build$src$core$tooltip=function getTooltipOfObject$$module$build$src$core$tooltip(a){if(a=getTargetObject$$module$build$src$core$tooltip(a)){for(a=a.tooltip;"function"===typeof a;){a=a();}if("string"!==typeof a)throw Error("Tooltip function must return a string.");return a;}return"";},getTargetObject$$module$build$src$core$tooltip=function getTargetObject$$module$build$src$core$tooltip(a){for(;a&&a.tooltip;){if("string"===typeof a.tooltip||"function"===typeof a.tooltip)return a;a=a.tooltip;}return null;},createDom$$module$build$src$core$tooltip=function createDom$$module$build$src$core$tooltip(){containerDiv$$module$build$src$core$tooltip||(containerDiv$$module$build$src$core$tooltip=document.createElement("div"),containerDiv$$module$build$src$core$tooltip.className="blocklyTooltipDiv",(getParentContainer$$module$build$src$core$common()||document.body).appendChild(containerDiv$$module$build$src$core$tooltip));},bindMouseEvents$$module$build$src$core$tooltip=function bindMouseEvents$$module$build$src$core$tooltip(a){a.mouseOverWrapper_=bind$$module$build$src$core$browser_events(a,"mouseover",null,onMouseOver$$module$build$src$core$tooltip);a.mouseOutWrapper_=bind$$module$build$src$core$browser_events(a,"mouseout",null,onMouseOut$$module$build$src$core$tooltip);a.addEventListener("mousemove",onMouseMove$$module$build$src$core$tooltip,!1);},unbindMouseEvents$$module$build$src$core$tooltip=function unbindMouseEvents$$module$build$src$core$tooltip(a){a&&(unbind$$module$build$src$core$browser_events(a.mouseOverWrapper_),unbind$$module$build$src$core$browser_events(a.mouseOutWrapper_),a.removeEventListener("mousemove",onMouseMove$$module$build$src$core$tooltip));},onMouseOver$$module$build$src$core$tooltip=function onMouseOver$$module$build$src$core$tooltip(a){blocked$$module$build$src$core$tooltip||(a=getTargetObject$$module$build$src$core$tooltip(a.currentTarget),element$$module$build$src$core$tooltip!==a&&(hide$$module$build$src$core$tooltip(),poisonedElement$$module$build$src$core$tooltip=null,element$$module$build$src$core$tooltip=a),clearTimeout(mouseOutPid$$module$build$src$core$tooltip));},onMouseOut$$module$build$src$core$tooltip=function onMouseOut$$module$build$src$core$tooltip(a){blocked$$module$build$src$core$tooltip||(mouseOutPid$$module$build$src$core$tooltip=setTimeout(function(){poisonedElement$$module$build$src$core$tooltip=element$$module$build$src$core$tooltip=null;hide$$module$build$src$core$tooltip();},1),clearTimeout(showPid$$module$build$src$core$tooltip));},onMouseMove$$module$build$src$core$tooltip=function onMouseMove$$module$build$src$core$tooltip(a){if(element$$module$build$src$core$tooltip&&element$$module$build$src$core$tooltip.tooltip&&!blocked$$module$build$src$core$tooltip)if(visible$$module$build$src$core$tooltip){var b=lastX$$module$build$src$core$tooltip-a.pageX;a=lastY$$module$build$src$core$tooltip-a.pageY;Math.sqrt(b*b+a*a)>RADIUS_OK$$module$build$src$core$tooltip&&hide$$module$build$src$core$tooltip();}else poisonedElement$$module$build$src$core$tooltip!==element$$module$build$src$core$tooltip&&(clearTimeout(showPid$$module$build$src$core$tooltip),lastX$$module$build$src$core$tooltip=a.pageX,lastY$$module$build$src$core$tooltip=a.pageY,showPid$$module$build$src$core$tooltip=setTimeout(show$$module$build$src$core$tooltip,HOVER_MS$$module$build$src$core$tooltip));},dispose$$module$build$src$core$tooltip=function dispose$$module$build$src$core$tooltip(){poisonedElement$$module$build$src$core$tooltip=element$$module$build$src$core$tooltip=null;hide$$module$build$src$core$tooltip();},hide$$module$build$src$core$tooltip=function hide$$module$build$src$core$tooltip(){visible$$module$build$src$core$tooltip&&(visible$$module$build$src$core$tooltip=!1,containerDiv$$module$build$src$core$tooltip&&(containerDiv$$module$build$src$core$tooltip.style.display="none"));showPid$$module$build$src$core$tooltip&&clearTimeout(showPid$$module$build$src$core$tooltip);},block$$module$build$src$core$tooltip=function block$$module$build$src$core$tooltip(){hide$$module$build$src$core$tooltip();blocked$$module$build$src$core$tooltip=!0;},unblock$$module$build$src$core$tooltip=function unblock$$module$build$src$core$tooltip(){blocked$$module$build$src$core$tooltip=!1;},renderContent$$module$build$src$core$tooltip=function renderContent$$module$build$src$core$tooltip(){containerDiv$$module$build$src$core$tooltip&&element$$module$build$src$core$tooltip&&("function"===typeof customTooltip$$module$build$src$core$tooltip?customTooltip$$module$build$src$core$tooltip(containerDiv$$module$build$src$core$tooltip,element$$module$build$src$core$tooltip):renderDefaultContent$$module$build$src$core$tooltip());},renderDefaultContent$$module$build$src$core$tooltip=function renderDefaultContent$$module$build$src$core$tooltip(){var a=getTooltipOfObject$$module$build$src$core$tooltip(element$$module$build$src$core$tooltip);a=wrap$$module$build$src$core$utils$string(a,LIMIT$$module$build$src$core$tooltip);a=a.split("\n");for(var b=0;b<a.length;b++){var c=document.createElement("div");c.appendChild(document.createTextNode(a[b]));containerDiv$$module$build$src$core$tooltip.appendChild(c);}},getPosition$$module$build$src$core$tooltip=function getPosition$$module$build$src$core$tooltip(a){var b=document.documentElement.clientWidth,c=document.documentElement.clientHeight;var d=lastX$$module$build$src$core$tooltip;d=a?d-(OFFSET_X$$module$build$src$core$tooltip+containerDiv$$module$build$src$core$tooltip.offsetWidth):d+OFFSET_X$$module$build$src$core$tooltip;var e=lastY$$module$build$src$core$tooltip+OFFSET_Y$$module$build$src$core$tooltip;e+containerDiv$$module$build$src$core$tooltip.offsetHeight>c+window.scrollY&&(e-=containerDiv$$module$build$src$core$tooltip.offsetHeight+2*OFFSET_Y$$module$build$src$core$tooltip);a?d=Math.max(MARGINS$$module$build$src$core$tooltip-window.scrollX,d):d+containerDiv$$module$build$src$core$tooltip.offsetWidth>b+window.scrollX-2*MARGINS$$module$build$src$core$tooltip&&(d=b-containerDiv$$module$build$src$core$tooltip.offsetWidth-2*MARGINS$$module$build$src$core$tooltip);return{x:d,y:e};},show$$module$build$src$core$tooltip=function show$$module$build$src$core$tooltip(){if(!blocked$$module$build$src$core$tooltip&&(poisonedElement$$module$build$src$core$tooltip=element$$module$build$src$core$tooltip,containerDiv$$module$build$src$core$tooltip)){containerDiv$$module$build$src$core$tooltip.textContent="";renderContent$$module$build$src$core$tooltip();var a=element$$module$build$src$core$tooltip.RTL;containerDiv$$module$build$src$core$tooltip.style.direction=a?"rtl":"ltr";containerDiv$$module$build$src$core$tooltip.style.display="block";visible$$module$build$src$core$tooltip=!0;var _getPosition$$module$=getPosition$$module$build$src$core$tooltip(a),b=_getPosition$$module$.x,c=_getPosition$$module$.y;containerDiv$$module$build$src$core$tooltip.style.left=b+"px";containerDiv$$module$build$src$core$tooltip.style.top=c+"px";}},getHsvSaturation$$module$build$src$core$utils$colour=function getHsvSaturation$$module$build$src$core$utils$colour(){return hsvSaturation$$module$build$src$core$utils$colour;},setHsvSaturation$$module$build$src$core$utils$colour=function setHsvSaturation$$module$build$src$core$utils$colour(a){hsvSaturation$$module$build$src$core$utils$colour=a;},getHsvValue$$module$build$src$core$utils$colour=function getHsvValue$$module$build$src$core$utils$colour(){return hsvValue$$module$build$src$core$utils$colour;},setHsvValue$$module$build$src$core$utils$colour=function setHsvValue$$module$build$src$core$utils$colour(a){hsvValue$$module$build$src$core$utils$colour=a;},parse$$module$build$src$core$utils$colour=function parse$$module$build$src$core$utils$colour(a){a=String(a).toLowerCase().trim();var b=names$$module$build$src$core$utils$colour[a];if(b)return b;b="0x"===a.substring(0,2)?"#"+a.substring(2):a;b="#"===b[0]?b:"#"+b;if(/^#[0-9a-f]{6}$/.test(b))return b;if(/^#[0-9a-f]{3}$/.test(b))return["#",b[1],b[1],b[2],b[2],b[3],b[3]].join("");var c=a.match(/^(?:rgb)?\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/);return c&&(a=Number(c[1]),b=Number(c[2]),c=Number(c[3]),0<=a&&256>a&&0<=b&&256>b&&0<=c&&256>c)?rgbToHex$$module$build$src$core$utils$colour(a,b,c):null;},rgbToHex$$module$build$src$core$utils$colour=function rgbToHex$$module$build$src$core$utils$colour(a,b,c){b=a<<16|b<<8|c;return 16>a?"#"+(16777216|b).toString(16).substr(1):"#"+b.toString(16);},hexToRgb$$module$build$src$core$utils$colour=function hexToRgb$$module$build$src$core$utils$colour(a){a=parse$$module$build$src$core$utils$colour(a);if(!a)return[0,0,0];a=parseInt(a.substr(1),16);return[a>>16,a>>8&255,a&255];},hsvToHex$$module$build$src$core$utils$colour=function hsvToHex$$module$build$src$core$utils$colour(a,b,c){var d=0,e=0,f=0;if(0===b)f=e=d=c;else{var g=Math.floor(a/60),h=a/60-g;a=c*(1-b);var k=c*(1-b*h);b=c*(1-b*(1-h));switch(g){case 1:d=k;e=c;f=a;break;case 2:d=a;e=c;f=b;break;case 3:d=a;e=k;f=c;break;case 4:d=b;e=a;f=c;break;case 5:d=c;e=a;f=k;break;case 6:case 0:d=c,e=b,f=a;}}return rgbToHex$$module$build$src$core$utils$colour(Math.floor(d),Math.floor(e),Math.floor(f));},blend$$module$build$src$core$utils$colour=function blend$$module$build$src$core$utils$colour(a,b,c){a=parse$$module$build$src$core$utils$colour(a);if(!a)return null;b=parse$$module$build$src$core$utils$colour(b);if(!b)return null;a=hexToRgb$$module$build$src$core$utils$colour(a);b=hexToRgb$$module$build$src$core$utils$colour(b);return rgbToHex$$module$build$src$core$utils$colour(Math.round(b[0]+c*(a[0]-b[0])),Math.round(b[1]+c*(a[1]-b[1])),Math.round(b[2]+c*(a[2]-b[2])));},hueToHex$$module$build$src$core$utils$colour=function hueToHex$$module$build$src$core$utils$colour(a){return hsvToHex$$module$build$src$core$utils$colour(a,hsvSaturation$$module$build$src$core$utils$colour,255*hsvValue$$module$build$src$core$utils$colour);},tokenizeInterpolationInternal$$module$build$src$core$utils$parsing=function tokenizeInterpolationInternal$$module$build$src$core$utils$parsing(a,b){var c=[];var d=a.split("");d.push("");var e=0;a=[];var f=null;for(var k=0;k<d.length;k++){var g=d[k];if(0===e)"%"===g?((e=a.join(""))&&c.push(e),a.length=0,e=1):a.push(g);else if(1===e)"%"===g?(a.push(g),e=0):b&&"0"<=g&&"9">=g?(e=2,f=g,(g=a.join(""))&&c.push(g),a.length=0):"{"===g?e=3:(a.push("%",g),e=0);else if(2===e){if("0"<=g&&"9">=g)f+=g;else{var h=void 0;c.push(parseInt(null!=(h=f)?h:"",10));k--;e=0;}}else 3===e&&(""===g?(a.splice(0,0,"%{"),k--,e=0):"}"!==g?a.push(g):(e=a.join(""),/[A-Z]\w*/i.test(e)?(g=e.toUpperCase(),(g=g.startsWith("BKY_")?g.substring(4):null)&&g in Msg$$module$build$src$core$msg?(e=Msg$$module$build$src$core$msg[g],"string"===typeof e?Array.prototype.push.apply(c,tokenizeInterpolationInternal$$module$build$src$core$utils$parsing(e,b)):b?c.push(String(e)):c.push(e)):c.push("%{"+e+"}")):c.push("%{"+e+"}"),e=a.length=0));}(b=a.join(""))&&c.push(b);h=[];a.length=0;for(d=0;d<c.length;d++){"string"===typeof c[d]?a.push(c[d]):((b=a.join(""))&&h.push(b),a.length=0,h.push(c[d]));}(b=a.join(""))&&h.push(b);a.length=0;return h;},tokenizeInterpolation$$module$build$src$core$utils$parsing=function tokenizeInterpolation$$module$build$src$core$utils$parsing(a){return tokenizeInterpolationInternal$$module$build$src$core$utils$parsing(a,!0);},replaceMessageReferences$$module$build$src$core$utils$parsing=function replaceMessageReferences$$module$build$src$core$utils$parsing(a){if("string"!==typeof a)return a;a=tokenizeInterpolationInternal$$module$build$src$core$utils$parsing(a,!1);return a.length?String(a[0]):"";},checkMessageReferences$$module$build$src$core$utils$parsing=function checkMessageReferences$$module$build$src$core$utils$parsing(a){var b=!0;var c=Msg$$module$build$src$core$msg,d=a.match(/%{BKY_[A-Z]\w*}/ig);if(d)for(var e=0;e<d.length;e++){var f=d[e].toUpperCase();void 0===c[f.slice(6,-1)]&&(console.warn("No message string for "+d[e]+" in "+a),b=!1);}return b;},parseBlockColour$$module$build$src$core$utils$parsing=function parseBlockColour$$module$build$src$core$utils$parsing(a){var b="string"===typeof a?replaceMessageReferences$$module$build$src$core$utils$parsing(a):a;var c=Number(b);if(!isNaN(c)&&0<=c&&360>=c)return{hue:c,hex:hsvToHex$$module$build$src$core$utils$colour(c,getHsvSaturation$$module$build$src$core$utils$colour(),255*getHsvValue$$module$build$src$core$utils$colour())};if(c=parse$$module$build$src$core$utils$colour(b))return{hue:null,hex:c};c='Invalid colour: "'+b+'"';a!==b&&(c+=' (from "'+a+'")');throw Error(c);},getDiv$$module$build$src$core$widgetdiv=function getDiv$$module$build$src$core$widgetdiv(){return containerDiv$$module$build$src$core$widgetdiv;},testOnly_setDiv$$module$build$src$core$widgetdiv=function testOnly_setDiv$$module$build$src$core$widgetdiv(a){containerDiv$$module$build$src$core$widgetdiv=a;},createDom$$module$build$src$core$widgetdiv=function createDom$$module$build$src$core$widgetdiv(){containerDiv$$module$build$src$core$widgetdiv||(containerDiv$$module$build$src$core$widgetdiv=document.createElement("div"),containerDiv$$module$build$src$core$widgetdiv.className="blocklyWidgetDiv",(getParentContainer$$module$build$src$core$common()||document.body).appendChild(containerDiv$$module$build$src$core$widgetdiv));},show$$module$build$src$core$widgetdiv=function show$$module$build$src$core$widgetdiv(a,b,c){hide$$module$build$src$core$widgetdiv();owner$$module$build$src$core$widgetdiv=a;dispose$$module$build$src$core$widgetdiv=c;if(a=containerDiv$$module$build$src$core$widgetdiv)a.style.direction=b?"rtl":"ltr",a.style.display="block",b=getMainWorkspace$$module$build$src$core$common(),rendererClassName$$module$build$src$core$widgetdiv=b.getRenderer().getClassName(),themeClassName$$module$build$src$core$widgetdiv=b.getTheme().getClassName(),rendererClassName$$module$build$src$core$widgetdiv&&addClass$$module$build$src$core$utils$dom(a,rendererClassName$$module$build$src$core$widgetdiv),themeClassName$$module$build$src$core$widgetdiv&&addClass$$module$build$src$core$utils$dom(a,themeClassName$$module$build$src$core$widgetdiv);},hide$$module$build$src$core$widgetdiv=function hide$$module$build$src$core$widgetdiv(){if(isVisible$$module$build$src$core$widgetdiv()){owner$$module$build$src$core$widgetdiv=null;var a=containerDiv$$module$build$src$core$widgetdiv;a&&(a.style.display="none",a.style.left="",a.style.top="",dispose$$module$build$src$core$widgetdiv&&dispose$$module$build$src$core$widgetdiv(),dispose$$module$build$src$core$widgetdiv=null,a.textContent="",rendererClassName$$module$build$src$core$widgetdiv&&(removeClass$$module$build$src$core$utils$dom(a,rendererClassName$$module$build$src$core$widgetdiv),rendererClassName$$module$build$src$core$widgetdiv=""),themeClassName$$module$build$src$core$widgetdiv&&(removeClass$$module$build$src$core$utils$dom(a,themeClassName$$module$build$src$core$widgetdiv),themeClassName$$module$build$src$core$widgetdiv=""),getMainWorkspace$$module$build$src$core$common().markFocused());}},isVisible$$module$build$src$core$widgetdiv=function isVisible$$module$build$src$core$widgetdiv(){return!!owner$$module$build$src$core$widgetdiv;},hideIfOwner$$module$build$src$core$widgetdiv=function hideIfOwner$$module$build$src$core$widgetdiv(a){owner$$module$build$src$core$widgetdiv===a&&hide$$module$build$src$core$widgetdiv();},positionInternal$$module$build$src$core$widgetdiv=function positionInternal$$module$build$src$core$widgetdiv(a,b,c){containerDiv$$module$build$src$core$widgetdiv.style.left=a+"px";containerDiv$$module$build$src$core$widgetdiv.style.top=b+"px";containerDiv$$module$build$src$core$widgetdiv.style.height=c+"px";},positionWithAnchor$$module$build$src$core$widgetdiv=function positionWithAnchor$$module$build$src$core$widgetdiv(a,b,c,d){var e=calculateY$$module$build$src$core$widgetdiv(a,b,c);a=calculateX$$module$build$src$core$widgetdiv(a,b,c,d);0>e?positionInternal$$module$build$src$core$widgetdiv(a,0,c.height+e):positionInternal$$module$build$src$core$widgetdiv(a,e,c.height);},calculateX$$module$build$src$core$widgetdiv=function calculateX$$module$build$src$core$widgetdiv(a,b,c,d){return d?Math.min(Math.max(b.right-c.width,a.left),a.right-c.width):Math.max(Math.min(b.left,a.right-c.width),a.left);},calculateY$$module$build$src$core$widgetdiv=function calculateY$$module$build$src$core$widgetdiv(a,b,c){return b.bottom+c.height>=a.bottom?b.top-c.height:b.bottom;},register$$module$build$src$core$field_registry=function register$$module$build$src$core$field_registry(a,b){register$$module$build$src$core$registry(Type$$module$build$src$core$registry.FIELD,a,b);},unregister$$module$build$src$core$field_registry=function unregister$$module$build$src$core$field_registry(a){unregister$$module$build$src$core$registry(Type$$module$build$src$core$registry.FIELD,a);},fromJson$$module$build$src$core$field_registry=function fromJson$$module$build$src$core$field_registry(a){return TEST_ONLY$$module$build$src$core$field_registry.fromJsonInternal(a);},fromJsonInternal$$module$build$src$core$field_registry=function fromJsonInternal$$module$build$src$core$field_registry(a){var b=getObject$$module$build$src$core$registry(Type$$module$build$src$core$registry.FIELD,a.type);if(b){if("function"!==typeof b.fromJson)throw new TypeError("returned Field was not a IRegistrableField");return b.fromJson(a);}console.warn("Blockly could not create a field of type "+a.type+". The field is probably not being registered. This could be because the file is not loaded, the field does not register itself (Issue #1584), or the registration is not being reached.");return null;},setRole$$module$build$src$core$utils$aria=function setRole$$module$build$src$core$utils$aria(a,b){a.setAttribute(ROLE_ATTRIBUTE$$module$build$src$core$utils$aria,b);},setState$$module$build$src$core$utils$aria=function setState$$module$build$src$core$utils$aria(a,b,c){Array.isArray(c)&&(c=c.join(" "));a.setAttribute(ARIA_PREFIX$$module$build$src$core$utils$aria+b,"".concat(c));},isMenuGenerator$$module$build$src$core$field_dropdown=function isMenuGenerator$$module$build$src$core$field_dropdown(a){return a!==Field$$module$build$src$core$field.SKIP_SETUP;},trimOptions$$module$build$src$core$field_dropdown=function trimOptions$$module$build$src$core$field_dropdown(a){var b=!1;var c=a.map(function(_ref){var _ref2=_slicedToArray(_ref,2),g=_ref2[0],h=_ref2[1];if("string"===typeof g)return[replaceMessageReferences$$module$build$src$core$utils$parsing(g),h];b=!0;return[null!==g.alt?Object.assign({},g,{alt:replaceMessageReferences$$module$build$src$core$utils$parsing(g.alt)}):Object.assign({},g),h];});if(b||2>a.length)return{options:c};var d=c.map(function(_ref3){var _ref4=_slicedToArray(_ref3,1),g=_ref4[0];return g;}),e=shortestStringLength$$module$build$src$core$utils$string(d);a=commonWordPrefix$$module$build$src$core$utils$string(d,e);var f=commonWordSuffix$$module$build$src$core$utils$string(d,e);if(!a&&!f||e<=a+f)return{options:c};e=a?d[0].substring(0,a-1):void 0;d=f?d[0].substr(1-f):void 0;return{options:applyTrim$$module$build$src$core$field_dropdown(c,a,f),prefix:e,suffix:d};},applyTrim$$module$build$src$core$field_dropdown=function applyTrim$$module$build$src$core$field_dropdown(a,b,c){return a.map(function(_ref5){var _ref6=_slicedToArray(_ref5,2),d=_ref6[0],e=_ref6[1];return[d.substring(b,d.length-c),e];});},validateOptions$$module$build$src$core$field_dropdown=function validateOptions$$module$build$src$core$field_dropdown(a){if(!Array.isArray(a))throw TypeError("FieldDropdown options must be an array.");if(!a.length)throw TypeError("FieldDropdown options must not be an empty array.");var b=!1;for(var c=0;c<a.length;c++){var d=a[c];Array.isArray(d)?"string"!==typeof d[1]?(b=!0,console.error("Invalid option["+c+"]: Each FieldDropdown option id must be a string. Found "+d[1]+" in: ",d)):d[0]&&"string"!==typeof d[0]&&"string"!==typeof d[0].src&&(b=!0,console.error("Invalid option["+c+"]: Each FieldDropdown option must have a string label or image description. Found"+d[0]+" in: ",d)):(b=!0,console.error("Invalid option["+c+"]: Each FieldDropdown option must be an array. Found: ",d));}if(b)throw TypeError("Found invalid FieldDropdown options.");},inherits$$module$build$src$core$utils$object=function inherits$$module$build$src$core$utils$object(a,b){warn$$module$build$src$core$utils$deprecation("Blockly.utils.object.inherits","version 9","version 10");a.superClass_=b.prototype;Object.setPrototypeOf(a,b);a.prototype=Object.create(b.prototype);a.prototype.constructor=a;},mixin$$module$build$src$core$utils$object=function mixin$$module$build$src$core$utils$object(a,b){warn$$module$build$src$core$utils$deprecation("Blockly.utils.object.mixin","May 2022","May 2023","Object.assign");for(var c in b){a[c]=b[c];}},deepMerge$$module$build$src$core$utils$object=function deepMerge$$module$build$src$core$utils$object(a,b){for(var c in b){a[c]=null!==b[c]&&"object"===_typeof(b[c])?deepMerge$$module$build$src$core$utils$object(a[c]||Object.create(null),b[c]):b[c];}return a;},values$$module$build$src$core$utils$object=function values$$module$build$src$core$utils$object(a){warn$$module$build$src$core$utils$deprecation("Blockly.utils.object.values","version 9","version 10","Object.values");return Object.values(a);},convertToolboxDefToJson$$module$build$src$core$utils$toolbox=function convertToolboxDefToJson$$module$build$src$core$utils$toolbox(a){if(!a)return null;if(a instanceof Element||"string"===typeof a)a=parseToolboxTree$$module$build$src$core$utils$toolbox(a),a=convertToToolboxJson$$module$build$src$core$utils$toolbox(a);validateToolbox$$module$build$src$core$utils$toolbox(a);return a;},validateToolbox$$module$build$src$core$utils$toolbox=function validateToolbox$$module$build$src$core$utils$toolbox(a){var b=a.kind;a=a.contents;if(b&&b!==FLYOUT_TOOLBOX_KIND$$module$build$src$core$utils$toolbox&&b!==CATEGORY_TOOLBOX_KIND$$module$build$src$core$utils$toolbox)throw Error("Invalid toolbox kind "+b+". Please supply either "+FLYOUT_TOOLBOX_KIND$$module$build$src$core$utils$toolbox+" or "+CATEGORY_TOOLBOX_KIND$$module$build$src$core$utils$toolbox);if(!a)throw Error("Toolbox must have a contents attribute.");},convertFlyoutDefToJsonArray$$module$build$src$core$utils$toolbox=function convertFlyoutDefToJsonArray$$module$build$src$core$utils$toolbox(a){return a?a.contents?a.contents:Array.isArray(a)&&0<a.length&&!a[0].nodeType?a:xmlToJsonArray$$module$build$src$core$utils$toolbox(a):[];},hasCategories$$module$build$src$core$utils$toolbox=function hasCategories$$module$build$src$core$utils$toolbox(a){return TEST_ONLY$$module$build$src$core$utils$toolbox.hasCategoriesInternal(a);},hasCategoriesInternal$$module$build$src$core$utils$toolbox=function hasCategoriesInternal$$module$build$src$core$utils$toolbox(a){if(!a)return!1;var b=a.kind;return b?b===CATEGORY_TOOLBOX_KIND$$module$build$src$core$utils$toolbox:!!a.contents.filter(function(c){return"CATEGORY"===c.kind.toUpperCase();}).length;},isCategoryCollapsible$$module$build$src$core$utils$toolbox=function isCategoryCollapsible$$module$build$src$core$utils$toolbox(a){return a&&a.contents?!!a.contents.filter(function(b){return"CATEGORY"===b.kind.toUpperCase();}).length:!1;},convertToToolboxJson$$module$build$src$core$utils$toolbox=function convertToToolboxJson$$module$build$src$core$utils$toolbox(a){var b={contents:xmlToJsonArray$$module$build$src$core$utils$toolbox(a)};a instanceof Node&&addAttributes$$module$build$src$core$utils$toolbox(a,b);return b;},xmlToJsonArray$$module$build$src$core$utils$toolbox=function xmlToJsonArray$$module$build$src$core$utils$toolbox(a){var b=[];var c=a.childNodes;c||(c=a);for(var d=0,e;e=c[d];d++){if(!e.tagName)continue;a={};var f=e.tagName.toUpperCase();a.kind=f;"BLOCK"===f?a.blockxml=e:e.childNodes&&0<e.childNodes.length&&(a.contents=xmlToJsonArray$$module$build$src$core$utils$toolbox(e));addAttributes$$module$build$src$core$utils$toolbox(e,a);b.push(a);}return b;},addAttributes$$module$build$src$core$utils$toolbox=function addAttributes$$module$build$src$core$utils$toolbox(a,b){for(var c=0;c<a.attributes.length;c++){var d=a.attributes[c];-1<d.nodeName.indexOf("css-")?(b.cssconfig=b.cssconfig||{},b.cssconfig[d.nodeName.replace("css-","")]=d.value):b[d.nodeName]=d.value;}},parseToolboxTree$$module$build$src$core$utils$toolbox=function parseToolboxTree$$module$build$src$core$utils$toolbox(a){var b=null;if(a)if("string"===typeof a){if(b=textToDom$$module$build$src$core$xml(a),"xml"!==b.nodeName.toLowerCase())throw TypeError("Toolbox should be an <xml> document.");}else a instanceof Element&&(b=a);return b;},register$$module$build$src$core$extensions=function register$$module$build$src$core$extensions(a,b){if("string"!==typeof a||""===a.trim())throw Error('Error: Invalid extension name "'+a+'"');if(allExtensions$$module$build$src$core$extensions[a])throw Error('Error: Extension "'+a+'" is already registered.');if("function"!==typeof b)throw Error('Error: Extension "'+a+'" must be a function');allExtensions$$module$build$src$core$extensions[a]=b;},registerMixin$$module$build$src$core$extensions=function registerMixin$$module$build$src$core$extensions(a,b){if(!b||"object"!==_typeof(b))throw Error('Error: Mixin "'+a+'" must be a object');register$$module$build$src$core$extensions(a,function(){this.mixin(b);});},registerMutator$$module$build$src$core$extensions=function registerMutator$$module$build$src$core$extensions(a,b,c,d){var e='Error when registering mutator "'+a+'": ';checkHasMutatorProperties$$module$build$src$core$extensions(e,b);var f=checkMutatorDialog$$module$build$src$core$extensions(b,e);if(c&&"function"!==typeof c)throw Error(e+'Extension "'+a+'" is not a function');register$$module$build$src$core$extensions(a,function(){f&&this.setMutator(new $.Mutator$$module$build$src$core$mutator(d||[],this));this.mixin(b);c&&c.apply(this);});},unregister$$module$build$src$core$extensions=function unregister$$module$build$src$core$extensions(a){isRegistered$$module$build$src$core$extensions(a)?delete allExtensions$$module$build$src$core$extensions[a]:console.warn('No extension mapping for name "'+a+'" found to unregister');},isRegistered$$module$build$src$core$extensions=function isRegistered$$module$build$src$core$extensions(a){return!!allExtensions$$module$build$src$core$extensions[a];},apply$$module$build$src$core$extensions=function apply$$module$build$src$core$extensions(a,b,c){var d=allExtensions$$module$build$src$core$extensions[a];if("function"!==typeof d)throw Error('Error: Extension "'+a+'" not found.');var e;c?checkNoMutatorProperties$$module$build$src$core$extensions(a,b):e=getMutatorProperties$$module$build$src$core$extensions(b);d.apply(b);if(c)checkHasMutatorProperties$$module$build$src$core$extensions('Error after applying mutator "'+a+'": ',b);else if(!mutatorPropertiesMatch$$module$build$src$core$extensions(e,b))throw Error('Error when applying extension "'+a+'": mutation properties changed when applying a non-mutator extension.');},checkNoMutatorProperties$$module$build$src$core$extensions=function checkNoMutatorProperties$$module$build$src$core$extensions(a,b){if(getMutatorProperties$$module$build$src$core$extensions(b).length)throw Error('Error: tried to apply mutation "'+a+'" to a block that already has mutator functions.  Block id: '+b.id);},checkXmlHooks$$module$build$src$core$extensions=function checkXmlHooks$$module$build$src$core$extensions(a,b){return checkHasFunctionPair$$module$build$src$core$extensions(a.mutationToDom,a.domToMutation,b+" mutationToDom/domToMutation");},checkJsonHooks$$module$build$src$core$extensions=function checkJsonHooks$$module$build$src$core$extensions(a,b){return checkHasFunctionPair$$module$build$src$core$extensions(a.saveExtraState,a.loadExtraState,b+" saveExtraState/loadExtraState");},checkMutatorDialog$$module$build$src$core$extensions=function checkMutatorDialog$$module$build$src$core$extensions(a,b){return checkHasFunctionPair$$module$build$src$core$extensions(a.compose,a.decompose,b+" compose/decompose");},checkHasFunctionPair$$module$build$src$core$extensions=function checkHasFunctionPair$$module$build$src$core$extensions(a,b,c){if(a&&b){if("function"!==typeof a||"function"!==typeof b)throw Error(c+" must be a function");return!0;}if(!a&&!b)return!1;throw Error(c+"Must have both or neither functions");},checkHasMutatorProperties$$module$build$src$core$extensions=function checkHasMutatorProperties$$module$build$src$core$extensions(a,b){var c=checkXmlHooks$$module$build$src$core$extensions(b,a),d=checkJsonHooks$$module$build$src$core$extensions(b,a);if(!c&&!d)throw Error(a+"Mutations must contain either XML hooks, or JSON hooks, or both");checkMutatorDialog$$module$build$src$core$extensions(b,a);},getMutatorProperties$$module$build$src$core$extensions=function getMutatorProperties$$module$build$src$core$extensions(a){var b=[];void 0!==a.domToMutation&&b.push(a.domToMutation);void 0!==a.mutationToDom&&b.push(a.mutationToDom);void 0!==a.saveExtraState&&b.push(a.saveExtraState);void 0!==a.loadExtraState&&b.push(a.loadExtraState);void 0!==a.compose&&b.push(a.compose);void 0!==a.decompose&&b.push(a.decompose);return b;},mutatorPropertiesMatch$$module$build$src$core$extensions=function mutatorPropertiesMatch$$module$build$src$core$extensions(a,b){b=getMutatorProperties$$module$build$src$core$extensions(b);if(b.length!==a.length)return!1;for(var c=0;c<b.length;c++){if(a[c]!==b[c])return!1;}return!0;},runAfterPageLoad$$module$build$src$core$extensions=function runAfterPageLoad$$module$build$src$core$extensions(a){if("object"!==(typeof document==="undefined"?"undefined":_typeof(document)))throw Error("runAfterPageLoad() requires browser document.");if("complete"===document.readyState)a();else{var b=setInterval(function(){"complete"===document.readyState&&(clearInterval(b),a());},10);}},buildTooltipForDropdown$$module$build$src$core$extensions=function buildTooltipForDropdown$$module$build$src$core$extensions(a,b){var c=[];"object"===(typeof document==="undefined"?"undefined":_typeof(document))&&runAfterPageLoad$$module$build$src$core$extensions(function(){for(var d in b){checkMessageReferences$$module$build$src$core$utils$parsing(b[d]);}});return function(){this.type&&-1===c.indexOf(this.type)&&(checkDropdownOptionsInTable$$module$build$src$core$extensions(this,a,b),c.push(this.type));this.setTooltip(function(){var d=String(this.getFieldValue(a));var e=b[d];null===e?-1===c.indexOf(this.type)&&(d="No tooltip mapping for value "+d+" of field "+a,null!==this.type&&(d+=" of block type "+this.type),console.warn(d+".")):e=replaceMessageReferences$$module$build$src$core$utils$parsing(e);return e;}.bind(this));};},checkDropdownOptionsInTable$$module$build$src$core$extensions=function checkDropdownOptionsInTable$$module$build$src$core$extensions(a,b,c){var d=a.getField(b);if(d instanceof FieldDropdown$$module$build$src$core$field_dropdown&&!d.isOptionListDynamic()){d=d.getOptions();for(var e=0;e<d.length;e++){var f=d[e][1];null===c[f]&&console.warn("No tooltip mapping for value "+f+" of field "+b+" of block type "+a.type);}}},buildTooltipWithFieldText$$module$build$src$core$extensions=function buildTooltipWithFieldText$$module$build$src$core$extensions(a,b){"object"===(typeof document==="undefined"?"undefined":_typeof(document))&&runAfterPageLoad$$module$build$src$core$extensions(function(){checkMessageReferences$$module$build$src$core$utils$parsing(a);});return function(){this.setTooltip(function(){var c=this.getField(b);return replaceMessageReferences$$module$build$src$core$utils$parsing(a).replace("%1",c?c.getText():"");}.bind(this));};},extensionParentTooltip$$module$build$src$core$extensions=function extensionParentTooltip$$module$build$src$core$extensions(){var a=this.tooltip;this.setTooltip(function(){var b=this.getParent();return b&&b.getInputsInline()&&b.tooltip||a;}.bind(this));},removeElem$$module$build$src$core$utils$array=function removeElem$$module$build$src$core$utils$array(a,b){b=a.indexOf(b);if(-1===b)return!1;a.splice(b,1);return!0;},point$$module$build$src$core$utils$svg_paths=function point$$module$build$src$core$utils$svg_paths(a,b){return" "+a+","+b+" ";},curve$$module$build$src$core$utils$svg_paths=function curve$$module$build$src$core$utils$svg_paths(a,b){return" "+a+b.join("");},moveTo$$module$build$src$core$utils$svg_paths=function moveTo$$module$build$src$core$utils$svg_paths(a,b){return" M "+a+","+b+" ";},moveBy$$module$build$src$core$utils$svg_paths=function moveBy$$module$build$src$core$utils$svg_paths(a,b){return" m "+a+","+b+" ";},lineTo$$module$build$src$core$utils$svg_paths=function lineTo$$module$build$src$core$utils$svg_paths(a,b){return" l "+a+","+b+" ";},line$$module$build$src$core$utils$svg_paths=function line$$module$build$src$core$utils$svg_paths(a){return" l"+a.join("");},lineOnAxis$$module$build$src$core$utils$svg_paths=function lineOnAxis$$module$build$src$core$utils$svg_paths(a,b){return" "+a+" "+b+" ";},arc$$module$build$src$core$utils$svg_paths=function arc$$module$build$src$core$utils$svg_paths(a,b,c,d){return a+" "+c+" "+c+" "+b+d;},getRelativeXY$$module$build$src$core$utils=function getRelativeXY$$module$build$src$core$utils(a){warn$$module$build$src$core$utils$deprecation("Blockly.utils.getRelativeXY","December 2021","December 2022","Blockly.utils.svgMath.getRelativeXY");return getRelativeXY$$module$build$src$core$utils$svg_math(a);},getInjectionDivXY$$module$build$src$core$utils=function getInjectionDivXY$$module$build$src$core$utils(a){warn$$module$build$src$core$utils$deprecation("Blockly.utils.getInjectionDivXY_","December 2021","December 2022","Blockly.utils.svgMath.getInjectionDivXY");return getInjectionDivXY$$module$build$src$core$utils$svg_math(a);},tokenizeInterpolation$$module$build$src$core$utils=function tokenizeInterpolation$$module$build$src$core$utils(a){warn$$module$build$src$core$utils$deprecation("Blockly.utils.tokenizeInterpolation","December 2021","December 2022","Blockly.utils.parsing.tokenizeInterpolation");return tokenizeInterpolation$$module$build$src$core$utils$parsing(a);},replaceMessageReferences$$module$build$src$core$utils=function replaceMessageReferences$$module$build$src$core$utils(a){warn$$module$build$src$core$utils$deprecation("Blockly.utils.replaceMessageReferences","December 2021","December 2022","Blockly.utils.parsing.replaceMessageReferences");return replaceMessageReferences$$module$build$src$core$utils$parsing(a);},checkMessageReferences$$module$build$src$core$utils=function checkMessageReferences$$module$build$src$core$utils(a){warn$$module$build$src$core$utils$deprecation("Blockly.utils.checkMessageReferences","December 2021","December 2022","Blockly.utils.parsing.checkMessageReferences");return checkMessageReferences$$module$build$src$core$utils$parsing(a);},is3dSupported$$module$build$src$core$utils=function is3dSupported$$module$build$src$core$utils(){warn$$module$build$src$core$utils$deprecation("Blockly.utils.is3dSupported","December 2021","December 2022","Blockly.utils.svgMath.is3dSupported");return is3dSupported$$module$build$src$core$utils$svg_math();},getViewportBBox$$module$build$src$core$utils=function getViewportBBox$$module$build$src$core$utils(){warn$$module$build$src$core$utils$deprecation("Blockly.utils.getViewportBBox","December 2021","December 2022","Blockly.utils.svgMath.getViewportBBox");return getViewportBBox$$module$build$src$core$utils$svg_math();},arrayRemove$$module$build$src$core$utils=function arrayRemove$$module$build$src$core$utils(a,b){warn$$module$build$src$core$utils$deprecation("Blockly.utils.arrayRemove","December 2021","December 2022","Blockly.array.removeElem");return removeElem$$module$build$src$core$utils$array(a,b);},getDocumentScroll$$module$build$src$core$utils=function getDocumentScroll$$module$build$src$core$utils(){warn$$module$build$src$core$utils$deprecation("Blockly.utils.getDocumentScroll","December 2021","December 2022","Blockly.utils.svgMath.getDocumentScroll");return getDocumentScroll$$module$build$src$core$utils$svg_math();},getBlockTypeCounts$$module$build$src$core$utils=function getBlockTypeCounts$$module$build$src$core$utils(a,b){warn$$module$build$src$core$utils$deprecation("Blockly.utils.getBlockTypeCounts","December 2021","December 2022","Blockly.common.getBlockTypeCounts");return getBlockTypeCounts$$module$build$src$core$common(a,b);},screenToWsCoordinates$$module$build$src$core$utils=function screenToWsCoordinates$$module$build$src$core$utils(a,b){warn$$module$build$src$core$utils$deprecation("Blockly.utils.screenToWsCoordinates","December 2021","December 2022","Blockly.utils.svgMath.screenToWsCoordinates");return screenToWsCoordinates$$module$build$src$core$utils$svg_math(a,b);},parseBlockColour$$module$build$src$core$utils=function parseBlockColour$$module$build$src$core$utils(a){warn$$module$build$src$core$utils$deprecation("Blockly.utils.parseBlockColour","December 2021","December 2022","Blockly.utils.parsing.parseBlockColour");return parseBlockColour$$module$build$src$core$utils$parsing(a);},runAfterPageLoad$$module$build$src$core$utils=function runAfterPageLoad$$module$build$src$core$utils(a){warn$$module$build$src$core$utils$deprecation("Blockly.utils.runAfterPageLoad","December 2021","December 2022");runAfterPageLoad$$module$build$src$core$extensions(a);},register$$module$build$src$core$serialization$registry=function register$$module$build$src$core$serialization$registry(a,b){register$$module$build$src$core$registry(Type$$module$build$src$core$registry.SERIALIZER,a,b);},unregister$$module$build$src$core$serialization$registry=function unregister$$module$build$src$core$serialization$registry(a){unregister$$module$build$src$core$registry(Type$$module$build$src$core$registry.SERIALIZER,a);},save$$module$build$src$core$serialization$blocks=function save$$module$build$src$core$serialization$blocks(a){var _ref7=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{},_ref7$addCoordinates=_ref7.addCoordinates,b=_ref7$addCoordinates===void 0?!1:_ref7$addCoordinates,_ref7$addInputBlocks=_ref7.addInputBlocks,c=_ref7$addInputBlocks===void 0?!0:_ref7$addInputBlocks,_ref7$addNextBlocks=_ref7.addNextBlocks,d=_ref7$addNextBlocks===void 0?!0:_ref7$addNextBlocks,_ref7$doFullSerializa=_ref7.doFullSerialization,e=_ref7$doFullSerializa===void 0?!0:_ref7$doFullSerializa;if(a.isInsertionMarker())return null;var f={type:a.type,id:a.id};b&&saveCoords$$module$build$src$core$serialization$blocks(a,f);saveAttributes$$module$build$src$core$serialization$blocks(a,f);saveExtraState$$module$build$src$core$serialization$blocks(a,f);saveIcons$$module$build$src$core$serialization$blocks(a,f);saveFields$$module$build$src$core$serialization$blocks(a,f,e);c&&saveInputBlocks$$module$build$src$core$serialization$blocks(a,f,e);d&&saveNextBlocks$$module$build$src$core$serialization$blocks(a,f,e);return f;},saveAttributes$$module$build$src$core$serialization$blocks=function saveAttributes$$module$build$src$core$serialization$blocks(a,b){a.isCollapsed()&&(b.collapsed=!0);a.isEnabled()||(b.enabled=!1);void 0!==a.inputsInline&&a.inputsInline!==a.inputsInlineDefault&&(b.inline=a.inputsInline);a.data&&(b.data=a.data);},saveCoords$$module$build$src$core$serialization$blocks=function saveCoords$$module$build$src$core$serialization$blocks(a,b){var c=a.workspace;a=a.getRelativeToSurfaceXY();b.x=Math.round(c.RTL?c.getWidth()-a.x:a.x);b.y=Math.round(a.y);},saveExtraState$$module$build$src$core$serialization$blocks=function saveExtraState$$module$build$src$core$serialization$blocks(a,b){a.saveExtraState?(a=a.saveExtraState(),null!==a&&(b.extraState=a)):a.mutationToDom&&(a=a.mutationToDom(),null!==a&&(b.extraState=domToText$$module$build$src$core$xml(a).replace(' xmlns="https://developers.google.com/blockly/xml"',"")));},saveIcons$$module$build$src$core$serialization$blocks=function saveIcons$$module$build$src$core$serialization$blocks(a,b){a.getCommentText()&&(b.icons={comment:{text:a.getCommentText(),pinned:a.commentModel.pinned,height:Math.round(a.commentModel.size.height),width:Math.round(a.commentModel.size.width)}});},saveFields$$module$build$src$core$serialization$blocks=function saveFields$$module$build$src$core$serialization$blocks(a,b,c){var d=Object.create(null);for(var e=0;e<a.inputList.length;e++){var f=a.inputList[e];for(var g=0;g<f.fieldRow.length;g++){var h=f.fieldRow[g];h.isSerializable()&&(d[h.name]=h.saveState(c));}}Object.keys(d).length&&(b.fields=d);},saveInputBlocks$$module$build$src$core$serialization$blocks=function saveInputBlocks$$module$build$src$core$serialization$blocks(a,b,c){var d=Object.create(null);for(var e=0;e<a.inputList.length;e++){var f=a.inputList[e];if(f.type===inputTypes$$module$build$src$core$input_types.DUMMY)continue;var g=saveConnection$$module$build$src$core$serialization$blocks(f.connection,c);g&&(d[f.name]=g);}Object.keys(d).length&&(b.inputs=d);},saveNextBlocks$$module$build$src$core$serialization$blocks=function saveNextBlocks$$module$build$src$core$serialization$blocks(a,b,c){a.nextConnection&&(a=saveConnection$$module$build$src$core$serialization$blocks(a.nextConnection,c))&&(b.next=a);},saveConnection$$module$build$src$core$serialization$blocks=function saveConnection$$module$build$src$core$serialization$blocks(a,b){var c=a.getShadowState(!0);a=a.targetBlock();if(!c&&!a)return null;var d=Object.create(null);c&&(d.shadow=c);a&&!a.isShadow()&&(d.block=save$$module$build$src$core$serialization$blocks(a,{doFullSerialization:b}));return d;},append$$module$build$src$core$serialization$blocks=function append$$module$build$src$core$serialization$blocks(a,b){var _ref8=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{},_ref8$recordUndo=_ref8.recordUndo,c=_ref8$recordUndo===void 0?!1:_ref8$recordUndo;return appendInternal$$module$build$src$core$serialization$blocks(a,b,{recordUndo:c});},appendInternal$$module$build$src$core$serialization$blocks=function appendInternal$$module$build$src$core$serialization$blocks(a,b){var _ref9=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{},c=_ref9.parentConnection,_ref9$isShadow=_ref9.isShadow,d=_ref9$isShadow===void 0?!1:_ref9$isShadow,_ref9$recordUndo=_ref9.recordUndo,e=_ref9$recordUndo===void 0?!1:_ref9$recordUndo;var f=getRecordUndo$$module$build$src$core$events$utils();setRecordUndo$$module$build$src$core$events$utils(e);(e=getGroup$$module$build$src$core$events$utils())||setGroup$$module$build$src$core$events$utils(!0);disable$$module$build$src$core$events$utils();var g=appendPrivate$$module$build$src$core$serialization$blocks(a,b,{parentConnection:c,isShadow:d});enable$$module$build$src$core$events$utils();fire$$module$build$src$core$events$utils(new(get$$module$build$src$core$events$utils(CREATE$$module$build$src$core$events$utils))(g));setGroup$$module$build$src$core$events$utils(e);setRecordUndo$$module$build$src$core$events$utils(f);b.rendered&&setTimeout(function(){g.disposed||g.setConnectionTracking(!0);},1);return g;},appendPrivate$$module$build$src$core$serialization$blocks=function appendPrivate$$module$build$src$core$serialization$blocks(a,b){var _ref10=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{},c=_ref10.parentConnection,_ref10$isShadow=_ref10.isShadow,d=_ref10$isShadow===void 0?!1:_ref10$isShadow;if(!a.type)throw new MissingBlockType$$module$build$src$core$serialization$exceptions(a);var e=b.newBlock(a.type,a.id);e.setShadow(d);loadCoords$$module$build$src$core$serialization$blocks(e,a);loadAttributes$$module$build$src$core$serialization$blocks(e,a);loadExtraState$$module$build$src$core$serialization$blocks(e,a);tryToConnectParent$$module$build$src$core$serialization$blocks(c,e,a);loadIcons$$module$build$src$core$serialization$blocks(e,a);loadFields$$module$build$src$core$serialization$blocks(e,a);loadInputBlocks$$module$build$src$core$serialization$blocks(e,a);loadNextBlocks$$module$build$src$core$serialization$blocks(e,a);initBlock$$module$build$src$core$serialization$blocks(e,b.rendered);return e;},loadCoords$$module$build$src$core$serialization$blocks=function loadCoords$$module$build$src$core$serialization$blocks(a,b){var c=void 0===b.x?0:b.x;b=void 0===b.y?0:b.y;var d=a.workspace;c=d.RTL?d.getWidth()-c:c;a.moveBy(c,b);},loadAttributes$$module$build$src$core$serialization$blocks=function loadAttributes$$module$build$src$core$serialization$blocks(a,b){b.collapsed&&a.setCollapsed(!0);!1===b.enabled&&a.setEnabled(!1);void 0!==b.inline&&a.setInputsInline(b.inline);void 0!==b.data&&(a.data=b.data);},loadExtraState$$module$build$src$core$serialization$blocks=function loadExtraState$$module$build$src$core$serialization$blocks(a,b){b.extraState&&(a.loadExtraState?a.loadExtraState(b.extraState):a.domToMutation&&a.domToMutation(textToDom$$module$build$src$core$xml(b.extraState)));},tryToConnectParent$$module$build$src$core$serialization$blocks=function tryToConnectParent$$module$build$src$core$serialization$blocks(a,b,c){if(a){if(a.getSourceBlock().isShadow()&&!b.isShadow())throw new RealChildOfShadow$$module$build$src$core$serialization$exceptions(c);if(a.type===inputTypes$$module$build$src$core$input_types.VALUE){var d=b.outputConnection;if(!d)throw new MissingConnection$$module$build$src$core$serialization$exceptions("output",b,c);}else if(d=b.previousConnection,!d)throw new MissingConnection$$module$build$src$core$serialization$exceptions("previous",b,c);if(!a.connect(d)){var e=b.workspace.connectionChecker;throw new BadConnectionCheck$$module$build$src$core$serialization$exceptions(e.getErrorMessage(e.canConnectWithReason(d,a,!1),d,a),a.type===inputTypes$$module$build$src$core$input_types.VALUE?"output connection":"previous connection",b,c);}}},loadIcons$$module$build$src$core$serialization$blocks=function loadIcons$$module$build$src$core$serialization$blocks(a,b){b.icons&&(b=b.icons.comment)&&(a.setCommentText(b.text),"pinned"in b&&(a.commentModel.pinned=b.pinned),"width"in b&&"height"in b&&(a.commentModel.size=new Size$$module$build$src$core$utils$size(b.width,b.height)),b.pinned&&a.rendered&&!a.isInFlyout&&setTimeout(function(){return a.getCommentIcon().setVisible(!0);},1));},loadFields$$module$build$src$core$serialization$blocks=function loadFields$$module$build$src$core$serialization$blocks(a,b){if(b.fields){var c=Object.keys(b.fields);for(var d=0;d<c.length;d++){var e=c[d],f=b.fields[e],g=a.getField(e);g?g.loadState(f):console.warn("Ignoring non-existant field ".concat(e," in block ").concat(a.type));}}},loadInputBlocks$$module$build$src$core$serialization$blocks=function loadInputBlocks$$module$build$src$core$serialization$blocks(a,b){if(b.inputs){var c=Object.keys(b.inputs);for(var d=0;d<c.length;d++){var e=c[d],f=a.getInput(e);if(!f||!f.connection)throw new MissingConnection$$module$build$src$core$serialization$exceptions(e,a,b);loadConnection$$module$build$src$core$serialization$blocks(f.connection,b.inputs[e]);}}},loadNextBlocks$$module$build$src$core$serialization$blocks=function loadNextBlocks$$module$build$src$core$serialization$blocks(a,b){if(b.next){if(!a.nextConnection)throw new MissingConnection$$module$build$src$core$serialization$exceptions("next",a,b);loadConnection$$module$build$src$core$serialization$blocks(a.nextConnection,b.next);}},loadConnection$$module$build$src$core$serialization$blocks=function loadConnection$$module$build$src$core$serialization$blocks(a,b){b.shadow&&a.setShadowState(b.shadow);b.block&&appendPrivate$$module$build$src$core$serialization$blocks(b.block,a.getSourceBlock().workspace,{parentConnection:a});},initBlock$$module$build$src$core$serialization$blocks=function initBlock$$module$build$src$core$serialization$blocks(a,b){if(b)for(a.setConnectionTracking(!1),a.initSvg(),a.render(!1),a=a.getIcons(),b=0;b<a.length;b++){a[b].computeIconLocation();}else a.initModel();},connectReciprocally$$module$build$src$core$connection=function connectReciprocally$$module$build$src$core$connection(a,b){if(!a||!b)throw Error("Cannot connect null connections.");a.targetConnection=b;b.targetConnection=a;},getSingleConnection$$module$build$src$core$connection=function getSingleConnection$$module$build$src$core$connection(a,b){var c=null;b=b.outputConnection;var d=b.getConnectionChecker();for(var e=0,f;f=a.inputList[e];e++){var g=f.connection;if(g&&d.canConnect(b,g,!1)){if(c)return null;c=g;}}return c;},getConnectionForOrphanedOutput$$module$build$src$core$connection=function getConnectionForOrphanedOutput$$module$build$src$core$connection(a,b){var c;for(;c=getSingleConnection$$module$build$src$core$connection(a,b);){if(a=c.targetBlock(),!a||a.isShadow())return c;}return null;},getParentConnection$$module$build$src$core$keyboard_nav$ast_node=function getParentConnection$$module$build$src$core$keyboard_nav$ast_node(a){var b=a.outputConnection;if(!b||a.previousConnection&&a.previousConnection.isConnected())b=a.previousConnection;return b;},disposeUiEffect$$module$build$src$core$block_animations=function disposeUiEffect$$module$build$src$core$block_animations(a){var b=a.workspace;var c=a.getSvgRoot();b.getAudioManager().play("delete");var d=b.getSvgXY(c);c=c.cloneNode(!0);c.setAttribute("transform","translate("+d.x+","+d.y+")");b.getParentSvg().appendChild(c);disposeUiStep$$module$build$src$core$block_animations(c,{x:d.x,y:d.y,width:a.width,height:a.height},b.RTL,new Date(),b.scale);},disposeUiStep$$module$build$src$core$block_animations=function disposeUiStep$$module$build$src$core$block_animations(a,b,c,d,e){var f=(new Date().getTime()-d.getTime())/150;1<f?removeNode$$module$build$src$core$utils$dom(a):(a.setAttribute("transform","translate("+(b.x+(c?-1:1)*b.width*e/2*f)+","+(b.y+b.height*e*f)+") scale("+(1-f)*e+")"),setTimeout(disposeUiStep$$module$build$src$core$block_animations,10,a,b,c,d,e));},connectionUiEffect$$module$build$src$core$block_animations=function connectionUiEffect$$module$build$src$core$block_animations(a){var b=a.workspace,c=b.scale;b.getAudioManager().play("click");if(!(1>c)){var d=b.getSvgXY(a.getSvgRoot());a.outputConnection?(d.x+=(a.RTL?3:-3)*c,d.y+=13*c):a.previousConnection&&(d.x+=(a.RTL?-23:23)*c,d.y+=3*c);a=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.CIRCLE,{cx:d.x,cy:d.y,r:0,fill:"none",stroke:"#888","stroke-width":10},b.getParentSvg());connectionUiStep$$module$build$src$core$block_animations(a,new Date(),c);}},connectionUiStep$$module$build$src$core$block_animations=function connectionUiStep$$module$build$src$core$block_animations(a,b,c){var d=(new Date().getTime()-b.getTime())/150;1<d?removeNode$$module$build$src$core$utils$dom(a):(a.setAttribute("r",(25*d*c).toString()),a.style.opacity=(1-d).toString(),disconnectPid$$module$build$src$core$block_animations=setTimeout(connectionUiStep$$module$build$src$core$block_animations,10,a,b,c));},disconnectUiEffect$$module$build$src$core$block_animations=function disconnectUiEffect$$module$build$src$core$block_animations(a){disconnectUiStop$$module$build$src$core$block_animations();a.workspace.getAudioManager().play("disconnect");if(!(1>a.workspace.scale)){var b=a.getHeightWidth().height;b=Math.atan(10/b)/Math.PI*180;a.RTL||(b*=-1);disconnectGroup$$module$build$src$core$block_animations=a.getSvgRoot();disconnectUiStep$$module$build$src$core$block_animations(disconnectGroup$$module$build$src$core$block_animations,b,new Date());}},disconnectUiStep$$module$build$src$core$block_animations=function disconnectUiStep$$module$build$src$core$block_animations(a,b,c){var d=(new Date().getTime()-c.getTime())/200;var e="";1>=d&&(e="skewX(".concat(Math.round(Math.sin(d*Math.PI*3)*(1-d)*b),")"),disconnectPid$$module$build$src$core$block_animations=setTimeout(disconnectUiStep$$module$build$src$core$block_animations,10,a,b,c));a.skew_=e;a.setAttribute("transform",a.translate_+a.skew_);},disconnectUiStop$$module$build$src$core$block_animations=function disconnectUiStop$$module$build$src$core$block_animations(){if(disconnectGroup$$module$build$src$core$block_animations){disconnectPid$$module$build$src$core$block_animations&&clearTimeout(disconnectPid$$module$build$src$core$block_animations);var a=disconnectGroup$$module$build$src$core$block_animations;a.skew_="";a.setAttribute("transform",a.translate_);disconnectGroup$$module$build$src$core$block_animations=null;}},copy$$module$build$src$core$clipboard=function copy$$module$build$src$core$clipboard(a){TEST_ONLY$$module$build$src$core$clipboard.copyInternal(a);},copyInternal$$module$build$src$core$clipboard=function copyInternal$$module$build$src$core$clipboard(a){copyData$$module$build$src$core$clipboard=a.toCopyData();},paste$$module$build$src$core$clipboard=function paste$$module$build$src$core$clipboard(){if(!copyData$$module$build$src$core$clipboard)return null;var a=copyData$$module$build$src$core$clipboard.source;a.isFlyout&&(a=a.targetWorkspace);return copyData$$module$build$src$core$clipboard.typeCounts&&a.isCapacityAvailable(copyData$$module$build$src$core$clipboard.typeCounts)?a.paste(copyData$$module$build$src$core$clipboard.saveInfo):null;},duplicate$$module$build$src$core$clipboard=function duplicate$$module$build$src$core$clipboard(a){return TEST_ONLY$$module$build$src$core$clipboard.duplicateInternal(a);},duplicateInternal$$module$build$src$core$clipboard=function duplicateInternal$$module$build$src$core$clipboard(a){var b=copyData$$module$build$src$core$clipboard;copy$$module$build$src$core$clipboard(a);var c,d,e;a=null!=(e=null==(c=a.toCopyData())?void 0:null==(d=c.source)?void 0:d.paste(copyData$$module$build$src$core$clipboard.saveInfo))?e:null;copyData$$module$build$src$core$clipboard=b;return a;},getCurrentBlock$$module$build$src$core$contextmenu=function getCurrentBlock$$module$build$src$core$contextmenu(){return currentBlock$$module$build$src$core$contextmenu;},setCurrentBlock$$module$build$src$core$contextmenu=function setCurrentBlock$$module$build$src$core$contextmenu(a){currentBlock$$module$build$src$core$contextmenu=a;},show$$module$build$src$core$contextmenu=function show$$module$build$src$core$contextmenu(a,b,c){show$$module$build$src$core$widgetdiv(dummyOwner$$module$build$src$core$contextmenu,c,dispose$$module$build$src$core$contextmenu);if(b.length){var d=populate_$$module$build$src$core$contextmenu(b,c);menu_$$module$build$src$core$contextmenu=d;position_$$module$build$src$core$contextmenu(d,a,c);setTimeout(function(){d.focus();},1);currentBlock$$module$build$src$core$contextmenu=null;}else hide$$module$build$src$core$contextmenu();},populate_$$module$build$src$core$contextmenu=function populate_$$module$build$src$core$contextmenu(a,b){var c=new Menu$$module$build$src$core$menu();c.setRole(Role$$module$build$src$core$utils$aria.MENU);var _loop=function _loop(d){var e=a[d],f=new MenuItem$$module$build$src$core$menuitem(e.text);f.setRightToLeft(b);f.setRole(Role$$module$build$src$core$utils$aria.MENUITEM);c.addChild(f);f.setEnabled(e.enabled);if(e.enabled)f.onAction(function(){hide$$module$build$src$core$contextmenu();e.callback(e.scope);},{});};for(var d=0;d<a.length;d++){_loop(d);}return c;},position_$$module$build$src$core$contextmenu=function position_$$module$build$src$core$contextmenu(a,b,c){var d=getViewportBBox$$module$build$src$core$utils$svg_math();b=new Rect$$module$build$src$core$utils$rect(b.clientY+d.top,b.clientY+d.top,b.clientX+d.left,b.clientX+d.left);createWidget_$$module$build$src$core$contextmenu(a);var e=a.getSize();c&&(b.left+=e.width,b.right+=e.width,d.left+=e.width,d.right+=e.width);positionWithAnchor$$module$build$src$core$widgetdiv(d,b,e,c);a.focus();},createWidget_$$module$build$src$core$contextmenu=function createWidget_$$module$build$src$core$contextmenu(a){var b=getDiv$$module$build$src$core$widgetdiv();if(!b)throw Error("Attempting to create a context menu when widget div is null");b=a.render(b);addClass$$module$build$src$core$utils$dom(b,"blocklyContextMenu");conditionalBind$$module$build$src$core$browser_events(b,"contextmenu",null,haltPropagation$$module$build$src$core$contextmenu);a.focus();},haltPropagation$$module$build$src$core$contextmenu=function haltPropagation$$module$build$src$core$contextmenu(a){a.preventDefault();a.stopPropagation();},hide$$module$build$src$core$contextmenu=function hide$$module$build$src$core$contextmenu(){hideIfOwner$$module$build$src$core$widgetdiv(dummyOwner$$module$build$src$core$contextmenu);currentBlock$$module$build$src$core$contextmenu=null;},dispose$$module$build$src$core$contextmenu=function dispose$$module$build$src$core$contextmenu(){menu_$$module$build$src$core$contextmenu&&(menu_$$module$build$src$core$contextmenu.dispose(),menu_$$module$build$src$core$contextmenu=null);},callbackFactory$$module$build$src$core$contextmenu=function callbackFactory$$module$build$src$core$contextmenu(a,b){return function(){disable$$module$build$src$core$events$utils();var c;try{c=domToBlock$$module$build$src$core$xml(b,a.workspace);var d=a.getRelativeToSurfaceXY();d.x=a.RTL?d.x-$.config$$module$build$src$core$config.snapRadius:d.x+$.config$$module$build$src$core$config.snapRadius;d.y+=2*$.config$$module$build$src$core$config.snapRadius;c.moveBy(d.x,d.y);}finally{enable$$module$build$src$core$events$utils();}isEnabled$$module$build$src$core$events$utils()&&!c.isShadow()&&fire$$module$build$src$core$events$utils(new(get$$module$build$src$core$events$utils(CREATE$$module$build$src$core$events$utils))(c));c.select();};},commentDeleteOption$$module$build$src$core$contextmenu=function commentDeleteOption$$module$build$src$core$contextmenu(a){return{text:Msg$$module$build$src$core$msg.REMOVE_COMMENT,enabled:!0,callback:function callback(){setGroup$$module$build$src$core$events$utils(!0);a.dispose();setGroup$$module$build$src$core$events$utils(!1);}};},commentDuplicateOption$$module$build$src$core$contextmenu=function commentDuplicateOption$$module$build$src$core$contextmenu(a){return{text:Msg$$module$build$src$core$msg.DUPLICATE_COMMENT,enabled:!0,callback:function callback(){duplicate$$module$build$src$core$clipboard(a);}};},workspaceCommentOption$$module$build$src$core$contextmenu=function workspaceCommentOption$$module$build$src$core$contextmenu(a,b){var c={enabled:!0};c.text=Msg$$module$build$src$core$msg.ADD_COMMENT;c.callback=function(){var d=new WorkspaceCommentSvg$$module$build$src$core$workspace_comment_svg(a,Msg$$module$build$src$core$msg.WORKSPACE_COMMENT_DEFAULT_TEXT,WorkspaceCommentSvg$$module$build$src$core$workspace_comment_svg.DEFAULT_SIZE,WorkspaceCommentSvg$$module$build$src$core$workspace_comment_svg.DEFAULT_SIZE);var e=a.getInjectionDiv().getBoundingClientRect();e=new Coordinate$$module$build$src$core$utils$coordinate(b.clientX-e.left,b.clientY-e.top);var f=a.getOriginOffsetInPixels();e=Coordinate$$module$build$src$core$utils$coordinate.difference(e,f);e.scale(1/a.scale);d.moveBy(e.x,e.y);a.rendered&&(d.initSvg(),d.render(),d.select());};return c;},getStartPositionRect$$module$build$src$core$positionable_helpers=function getStartPositionRect$$module$build$src$core$positionable_helpers(a,b,c,d,e,f){var g=f.scrollbar&&f.scrollbar.canScrollVertically();a.horizontal===horizontalPosition$$module$build$src$core$positionable_helpers.LEFT?(c=e.absoluteMetrics.left+c,g&&f.RTL&&(c+=Scrollbar$$module$build$src$core$scrollbar.scrollbarThickness)):(c=e.absoluteMetrics.left+e.viewMetrics.width-b.width-c,g&&!f.RTL&&(c-=Scrollbar$$module$build$src$core$scrollbar.scrollbarThickness));a.vertical===verticalPosition$$module$build$src$core$positionable_helpers.TOP?a=e.absoluteMetrics.top+d:(a=e.absoluteMetrics.top+e.viewMetrics.height-b.height-d,f.scrollbar&&f.scrollbar.canScrollHorizontally()&&(a-=Scrollbar$$module$build$src$core$scrollbar.scrollbarThickness));return new Rect$$module$build$src$core$utils$rect(a,a+b.height,c,c+b.width);},getCornerOppositeToolbox$$module$build$src$core$positionable_helpers=function getCornerOppositeToolbox$$module$build$src$core$positionable_helpers(a,b){return{horizontal:b.toolboxMetrics.position===Position$$module$build$src$core$utils$toolbox.LEFT||a.horizontalLayout&&!a.RTL?horizontalPosition$$module$build$src$core$positionable_helpers.RIGHT:horizontalPosition$$module$build$src$core$positionable_helpers.LEFT,vertical:b.toolboxMetrics.position===Position$$module$build$src$core$utils$toolbox.BOTTOM?verticalPosition$$module$build$src$core$positionable_helpers.TOP:verticalPosition$$module$build$src$core$positionable_helpers.BOTTOM};},bumpPositionRect$$module$build$src$core$positionable_helpers=function bumpPositionRect$$module$build$src$core$positionable_helpers(a,b,c,d){var e=a.left,f=a.right-a.left,g=a.bottom-a.top;for(var h=0;h<d.length;h++){var k=d[h];a.intersects(k)&&(a=c===bumpDirection$$module$build$src$core$positionable_helpers.UP?k.top-g-b:k.bottom+b,a=new Rect$$module$build$src$core$utils$rect(a,a+g,e,e+f),h=-1);}return a;},registerEscape$$module$build$src$core$shortcut_items=function registerEscape$$module$build$src$core$shortcut_items(){_ShortcutRegistry$$module$build$src$core$shortcut_registry.registry.register({name:names$$module$build$src$core$shortcut_items.ESCAPE,preconditionFn:function preconditionFn(a){return!a.options.readOnly;},callback:function callback(a){a.hideChaff();return!0;},keyCodes:[KeyCodes$$module$build$src$core$utils$keycodes.ESC]});},registerDelete$$module$build$src$core$shortcut_items=function registerDelete$$module$build$src$core$shortcut_items(){_ShortcutRegistry$$module$build$src$core$shortcut_registry.registry.register({name:names$$module$build$src$core$shortcut_items.DELETE,preconditionFn:function preconditionFn(a){var b=getSelected$$module$build$src$core$common();return!a.options.readOnly&&null!=b&&b.isDeletable();},callback:function callback(a,b){b.preventDefault();if(Gesture$$module$build$src$core$gesture.inProgress())return!1;getSelected$$module$build$src$core$common().checkAndDelete();return!0;},keyCodes:[KeyCodes$$module$build$src$core$utils$keycodes.DELETE,KeyCodes$$module$build$src$core$utils$keycodes.BACKSPACE]});},registerCopy$$module$build$src$core$shortcut_items=function registerCopy$$module$build$src$core$shortcut_items(){var a=_ShortcutRegistry$$module$build$src$core$shortcut_registry.registry.createSerializedKey(KeyCodes$$module$build$src$core$utils$keycodes.C,[KeyCodes$$module$build$src$core$utils$keycodes.CTRL]),b=_ShortcutRegistry$$module$build$src$core$shortcut_registry.registry.createSerializedKey(KeyCodes$$module$build$src$core$utils$keycodes.C,[KeyCodes$$module$build$src$core$utils$keycodes.ALT]),c=_ShortcutRegistry$$module$build$src$core$shortcut_registry.registry.createSerializedKey(KeyCodes$$module$build$src$core$utils$keycodes.C,[KeyCodes$$module$build$src$core$utils$keycodes.META]);_ShortcutRegistry$$module$build$src$core$shortcut_registry.registry.register({name:names$$module$build$src$core$shortcut_items.COPY,preconditionFn:function preconditionFn(d){var e=getSelected$$module$build$src$core$common();return!d.options.readOnly&&!Gesture$$module$build$src$core$gesture.inProgress()&&null!=e&&e.isDeletable()&&e.isMovable();},callback:function callback(d,e){e.preventDefault();d.hideChaff();copy$$module$build$src$core$clipboard(getSelected$$module$build$src$core$common());return!0;},keyCodes:[a,b,c]});},registerCut$$module$build$src$core$shortcut_items=function registerCut$$module$build$src$core$shortcut_items(){var a=_ShortcutRegistry$$module$build$src$core$shortcut_registry.registry.createSerializedKey(KeyCodes$$module$build$src$core$utils$keycodes.X,[KeyCodes$$module$build$src$core$utils$keycodes.CTRL]),b=_ShortcutRegistry$$module$build$src$core$shortcut_registry.registry.createSerializedKey(KeyCodes$$module$build$src$core$utils$keycodes.X,[KeyCodes$$module$build$src$core$utils$keycodes.ALT]),c=_ShortcutRegistry$$module$build$src$core$shortcut_registry.registry.createSerializedKey(KeyCodes$$module$build$src$core$utils$keycodes.X,[KeyCodes$$module$build$src$core$utils$keycodes.META]);_ShortcutRegistry$$module$build$src$core$shortcut_registry.registry.register({name:names$$module$build$src$core$shortcut_items.CUT,preconditionFn:function preconditionFn(d){var e=getSelected$$module$build$src$core$common();return!d.options.readOnly&&!Gesture$$module$build$src$core$gesture.inProgress()&&null!=e&&e instanceof BlockSvg$$module$build$src$core$block_svg&&e.isDeletable()&&e.isMovable()&&!e.workspace.isFlyout;},callback:function callback(){var d=getSelected$$module$build$src$core$common();if(!d)return!1;copy$$module$build$src$core$clipboard(d);d.checkAndDelete();return!0;},keyCodes:[a,b,c]});},registerPaste$$module$build$src$core$shortcut_items=function registerPaste$$module$build$src$core$shortcut_items(){var a=_ShortcutRegistry$$module$build$src$core$shortcut_registry.registry.createSerializedKey(KeyCodes$$module$build$src$core$utils$keycodes.V,[KeyCodes$$module$build$src$core$utils$keycodes.CTRL]),b=_ShortcutRegistry$$module$build$src$core$shortcut_registry.registry.createSerializedKey(KeyCodes$$module$build$src$core$utils$keycodes.V,[KeyCodes$$module$build$src$core$utils$keycodes.ALT]),c=_ShortcutRegistry$$module$build$src$core$shortcut_registry.registry.createSerializedKey(KeyCodes$$module$build$src$core$utils$keycodes.V,[KeyCodes$$module$build$src$core$utils$keycodes.META]);_ShortcutRegistry$$module$build$src$core$shortcut_registry.registry.register({name:names$$module$build$src$core$shortcut_items.PASTE,preconditionFn:function preconditionFn(d){return!d.options.readOnly&&!Gesture$$module$build$src$core$gesture.inProgress();},callback:function callback(){return!!paste$$module$build$src$core$clipboard();},keyCodes:[a,b,c]});},registerUndo$$module$build$src$core$shortcut_items=function registerUndo$$module$build$src$core$shortcut_items(){var a=_ShortcutRegistry$$module$build$src$core$shortcut_registry.registry.createSerializedKey(KeyCodes$$module$build$src$core$utils$keycodes.Z,[KeyCodes$$module$build$src$core$utils$keycodes.CTRL]),b=_ShortcutRegistry$$module$build$src$core$shortcut_registry.registry.createSerializedKey(KeyCodes$$module$build$src$core$utils$keycodes.Z,[KeyCodes$$module$build$src$core$utils$keycodes.ALT]),c=_ShortcutRegistry$$module$build$src$core$shortcut_registry.registry.createSerializedKey(KeyCodes$$module$build$src$core$utils$keycodes.Z,[KeyCodes$$module$build$src$core$utils$keycodes.META]);_ShortcutRegistry$$module$build$src$core$shortcut_registry.registry.register({name:names$$module$build$src$core$shortcut_items.UNDO,preconditionFn:function preconditionFn(d){return!d.options.readOnly&&!Gesture$$module$build$src$core$gesture.inProgress();},callback:function callback(d){d.hideChaff();d.undo(!1);return!0;},keyCodes:[a,b,c]});},registerRedo$$module$build$src$core$shortcut_items=function registerRedo$$module$build$src$core$shortcut_items(){var a=_ShortcutRegistry$$module$build$src$core$shortcut_registry.registry.createSerializedKey(KeyCodes$$module$build$src$core$utils$keycodes.Z,[KeyCodes$$module$build$src$core$utils$keycodes.SHIFT,KeyCodes$$module$build$src$core$utils$keycodes.CTRL]),b=_ShortcutRegistry$$module$build$src$core$shortcut_registry.registry.createSerializedKey(KeyCodes$$module$build$src$core$utils$keycodes.Z,[KeyCodes$$module$build$src$core$utils$keycodes.SHIFT,KeyCodes$$module$build$src$core$utils$keycodes.ALT]),c=_ShortcutRegistry$$module$build$src$core$shortcut_registry.registry.createSerializedKey(KeyCodes$$module$build$src$core$utils$keycodes.Z,[KeyCodes$$module$build$src$core$utils$keycodes.SHIFT,KeyCodes$$module$build$src$core$utils$keycodes.META]),d=_ShortcutRegistry$$module$build$src$core$shortcut_registry.registry.createSerializedKey(KeyCodes$$module$build$src$core$utils$keycodes.Y,[KeyCodes$$module$build$src$core$utils$keycodes.CTRL]);_ShortcutRegistry$$module$build$src$core$shortcut_registry.registry.register({name:names$$module$build$src$core$shortcut_items.REDO,preconditionFn:function preconditionFn(e){return!Gesture$$module$build$src$core$gesture.inProgress()&&!e.options.readOnly;},callback:function callback(e){e.hideChaff();e.undo(!0);return!0;},keyCodes:[a,b,c,d]});},registerDefaultShortcuts$$module$build$src$core$shortcut_items=function registerDefaultShortcuts$$module$build$src$core$shortcut_items(){registerEscape$$module$build$src$core$shortcut_items();registerDelete$$module$build$src$core$shortcut_items();registerCopy$$module$build$src$core$shortcut_items();registerCut$$module$build$src$core$shortcut_items();registerPaste$$module$build$src$core$shortcut_items();registerUndo$$module$build$src$core$shortcut_items();registerRedo$$module$build$src$core$shortcut_items();},isProcedureBlock$$module$build$src$core$interfaces$i_procedure_block=function isProcedureBlock$$module$build$src$core$interfaces$i_procedure_block(a){return void 0!==a.doProcedureUpdate;},triggerProceduresUpdate$$module$build$src$core$procedures$update_procedures=function triggerProceduresUpdate$$module$build$src$core$procedures$update_procedures(a){var _iterator=_createForOfIteratorHelper(a.getAllBlocks(!1)),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var b=_step.value;isProcedureBlock$$module$build$src$core$interfaces$i_procedure_block(b)&&b.doProcedureUpdate();}}catch(err){_iterator.e(err);}finally{_iterator.f();}},allProcedures$$module$build$src$core$procedures=function allProcedures$$module$build$src$core$procedures(a){var b=a.getBlocksByType("procedures_defnoreturn",!1).map(function(c){return c.getProcedureDef();});a=a.getBlocksByType("procedures_defreturn",!1).map(function(c){return c.getProcedureDef();});b.sort(procTupleComparator$$module$build$src$core$procedures);a.sort(procTupleComparator$$module$build$src$core$procedures);return[b,a];},procTupleComparator$$module$build$src$core$procedures=function procTupleComparator$$module$build$src$core$procedures(a,b){return a[0].localeCompare(b[0],void 0,{sensitivity:"base"});},findLegalName$$module$build$src$core$procedures=function findLegalName$$module$build$src$core$procedures(a,b){if(b.isInFlyout)return a;for(a=a||Msg$$module$build$src$core$msg.UNNAMED_KEY||"unnamed";!isLegalName$$module$build$src$core$procedures(a,b.workspace,b);){var c=a.match(/^(.*?)(\d+)$/);a=c?c[1]+(parseInt(c[2])+1):a+"2";}return a;},isLegalName$$module$build$src$core$procedures=function isLegalName$$module$build$src$core$procedures(a,b,c){return!isNameUsed$$module$build$src$core$procedures(a,b,c);},isNameUsed$$module$build$src$core$procedures=function isNameUsed$$module$build$src$core$procedures(a,b,c){b=b.getAllBlocks(!1);for(var e=0;e<b.length;e++){if(b[e]!==c){var d=b[e];if(d.getProcedureDef&&(d=d.getProcedureDef(),Names$$module$build$src$core$names.equals(d[0],a)))return!0;}}return!1;},rename$$module$build$src$core$procedures=function rename$$module$build$src$core$procedures(a){var b=this.getSourceBlock();if(!b)throw new UnattachedFieldError$$module$build$src$core$field();a=a.trim();var c=findLegalName$$module$build$src$core$procedures(a,b),d=this.getValue();if(d!==a&&d!==c)for(a=b.workspace.getAllBlocks(!1),b=0;b<a.length;b++){var e=a[b];e.renameProcedure&&e.renameProcedure(d,c);}return c;},flyoutCategory$$module$build$src$core$procedures=function flyoutCategory$$module$build$src$core$procedures(a){function b(f,g){for(var k=0;k<f.length;k++){var h=f[k][0];var l=f[k][1],m=createElement$$module$build$src$core$utils$xml("block");m.setAttribute("type",g);m.setAttribute("gap","16");var n=createElement$$module$build$src$core$utils$xml("mutation");n.setAttribute("name",h);m.appendChild(n);for(h=0;h<l.length;h++){var p=createElement$$module$build$src$core$utils$xml("arg");p.setAttribute("name",l[h]);n.appendChild(p);}c.push(m);}}var c=[];if(Blocks$$module$build$src$core$blocks.procedures_defnoreturn){var d=createElement$$module$build$src$core$utils$xml("block");d.setAttribute("type","procedures_defnoreturn");d.setAttribute("gap","16");var e=createElement$$module$build$src$core$utils$xml("field");e.setAttribute("name","NAME");e.appendChild(createTextNode$$module$build$src$core$utils$xml(Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_PROCEDURE));d.appendChild(e);c.push(d);}Blocks$$module$build$src$core$blocks.procedures_defreturn&&(d=createElement$$module$build$src$core$utils$xml("block"),d.setAttribute("type","procedures_defreturn"),d.setAttribute("gap","16"),e=createElement$$module$build$src$core$utils$xml("field"),e.setAttribute("name","NAME"),e.appendChild(createTextNode$$module$build$src$core$utils$xml(Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_PROCEDURE)),d.appendChild(e),c.push(d));Blocks$$module$build$src$core$blocks.procedures_ifreturn&&(d=createElement$$module$build$src$core$utils$xml("block"),d.setAttribute("type","procedures_ifreturn"),d.setAttribute("gap","16"),c.push(d));c.length&&c[c.length-1].setAttribute("gap","24");a=allProcedures$$module$build$src$core$procedures(a);b(a[0],"procedures_callnoreturn");b(a[1],"procedures_callreturn");return c;},updateMutatorFlyout$$module$build$src$core$procedures=function updateMutatorFlyout$$module$build$src$core$procedures(a){var b=[],c=a.getBlocksByType("procedures_mutatorarg",!1);for(var f=0,g;g=c[f];f++){b.push(g.getFieldValue("NAME"));}c=createElement$$module$build$src$core$utils$xml("xml");var d=createElement$$module$build$src$core$utils$xml("block");d.setAttribute("type","procedures_mutatorarg");var e=createElement$$module$build$src$core$utils$xml("field");e.setAttribute("name","NAME");b=generateUniqueNameFromOptions$$module$build$src$core$variables(DEFAULT_ARG$$module$build$src$core$procedures,b);b=createTextNode$$module$build$src$core$utils$xml(b);e.appendChild(b);d.appendChild(e);c.appendChild(d);a.updateToolbox(c);},mutatorOpenListener$$module$build$src$core$procedures=function mutatorOpenListener$$module$build$src$core$procedures(a){if(a.type===BUBBLE_OPEN$$module$build$src$core$events$utils&&"mutator"===a.bubbleType&&a.isOpen&&a.blockId){a=getWorkspaceById$$module$build$src$core$common(a.workspaceId).getBlockById(a.blockId);var b=a.type;if("procedures_defnoreturn"===b||"procedures_defreturn"===b)a=a.mutator.getWorkspace(),updateMutatorFlyout$$module$build$src$core$procedures(a),a.addChangeListener(mutatorChangeListener$$module$build$src$core$procedures);}},mutatorChangeListener$$module$build$src$core$procedures=function mutatorChangeListener$$module$build$src$core$procedures(a){if(a.type===CREATE$$module$build$src$core$events$utils||a.type===DELETE$$module$build$src$core$events$utils||a.type===CHANGE$$module$build$src$core$events$utils)a=getWorkspaceById$$module$build$src$core$common(a.workspaceId),updateMutatorFlyout$$module$build$src$core$procedures(a);},getCallers$$module$build$src$core$procedures=function getCallers$$module$build$src$core$procedures(a,b){var c=[];b=b.getAllBlocks(!1);for(var e=0;e<b.length;e++){var d=b[e];d.getProcedureCall&&(d=d.getProcedureCall())&&Names$$module$build$src$core$names.equals(d,a)&&c.push(b[e]);}return c;},mutateCallers$$module$build$src$core$procedures=function mutateCallers$$module$build$src$core$procedures(a){var b=getRecordUndo$$module$build$src$core$events$utils();var c=a.getProcedureDef()[0];var d=a.mutationToDom(!0);a=getCallers$$module$build$src$core$procedures(c,a.workspace);for(var f=0,g;g=a[f];f++){c=(c=g.mutationToDom())&&domToText$$module$build$src$core$xml(c);g.domToMutation&&g.domToMutation(d);var e=g.mutationToDom();e=e&&domToText$$module$build$src$core$xml(e);c!==e&&(setRecordUndo$$module$build$src$core$events$utils(!1),fire$$module$build$src$core$events$utils(new(get$$module$build$src$core$events$utils(CHANGE$$module$build$src$core$events$utils))(g,"mutation",null,c,e)),setRecordUndo$$module$build$src$core$events$utils(b));}},getDefinition$$module$build$src$core$procedures=function getDefinition$$module$build$src$core$procedures(a,b){b=b.getAllBlocks(!1);for(var d=0;d<b.length;d++){var c=b[d];if(c.getProcedureDef&&(c=c.getProcedureDef())&&Names$$module$build$src$core$names.equals(c[0],a))return b[d];}return null;},isDynamicShape$$module$build$src$core$renderers$common$constants=function isDynamicShape$$module$build$src$core$renderers$common$constants(a){return a.isDynamic;},isDebuggerEnabled$$module$build$src$core$renderers$common$debug=function isDebuggerEnabled$$module$build$src$core$renderers$common$debug(){return useDebugger$$module$build$src$core$renderers$common$debug;},startDebugger$$module$build$src$core$renderers$common$debug=function startDebugger$$module$build$src$core$renderers$common$debug(){warn$$module$build$src$core$utils$deprecation("Blockly.blockRendering.debug.startDebugger()","version 8","version 10","the debug renderer in @blockly/dev-tools (See https://www.npmjs.com/package/@blockly/dev-tools.)");useDebugger$$module$build$src$core$renderers$common$debug=!0;},stopDebugger$$module$build$src$core$renderers$common$debug=function stopDebugger$$module$build$src$core$renderers$common$debug(){warn$$module$build$src$core$utils$deprecation("Blockly.blockRendering.debug.stopDebugger()","version 8","version 10","the debug renderer in @blockly/dev-tools (See https://www.npmjs.com/package/@blockly/dev-tools.)");useDebugger$$module$build$src$core$renderers$common$debug=!1;},register$$module$build$src$core$renderers$common$block_rendering=function register$$module$build$src$core$renderers$common$block_rendering(a,b){register$$module$build$src$core$registry(Type$$module$build$src$core$registry.RENDERER,a,b);},unregister$$module$build$src$core$renderers$common$block_rendering=function unregister$$module$build$src$core$renderers$common$block_rendering(a){unregister$$module$build$src$core$registry(Type$$module$build$src$core$registry.RENDERER,a);},stopDebugger$$module$build$src$core$renderers$common$block_rendering=function stopDebugger$$module$build$src$core$renderers$common$block_rendering(){warn$$module$build$src$core$utils$deprecation("Blockly.blockRendering.stopDebugger()","September 2021","September 2022","the debug renderer in @blockly/dev-tools (See https://www.npmjs.com/package/@blockly/dev-tools.)");stopDebugger$$module$build$src$core$renderers$common$debug();},init$$module$build$src$core$renderers$common$block_rendering=function init$$module$build$src$core$renderers$common$block_rendering(a,b,c){a=new(getClass$$module$build$src$core$registry(Type$$module$build$src$core$registry.RENDERER,a))(a);a.init(b,c);return a;},stringButtonClickHandler$$module$build$src$core$variables_dynamic=function stringButtonClickHandler$$module$build$src$core$variables_dynamic(a){createVariableButtonHandler$$module$build$src$core$variables(a.getTargetWorkspace(),void 0,"String");},numberButtonClickHandler$$module$build$src$core$variables_dynamic=function numberButtonClickHandler$$module$build$src$core$variables_dynamic(a){createVariableButtonHandler$$module$build$src$core$variables(a.getTargetWorkspace(),void 0,"Number");},colourButtonClickHandler$$module$build$src$core$variables_dynamic=function colourButtonClickHandler$$module$build$src$core$variables_dynamic(a){createVariableButtonHandler$$module$build$src$core$variables(a.getTargetWorkspace(),void 0,"Colour");},flyoutCategory$$module$build$src$core$variables_dynamic=function flyoutCategory$$module$build$src$core$variables_dynamic(a){var b=[],c=document.createElement("button");c.setAttribute("text",Msg$$module$build$src$core$msg.NEW_STRING_VARIABLE);c.setAttribute("callbackKey","CREATE_VARIABLE_STRING");b.push(c);c=document.createElement("button");c.setAttribute("text",Msg$$module$build$src$core$msg.NEW_NUMBER_VARIABLE);c.setAttribute("callbackKey","CREATE_VARIABLE_NUMBER");b.push(c);c=document.createElement("button");c.setAttribute("text",Msg$$module$build$src$core$msg.NEW_COLOUR_VARIABLE);c.setAttribute("callbackKey","CREATE_VARIABLE_COLOUR");b.push(c);a.registerButtonCallback("CREATE_VARIABLE_STRING",stringButtonClickHandler$$module$build$src$core$variables_dynamic);a.registerButtonCallback("CREATE_VARIABLE_NUMBER",numberButtonClickHandler$$module$build$src$core$variables_dynamic);a.registerButtonCallback("CREATE_VARIABLE_COLOUR",colourButtonClickHandler$$module$build$src$core$variables_dynamic);a=flyoutCategoryBlocks$$module$build$src$core$variables_dynamic(a);return b=b.concat(a);},flyoutCategoryBlocks$$module$build$src$core$variables_dynamic=function flyoutCategoryBlocks$$module$build$src$core$variables_dynamic(a){a=a.getAllVariables();var b=[];if(0<a.length){if(Blocks$$module$build$src$core$blocks.variables_set_dynamic){var c=a[a.length-1];var d=createElement$$module$build$src$core$utils$xml("block");d.setAttribute("type","variables_set_dynamic");d.setAttribute("gap","24");d.appendChild(generateVariableFieldDom$$module$build$src$core$variables(c));b.push(d);}if(Blocks$$module$build$src$core$blocks.variables_get_dynamic){a.sort(VariableModel$$module$build$src$core$variable_model.compareByName);for(var _d2=0,e;e=a[_d2];_d2++){c=createElement$$module$build$src$core$utils$xml("block"),c.setAttribute("type","variables_get_dynamic"),c.setAttribute("gap","8"),c.appendChild(generateVariableFieldDom$$module$build$src$core$variables(e)),b.push(c);}}}return b;},resizeSvgContents$$module$build$src$core$workspace_svg=function resizeSvgContents$$module$build$src$core$workspace_svg(a){a.resizeContents();},save$$module$build$src$core$serialization$workspaces=function save$$module$build$src$core$serialization$workspaces(a){var b=Object.create(null),c=getAllItems$$module$build$src$core$registry(Type$$module$build$src$core$registry.SERIALIZER,!0);for(var d in c){var e=void 0;var f=null==(e=c[d])?void 0:e.save(a);f&&(b[d]=f);}return b;},load$$module$build$src$core$serialization$workspaces=function load$$module$build$src$core$serialization$workspaces(a,b){var _ref11=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{},_ref11$recordUndo=_ref11.recordUndo,c=_ref11$recordUndo===void 0?!1:_ref11$recordUndo;var d=getAllItems$$module$build$src$core$registry(Type$$module$build$src$core$registry.SERIALIZER,!0);if(d){d=Object.entries(d).sort(function(f,g){return g[1].priority-f[1].priority;});var e=getRecordUndo$$module$build$src$core$events$utils();setRecordUndo$$module$build$src$core$events$utils(c);(c=getGroup$$module$build$src$core$events$utils())||setGroup$$module$build$src$core$events$utils(!0);startTextWidthCache$$module$build$src$core$utils$dom();b instanceof WorkspaceSvg$$module$build$src$core$workspace_svg&&b.setResizesEnabled(!1);var _iterator2=_createForOfIteratorHelper(d.reverse()),_step2;try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var _step2$value=_slicedToArray(_step2.value,2),f=_step2$value[1];var g=void 0;null==(g=f)||g.clear(b);}}catch(err){_iterator2.e(err);}finally{_iterator2.f();}var _iterator3=_createForOfIteratorHelper(d.reverse()),_step3;try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var _step3$value=_slicedToArray(_step3.value,2),_f2=_step3$value[0],_g3=_step3$value[1];if(a[_f2]){var h=void 0;null==(h=_g3)||h.load(a[_f2],b);}}}catch(err){_iterator3.e(err);}finally{_iterator3.f();}b instanceof WorkspaceSvg$$module$build$src$core$workspace_svg&&b.setResizesEnabled(!0);stopTextWidthCache$$module$build$src$core$utils$dom();fire$$module$build$src$core$events$utils(new(get$$module$build$src$core$events$utils(FINISHED_LOADING$$module$build$src$core$events$utils))(b));setGroup$$module$build$src$core$events$utils(c);setRecordUndo$$module$build$src$core$events$utils(e);}},saveProcedure$$module$build$src$core$serialization$procedures=function saveProcedure$$module$build$src$core$serialization$procedures(a){var b={id:a.getId(),name:a.getName(),returnTypes:a.getReturnTypes()};if(!a.getParameters().length)return b;b.parameters=a.getParameters().map(function(c){return saveParameter$$module$build$src$core$serialization$procedures(c);});return b;},saveParameter$$module$build$src$core$serialization$procedures=function saveParameter$$module$build$src$core$serialization$procedures(a){var b={id:a.getId(),name:a.getName()};if(!a.getTypes().length)return b;b.types=a.getTypes();return b;},loadProcedure$$module$build$src$core$serialization$procedures=function loadProcedure$$module$build$src$core$serialization$procedures(a,b,c,d){a=new a(d,c.name,c.id).setReturnTypes(c.returnTypes);if(!c.parameters)return a;var _iterator4=_createForOfIteratorHelper(c.parameters.entries()),_step4;try{for(_iterator4.s();!(_step4=_iterator4.n()).done;){var _step4$value=_slicedToArray(_step4.value,2),e=_step4$value[0],f=_step4$value[1];a.insertParameter(loadParameter$$module$build$src$core$serialization$procedures(b,f,d),e);}}catch(err){_iterator4.e(err);}finally{_iterator4.f();}return a;},loadParameter$$module$build$src$core$serialization$procedures=function loadParameter$$module$build$src$core$serialization$procedures(a,b,c){return new a(c,b.name,b.id).setTypes(b.types||[]);},bumpObjectIntoBounds$$module$build$src$core$bump_objects=function bumpObjectIntoBounds$$module$build$src$core$bump_objects(a,b,c){var d=c.getBoundingRectangle(),e=d.right-d.left,f=clamp$$module$build$src$core$utils$math(b.top,d.top,b.top+b.height-(d.bottom-d.top))-d.top;var g=b.left;b=b.left+b.width-e;a.RTL?g=Math.min(b,g):b=Math.max(g,b);return(a=clamp$$module$build$src$core$utils$math(g,d.left,b)-d.left)||f?(c.moveBy(a,f),!0):!1;},bumpIntoBoundsHandler$$module$build$src$core$bump_objects=function bumpIntoBoundsHandler$$module$build$src$core$bump_objects(a){return function(b){var c=a.getMetricsManager();if(c.hasFixedEdges()&&!a.isDragging()){var d;if(-1!==BUMP_EVENTS$$module$build$src$core$events$utils.indexOf(null!=(d=b.type)?d:"")){d=c.getScrollMetrics(!0);var e=extractObjectFromEvent$$module$build$src$core$bump_objects(a,b);e&&(c=getGroup$$module$build$src$core$events$utils(),setGroup$$module$build$src$core$events$utils(b.group),bumpObjectIntoBounds$$module$build$src$core$bump_objects(a,d,e)&&!b.group&&console.warn("Moved object in bounds but there was no event group. This may break undo."),null!==c&&setGroup$$module$build$src$core$events$utils(c));}else b.type===VIEWPORT_CHANGE$$module$build$src$core$events$utils&&b.scale&&b.oldScale&&b.scale>b.oldScale&&bumpTopObjectsIntoBounds$$module$build$src$core$bump_objects(a);}};},extractObjectFromEvent$$module$build$src$core$bump_objects=function extractObjectFromEvent$$module$build$src$core$bump_objects(a,b){var c=null;switch(b.type){case CREATE$$module$build$src$core$events$utils:case MOVE$$module$build$src$core$events$utils:(c=a.getBlockById(b.blockId))&&(c=c.getRootBlock());break;case COMMENT_CREATE$$module$build$src$core$events$utils:case COMMENT_MOVE$$module$build$src$core$events$utils:c=a.getCommentById(b.commentId);}return c;},bumpTopObjectsIntoBounds$$module$build$src$core$bump_objects=function bumpTopObjectsIntoBounds$$module$build$src$core$bump_objects(a){var b=a.getMetricsManager();if(b.hasFixedEdges()&&!a.isDragging()){b=b.getScrollMetrics(!0);var c=a.getTopBoundedElements();for(var d=0,e;e=c[d];d++){bumpObjectIntoBounds$$module$build$src$core$bump_objects(a,b,e);}}},inject$$module$build$src$core$inject=function inject$$module$build$src$core$inject(a,b){"string"===typeof a&&(a=document.getElementById(a)||document.querySelector(a));if(!a||!containsNode$$module$build$src$core$utils$dom(document,a))throw Error("Error: container is not in current document.");b=new Options$$module$build$src$core$options(b||{});var c=document.createElement("div");c.className="injectionDiv";c.tabIndex=0;setState$$module$build$src$core$utils$aria(c,State$$module$build$src$core$utils$aria.LABEL,Msg$$module$build$src$core$msg.WORKSPACE_ARIA_LABEL);a.appendChild(c);a=createDom$$module$build$src$core$inject(c,b);var d=new BlockDragSurfaceSvg$$module$build$src$core$block_drag_surface(c),e=new WorkspaceDragSurfaceSvg$$module$build$src$core$workspace_drag_surface_svg(c),f=createMainWorkspace$$module$build$src$core$inject(a,b,d,e);init$$module$build$src$core$inject(f);setMainWorkspace$$module$build$src$core$common(f);svgResize$$module$build$src$core$common(f);c.addEventListener("focusin",function(){setMainWorkspace$$module$build$src$core$common(f);});return f;},createDom$$module$build$src$core$inject=function createDom$$module$build$src$core$inject(a,b){a.setAttribute("dir","LTR");inject$$module$build$src$core$css(b.hasCss,b.pathToMedia);a=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.SVG,{xmlns:SVG_NS$$module$build$src$core$utils$dom,"xmlns:html":HTML_NS$$module$build$src$core$utils$dom,"xmlns:xlink":XLINK_NS$$module$build$src$core$utils$dom,version:"1.1","class":"blocklySvg",tabindex:"0"},a);var c=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.DEFS,{},a),d=String(Math.random()).substring(2);b.gridPattern=Grid$$module$build$src$core$grid.createDom(d,b.gridOptions,c);return a;},createMainWorkspace$$module$build$src$core$inject=function createMainWorkspace$$module$build$src$core$inject(a,b,c,d){b.parentWorkspace=null;b=new WorkspaceSvg$$module$build$src$core$workspace_svg(b,c,d);c=b.options;b.scale=c.zoomOptions.startScale;a.appendChild(b.createDom("blocklyMainBackground"));d=b.getInjectionDiv();var e=b.getRenderer().getClassName();e&&addClass$$module$build$src$core$utils$dom(d,e);(e=b.getTheme().getClassName())&&addClass$$module$build$src$core$utils$dom(d,e);!c.hasCategories&&c.languageTree&&(d=b.addFlyout(Svg$$module$build$src$core$utils$svg.SVG),insertAfter$$module$build$src$core$utils$dom(d,a));c.hasTrashcan&&b.addTrashcan();c.zoomOptions&&c.zoomOptions.controls&&b.addZoomControls();b.getThemeManager().subscribe(a,"workspaceBackgroundColour","background-color");b.translate(0,0);b.addChangeListener(bumpIntoBoundsHandler$$module$build$src$core$bump_objects(b));svgResize$$module$build$src$core$common(b);createDom$$module$build$src$core$widgetdiv();createDom$$module$build$src$core$dropdowndiv();createDom$$module$build$src$core$tooltip();return b;},init$$module$build$src$core$inject=function init$$module$build$src$core$inject(a){var b=a.options;var c=a.getParentSvg();conditionalBind$$module$build$src$core$browser_events(c.parentNode,"contextmenu",null,function(d){isTargetInput$$module$build$src$core$browser_events(d)||d.preventDefault();});c=conditionalBind$$module$build$src$core$browser_events(window,"resize",null,function(){a.hideChaff(!0);svgResize$$module$build$src$core$common(a);bumpTopObjectsIntoBounds$$module$build$src$core$bump_objects(a);});a.setResizeHandlerWrapper(c);bindDocumentEvents$$module$build$src$core$inject();if(b.languageTree){c=a.getToolbox();var d=a.getFlyout(!0);c?c.init():d&&(d.init(a),d.show(b.languageTree),"function"===typeof d.scrollToStart&&d.scrollToStart());}b.hasTrashcan&&a.trashcan.init();b.zoomOptions&&b.zoomOptions.controls&&a.zoomControls_.init();b.moveOptions&&b.moveOptions.scrollbars?(a.scrollbar=new ScrollbarPair$$module$build$src$core$scrollbar_pair(a,!0===b.moveOptions.scrollbars||!!b.moveOptions.scrollbars.horizontal,!0===b.moveOptions.scrollbars||!!b.moveOptions.scrollbars.vertical,"blocklyMainWorkspaceScrollbar"),a.scrollbar.resize()):a.setMetrics({x:.5,y:.5});b.hasSounds&&loadSounds$$module$build$src$core$inject(b.pathToMedia,a);},onKeyDown$$module$build$src$core$inject=function onKeyDown$$module$build$src$core$inject(a){var b=getMainWorkspace$$module$build$src$core$common();if(b&&!(isTargetInput$$module$build$src$core$browser_events(a)||b.rendered&&!b.isVisible()))_ShortcutRegistry$$module$build$src$core$shortcut_registry.registry.onKeyDown(b,a);},bindDocumentEvents$$module$build$src$core$inject=function bindDocumentEvents$$module$build$src$core$inject(){documentEventsBound$$module$build$src$core$inject||(conditionalBind$$module$build$src$core$browser_events(document,"scroll",null,function(){var a=getAllWorkspaces$$module$build$src$core$common();for(var b=0,c;c=a[b];b++){c instanceof WorkspaceSvg$$module$build$src$core$workspace_svg&&c.updateInverseScreenCTM();}}),conditionalBind$$module$build$src$core$browser_events(document,"keydown",null,onKeyDown$$module$build$src$core$inject),bind$$module$build$src$core$browser_events(document,"touchend",null,longStop$$module$build$src$core$touch),bind$$module$build$src$core$browser_events(document,"touchcancel",null,longStop$$module$build$src$core$touch),IPAD$$module$build$src$core$utils$useragent&&conditionalBind$$module$build$src$core$browser_events(window,"orientationchange",document,function(){svgResize$$module$build$src$core$common(getMainWorkspace$$module$build$src$core$common());}));documentEventsBound$$module$build$src$core$inject=!0;},loadSounds$$module$build$src$core$inject=function loadSounds$$module$build$src$core$inject(a,b){function c(){for(;e.length;){unbind$$module$build$src$core$browser_events(e.pop());}d.preload();}var d=b.getAudioManager();d.load([a+"click.mp3",a+"click.wav",a+"click.ogg"],"click");d.load([a+"disconnect.wav",a+"disconnect.mp3",a+"disconnect.ogg"],"disconnect");d.load([a+"delete.mp3",a+"delete.ogg",a+"delete.wav"],"delete");var e=[];e.push(conditionalBind$$module$build$src$core$browser_events(document,"mousemove",null,c,!0));e.push(conditionalBind$$module$build$src$core$browser_events(document,"touchstart",null,c,!0));},registerUndo$$module$build$src$core$contextmenu_items=function registerUndo$$module$build$src$core$contextmenu_items(){ContextMenuRegistry$$module$build$src$core$contextmenu_registry.registry.register({displayText:function displayText(){return Msg$$module$build$src$core$msg.UNDO;},preconditionFn:function preconditionFn(a){return 0<a.workspace.getUndoStack().length?"enabled":"disabled";},callback:function callback(a){a.workspace.undo(!1);},scopeType:ContextMenuRegistry$$module$build$src$core$contextmenu_registry.ScopeType.WORKSPACE,id:"undoWorkspace",weight:1});},registerRedo$$module$build$src$core$contextmenu_items=function registerRedo$$module$build$src$core$contextmenu_items(){ContextMenuRegistry$$module$build$src$core$contextmenu_registry.registry.register({displayText:function displayText(){return Msg$$module$build$src$core$msg.REDO;},preconditionFn:function preconditionFn(a){return 0<a.workspace.getRedoStack().length?"enabled":"disabled";},callback:function callback(a){a.workspace.undo(!0);},scopeType:ContextMenuRegistry$$module$build$src$core$contextmenu_registry.ScopeType.WORKSPACE,id:"redoWorkspace",weight:2});},registerCleanup$$module$build$src$core$contextmenu_items=function registerCleanup$$module$build$src$core$contextmenu_items(){ContextMenuRegistry$$module$build$src$core$contextmenu_registry.registry.register({displayText:function displayText(){return Msg$$module$build$src$core$msg.CLEAN_UP;},preconditionFn:function preconditionFn(a){return a.workspace.isMovable()?1<a.workspace.getTopBlocks(!1).length?"enabled":"disabled":"hidden";},callback:function callback(a){a.workspace.cleanUp();},scopeType:ContextMenuRegistry$$module$build$src$core$contextmenu_registry.ScopeType.WORKSPACE,id:"cleanWorkspace",weight:3});},toggleOption_$$module$build$src$core$contextmenu_items=function toggleOption_$$module$build$src$core$contextmenu_items(a,b){function c(f){e--;f.setCollapsed(a);0===e&&setGroup$$module$build$src$core$events$utils(!1);}var d=0,e=0;setGroup$$module$build$src$core$events$utils(!0);for(var f=0;f<b.length;f++){var g=b[f];for(;g;){e++,setTimeout(c.bind(null,g),d),g=g.getNextBlock(),d+=10;}}},registerCollapse$$module$build$src$core$contextmenu_items=function registerCollapse$$module$build$src$core$contextmenu_items(){ContextMenuRegistry$$module$build$src$core$contextmenu_registry.registry.register({displayText:function displayText(){return Msg$$module$build$src$core$msg.COLLAPSE_ALL;},preconditionFn:function preconditionFn(a){if(a.workspace.options.collapse){a=a.workspace.getTopBlocks(!1);for(var b=0;b<a.length;b++){var c=a[b];for(;c;){if(!c.isCollapsed())return"enabled";c=c.getNextBlock();}}return"disabled";}return"hidden";},callback:function callback(a){toggleOption_$$module$build$src$core$contextmenu_items(!0,a.workspace.getTopBlocks(!0));},scopeType:ContextMenuRegistry$$module$build$src$core$contextmenu_registry.ScopeType.WORKSPACE,id:"collapseWorkspace",weight:4});},registerExpand$$module$build$src$core$contextmenu_items=function registerExpand$$module$build$src$core$contextmenu_items(){ContextMenuRegistry$$module$build$src$core$contextmenu_registry.registry.register({displayText:function displayText(){return Msg$$module$build$src$core$msg.EXPAND_ALL;},preconditionFn:function preconditionFn(a){if(a.workspace.options.collapse){a=a.workspace.getTopBlocks(!1);for(var b=0;b<a.length;b++){var c=a[b];for(;c;){if(c.isCollapsed())return"enabled";c=c.getNextBlock();}}return"disabled";}return"hidden";},callback:function callback(a){toggleOption_$$module$build$src$core$contextmenu_items(!1,a.workspace.getTopBlocks(!0));},scopeType:ContextMenuRegistry$$module$build$src$core$contextmenu_registry.ScopeType.WORKSPACE,id:"expandWorkspace",weight:5});},addDeletableBlocks_$$module$build$src$core$contextmenu_items=function addDeletableBlocks_$$module$build$src$core$contextmenu_items(a,b){if(a.isDeletable())Array.prototype.push.apply(b,a.getDescendants(!1));else{a=a.getChildren(!1);for(var c=0;c<a.length;c++){addDeletableBlocks_$$module$build$src$core$contextmenu_items(a[c],b);}}},getDeletableBlocks_$$module$build$src$core$contextmenu_items=function getDeletableBlocks_$$module$build$src$core$contextmenu_items(a){var b=[];a=a.getTopBlocks(!0);for(var c=0;c<a.length;c++){addDeletableBlocks_$$module$build$src$core$contextmenu_items(a[c],b);}return b;},deleteNext_$$module$build$src$core$contextmenu_items=function deleteNext_$$module$build$src$core$contextmenu_items(a,b){setGroup$$module$build$src$core$events$utils(b);var c=a.shift();c&&(c.isDeadOrDying()?deleteNext_$$module$build$src$core$contextmenu_items(a,b):(c.dispose(!1,!0),setTimeout(deleteNext_$$module$build$src$core$contextmenu_items,10,a,b)));setGroup$$module$build$src$core$events$utils(!1);},registerDeleteAll$$module$build$src$core$contextmenu_items=function registerDeleteAll$$module$build$src$core$contextmenu_items(){ContextMenuRegistry$$module$build$src$core$contextmenu_registry.registry.register({displayText:function displayText(a){if(!a.workspace)return"";a=getDeletableBlocks_$$module$build$src$core$contextmenu_items(a.workspace).length;return 1===a?Msg$$module$build$src$core$msg.DELETE_BLOCK:Msg$$module$build$src$core$msg.DELETE_X_BLOCKS.replace("%1",String(a));},preconditionFn:function preconditionFn(a){return a.workspace?0<getDeletableBlocks_$$module$build$src$core$contextmenu_items(a.workspace).length?"enabled":"disabled":"disabled";},callback:function callback(a){if(a.workspace){a.workspace.cancelCurrentGesture();var b=getDeletableBlocks_$$module$build$src$core$contextmenu_items(a.workspace),c=genUid$$module$build$src$core$utils$idgenerator();2>b.length?deleteNext_$$module$build$src$core$contextmenu_items(b,c):confirm$$module$build$src$core$dialog(Msg$$module$build$src$core$msg.DELETE_ALL_BLOCKS.replace("%1",String(b.length)),function(d){d&&deleteNext_$$module$build$src$core$contextmenu_items(b,c);});}},scopeType:ContextMenuRegistry$$module$build$src$core$contextmenu_registry.ScopeType.WORKSPACE,id:"workspaceDelete",weight:6});},registerWorkspaceOptions_$$module$build$src$core$contextmenu_items=function registerWorkspaceOptions_$$module$build$src$core$contextmenu_items(){registerUndo$$module$build$src$core$contextmenu_items();registerRedo$$module$build$src$core$contextmenu_items();registerCleanup$$module$build$src$core$contextmenu_items();registerCollapse$$module$build$src$core$contextmenu_items();registerExpand$$module$build$src$core$contextmenu_items();registerDeleteAll$$module$build$src$core$contextmenu_items();},registerDuplicate$$module$build$src$core$contextmenu_items=function registerDuplicate$$module$build$src$core$contextmenu_items(){ContextMenuRegistry$$module$build$src$core$contextmenu_registry.registry.register({displayText:function displayText(){return Msg$$module$build$src$core$msg.DUPLICATE_BLOCK;},preconditionFn:function preconditionFn(a){a=a.block;return!a.isInFlyout&&a.isDeletable()&&a.isMovable()?a.isDuplicatable()?"enabled":"disabled":"hidden";},callback:function callback(a){a.block&&duplicate$$module$build$src$core$clipboard(a.block);},scopeType:ContextMenuRegistry$$module$build$src$core$contextmenu_registry.ScopeType.BLOCK,id:"blockDuplicate",weight:1});},registerComment$$module$build$src$core$contextmenu_items=function registerComment$$module$build$src$core$contextmenu_items(){ContextMenuRegistry$$module$build$src$core$contextmenu_registry.registry.register({displayText:function displayText(a){return a.block.getCommentIcon()?Msg$$module$build$src$core$msg.REMOVE_COMMENT:Msg$$module$build$src$core$msg.ADD_COMMENT;},preconditionFn:function preconditionFn(a){a=a.block;return!a.isInFlyout&&a.workspace.options.comments&&!a.isCollapsed()&&a.isEditable()?"enabled":"hidden";},callback:function callback(a){a=a.block;a.getCommentIcon()?a.setCommentText(null):a.setCommentText("");},scopeType:ContextMenuRegistry$$module$build$src$core$contextmenu_registry.ScopeType.BLOCK,id:"blockComment",weight:2});},registerInline$$module$build$src$core$contextmenu_items=function registerInline$$module$build$src$core$contextmenu_items(){ContextMenuRegistry$$module$build$src$core$contextmenu_registry.registry.register({displayText:function displayText(a){return a.block.getInputsInline()?Msg$$module$build$src$core$msg.EXTERNAL_INPUTS:Msg$$module$build$src$core$msg.INLINE_INPUTS;},preconditionFn:function preconditionFn(a){a=a.block;if(!a.isInFlyout&&a.isMovable()&&!a.isCollapsed())for(var b=1;b<a.inputList.length;b++){if(a.inputList[b-1].type!==inputTypes$$module$build$src$core$input_types.STATEMENT&&a.inputList[b].type!==inputTypes$$module$build$src$core$input_types.STATEMENT)return"enabled";}return"hidden";},callback:function callback(a){a.block.setInputsInline(!a.block.getInputsInline());},scopeType:ContextMenuRegistry$$module$build$src$core$contextmenu_registry.ScopeType.BLOCK,id:"blockInline",weight:3});},registerCollapseExpandBlock$$module$build$src$core$contextmenu_items=function registerCollapseExpandBlock$$module$build$src$core$contextmenu_items(){ContextMenuRegistry$$module$build$src$core$contextmenu_registry.registry.register({displayText:function displayText(a){return a.block.isCollapsed()?Msg$$module$build$src$core$msg.EXPAND_BLOCK:Msg$$module$build$src$core$msg.COLLAPSE_BLOCK;},preconditionFn:function preconditionFn(a){a=a.block;return!a.isInFlyout&&a.isMovable()&&a.workspace.options.collapse?"enabled":"hidden";},callback:function callback(a){a.block.setCollapsed(!a.block.isCollapsed());},scopeType:ContextMenuRegistry$$module$build$src$core$contextmenu_registry.ScopeType.BLOCK,id:"blockCollapseExpand",weight:4});},registerDisable$$module$build$src$core$contextmenu_items=function registerDisable$$module$build$src$core$contextmenu_items(){ContextMenuRegistry$$module$build$src$core$contextmenu_registry.registry.register({displayText:function displayText(a){return a.block.isEnabled()?Msg$$module$build$src$core$msg.DISABLE_BLOCK:Msg$$module$build$src$core$msg.ENABLE_BLOCK;},preconditionFn:function preconditionFn(a){a=a.block;return!a.isInFlyout&&a.workspace.options.disable&&a.isEditable()?a.getInheritedDisabled()?"disabled":"enabled":"hidden";},callback:function callback(a){a=a.block;var b=getGroup$$module$build$src$core$events$utils();b||setGroup$$module$build$src$core$events$utils(!0);a.setEnabled(!a.isEnabled());b||setGroup$$module$build$src$core$events$utils(!1);},scopeType:ContextMenuRegistry$$module$build$src$core$contextmenu_registry.ScopeType.BLOCK,id:"blockDisable",weight:5});},registerDelete$$module$build$src$core$contextmenu_items=function registerDelete$$module$build$src$core$contextmenu_items(){ContextMenuRegistry$$module$build$src$core$contextmenu_registry.registry.register({displayText:function displayText(a){var b=a.block;a=b.getDescendants(!1).length;(b=b.getNextBlock())&&(a-=b.getDescendants(!1).length);return 1===a?Msg$$module$build$src$core$msg.DELETE_BLOCK:Msg$$module$build$src$core$msg.DELETE_X_BLOCKS.replace("%1",String(a));},preconditionFn:function preconditionFn(a){return!a.block.isInFlyout&&a.block.isDeletable()?"enabled":"hidden";},callback:function callback(a){a.block&&a.block.checkAndDelete();},scopeType:ContextMenuRegistry$$module$build$src$core$contextmenu_registry.ScopeType.BLOCK,id:"blockDelete",weight:6});},registerHelp$$module$build$src$core$contextmenu_items=function registerHelp$$module$build$src$core$contextmenu_items(){ContextMenuRegistry$$module$build$src$core$contextmenu_registry.registry.register({displayText:function displayText(){return Msg$$module$build$src$core$msg.HELP;},preconditionFn:function preconditionFn(a){a=a.block;return("function"===typeof a.helpUrl?a.helpUrl():a.helpUrl)?"enabled":"hidden";},callback:function callback(a){a.block.showHelp();},scopeType:ContextMenuRegistry$$module$build$src$core$contextmenu_registry.ScopeType.BLOCK,id:"blockHelp",weight:7});},registerBlockOptions_$$module$build$src$core$contextmenu_items=function registerBlockOptions_$$module$build$src$core$contextmenu_items(){registerDuplicate$$module$build$src$core$contextmenu_items();registerComment$$module$build$src$core$contextmenu_items();registerInline$$module$build$src$core$contextmenu_items();registerCollapseExpandBlock$$module$build$src$core$contextmenu_items();registerDisable$$module$build$src$core$contextmenu_items();registerDelete$$module$build$src$core$contextmenu_items();registerHelp$$module$build$src$core$contextmenu_items();},registerDefaultOptions$$module$build$src$core$contextmenu_items=function registerDefaultOptions$$module$build$src$core$contextmenu_items(){registerWorkspaceOptions_$$module$build$src$core$contextmenu_items();registerBlockOptions_$$module$build$src$core$contextmenu_items();},initIconData$$module$build$src$core$block_dragger=function initIconData$$module$build$src$core$block_dragger(a){var b=[];a=a.getDescendants(!1);for(var c=0,d;d=a[c];c++){var e=d.getIcons();for(var f=0;f<e.length;f++){var g={location:e[f].getIconLocation(),icon:e[f]};b.push(g);}}return b;},hideChaff$$module$build$src$core$blockly=function hideChaff$$module$build$src$core$blockly(a){getMainWorkspace$$module$build$src$core$common().hideChaff(a);},resizeSvgContentsLocal$$module$build$src$core$blockly=function resizeSvgContentsLocal$$module$build$src$core$blockly(a){warn$$module$build$src$core$utils$deprecation("Blockly.resizeSvgContents","December 2021","December 2022","Blockly.WorkspaceSvg.resizeSvgContents");resizeSvgContents$$module$build$src$core$workspace_svg(a);},copy$$module$build$src$core$blockly=function copy$$module$build$src$core$blockly(a){warn$$module$build$src$core$utils$deprecation("Blockly.copy","December 2021","December 2022","Blockly.clipboard.copy");copy$$module$build$src$core$clipboard(a);},paste$$module$build$src$core$blockly=function paste$$module$build$src$core$blockly(){warn$$module$build$src$core$utils$deprecation("Blockly.paste","December 2021","December 2022","Blockly.clipboard.paste");return!!paste$$module$build$src$core$clipboard();},duplicate$$module$build$src$core$blockly=function duplicate$$module$build$src$core$blockly(a){warn$$module$build$src$core$utils$deprecation("Blockly.duplicate","December 2021","December 2022","Blockly.clipboard.duplicate");duplicate$$module$build$src$core$clipboard(a);},isNumber$$module$build$src$core$blockly=function isNumber$$module$build$src$core$blockly(a){warn$$module$build$src$core$utils$deprecation("Blockly.isNumber","December 2021","December 2022","Blockly.utils.string.isNumber");return isNumber$$module$build$src$core$utils$string(a);},hueToHex$$module$build$src$core$blockly=function hueToHex$$module$build$src$core$blockly(a){warn$$module$build$src$core$utils$deprecation("Blockly.hueToHex","December 2021","December 2022","Blockly.utils.colour.hueToHex");return hueToHex$$module$build$src$core$utils$colour(a);},bindEvent_$$module$build$src$core$blockly=function bindEvent_$$module$build$src$core$blockly(a,b,c,d){warn$$module$build$src$core$utils$deprecation("Blockly.bindEvent_","December 2021","December 2022","Blockly.browserEvents.bind");return bind$$module$build$src$core$browser_events(a,b,c,d);},unbindEvent_$$module$build$src$core$blockly=function unbindEvent_$$module$build$src$core$blockly(a){warn$$module$build$src$core$utils$deprecation("Blockly.unbindEvent_","December 2021","December 2022","Blockly.browserEvents.unbind");return unbind$$module$build$src$core$browser_events(a);},bindEventWithChecks_$$module$build$src$core$blockly=function bindEventWithChecks_$$module$build$src$core$blockly(a,b,c,d,e,f){warn$$module$build$src$core$utils$deprecation("Blockly.bindEventWithChecks_","December 2021","December 2022","Blockly.browserEvents.conditionalBind");return conditionalBind$$module$build$src$core$browser_events(a,b,c,d,e,f);},$jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){if(a==Array.prototype||a==Object.prototype)return a;a[b]=c.value;return a;};$jscomp.getGlobal=function(a){a=["object"==(typeof globalThis==="undefined"?"undefined":_typeof(globalThis))&&globalThis,a,"object"==(typeof window==="undefined"?"undefined":_typeof(window))&&window,"object"==(typeof self==="undefined"?"undefined":_typeof(self))&&self,"object"==(typeof __webpack_require__.g==="undefined"?"undefined":_typeof(__webpack_require__.g))&&__webpack_require__.g];for(var b=0;b<a.length;++b){var c=a[b];if(c&&c.Math==Math)return c;}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===_typeof(Symbol("x"));$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function $jscomp$lookupPolyfilledValue(a,b){var c=$jscomp.propertyToPolyfillSymbol[b];if(null==c)return a[b];c=a[c];return void 0!==c?c:a[b];};$jscomp.polyfill=function(a,b,c,d){b&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(a,b,c,d):$jscomp.polyfillUnisolated(a,b,c,d));};$jscomp.polyfillUnisolated=function(a,b,c,d){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];if(!(e in c))return;c=c[e];}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b});};$jscomp.polyfillIsolated=function(a,b,c,d){var e=a.split(".");a=1===e.length;d=e[0];d=!a&&d in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var f=0;f<e.length-1;f++){var g=e[f];if(!(g in d))return;d=d[g];}e=e[e.length-1];c=$jscomp.IS_SYMBOL_NATIVE&&"es6"===c?d[e]:null;b=b(c);null!=b&&(a?$jscomp.defineProperty($jscomp.polyfills,e,{configurable:!0,writable:!0,value:b}):b!==c&&(void 0===$jscomp.propertyToPolyfillSymbol[e]&&(c=1E9*Math.random()>>>0,$jscomp.propertyToPolyfillSymbol[e]=$jscomp.IS_SYMBOL_NATIVE?$jscomp.global.Symbol(e):$jscomp.POLYFILL_PREFIX+c+"$"+e),$jscomp.defineProperty(d,$jscomp.propertyToPolyfillSymbol[e],{configurable:!0,writable:!0,value:b})));};$jscomp.polyfill("globalThis",function(a){return a||$jscomp.global;},"es_2020","es3");$jscomp.arrayIteratorImpl=function(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0};};};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)};};$jscomp.initSymbol=function(){};$jscomp.iteratorPrototype=function(a){a={next:a};a[Symbol.iterator]=function(){return this;};return a;};$jscomp.iteratorFromArray=function(a,b){a instanceof String&&(a+="");var c=0,d=!1,e={next:function next(){if(!d&&c<a.length){var f=c++;return{value:b(f,a[f]),done:!1};}d=!0;return{done:!0,value:void 0};}};e[Symbol.iterator]=function(){return e;};return e;};$jscomp.polyfill("Array.prototype.values",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(b,c){return c;});};},"es8","es3");$jscomp.owns=function(a,b){return Object.prototype.hasOwnProperty.call(a,b);};$jscomp.polyfill("Object.values",function(a){return a?a:function(b){var c=[],d;for(d in b){$jscomp.owns(b,d)&&c.push(b[d]);}return c;};},"es8","es3");$jscomp.polyfill("Array.prototype.flat",function(a){return a?a:function(b){b=void 0===b?1:b;for(var c=[],d=0;d<this.length;d++){var e=this[d];Array.isArray(e)&&0<b?(e=Array.prototype.flat.call(e,b-1),c.push.apply(c,e)):c.push(e);}return c;};},"es9","es5");$jscomp.polyfill("Object.entries",function(a){return a?a:function(b){var c=[],d;for(d in b){$jscomp.owns(b,d)&&c.push([d,b[d]]);}return c;};},"es8","es3");var global$$module$build$src$closure$goog$goog=globalThis,declareModuleId$$module$build$src$closure$goog$goog=function declareModuleId$$module$build$src$closure$goog$goog(a){window.goog&&window.goog.declareModuleId&&window.goog.declareModuleId.call(this,a);},module$build$src$closure$goog$goog={};module$build$src$closure$goog$goog.declareModuleId=declareModuleId$$module$build$src$closure$goog$goog;module$build$src$closure$goog$goog.global=global$$module$build$src$closure$goog$goog;/*

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var COMPILED=!0,goog=goog||{};goog.global=globalThis||root;goog.define=function(a,b){return b;};goog.DEBUG=!1;goog.DISALLOW_TEST_ONLY_CODE=COMPILED&&!goog.DEBUG;goog.provide=function(a){};goog.module=function(a){};goog.module.get=function(a){};goog.module.declareLegacyNamespace=function(){};goog.setTestOnly=function(a){if(goog.DISALLOW_TEST_ONLY_CODE)throw a=a||"",Error("Importing test-only code into non-debug environment"+(a?": "+a:"."));};goog.require=function(a){};goog.requireType=function(a){};var LONGPRESS$$module$build$src$core$touch=750,TOUCH_ENABLED$$module$build$src$core$touch="ontouchstart"in globalThis||!!(globalThis.document&&document.documentElement&&"ontouchstart"in document.documentElement)||!(!globalThis.navigator||!globalThis.navigator.maxTouchPoints&&!globalThis.navigator.msMaxTouchPoints),touchIdentifier_$$module$build$src$core$touch=null,TOUCH_MAP$$module$build$src$core$touch=globalThis.PointerEvent?{mousedown:["pointerdown"],mouseenter:["pointerenter"],mouseleave:["pointerleave"],mousemove:["pointermove"],mouseout:["pointerout"],mouseover:["pointerover"],mouseup:["pointerup","pointercancel"],touchend:["pointerup"],touchcancel:["pointercancel"]}:{mousedown:["touchstart"],mousemove:["touchmove"],mouseup:["touchend","touchcancel"]},longPid_$$module$build$src$core$touch=0,module$build$src$core$touch={};module$build$src$core$touch.TOUCH_ENABLED=TOUCH_ENABLED$$module$build$src$core$touch;module$build$src$core$touch.TOUCH_MAP=TOUCH_MAP$$module$build$src$core$touch;module$build$src$core$touch.checkTouchIdentifier=checkTouchIdentifier$$module$build$src$core$touch;module$build$src$core$touch.clearTouchIdentifier=clearTouchIdentifier$$module$build$src$core$touch;module$build$src$core$touch.getTouchIdentifierFromEvent=getTouchIdentifierFromEvent$$module$build$src$core$touch;module$build$src$core$touch.isMouseOrTouchEvent=isMouseOrTouchEvent$$module$build$src$core$touch;module$build$src$core$touch.isTouchEvent=isTouchEvent$$module$build$src$core$touch;module$build$src$core$touch.longStart=longStart$$module$build$src$core$touch;module$build$src$core$touch.longStop=longStop$$module$build$src$core$touch;module$build$src$core$touch.setClientFromTouch=setClientFromTouch$$module$build$src$core$touch;module$build$src$core$touch.shouldHandleEvent=shouldHandleEvent$$module$build$src$core$touch;module$build$src$core$touch.splitEventByTouches=splitEventByTouches$$module$build$src$core$touch;var rawUserAgent$$module$build$src$core$utils$useragent,isJavaFx$$module$build$src$core$utils$useragent,isWebKit$$module$build$src$core$utils$useragent,isGecko$$module$build$src$core$utils$useragent,isAndroid$$module$build$src$core$utils$useragent,isIPad$$module$build$src$core$utils$useragent,isIPhone$$module$build$src$core$utils$useragent,isMac$$module$build$src$core$utils$useragent,isTablet$$module$build$src$core$utils$useragent,isMobile$$module$build$src$core$utils$useragent;(function(a){function b(d){return-1!==c.indexOf(d.toUpperCase());}rawUserAgent$$module$build$src$core$utils$useragent=a;var c=rawUserAgent$$module$build$src$core$utils$useragent.toUpperCase();isJavaFx$$module$build$src$core$utils$useragent=b("JavaFX");isWebKit$$module$build$src$core$utils$useragent=b("WebKit");isGecko$$module$build$src$core$utils$useragent=b("Gecko")&&!isWebKit$$module$build$src$core$utils$useragent;isAndroid$$module$build$src$core$utils$useragent=b("Android");a=globalThis.navigator&&globalThis.navigator.maxTouchPoints;isIPad$$module$build$src$core$utils$useragent=b("iPad")||b("Macintosh")&&0<a;isIPhone$$module$build$src$core$utils$useragent=b("iPhone")&&!isIPad$$module$build$src$core$utils$useragent;isMac$$module$build$src$core$utils$useragent=b("Macintosh");isTablet$$module$build$src$core$utils$useragent=isIPad$$module$build$src$core$utils$useragent||isAndroid$$module$build$src$core$utils$useragent&&!b("Mobile")||b("Silk");isMobile$$module$build$src$core$utils$useragent=!isTablet$$module$build$src$core$utils$useragent&&(isIPhone$$module$build$src$core$utils$useragent||isAndroid$$module$build$src$core$utils$useragent);})(globalThis.navigator&&globalThis.navigator.userAgent||"");var raw$$module$build$src$core$utils$useragent=rawUserAgent$$module$build$src$core$utils$useragent,JavaFx$$module$build$src$core$utils$useragent=isJavaFx$$module$build$src$core$utils$useragent,GECKO$$module$build$src$core$utils$useragent=isGecko$$module$build$src$core$utils$useragent,ANDROID$$module$build$src$core$utils$useragent=isAndroid$$module$build$src$core$utils$useragent,IPAD$$module$build$src$core$utils$useragent=isIPad$$module$build$src$core$utils$useragent,IPHONE$$module$build$src$core$utils$useragent=isIPhone$$module$build$src$core$utils$useragent,MAC$$module$build$src$core$utils$useragent=isMac$$module$build$src$core$utils$useragent,MOBILE$$module$build$src$core$utils$useragent=isMobile$$module$build$src$core$utils$useragent,module$build$src$core$utils$useragent={};module$build$src$core$utils$useragent.ANDROID=ANDROID$$module$build$src$core$utils$useragent;module$build$src$core$utils$useragent.GECKO=GECKO$$module$build$src$core$utils$useragent;module$build$src$core$utils$useragent.IPAD=IPAD$$module$build$src$core$utils$useragent;module$build$src$core$utils$useragent.IPHONE=IPHONE$$module$build$src$core$utils$useragent;module$build$src$core$utils$useragent.JavaFx=JavaFx$$module$build$src$core$utils$useragent;module$build$src$core$utils$useragent.MAC=MAC$$module$build$src$core$utils$useragent;module$build$src$core$utils$useragent.MOBILE=MOBILE$$module$build$src$core$utils$useragent;module$build$src$core$utils$useragent.raw=raw$$module$build$src$core$utils$useragent;var LINE_MODE_MULTIPLIER$$module$build$src$core$browser_events=40,PAGE_MODE_MULTIPLIER$$module$build$src$core$browser_events=125,module$build$src$core$browser_events={};module$build$src$core$browser_events.bind=bind$$module$build$src$core$browser_events;module$build$src$core$browser_events.conditionalBind=conditionalBind$$module$build$src$core$browser_events;module$build$src$core$browser_events.getScrollDeltaPixels=getScrollDeltaPixels$$module$build$src$core$browser_events;module$build$src$core$browser_events.isRightButton=isRightButton$$module$build$src$core$browser_events;module$build$src$core$browser_events.isTargetInput=isTargetInput$$module$build$src$core$browser_events;module$build$src$core$browser_events.mouseToSvg=mouseToSvg$$module$build$src$core$browser_events;module$build$src$core$browser_events.unbind=unbind$$module$build$src$core$browser_events;var Blocks$$module$build$src$core$blocks=Object.create(null),module$build$src$core$blocks={};module$build$src$core$blocks.Blocks=Blocks$$module$build$src$core$blocks;var WorkspaceDB_$$module$build$src$core$common,mainWorkspace$$module$build$src$core$common,selected$$module$build$src$core$common,parentContainer$$module$build$src$core$common,draggingConnections$$module$build$src$core$common,TEST_ONLY$$module$build$src$core$common;WorkspaceDB_$$module$build$src$core$common=Object.create(null);selected$$module$build$src$core$common=null;draggingConnections$$module$build$src$core$common=[];TEST_ONLY$$module$build$src$core$common={defineBlocksWithJsonArrayInternal:defineBlocksWithJsonArrayInternal$$module$build$src$core$common};$.module$build$src$core$common={};$.module$build$src$core$common.TEST_ONLY=TEST_ONLY$$module$build$src$core$common;$.module$build$src$core$common.createBlockDefinitionsFromJsonArray=createBlockDefinitionsFromJsonArray$$module$build$src$core$common;$.module$build$src$core$common.defineBlocks=defineBlocks$$module$build$src$core$common;$.module$build$src$core$common.defineBlocksWithJsonArray=defineBlocksWithJsonArray$$module$build$src$core$common;$.module$build$src$core$common.draggingConnections=draggingConnections$$module$build$src$core$common;$.module$build$src$core$common.getAllWorkspaces=getAllWorkspaces$$module$build$src$core$common;$.module$build$src$core$common.getBlockTypeCounts=getBlockTypeCounts$$module$build$src$core$common;$.module$build$src$core$common.getMainWorkspace=getMainWorkspace$$module$build$src$core$common;$.module$build$src$core$common.getParentContainer=getParentContainer$$module$build$src$core$common;$.module$build$src$core$common.getSelected=getSelected$$module$build$src$core$common;$.module$build$src$core$common.getWorkspaceById=getWorkspaceById$$module$build$src$core$common;$.module$build$src$core$common.registerWorkspace=registerWorkspace$$module$build$src$core$common;$.module$build$src$core$common.setMainWorkspace=setMainWorkspace$$module$build$src$core$common;$.module$build$src$core$common.setParentContainer=setParentContainer$$module$build$src$core$common;$.module$build$src$core$common.setSelected=setSelected$$module$build$src$core$common;$.module$build$src$core$common.svgResize=svgResize$$module$build$src$core$common;$.module$build$src$core$common.unregisterWorkpace=unregisterWorkpace$$module$build$src$core$common;var SVG_NS$$module$build$src$core$utils$dom="http://www.w3.org/2000/svg",HTML_NS$$module$build$src$core$utils$dom="http://www.w3.org/1999/xhtml",XLINK_NS$$module$build$src$core$utils$dom="http://www.w3.org/1999/xlink",NodeType$$module$build$src$core$utils$dom;(function(a){a[a.ELEMENT_NODE=1]="ELEMENT_NODE";a[a.TEXT_NODE=3]="TEXT_NODE";a[a.COMMENT_NODE=8]="COMMENT_NODE";a[a.DOCUMENT_POSITION_CONTAINED_BY=16]="DOCUMENT_POSITION_CONTAINED_BY";})(NodeType$$module$build$src$core$utils$dom||(NodeType$$module$build$src$core$utils$dom={}));var cacheWidths$$module$build$src$core$utils$dom=null,cacheReference$$module$build$src$core$utils$dom=0,canvasContext$$module$build$src$core$utils$dom=null,module$build$src$core$utils$dom={};module$build$src$core$utils$dom.HTML_NS=HTML_NS$$module$build$src$core$utils$dom;module$build$src$core$utils$dom.NodeType=NodeType$$module$build$src$core$utils$dom;module$build$src$core$utils$dom.SVG_NS=SVG_NS$$module$build$src$core$utils$dom;module$build$src$core$utils$dom.XLINK_NS=XLINK_NS$$module$build$src$core$utils$dom;module$build$src$core$utils$dom.addClass=addClass$$module$build$src$core$utils$dom;module$build$src$core$utils$dom.containsNode=containsNode$$module$build$src$core$utils$dom;module$build$src$core$utils$dom.createSvgElement=createSvgElement$$module$build$src$core$utils$dom;module$build$src$core$utils$dom.getFastTextWidth=getFastTextWidth$$module$build$src$core$utils$dom;module$build$src$core$utils$dom.getFastTextWidthWithSizeString=getFastTextWidthWithSizeString$$module$build$src$core$utils$dom;module$build$src$core$utils$dom.getTextWidth=getTextWidth$$module$build$src$core$utils$dom;module$build$src$core$utils$dom.hasClass=hasClass$$module$build$src$core$utils$dom;module$build$src$core$utils$dom.insertAfter=insertAfter$$module$build$src$core$utils$dom;module$build$src$core$utils$dom.measureFontMetrics=measureFontMetrics$$module$build$src$core$utils$dom;module$build$src$core$utils$dom.removeClass=removeClass$$module$build$src$core$utils$dom;module$build$src$core$utils$dom.removeClasses=removeClasses$$module$build$src$core$utils$dom;module$build$src$core$utils$dom.removeNode=removeNode$$module$build$src$core$utils$dom;module$build$src$core$utils$dom.setCssTransform=setCssTransform$$module$build$src$core$utils$dom;module$build$src$core$utils$dom.startTextWidthCache=startTextWidthCache$$module$build$src$core$utils$dom;module$build$src$core$utils$dom.stopTextWidthCache=stopTextWidthCache$$module$build$src$core$utils$dom;var module$build$src$core$utils$math={};module$build$src$core$utils$math.clamp=clamp$$module$build$src$core$utils$math;module$build$src$core$utils$math.toDegrees=toDegrees$$module$build$src$core$utils$math;module$build$src$core$utils$math.toRadians=toRadians$$module$build$src$core$utils$math;var Rect$$module$build$src$core$utils$rect=/*#__PURE__*/function(){function Rect$$module$build$src$core$utils$rect(a,b,c,d){_classCallCheck(this,Rect$$module$build$src$core$utils$rect);this.top=a;this.bottom=b;this.left=c;this.right=d;}_createClass(Rect$$module$build$src$core$utils$rect,[{key:"contains",value:function contains(a,b){return a>=this.left&&a<=this.right&&b>=this.top&&b<=this.bottom;}},{key:"intersects",value:function intersects(a){return!(this.left>a.right||this.right<a.left||this.top>a.bottom||this.bottom<a.top);}}]);return Rect$$module$build$src$core$utils$rect;}(),module$build$src$core$utils$rect={};module$build$src$core$utils$rect.Rect=Rect$$module$build$src$core$utils$rect;var module$build$src$core$utils$deprecation={};module$build$src$core$utils$deprecation.warn=warn$$module$build$src$core$utils$deprecation;var Coordinate$$module$build$src$core$utils$coordinate=/*#__PURE__*/function(){function Coordinate$$module$build$src$core$utils$coordinate(a,b){_classCallCheck(this,Coordinate$$module$build$src$core$utils$coordinate);this.x=a;this.y=b;}_createClass(Coordinate$$module$build$src$core$utils$coordinate,[{key:"clone",value:function clone(){return new Coordinate$$module$build$src$core$utils$coordinate(this.x,this.y);}},{key:"scale",value:function scale(a){this.x*=a;this.y*=a;return this;}},{key:"translate",value:function translate(a,b){this.x+=a;this.y+=b;return this;}}],[{key:"equals",value:function equals(a,b){return a===b?!0:a&&b?a.x===b.x&&a.y===b.y:!1;}},{key:"distance",value:function distance(a,b){var c=a.x-b.x;a=a.y-b.y;return Math.sqrt(c*c+a*a);}},{key:"magnitude",value:function magnitude(a){return Math.sqrt(a.x*a.x+a.y*a.y);}},{key:"difference",value:function difference(a,b){return new Coordinate$$module$build$src$core$utils$coordinate(a.x-b.x,a.y-b.y);}},{key:"sum",value:function sum(a,b){return new Coordinate$$module$build$src$core$utils$coordinate(a.x+b.x,a.y+b.y);}}]);return Coordinate$$module$build$src$core$utils$coordinate;}(),module$build$src$core$utils$coordinate={};module$build$src$core$utils$coordinate.Coordinate=Coordinate$$module$build$src$core$utils$coordinate;var Size$$module$build$src$core$utils$size=/*#__PURE__*/function(){function Size$$module$build$src$core$utils$size(a,b){_classCallCheck(this,Size$$module$build$src$core$utils$size);this.width=a;this.height=b;}_createClass(Size$$module$build$src$core$utils$size,null,[{key:"equals",value:function equals(a,b){return a===b?!0:a&&b?a.width===b.width&&a.height===b.height:!1;}}]);return Size$$module$build$src$core$utils$size;}(),module$build$src$core$utils$size={};module$build$src$core$utils$size.Size=Size$$module$build$src$core$utils$size;var TEST_ONLY$$module$build$src$core$utils$style={getSizeInternal:getSizeInternal$$module$build$src$core$utils$style},module$build$src$core$utils$style={};module$build$src$core$utils$style.TEST_ONLY=TEST_ONLY$$module$build$src$core$utils$style;module$build$src$core$utils$style.getBorderBox=getBorderBox$$module$build$src$core$utils$style;module$build$src$core$utils$style.getCascadedStyle=getCascadedStyle$$module$build$src$core$utils$style;module$build$src$core$utils$style.getComputedStyle=getComputedStyle$$module$build$src$core$utils$style;module$build$src$core$utils$style.getContainerOffsetToScrollInto=getContainerOffsetToScrollInto$$module$build$src$core$utils$style;module$build$src$core$utils$style.getPageOffset=getPageOffset$$module$build$src$core$utils$style;module$build$src$core$utils$style.getSize=getSize$$module$build$src$core$utils$style;module$build$src$core$utils$style.getViewportPageOffset=getViewportPageOffset$$module$build$src$core$utils$style;module$build$src$core$utils$style.scrollIntoContainerView=scrollIntoContainerView$$module$build$src$core$utils$style;var ARROW_SIZE$$module$build$src$core$dropdowndiv=16,BORDER_SIZE$$module$build$src$core$dropdowndiv=1,ARROW_HORIZONTAL_PADDING$$module$build$src$core$dropdowndiv=12,PADDING_Y$$module$build$src$core$dropdowndiv=16,ANIMATION_TIME$$module$build$src$core$dropdowndiv=.25,animateOutTimer$$module$build$src$core$dropdowndiv=null,onHide$$module$build$src$core$dropdowndiv=null,renderedClassName$$module$build$src$core$dropdowndiv="",themeClassName$$module$build$src$core$dropdowndiv="",div$$module$build$src$core$dropdowndiv,content$$module$build$src$core$dropdowndiv,arrow$$module$build$src$core$dropdowndiv,boundsElement$$module$build$src$core$dropdowndiv=null,owner$$module$build$src$core$dropdowndiv=null,positionToField$$module$build$src$core$dropdowndiv=null,internal$$module$build$src$core$dropdowndiv={getBoundsInfo:function getBoundsInfo(){var a=getPageOffset$$module$build$src$core$utils$style(boundsElement$$module$build$src$core$dropdowndiv),b=getSize$$module$build$src$core$utils$style(boundsElement$$module$build$src$core$dropdowndiv);return{left:a.x,right:a.x+b.width,top:a.y,bottom:a.y+b.height,width:b.width,height:b.height};},getPositionMetrics:function getPositionMetrics(a,b,c,d){var e=internal$$module$build$src$core$dropdowndiv.getBoundsInfo(),f=getSize$$module$build$src$core$utils$style(div$$module$build$src$core$dropdowndiv);return b+f.height<e.bottom?getPositionBelowMetrics$$module$build$src$core$dropdowndiv(a,b,e,f):d-f.height>e.top?getPositionAboveMetrics$$module$build$src$core$dropdowndiv(c,d,e,f):b+f.height<document.documentElement.clientHeight?getPositionBelowMetrics$$module$build$src$core$dropdowndiv(a,b,e,f):d-f.height>document.documentElement.clientTop?getPositionAboveMetrics$$module$build$src$core$dropdowndiv(c,d,e,f):getPositionTopOfPageMetrics$$module$build$src$core$dropdowndiv(a,e,f);}},TEST_ONLY$$module$build$src$core$dropdowndiv=internal$$module$build$src$core$dropdowndiv,module$build$src$core$dropdowndiv={};module$build$src$core$dropdowndiv.ANIMATION_TIME=ANIMATION_TIME$$module$build$src$core$dropdowndiv;module$build$src$core$dropdowndiv.ARROW_HORIZONTAL_PADDING=ARROW_HORIZONTAL_PADDING$$module$build$src$core$dropdowndiv;module$build$src$core$dropdowndiv.ARROW_SIZE=ARROW_SIZE$$module$build$src$core$dropdowndiv;module$build$src$core$dropdowndiv.BORDER_SIZE=BORDER_SIZE$$module$build$src$core$dropdowndiv;module$build$src$core$dropdowndiv.PADDING_Y=PADDING_Y$$module$build$src$core$dropdowndiv;module$build$src$core$dropdowndiv.TEST_ONLY=internal$$module$build$src$core$dropdowndiv;module$build$src$core$dropdowndiv.clearContent=clearContent$$module$build$src$core$dropdowndiv;module$build$src$core$dropdowndiv.createDom=createDom$$module$build$src$core$dropdowndiv;module$build$src$core$dropdowndiv.getContentDiv=getContentDiv$$module$build$src$core$dropdowndiv;module$build$src$core$dropdowndiv.getPositionX=getPositionX$$module$build$src$core$dropdowndiv;module$build$src$core$dropdowndiv.hide=hide$$module$build$src$core$dropdowndiv;module$build$src$core$dropdowndiv.hideIfOwner=hideIfOwner$$module$build$src$core$dropdowndiv;module$build$src$core$dropdowndiv.hideWithoutAnimation=hideWithoutAnimation$$module$build$src$core$dropdowndiv;module$build$src$core$dropdowndiv.isVisible=isVisible$$module$build$src$core$dropdowndiv;module$build$src$core$dropdowndiv.repositionForWindowResize=repositionForWindowResize$$module$build$src$core$dropdowndiv;module$build$src$core$dropdowndiv.setBoundsElement=setBoundsElement$$module$build$src$core$dropdowndiv;module$build$src$core$dropdowndiv.setColour=setColour$$module$build$src$core$dropdowndiv;module$build$src$core$dropdowndiv.show=show$$module$build$src$core$dropdowndiv;module$build$src$core$dropdowndiv.showPositionedByBlock=showPositionedByBlock$$module$build$src$core$dropdowndiv;module$build$src$core$dropdowndiv.showPositionedByField=showPositionedByField$$module$build$src$core$dropdowndiv;var typeMap$$module$build$src$core$registry=Object.create(null),TEST_ONLY$$module$build$src$core$registry={typeMap:typeMap$$module$build$src$core$registry},nameMap$$module$build$src$core$registry=Object.create(null),DEFAULT$$module$build$src$core$registry="default",Type$$module$build$src$core$registry=/*#__PURE__*/function(){function Type$$module$build$src$core$registry(a){_classCallCheck(this,Type$$module$build$src$core$registry);this.name=a;}_createClass(Type$$module$build$src$core$registry,[{key:"toString",value:function toString(){return this.name;}}]);return Type$$module$build$src$core$registry;}();Type$$module$build$src$core$registry.CONNECTION_CHECKER=new Type$$module$build$src$core$registry("connectionChecker");Type$$module$build$src$core$registry.CURSOR=new Type$$module$build$src$core$registry("cursor");Type$$module$build$src$core$registry.EVENT=new Type$$module$build$src$core$registry("event");Type$$module$build$src$core$registry.FIELD=new Type$$module$build$src$core$registry("field");Type$$module$build$src$core$registry.RENDERER=new Type$$module$build$src$core$registry("renderer");Type$$module$build$src$core$registry.TOOLBOX=new Type$$module$build$src$core$registry("toolbox");Type$$module$build$src$core$registry.THEME=new Type$$module$build$src$core$registry("theme");Type$$module$build$src$core$registry.TOOLBOX_ITEM=new Type$$module$build$src$core$registry("toolboxItem");Type$$module$build$src$core$registry.FLYOUTS_VERTICAL_TOOLBOX=new Type$$module$build$src$core$registry("flyoutsVerticalToolbox");Type$$module$build$src$core$registry.FLYOUTS_HORIZONTAL_TOOLBOX=new Type$$module$build$src$core$registry("flyoutsHorizontalToolbox");Type$$module$build$src$core$registry.METRICS_MANAGER=new Type$$module$build$src$core$registry("metricsManager");Type$$module$build$src$core$registry.BLOCK_DRAGGER=new Type$$module$build$src$core$registry("blockDragger");Type$$module$build$src$core$registry.SERIALIZER=new Type$$module$build$src$core$registry("serializer");var module$build$src$core$registry={};module$build$src$core$registry.DEFAULT=DEFAULT$$module$build$src$core$registry;module$build$src$core$registry.TEST_ONLY=TEST_ONLY$$module$build$src$core$registry;module$build$src$core$registry.Type=Type$$module$build$src$core$registry;module$build$src$core$registry.getAllItems=getAllItems$$module$build$src$core$registry;module$build$src$core$registry.getClass=getClass$$module$build$src$core$registry;module$build$src$core$registry.getClassFromOptions=getClassFromOptions$$module$build$src$core$registry;module$build$src$core$registry.getObject=getObject$$module$build$src$core$registry;module$build$src$core$registry.hasItem=hasItem$$module$build$src$core$registry;module$build$src$core$registry.register=register$$module$build$src$core$registry;module$build$src$core$registry.unregister=unregister$$module$build$src$core$registry;var soup$$module$build$src$core$utils$idgenerator="!#$%()*+,-./:;=?@[]^_`{|}~ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",internal$$module$build$src$core$utils$idgenerator={genUid:function genUid(){var a=soup$$module$build$src$core$utils$idgenerator.length,b=[];for(var c=0;20>c;c++){b[c]=soup$$module$build$src$core$utils$idgenerator.charAt(Math.random()*a);}return b.join("");}},TEST_ONLY$$module$build$src$core$utils$idgenerator=internal$$module$build$src$core$utils$idgenerator,nextId$$module$build$src$core$utils$idgenerator=0,module$build$src$core$utils$idgenerator={};module$build$src$core$utils$idgenerator.TEST_ONLY=internal$$module$build$src$core$utils$idgenerator;module$build$src$core$utils$idgenerator.genUid=genUid$$module$build$src$core$utils$idgenerator;module$build$src$core$utils$idgenerator.getNextUniqueId=getNextUniqueId$$module$build$src$core$utils$idgenerator;var group$$module$build$src$core$events$utils="",recordUndo$$module$build$src$core$events$utils=!0,disabled$$module$build$src$core$events$utils=0,CREATE$$module$build$src$core$events$utils="create",BLOCK_CREATE$$module$build$src$core$events$utils=CREATE$$module$build$src$core$events$utils,DELETE$$module$build$src$core$events$utils="delete",BLOCK_DELETE$$module$build$src$core$events$utils=DELETE$$module$build$src$core$events$utils,CHANGE$$module$build$src$core$events$utils="change",BLOCK_CHANGE$$module$build$src$core$events$utils=CHANGE$$module$build$src$core$events$utils,MOVE$$module$build$src$core$events$utils="move",BLOCK_MOVE$$module$build$src$core$events$utils=MOVE$$module$build$src$core$events$utils,VAR_CREATE$$module$build$src$core$events$utils="var_create",VAR_DELETE$$module$build$src$core$events$utils="var_delete",VAR_RENAME$$module$build$src$core$events$utils="var_rename",UI$$module$build$src$core$events$utils="ui",BLOCK_DRAG$$module$build$src$core$events$utils="drag",SELECTED$$module$build$src$core$events$utils="selected",CLICK$$module$build$src$core$events$utils="click",MARKER_MOVE$$module$build$src$core$events$utils="marker_move",BUBBLE_OPEN$$module$build$src$core$events$utils="bubble_open",TRASHCAN_OPEN$$module$build$src$core$events$utils="trashcan_open",TOOLBOX_ITEM_SELECT$$module$build$src$core$events$utils="toolbox_item_select",THEME_CHANGE$$module$build$src$core$events$utils="theme_change",VIEWPORT_CHANGE$$module$build$src$core$events$utils="viewport_change",COMMENT_CREATE$$module$build$src$core$events$utils="comment_create",COMMENT_DELETE$$module$build$src$core$events$utils="comment_delete",COMMENT_CHANGE$$module$build$src$core$events$utils="comment_change",COMMENT_MOVE$$module$build$src$core$events$utils="comment_move",FINISHED_LOADING$$module$build$src$core$events$utils="finished_loading",BUMP_EVENTS$$module$build$src$core$events$utils=[CREATE$$module$build$src$core$events$utils,MOVE$$module$build$src$core$events$utils,COMMENT_CREATE$$module$build$src$core$events$utils,COMMENT_MOVE$$module$build$src$core$events$utils],FIRE_QUEUE$$module$build$src$core$events$utils=[],TEST_ONLY$$module$build$src$core$events$utils={FIRE_QUEUE:FIRE_QUEUE$$module$build$src$core$events$utils,fireNow:fireNow$$module$build$src$core$events$utils,fireInternal:fireInternal$$module$build$src$core$events$utils,setGroupInternal:setGroupInternal$$module$build$src$core$events$utils},module$build$src$core$events$utils={};module$build$src$core$events$utils.BLOCK_CHANGE=CHANGE$$module$build$src$core$events$utils;module$build$src$core$events$utils.BLOCK_CREATE=CREATE$$module$build$src$core$events$utils;module$build$src$core$events$utils.BLOCK_DELETE=DELETE$$module$build$src$core$events$utils;module$build$src$core$events$utils.BLOCK_DRAG=BLOCK_DRAG$$module$build$src$core$events$utils;module$build$src$core$events$utils.BLOCK_MOVE=MOVE$$module$build$src$core$events$utils;module$build$src$core$events$utils.BUBBLE_OPEN=BUBBLE_OPEN$$module$build$src$core$events$utils;module$build$src$core$events$utils.BUMP_EVENTS=BUMP_EVENTS$$module$build$src$core$events$utils;module$build$src$core$events$utils.CHANGE=CHANGE$$module$build$src$core$events$utils;module$build$src$core$events$utils.CLICK=CLICK$$module$build$src$core$events$utils;module$build$src$core$events$utils.COMMENT_CHANGE=COMMENT_CHANGE$$module$build$src$core$events$utils;module$build$src$core$events$utils.COMMENT_CREATE=COMMENT_CREATE$$module$build$src$core$events$utils;module$build$src$core$events$utils.COMMENT_DELETE=COMMENT_DELETE$$module$build$src$core$events$utils;module$build$src$core$events$utils.COMMENT_MOVE=COMMENT_MOVE$$module$build$src$core$events$utils;module$build$src$core$events$utils.CREATE=CREATE$$module$build$src$core$events$utils;module$build$src$core$events$utils.DELETE=DELETE$$module$build$src$core$events$utils;module$build$src$core$events$utils.FINISHED_LOADING=FINISHED_LOADING$$module$build$src$core$events$utils;module$build$src$core$events$utils.MARKER_MOVE=MARKER_MOVE$$module$build$src$core$events$utils;module$build$src$core$events$utils.MOVE=MOVE$$module$build$src$core$events$utils;module$build$src$core$events$utils.SELECTED=SELECTED$$module$build$src$core$events$utils;module$build$src$core$events$utils.TEST_ONLY=TEST_ONLY$$module$build$src$core$events$utils;module$build$src$core$events$utils.THEME_CHANGE=THEME_CHANGE$$module$build$src$core$events$utils;module$build$src$core$events$utils.TOOLBOX_ITEM_SELECT=TOOLBOX_ITEM_SELECT$$module$build$src$core$events$utils;module$build$src$core$events$utils.TRASHCAN_OPEN=TRASHCAN_OPEN$$module$build$src$core$events$utils;module$build$src$core$events$utils.UI=UI$$module$build$src$core$events$utils;module$build$src$core$events$utils.VAR_CREATE=VAR_CREATE$$module$build$src$core$events$utils;module$build$src$core$events$utils.VAR_DELETE=VAR_DELETE$$module$build$src$core$events$utils;module$build$src$core$events$utils.VAR_RENAME=VAR_RENAME$$module$build$src$core$events$utils;module$build$src$core$events$utils.VIEWPORT_CHANGE=VIEWPORT_CHANGE$$module$build$src$core$events$utils;module$build$src$core$events$utils.clearPendingUndo=clearPendingUndo$$module$build$src$core$events$utils;module$build$src$core$events$utils.disable=disable$$module$build$src$core$events$utils;module$build$src$core$events$utils.disableOrphans=disableOrphans$$module$build$src$core$events$utils;module$build$src$core$events$utils.enable=enable$$module$build$src$core$events$utils;module$build$src$core$events$utils.filter=filter$$module$build$src$core$events$utils;module$build$src$core$events$utils.fire=fire$$module$build$src$core$events$utils;module$build$src$core$events$utils.fromJson=fromJson$$module$build$src$core$events$utils;module$build$src$core$events$utils.get=get$$module$build$src$core$events$utils;module$build$src$core$events$utils.getDescendantIds=getDescendantIds$$module$build$src$core$events$utils;module$build$src$core$events$utils.getGroup=getGroup$$module$build$src$core$events$utils;module$build$src$core$events$utils.getRecordUndo=getRecordUndo$$module$build$src$core$events$utils;module$build$src$core$events$utils.isEnabled=isEnabled$$module$build$src$core$events$utils;module$build$src$core$events$utils.setGroup=setGroup$$module$build$src$core$events$utils;module$build$src$core$events$utils.setRecordUndo=setRecordUndo$$module$build$src$core$events$utils;var inputTypes$$module$build$src$core$input_types;(function(a){a[a.VALUE=1]="VALUE";a[a.STATEMENT=3]="STATEMENT";a[a.DUMMY=5]="DUMMY";})(inputTypes$$module$build$src$core$input_types||(inputTypes$$module$build$src$core$input_types={}));$.module$build$src$core$input_types={};$.module$build$src$core$input_types.inputTypes=inputTypes$$module$build$src$core$input_types;var NAME_SPACE$$module$build$src$core$utils$xml,xmlDocument$$module$build$src$core$utils$xml;NAME_SPACE$$module$build$src$core$utils$xml="https://developers.google.com/blockly/xml";xmlDocument$$module$build$src$core$utils$xml=globalThis.document;$.module$build$src$core$utils$xml={};$.module$build$src$core$utils$xml.NAME_SPACE=NAME_SPACE$$module$build$src$core$utils$xml;$.module$build$src$core$utils$xml.createElement=createElement$$module$build$src$core$utils$xml;$.module$build$src$core$utils$xml.createTextNode=createTextNode$$module$build$src$core$utils$xml;$.module$build$src$core$utils$xml.domToText=domToText$$module$build$src$core$utils$xml;$.module$build$src$core$utils$xml.getDocument=getDocument$$module$build$src$core$utils$xml;$.module$build$src$core$utils$xml.setDocument=setDocument$$module$build$src$core$utils$xml;$.module$build$src$core$utils$xml.textToDomDocument=textToDomDocument$$module$build$src$core$utils$xml;var alertImplementation$$module$build$src$core$dialog=function alertImplementation$$module$build$src$core$dialog(a,b){window.alert(a);b&&b();},confirmImplementation$$module$build$src$core$dialog=function confirmImplementation$$module$build$src$core$dialog(a,b){b(window.confirm(a));},promptImplementation$$module$build$src$core$dialog=function promptImplementation$$module$build$src$core$dialog(a,b,c){c(window.prompt(a,b));},TEST_ONLY$$module$build$src$core$dialog={confirmInternal:confirmInternal$$module$build$src$core$dialog},module$build$src$core$dialog={};module$build$src$core$dialog.TEST_ONLY=TEST_ONLY$$module$build$src$core$dialog;module$build$src$core$dialog.alert=alert$$module$build$src$core$dialog;module$build$src$core$dialog.confirm=confirm$$module$build$src$core$dialog;module$build$src$core$dialog.prompt=prompt$$module$build$src$core$dialog;module$build$src$core$dialog.setAlert=setAlert$$module$build$src$core$dialog;module$build$src$core$dialog.setConfirm=setConfirm$$module$build$src$core$dialog;module$build$src$core$dialog.setPrompt=setPrompt$$module$build$src$core$dialog;var Msg$$module$build$src$core$msg,setLocale$$module$build$src$core$msg;Msg$$module$build$src$core$msg=Object.create(null);setLocale$$module$build$src$core$msg=function setLocale$$module$build$src$core$msg(a){Object.keys(a).forEach(function(b){Msg$$module$build$src$core$msg[b]=a[b];});};$.module$build$src$core$msg={};$.module$build$src$core$msg.Msg=Msg$$module$build$src$core$msg;$.module$build$src$core$msg.setLocale=setLocale$$module$build$src$core$msg;var Abstract$$module$build$src$core$events$events_abstract=/*#__PURE__*/function(){function Abstract$$module$build$src$core$events$events_abstract(){_classCallCheck(this,Abstract$$module$build$src$core$events$events_abstract);this.workspaceId=void 0;this.isUiEvent=!1;this.type="";this.group=getGroup$$module$build$src$core$events$utils();this.recordUndo=getRecordUndo$$module$build$src$core$events$utils();}_createClass(Abstract$$module$build$src$core$events$events_abstract,[{key:"toJson",value:function toJson(){return{type:this.type,group:this.group};}},{key:"fromJson",value:function fromJson(a){this.isBlank=!1;this.group=a.group||"";}},{key:"isNull",value:function isNull(){return!1;}},{key:"run",value:function run(a){}},{key:"getEventWorkspace_",value:function getEventWorkspace_(){var a;this.workspaceId&&(a=getWorkspaceById$$module$build$src$core$common(this.workspaceId));if(!a)throw Error("Workspace is null. Event must have been generated from real Blockly events.");return a;}}]);return Abstract$$module$build$src$core$events$events_abstract;}(),module$build$src$core$events$events_abstract={};module$build$src$core$events$events_abstract.Abstract=Abstract$$module$build$src$core$events$events_abstract;var VarBase$$module$build$src$core$events$events_var_base=/*#__PURE__*/function(_Abstract$$module$bui){_inherits(VarBase$$module$build$src$core$events$events_var_base,_Abstract$$module$bui);var _super=_createSuper(VarBase$$module$build$src$core$events$events_var_base);function VarBase$$module$build$src$core$events$events_var_base(a){var _this;_classCallCheck(this,VarBase$$module$build$src$core$events$events_var_base);_this=_super.call(this);_this.isBlank="undefined"===typeof a;a&&(_this.varId=a.getId(),_this.workspaceId=a.workspace.id);return _this;}_createClass(VarBase$$module$build$src$core$events$events_var_base,[{key:"toJson",value:function toJson(){var a=_get(_getPrototypeOf(VarBase$$module$build$src$core$events$events_var_base.prototype),"toJson",this).call(this);if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");a.varId=this.varId;return a;}},{key:"fromJson",value:function fromJson(a){_get(_getPrototypeOf(VarBase$$module$build$src$core$events$events_var_base.prototype),"fromJson",this).call(this,a);this.varId=a.varId;}}]);return VarBase$$module$build$src$core$events$events_var_base;}(Abstract$$module$build$src$core$events$events_abstract),module$build$src$core$events$events_var_base={};module$build$src$core$events$events_var_base.VarBase=VarBase$$module$build$src$core$events$events_var_base;var VarCreate$$module$build$src$core$events$events_var_create=/*#__PURE__*/function(_VarBase$$module$buil){_inherits(VarCreate$$module$build$src$core$events$events_var_create,_VarBase$$module$buil);var _super2=_createSuper(VarCreate$$module$build$src$core$events$events_var_create);function VarCreate$$module$build$src$core$events$events_var_create(a){var _this2;_classCallCheck(this,VarCreate$$module$build$src$core$events$events_var_create);_this2=_super2.call(this,a);_this2.type=VAR_CREATE$$module$build$src$core$events$utils;a&&(_this2.varType=a.type,_this2.varName=a.name);return _this2;}_createClass(VarCreate$$module$build$src$core$events$events_var_create,[{key:"toJson",value:function toJson(){var a=_get(_getPrototypeOf(VarCreate$$module$build$src$core$events$events_var_create.prototype),"toJson",this).call(this);if(!this.varType)throw Error("The var type is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");a.varType=this.varType;a.varName=this.varName;return a;}},{key:"fromJson",value:function fromJson(a){_get(_getPrototypeOf(VarCreate$$module$build$src$core$events$events_var_create.prototype),"fromJson",this).call(this,a);this.varType=a.varType;this.varName=a.varName;}},{key:"run",value:function run(a){var b=this.getEventWorkspace_();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");a?b.createVariable(this.varName,this.varType,this.varId):b.deleteVariableById(this.varId);}}]);return VarCreate$$module$build$src$core$events$events_var_create;}(VarBase$$module$build$src$core$events$events_var_base);register$$module$build$src$core$registry(Type$$module$build$src$core$registry.EVENT,VAR_CREATE$$module$build$src$core$events$utils,VarCreate$$module$build$src$core$events$events_var_create);var module$build$src$core$events$events_var_create={};module$build$src$core$events$events_var_create.VarCreate=VarCreate$$module$build$src$core$events$events_var_create;var VariableModel$$module$build$src$core$variable_model=/*#__PURE__*/function(){function VariableModel$$module$build$src$core$variable_model(a,b,c,d){_classCallCheck(this,VariableModel$$module$build$src$core$variable_model);this.workspace=a;this.name=b;this.type=c||"";this.id_=d||genUid$$module$build$src$core$utils$idgenerator();fire$$module$build$src$core$events$utils(new(get$$module$build$src$core$events$utils(VAR_CREATE$$module$build$src$core$events$utils))(this));}_createClass(VariableModel$$module$build$src$core$variable_model,[{key:"getId",value:function getId(){return this.id_;}}],[{key:"compareByName",value:function compareByName(a,b){return a.name.localeCompare(b.name,void 0,{sensitivity:"base"});}}]);return VariableModel$$module$build$src$core$variable_model;}(),module$build$src$core$variable_model={};module$build$src$core$variable_model.VariableModel=VariableModel$$module$build$src$core$variable_model;var CATEGORY_NAME$$module$build$src$core$variables,VAR_LETTER_OPTIONS$$module$build$src$core$variables,TEST_ONLY$$module$build$src$core$variables;CATEGORY_NAME$$module$build$src$core$variables="VARIABLE";VAR_LETTER_OPTIONS$$module$build$src$core$variables="ijkmnopqrstuvwxyzabcdefgh";TEST_ONLY$$module$build$src$core$variables={generateUniqueNameInternal:generateUniqueNameInternal$$module$build$src$core$variables};$.module$build$src$core$variables={};$.module$build$src$core$variables.CATEGORY_NAME=CATEGORY_NAME$$module$build$src$core$variables;$.module$build$src$core$variables.TEST_ONLY=TEST_ONLY$$module$build$src$core$variables;$.module$build$src$core$variables.VAR_LETTER_OPTIONS=VAR_LETTER_OPTIONS$$module$build$src$core$variables;$.module$build$src$core$variables.allDeveloperVariables=allDeveloperVariables$$module$build$src$core$variables;$.module$build$src$core$variables.allUsedVarModels=allUsedVarModels$$module$build$src$core$variables;$.module$build$src$core$variables.createVariableButtonHandler=createVariableButtonHandler$$module$build$src$core$variables;$.module$build$src$core$variables.flyoutCategory=flyoutCategory$$module$build$src$core$variables;$.module$build$src$core$variables.flyoutCategoryBlocks=flyoutCategoryBlocks$$module$build$src$core$variables;$.module$build$src$core$variables.generateUniqueName=generateUniqueName$$module$build$src$core$variables;$.module$build$src$core$variables.generateUniqueNameFromOptions=generateUniqueNameFromOptions$$module$build$src$core$variables;$.module$build$src$core$variables.generateVariableFieldDom=generateVariableFieldDom$$module$build$src$core$variables;$.module$build$src$core$variables.getAddedVariables=getAddedVariables$$module$build$src$core$variables;$.module$build$src$core$variables.getOrCreateVariablePackage=getOrCreateVariablePackage$$module$build$src$core$variables;$.module$build$src$core$variables.getVariable=getVariable$$module$build$src$core$variables;$.module$build$src$core$variables.nameUsedWithAnyType=nameUsedWithAnyType$$module$build$src$core$variables;$.module$build$src$core$variables.promptName=promptName$$module$build$src$core$variables;$.module$build$src$core$variables.renameVariable=renameVariable$$module$build$src$core$variables;var WorkspaceComment$$module$build$src$core$workspace_comment=/*#__PURE__*/function(){function WorkspaceComment$$module$build$src$core$workspace_comment(a,b,c,d,e){_classCallCheck(this,WorkspaceComment$$module$build$src$core$workspace_comment);this.workspace=a;this.editable_=this.movable_=this.deletable_=!0;this.disposed_=!1;this.isComment=!0;this.id=e&&!a.getCommentById(e)?e:genUid$$module$build$src$core$utils$idgenerator();a.addTopComment(this);this.xy_=new Coordinate$$module$build$src$core$utils$coordinate(0,0);this.height_=c;this.width_=d;this.RTL=a.RTL;this.content_=b;WorkspaceComment$$module$build$src$core$workspace_comment.fireCreateEvent(this);}_createClass(WorkspaceComment$$module$build$src$core$workspace_comment,[{key:"dispose",value:function dispose(){this.disposed_||(isEnabled$$module$build$src$core$events$utils()&&fire$$module$build$src$core$events$utils(new(get$$module$build$src$core$events$utils(COMMENT_DELETE$$module$build$src$core$events$utils))(this)),this.workspace.removeTopComment(this),this.disposed_=!0);}},{key:"getHeight",value:function getHeight(){return this.height_;}},{key:"setHeight",value:function setHeight(a){this.height_=a;}},{key:"getWidth",value:function getWidth(){return this.width_;}},{key:"setWidth",value:function setWidth(a){this.width_=a;}},{key:"getXY",value:function getXY(){return new Coordinate$$module$build$src$core$utils$coordinate(this.xy_.x,this.xy_.y);}},{key:"moveBy",value:function moveBy(a,b){var c=new(get$$module$build$src$core$events$utils(COMMENT_MOVE$$module$build$src$core$events$utils))(this);this.xy_.translate(a,b);c.recordNew();fire$$module$build$src$core$events$utils(c);}},{key:"isDeletable",value:function isDeletable(){return this.deletable_&&!(this.workspace&&this.workspace.options.readOnly);}},{key:"setDeletable",value:function setDeletable(a){this.deletable_=a;}},{key:"isMovable",value:function isMovable(){return this.movable_&&!(this.workspace&&this.workspace.options.readOnly);}},{key:"setMovable",value:function setMovable(a){this.movable_=a;}},{key:"isEditable",value:function isEditable(){return this.editable_&&!(this.workspace&&this.workspace.options.readOnly);}},{key:"setEditable",value:function setEditable(a){this.editable_=a;}},{key:"getContent",value:function getContent(){return this.content_;}},{key:"setContent",value:function setContent(a){this.content_!==a&&(fire$$module$build$src$core$events$utils(new(get$$module$build$src$core$events$utils(COMMENT_CHANGE$$module$build$src$core$events$utils))(this,this.content_,a)),this.content_=a);}},{key:"toXmlWithXY",value:function toXmlWithXY(a){a=this.toXml(a);a.setAttribute("x","".concat(Math.round(this.xy_.x)));a.setAttribute("y","".concat(Math.round(this.xy_.y)));a.setAttribute("h","".concat(this.height_));a.setAttribute("w","".concat(this.width_));return a;}},{key:"toXml",value:function toXml(a){var b=createElement$$module$build$src$core$utils$xml("comment");a||(b.id=this.id);b.textContent=this.getContent();return b;}}],[{key:"fireCreateEvent",value:function fireCreateEvent(a){if(isEnabled$$module$build$src$core$events$utils()){var b=getGroup$$module$build$src$core$events$utils();b||setGroup$$module$build$src$core$events$utils(!0);try{fire$$module$build$src$core$events$utils(new(get$$module$build$src$core$events$utils(COMMENT_CREATE$$module$build$src$core$events$utils))(a));}finally{b||setGroup$$module$build$src$core$events$utils(!1);}}}},{key:"fromXml",value:function fromXml(a,b){var c=WorkspaceComment$$module$build$src$core$workspace_comment.parseAttributes(a);b=new WorkspaceComment$$module$build$src$core$workspace_comment(b,c.content,c.h,c.w,c.id);c=a.getAttribute("x");a=a.getAttribute("y");c=c?parseInt(c,10):NaN;a=a?parseInt(a,10):NaN;isNaN(c)||isNaN(a)||b.moveBy(c,a);WorkspaceComment$$module$build$src$core$workspace_comment.fireCreateEvent(b);return b;}},{key:"parseAttributes",value:function parseAttributes(a){var b=a.getAttribute("h"),c=a.getAttribute("w"),d=a.getAttribute("x"),e=a.getAttribute("y"),f=a.getAttribute("id");if(!f)throw Error("No ID present in XML comment definition.");var g;return{id:f,h:b?parseInt(b):100,w:c?parseInt(c):100,x:d?parseInt(d):NaN,y:e?parseInt(e):NaN,content:null!=(g=a.textContent)?g:""};}}]);return WorkspaceComment$$module$build$src$core$workspace_comment;}(),module$build$src$core$workspace_comment={};module$build$src$core$workspace_comment.WorkspaceComment=WorkspaceComment$$module$build$src$core$workspace_comment;var UiBase$$module$build$src$core$events$events_ui_base=/*#__PURE__*/function(_Abstract$$module$bui2){_inherits(UiBase$$module$build$src$core$events$events_ui_base,_Abstract$$module$bui2);var _super3=_createSuper(UiBase$$module$build$src$core$events$events_ui_base);function UiBase$$module$build$src$core$events$events_ui_base(a){var _this3;_classCallCheck(this,UiBase$$module$build$src$core$events$events_ui_base);_this3=_super3.call(this);_this3.isBlank=!0;_this3.recordUndo=!1;_this3.isUiEvent=!0;_this3.isBlank="undefined"===typeof a;_this3.workspaceId=a?a:"";return _this3;}return _createClass(UiBase$$module$build$src$core$events$events_ui_base);}(Abstract$$module$build$src$core$events$events_abstract),module$build$src$core$events$events_ui_base={};module$build$src$core$events$events_ui_base.UiBase=UiBase$$module$build$src$core$events$events_ui_base;var Selected$$module$build$src$core$events$events_selected=/*#__PURE__*/function(_UiBase$$module$build){_inherits(Selected$$module$build$src$core$events$events_selected,_UiBase$$module$build);var _super4=_createSuper(Selected$$module$build$src$core$events$events_selected);function Selected$$module$build$src$core$events$events_selected(a,b,c){var _this4;_classCallCheck(this,Selected$$module$build$src$core$events$events_selected);_this4=_super4.call(this,c);_this4.type=SELECTED$$module$build$src$core$events$utils;_this4.oldElementId=null!=a?a:void 0;_this4.newElementId=null!=b?b:void 0;return _this4;}_createClass(Selected$$module$build$src$core$events$events_selected,[{key:"toJson",value:function toJson(){var a=_get(_getPrototypeOf(Selected$$module$build$src$core$events$events_selected.prototype),"toJson",this).call(this);a.oldElementId=this.oldElementId;a.newElementId=this.newElementId;return a;}},{key:"fromJson",value:function fromJson(a){_get(_getPrototypeOf(Selected$$module$build$src$core$events$events_selected.prototype),"fromJson",this).call(this,a);this.oldElementId=a.oldElementId;this.newElementId=a.newElementId;}}]);return Selected$$module$build$src$core$events$events_selected;}(UiBase$$module$build$src$core$events$events_ui_base);register$$module$build$src$core$registry(Type$$module$build$src$core$registry.EVENT,SELECTED$$module$build$src$core$events$utils,Selected$$module$build$src$core$events$events_selected);var module$build$src$core$events$events_selected={};module$build$src$core$events$events_selected.Selected=Selected$$module$build$src$core$events$events_selected;var injected$$module$build$src$core$css=!1,content$$module$build$src$core$css='\n.blocklySvg {\n  background-color: #fff;\n  outline: none;\n  overflow: hidden;  /* IE overflows by default. */\n  position: absolute;\n  display: block;\n}\n\n.blocklyWidgetDiv {\n  display: none;\n  position: absolute;\n  z-index: 99999;  /* big value for bootstrap3 compatibility */\n}\n\n.injectionDiv {\n  height: 100%;\n  position: relative;\n  overflow: hidden;  /* So blocks in drag surface disappear at edges */\n  touch-action: none;\n}\n\n.blocklyNonSelectable {\n  user-select: none;\n  -ms-user-select: none;\n  -webkit-user-select: none;\n}\n\n.blocklyWsDragSurface {\n  display: none;\n  position: absolute;\n  top: 0;\n  left: 0;\n}\n\n/* Added as a separate rule with multiple classes to make it more specific\n   than a bootstrap rule that selects svg:root. See issue #1275 for context.\n*/\n.blocklyWsDragSurface.blocklyOverflowVisible {\n  overflow: visible;\n}\n\n.blocklyBlockDragSurface {\n  display: none;\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  overflow: visible !important;\n  z-index: 50;  /* Display below toolbox, but above everything else. */\n}\n\n.blocklyBlockCanvas.blocklyCanvasTransitioning,\n.blocklyBubbleCanvas.blocklyCanvasTransitioning {\n  transition: transform .5s;\n}\n\n.blocklyTooltipDiv {\n  background-color: #ffffc7;\n  border: 1px solid #ddc;\n  box-shadow: 4px 4px 20px 1px rgba(0,0,0,.15);\n  color: #000;\n  display: none;\n  font: 9pt sans-serif;\n  opacity: .9;\n  padding: 2px;\n  position: absolute;\n  z-index: 100000;  /* big value for bootstrap3 compatibility */\n}\n\n.blocklyDropDownDiv {\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 1000;\n  display: none;\n  border: 1px solid;\n  border-color: #dadce0;\n  background-color: #fff;\n  border-radius: 2px;\n  padding: 4px;\n  box-shadow: 0 0 3px 1px rgba(0,0,0,.3);\n}\n\n.blocklyDropDownDiv.blocklyFocused {\n  box-shadow: 0 0 6px 1px rgba(0,0,0,.3);\n}\n\n.blocklyDropDownContent {\n  max-height: 300px;  /* @todo: spec for maximum height. */\n  overflow: auto;\n  overflow-x: hidden;\n  position: relative;\n}\n\n.blocklyDropDownArrow {\n  position: absolute;\n  left: 0;\n  top: 0;\n  width: 16px;\n  height: 16px;\n  z-index: -1;\n  background-color: inherit;\n  border-color: inherit;\n}\n\n.blocklyDropDownButton {\n  display: inline-block;\n  float: left;\n  padding: 0;\n  margin: 4px;\n  border-radius: 4px;\n  outline: none;\n  border: 1px solid;\n  transition: box-shadow .1s;\n  cursor: pointer;\n}\n\n.blocklyArrowTop {\n  border-top: 1px solid;\n  border-left: 1px solid;\n  border-top-left-radius: 4px;\n  border-color: inherit;\n}\n\n.blocklyArrowBottom {\n  border-bottom: 1px solid;\n  border-right: 1px solid;\n  border-bottom-right-radius: 4px;\n  border-color: inherit;\n}\n\n.blocklyResizeSE {\n  cursor: se-resize;\n  fill: #aaa;\n}\n\n.blocklyResizeSW {\n  cursor: sw-resize;\n  fill: #aaa;\n}\n\n.blocklyResizeLine {\n  stroke: #515A5A;\n  stroke-width: 1;\n}\n\n.blocklyHighlightedConnectionPath {\n  fill: none;\n  stroke: #fc3;\n  stroke-width: 4px;\n}\n\n.blocklyPathLight {\n  fill: none;\n  stroke-linecap: round;\n  stroke-width: 1;\n}\n\n.blocklySelected>.blocklyPathLight {\n  display: none;\n}\n\n.blocklyDraggable {\n  /* backup for browsers (e.g. IE11) that don\'t support grab */\n  cursor: url("<<<PATH>>>/handopen.cur"), auto;\n  cursor: grab;\n  cursor: -webkit-grab;\n}\n\n  /* backup for browsers (e.g. IE11) that don\'t support grabbing */\n.blocklyDragging {\n  /* backup for browsers (e.g. IE11) that don\'t support grabbing */\n  cursor: url("<<<PATH>>>/handclosed.cur"), auto;\n  cursor: grabbing;\n  cursor: -webkit-grabbing;\n}\n\n  /* Changes cursor on mouse down. Not effective in Firefox because of\n     https://bugzilla.mozilla.org/show_bug.cgi?id=771241 */\n.blocklyDraggable:active {\n  /* backup for browsers (e.g. IE11) that don\'t support grabbing */\n  cursor: url("<<<PATH>>>/handclosed.cur"), auto;\n  cursor: grabbing;\n  cursor: -webkit-grabbing;\n}\n\n/* Change the cursor on the whole drag surface in case the mouse gets\n   ahead of block during a drag. This way the cursor is still a closed hand.\n  */\n.blocklyBlockDragSurface .blocklyDraggable {\n  /* backup for browsers (e.g. IE11) that don\'t support grabbing */\n  cursor: url("<<<PATH>>>/handclosed.cur"), auto;\n  cursor: grabbing;\n  cursor: -webkit-grabbing;\n}\n\n.blocklyDragging.blocklyDraggingDelete {\n  cursor: url("<<<PATH>>>/handdelete.cur"), auto;\n}\n\n.blocklyDragging>.blocklyPath,\n.blocklyDragging>.blocklyPathLight {\n  fill-opacity: .8;\n  stroke-opacity: .8;\n}\n\n.blocklyDragging>.blocklyPathDark {\n  display: none;\n}\n\n.blocklyDisabled>.blocklyPath {\n  fill-opacity: .5;\n  stroke-opacity: .5;\n}\n\n.blocklyDisabled>.blocklyPathLight,\n.blocklyDisabled>.blocklyPathDark {\n  display: none;\n}\n\n.blocklyInsertionMarker>.blocklyPath,\n.blocklyInsertionMarker>.blocklyPathLight,\n.blocklyInsertionMarker>.blocklyPathDark {\n  fill-opacity: .2;\n  stroke: none;\n}\n\n.blocklyMultilineText {\n  font-family: monospace;\n}\n\n.blocklyNonEditableText>text {\n  pointer-events: none;\n}\n\n.blocklyFlyout {\n  position: absolute;\n  z-index: 20;\n}\n\n.blocklyText text {\n  cursor: default;\n}\n\n/*\n  Don\'t allow users to select text.  It gets annoying when trying to\n  drag a block and selected text moves instead.\n*/\n.blocklySvg text,\n.blocklyBlockDragSurface text {\n  user-select: none;\n  -ms-user-select: none;\n  -webkit-user-select: none;\n  cursor: inherit;\n}\n\n.blocklyHidden {\n  display: none;\n}\n\n.blocklyFieldDropdown:not(.blocklyHidden) {\n  display: block;\n}\n\n.blocklyIconGroup {\n  cursor: default;\n}\n\n.blocklyIconGroup:not(:hover),\n.blocklyIconGroupReadonly {\n  opacity: .6;\n}\n\n.blocklyIconShape {\n  fill: #00f;\n  stroke: #fff;\n  stroke-width: 1px;\n}\n\n.blocklyIconSymbol {\n  fill: #fff;\n}\n\n.blocklyMinimalBody {\n  margin: 0;\n  padding: 0;\n}\n\n.blocklyHtmlInput {\n  border: none;\n  border-radius: 4px;\n  height: 100%;\n  margin: 0;\n  outline: none;\n  padding: 0;\n  width: 100%;\n  text-align: center;\n  display: block;\n  box-sizing: border-box;\n}\n\n/* Edge and IE introduce a close icon when the input value is longer than a\n   certain length. This affects our sizing calculations of the text input.\n   Hiding the close icon to avoid that. */\n.blocklyHtmlInput::-ms-clear {\n  display: none;\n}\n\n.blocklyMainBackground {\n  stroke-width: 1;\n  stroke: #c6c6c6;  /* Equates to #ddd due to border being off-pixel. */\n}\n\n.blocklyMutatorBackground {\n  fill: #fff;\n  stroke: #ddd;\n  stroke-width: 1;\n}\n\n.blocklyFlyoutBackground {\n  fill: #ddd;\n  fill-opacity: .8;\n}\n\n.blocklyMainWorkspaceScrollbar {\n  z-index: 20;\n}\n\n.blocklyFlyoutScrollbar {\n  z-index: 30;\n}\n\n.blocklyScrollbarHorizontal,\n.blocklyScrollbarVertical {\n  position: absolute;\n  outline: none;\n}\n\n.blocklyScrollbarBackground {\n  opacity: 0;\n}\n\n.blocklyScrollbarHandle {\n  fill: #ccc;\n}\n\n.blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,\n.blocklyScrollbarHandle:hover {\n  fill: #bbb;\n}\n\n/* Darken flyout scrollbars due to being on a grey background. */\n/* By contrast, workspace scrollbars are on a white background. */\n.blocklyFlyout .blocklyScrollbarHandle {\n  fill: #bbb;\n}\n\n.blocklyFlyout .blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,\n.blocklyFlyout .blocklyScrollbarHandle:hover {\n  fill: #aaa;\n}\n\n.blocklyInvalidInput {\n  background: #faa;\n}\n\n.blocklyVerticalMarker {\n  stroke-width: 3px;\n  fill: rgba(255,255,255,.5);\n  pointer-events: none;\n}\n\n.blocklyComputeCanvas {\n  position: absolute;\n  width: 0;\n  height: 0;\n}\n\n.blocklyNoPointerEvents {\n  pointer-events: none;\n}\n\n.blocklyContextMenu {\n  border-radius: 4px;\n  max-height: 100%;\n}\n\n.blocklyDropdownMenu {\n  border-radius: 2px;\n  padding: 0 !important;\n}\n\n.blocklyDropdownMenu .blocklyMenuItem {\n  /* 28px on the left for icon or checkbox. */\n  padding-left: 28px;\n}\n\n/* BiDi override for the resting state. */\n.blocklyDropdownMenu .blocklyMenuItemRtl {\n  /* Flip left/right padding for BiDi. */\n  padding-left: 5px;\n  padding-right: 28px;\n}\n\n.blocklyWidgetDiv .blocklyMenu {\n  background: #fff;\n  border: 1px solid transparent;\n  box-shadow: 0 0 3px 1px rgba(0,0,0,.3);\n  font: normal 13px Arial, sans-serif;\n  margin: 0;\n  outline: none;\n  padding: 4px 0;\n  position: absolute;\n  overflow-y: auto;\n  overflow-x: hidden;\n  max-height: 100%;\n  z-index: 20000;  /* Arbitrary, but some apps depend on it... */\n}\n\n.blocklyWidgetDiv .blocklyMenu.blocklyFocused {\n  box-shadow: 0 0 6px 1px rgba(0,0,0,.3);\n}\n\n.blocklyDropDownDiv .blocklyMenu {\n  background: inherit;  /* Compatibility with gapi, reset from goog-menu */\n  border: inherit;  /* Compatibility with gapi, reset from goog-menu */\n  font: normal 13px "Helvetica Neue", Helvetica, sans-serif;\n  outline: none;\n  position: relative;  /* Compatibility with gapi, reset from goog-menu */\n  z-index: 20000;  /* Arbitrary, but some apps depend on it... */\n}\n\n/* State: resting. */\n.blocklyMenuItem {\n  border: none;\n  color: #000;\n  cursor: pointer;\n  list-style: none;\n  margin: 0;\n  /* 7em on the right for shortcut. */\n  min-width: 7em;\n  padding: 6px 15px;\n  white-space: nowrap;\n}\n\n/* State: disabled. */\n.blocklyMenuItemDisabled {\n  color: #ccc;\n  cursor: inherit;\n}\n\n/* State: hover. */\n.blocklyMenuItemHighlight {\n  background-color: rgba(0,0,0,.1);\n}\n\n/* State: selected/checked. */\n.blocklyMenuItemCheckbox {\n  height: 16px;\n  position: absolute;\n  width: 16px;\n}\n\n.blocklyMenuItemSelected .blocklyMenuItemCheckbox {\n  background: url(<<<PATH>>>/sprites.png) no-repeat -48px -16px;\n  float: left;\n  margin-left: -24px;\n  position: static;  /* Scroll with the menu. */\n}\n\n.blocklyMenuItemRtl .blocklyMenuItemCheckbox {\n  float: right;\n  margin-right: -24px;\n}\n',module$build$src$core$css={};module$build$src$core$css.inject=inject$$module$build$src$core$css;module$build$src$core$css.register=register$$module$build$src$core$css;var Svg$$module$build$src$core$utils$svg=/*#__PURE__*/function(){function Svg$$module$build$src$core$utils$svg(a){_classCallCheck(this,Svg$$module$build$src$core$utils$svg);this.tagName=a;}_createClass(Svg$$module$build$src$core$utils$svg,[{key:"toString",value:function toString(){return this.tagName;}}]);return Svg$$module$build$src$core$utils$svg;}();Svg$$module$build$src$core$utils$svg.ANIMATE=new Svg$$module$build$src$core$utils$svg("animate");Svg$$module$build$src$core$utils$svg.CIRCLE=new Svg$$module$build$src$core$utils$svg("circle");Svg$$module$build$src$core$utils$svg.CLIPPATH=new Svg$$module$build$src$core$utils$svg("clipPath");Svg$$module$build$src$core$utils$svg.DEFS=new Svg$$module$build$src$core$utils$svg("defs");Svg$$module$build$src$core$utils$svg.FECOMPOSITE=new Svg$$module$build$src$core$utils$svg("feComposite");Svg$$module$build$src$core$utils$svg.FECOMPONENTTRANSFER=new Svg$$module$build$src$core$utils$svg("feComponentTransfer");Svg$$module$build$src$core$utils$svg.FEFLOOD=new Svg$$module$build$src$core$utils$svg("feFlood");Svg$$module$build$src$core$utils$svg.FEFUNCA=new Svg$$module$build$src$core$utils$svg("feFuncA");Svg$$module$build$src$core$utils$svg.FEGAUSSIANBLUR=new Svg$$module$build$src$core$utils$svg("feGaussianBlur");Svg$$module$build$src$core$utils$svg.FEPOINTLIGHT=new Svg$$module$build$src$core$utils$svg("fePointLight");Svg$$module$build$src$core$utils$svg.FESPECULARLIGHTING=new Svg$$module$build$src$core$utils$svg("feSpecularLighting");Svg$$module$build$src$core$utils$svg.FILTER=new Svg$$module$build$src$core$utils$svg("filter");Svg$$module$build$src$core$utils$svg.FOREIGNOBJECT=new Svg$$module$build$src$core$utils$svg("foreignObject");Svg$$module$build$src$core$utils$svg.G=new Svg$$module$build$src$core$utils$svg("g");Svg$$module$build$src$core$utils$svg.IMAGE=new Svg$$module$build$src$core$utils$svg("image");Svg$$module$build$src$core$utils$svg.LINE=new Svg$$module$build$src$core$utils$svg("line");Svg$$module$build$src$core$utils$svg.PATH=new Svg$$module$build$src$core$utils$svg("path");Svg$$module$build$src$core$utils$svg.PATTERN=new Svg$$module$build$src$core$utils$svg("pattern");Svg$$module$build$src$core$utils$svg.POLYGON=new Svg$$module$build$src$core$utils$svg("polygon");Svg$$module$build$src$core$utils$svg.RECT=new Svg$$module$build$src$core$utils$svg("rect");Svg$$module$build$src$core$utils$svg.SVG=new Svg$$module$build$src$core$utils$svg("svg");Svg$$module$build$src$core$utils$svg.TEXT=new Svg$$module$build$src$core$utils$svg("text");Svg$$module$build$src$core$utils$svg.TSPAN=new Svg$$module$build$src$core$utils$svg("tspan");var module$build$src$core$utils$svg={};module$build$src$core$utils$svg.Svg=Svg$$module$build$src$core$utils$svg;var XY_REGEX$$module$build$src$core$utils$svg_math=/translate\(\s*([-+\d.e]+)([ ,]\s*([-+\d.e]+)\s*)?/,XY_STYLE_REGEX$$module$build$src$core$utils$svg_math=/transform:\s*translate(?:3d)?\(\s*([-+\d.e]+)\s*px([ ,]\s*([-+\d.e]+)\s*px)?/,TEST_ONLY$$module$build$src$core$utils$svg_math={XY_REGEX:XY_REGEX$$module$build$src$core$utils$svg_math,XY_STYLE_REGEX:XY_STYLE_REGEX$$module$build$src$core$utils$svg_math},module$build$src$core$utils$svg_math={};module$build$src$core$utils$svg_math.TEST_ONLY=TEST_ONLY$$module$build$src$core$utils$svg_math;module$build$src$core$utils$svg_math.getDocumentScroll=getDocumentScroll$$module$build$src$core$utils$svg_math;module$build$src$core$utils$svg_math.getInjectionDivXY=getInjectionDivXY$$module$build$src$core$utils$svg_math;module$build$src$core$utils$svg_math.getRelativeXY=getRelativeXY$$module$build$src$core$utils$svg_math;module$build$src$core$utils$svg_math.getViewportBBox=getViewportBBox$$module$build$src$core$utils$svg_math;module$build$src$core$utils$svg_math.is3dSupported=is3dSupported$$module$build$src$core$utils$svg_math;module$build$src$core$utils$svg_math.screenToWsCoordinates=screenToWsCoordinates$$module$build$src$core$utils$svg_math;var RESIZE_SIZE$$module$build$src$core$workspace_comment_svg=8,BORDER_RADIUS$$module$build$src$core$workspace_comment_svg=3,TEXTAREA_OFFSET$$module$build$src$core$workspace_comment_svg=2,WorkspaceCommentSvg$$module$build$src$core$workspace_comment_svg=/*#__PURE__*/function(_WorkspaceComment$$mo){_inherits(WorkspaceCommentSvg$$module$build$src$core$workspace_comment_svg,_WorkspaceComment$$mo);var _super5=_createSuper(WorkspaceCommentSvg$$module$build$src$core$workspace_comment_svg);function WorkspaceCommentSvg$$module$build$src$core$workspace_comment_svg(a,b,c,d,e){var _this5;_classCallCheck(this,WorkspaceCommentSvg$$module$build$src$core$workspace_comment_svg);_this5=_super5.call(this,a,b,c,d,e);_this5.onMouseMoveWrapper_=_this5.onMouseUpWrapper_=null;_this5.eventsInit_=!1;_this5.deleteIconBorder_=_this5.deleteGroup_=_this5.resizeGroup_=_this5.foreignObject_=_this5.svgHandleTarget_=_this5.svgRectTarget_=_this5.textarea_=null;_this5.rendered_=_this5.autoLayout_=_this5.focused_=!1;_this5.svgGroup_=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.G,{"class":"blocklyComment"});_this5.svgGroup_.translate_="";_this5.workspace=a;_this5.svgRect_=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.RECT,{"class":"blocklyCommentRect",x:0,y:0,rx:BORDER_RADIUS$$module$build$src$core$workspace_comment_svg,ry:BORDER_RADIUS$$module$build$src$core$workspace_comment_svg});_this5.svgGroup_.appendChild(_this5.svgRect_);_this5.useDragSurface_=!!a.getBlockDragSurface();_this5.render();return _this5;}_createClass(WorkspaceCommentSvg$$module$build$src$core$workspace_comment_svg,[{key:"dispose",value:function dispose(){this.disposed_||(getSelected$$module$build$src$core$common()===this&&(this.unselect(),this.workspace.cancelCurrentGesture()),isEnabled$$module$build$src$core$events$utils()&&fire$$module$build$src$core$events$utils(new(get$$module$build$src$core$events$utils(COMMENT_DELETE$$module$build$src$core$events$utils))(this)),removeNode$$module$build$src$core$utils$dom(this.svgGroup_),this.disposeInternal_(),disable$$module$build$src$core$events$utils(),_get(_getPrototypeOf(WorkspaceCommentSvg$$module$build$src$core$workspace_comment_svg.prototype),"dispose",this).call(this),enable$$module$build$src$core$events$utils());}},{key:"initSvg",value:function initSvg(a){if(!this.workspace.rendered)throw TypeError("Workspace is headless.");this.workspace.options.readOnly||this.eventsInit_||(conditionalBind$$module$build$src$core$browser_events(this.svgRectTarget_,"mousedown",this,this.pathMouseDown_),conditionalBind$$module$build$src$core$browser_events(this.svgHandleTarget_,"mousedown",this,this.pathMouseDown_));this.eventsInit_=!0;this.updateMovable();this.getSvgRoot().parentNode||this.workspace.getBubbleCanvas().appendChild(this.getSvgRoot());!a&&this.textarea_&&this.textarea_.select();}},{key:"pathMouseDown_",value:function pathMouseDown_(a){var b=this.workspace.getGesture(a);b&&b.handleBubbleStart(a,this);}},{key:"showContextMenu",value:function showContextMenu(a){throw Error("The implementation of showContextMenu should be monkey-patched in by blockly.ts");}},{key:"select",value:function select(){if(getSelected$$module$build$src$core$common()!==this){var a=null;if(getSelected$$module$build$src$core$common()){a=getSelected$$module$build$src$core$common().id;disable$$module$build$src$core$events$utils();try{getSelected$$module$build$src$core$common().unselect();}finally{enable$$module$build$src$core$events$utils();}}a=new(get$$module$build$src$core$events$utils(SELECTED$$module$build$src$core$events$utils))(a,this.id,this.workspace.id);fire$$module$build$src$core$events$utils(a);setSelected$$module$build$src$core$common(this);this.addSelect();}}},{key:"unselect",value:function unselect(){if(getSelected$$module$build$src$core$common()===this){var a=new(get$$module$build$src$core$events$utils(SELECTED$$module$build$src$core$events$utils))(this.id,null,this.workspace.id);fire$$module$build$src$core$events$utils(a);setSelected$$module$build$src$core$common(null);this.removeSelect();this.blurFocus();}}},{key:"addSelect",value:function addSelect(){addClass$$module$build$src$core$utils$dom(this.svgGroup_,"blocklySelected");this.setFocus();}},{key:"removeSelect",value:function removeSelect(){addClass$$module$build$src$core$utils$dom(this.svgGroup_,"blocklySelected");this.blurFocus();}},{key:"addFocus",value:function addFocus(){addClass$$module$build$src$core$utils$dom(this.svgGroup_,"blocklyFocused");}},{key:"removeFocus",value:function removeFocus(){removeClass$$module$build$src$core$utils$dom(this.svgGroup_,"blocklyFocused");}},{key:"getRelativeToSurfaceXY",value:function getRelativeToSurfaceXY(){var a=0,b=0;var c=this.useDragSurface_?this.workspace.getBlockDragSurface().getGroup():null;var d=this.getSvgRoot();if(d){do{var e=getRelativeXY$$module$build$src$core$utils$svg_math(d);a+=e.x;b+=e.y;this.useDragSurface_&&this.workspace.getBlockDragSurface().getCurrentBlock()===d&&(e=this.workspace.getBlockDragSurface().getSurfaceTranslation(),a+=e.x,b+=e.y);d=d.parentNode;}while(d&&d!==this.workspace.getBubbleCanvas()&&d!==c);}return this.xy_=new Coordinate$$module$build$src$core$utils$coordinate(a,b);}},{key:"moveBy",value:function moveBy(a,b){var c=new(get$$module$build$src$core$events$utils(COMMENT_MOVE$$module$build$src$core$events$utils))(this),d=this.getRelativeToSurfaceXY();this.translate(d.x+a,d.y+b);this.xy_=new Coordinate$$module$build$src$core$utils$coordinate(d.x+a,d.y+b);c.recordNew();fire$$module$build$src$core$events$utils(c);this.workspace.resizeContents();}},{key:"translate",value:function translate(a,b){this.xy_=new Coordinate$$module$build$src$core$utils$coordinate(a,b);this.getSvgRoot().setAttribute("transform","translate("+a+","+b+")");}},{key:"moveToDragSurface",value:function moveToDragSurface(){if(this.useDragSurface_){var a=this.getRelativeToSurfaceXY();this.clearTransformAttributes_();this.workspace.getBlockDragSurface().translateSurface(a.x,a.y);this.workspace.getBlockDragSurface().setBlocksAndShow(this.getSvgRoot());}}},{key:"moveDuringDrag",value:function moveDuringDrag(a,b){a?a.translateSurface(b.x,b.y):(this.svgGroup_.translate_="translate("+b.x+","+b.y+")",this.svgGroup_.setAttribute("transform",this.svgGroup_.translate_+this.svgGroup_.skew_));}},{key:"moveTo",value:function moveTo(a,b){this.translate(a,b);}},{key:"clearTransformAttributes_",value:function clearTransformAttributes_(){this.getSvgRoot().removeAttribute("transform");}},{key:"getBoundingRectangle",value:function getBoundingRectangle(){var a=this.getRelativeToSurfaceXY();var b=this.getHeightWidth(),c=a.y,d=a.y+b.height;var e;this.RTL?(e=a.x-b.width,a=a.x):(e=a.x,a=a.x+b.width);return new Rect$$module$build$src$core$utils$rect(c,d,e,a);}},{key:"updateMovable",value:function updateMovable(){this.isMovable()?addClass$$module$build$src$core$utils$dom(this.svgGroup_,"blocklyDraggable"):removeClass$$module$build$src$core$utils$dom(this.svgGroup_,"blocklyDraggable");}},{key:"setMovable",value:function setMovable(a){_get(_getPrototypeOf(WorkspaceCommentSvg$$module$build$src$core$workspace_comment_svg.prototype),"setMovable",this).call(this,a);this.updateMovable();}},{key:"setEditable",value:function setEditable(a){_get(_getPrototypeOf(WorkspaceCommentSvg$$module$build$src$core$workspace_comment_svg.prototype),"setEditable",this).call(this,a);this.textarea_&&(this.textarea_.readOnly=!a);}},{key:"setDragging",value:function setDragging(a){a?(a=this.getSvgRoot(),a.translate_="",a.skew_="",addClass$$module$build$src$core$utils$dom(this.svgGroup_,"blocklyDragging")):removeClass$$module$build$src$core$utils$dom(this.svgGroup_,"blocklyDragging");}},{key:"getSvgRoot",value:function getSvgRoot(){return this.svgGroup_;}},{key:"getContent",value:function getContent(){return this.textarea_?this.textarea_.value:this.content_;}},{key:"setContent",value:function setContent(a){_get(_getPrototypeOf(WorkspaceCommentSvg$$module$build$src$core$workspace_comment_svg.prototype),"setContent",this).call(this,a);this.textarea_&&(this.textarea_.value=a);}},{key:"setDeleteStyle",value:function setDeleteStyle(a){a?addClass$$module$build$src$core$utils$dom(this.svgGroup_,"blocklyDraggingDelete"):removeClass$$module$build$src$core$utils$dom(this.svgGroup_,"blocklyDraggingDelete");}},{key:"setAutoLayout",value:function setAutoLayout(a){}},{key:"toXmlWithXY",value:function toXmlWithXY(a){var b=0;this.workspace.RTL&&(b=this.workspace.getWidth());a=this.toXml(a);var c=this.getRelativeToSurfaceXY();a.setAttribute("x",Math.round(this.workspace.RTL?b-c.x:c.x));a.setAttribute("y",Math.round(c.y));a.setAttribute("h",this.getHeight());a.setAttribute("w",this.getWidth());return a;}},{key:"toCopyData",value:function toCopyData(){return{saveInfo:this.toXmlWithXY(),source:this.workspace,typeCounts:null};}},{key:"getHeightWidth",value:function getHeightWidth(){return{width:this.getWidth(),height:this.getHeight()};}},{key:"render",value:function render(){if(!this.rendered_){var a=this.getHeightWidth();this.createEditor_();this.svgGroup_.appendChild(this.foreignObject_);this.svgHandleTarget_=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.RECT,{"class":"blocklyCommentHandleTarget",x:0,y:0});this.svgGroup_.appendChild(this.svgHandleTarget_);this.svgRectTarget_=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.RECT,{"class":"blocklyCommentTarget",x:0,y:0,rx:BORDER_RADIUS$$module$build$src$core$workspace_comment_svg,ry:BORDER_RADIUS$$module$build$src$core$workspace_comment_svg});this.svgGroup_.appendChild(this.svgRectTarget_);this.addResizeDom_();this.isDeletable()&&this.addDeleteDom_();this.setSize_(a.width,a.height);this.textarea_.value=this.content_;this.rendered_=!0;this.resizeGroup_&&conditionalBind$$module$build$src$core$browser_events(this.resizeGroup_,"mousedown",this,this.resizeMouseDown_);this.isDeletable()&&(conditionalBind$$module$build$src$core$browser_events(this.deleteGroup_,"mousedown",this,this.deleteMouseDown_),conditionalBind$$module$build$src$core$browser_events(this.deleteGroup_,"mouseout",this,this.deleteMouseOut_),conditionalBind$$module$build$src$core$browser_events(this.deleteGroup_,"mouseup",this,this.deleteMouseUp_));}}},{key:"createEditor_",value:function createEditor_(){this.foreignObject_=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.FOREIGNOBJECT,{x:0,y:WorkspaceCommentSvg$$module$build$src$core$workspace_comment_svg.TOP_OFFSET,"class":"blocklyCommentForeignObject"});var a=document.createElementNS(HTML_NS$$module$build$src$core$utils$dom,"body");a.setAttribute("xmlns",HTML_NS$$module$build$src$core$utils$dom);a.className="blocklyMinimalBody";var b=document.createElementNS(HTML_NS$$module$build$src$core$utils$dom,"textarea");b.className="blocklyCommentTextarea";b.setAttribute("dir",this.RTL?"RTL":"LTR");b.readOnly=!this.isEditable();a.appendChild(b);this.textarea_=b;this.foreignObject_.appendChild(a);conditionalBind$$module$build$src$core$browser_events(b,"wheel",this,function(c){c.stopPropagation();});conditionalBind$$module$build$src$core$browser_events(b,"change",this,function(c){this.setContent(b.value);});return this.foreignObject_;}},{key:"addResizeDom_",value:function addResizeDom_(){this.resizeGroup_=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.G,{"class":this.RTL?"blocklyResizeSW":"blocklyResizeSE"},this.svgGroup_);createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.POLYGON,{points:"0,x x,x x,0".replace(/x/g,RESIZE_SIZE$$module$build$src$core$workspace_comment_svg.toString())},this.resizeGroup_);createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.LINE,{"class":"blocklyResizeLine",x1:RESIZE_SIZE$$module$build$src$core$workspace_comment_svg/3,y1:RESIZE_SIZE$$module$build$src$core$workspace_comment_svg-1,x2:RESIZE_SIZE$$module$build$src$core$workspace_comment_svg-1,y2:RESIZE_SIZE$$module$build$src$core$workspace_comment_svg/3},this.resizeGroup_);createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.LINE,{"class":"blocklyResizeLine",x1:2*RESIZE_SIZE$$module$build$src$core$workspace_comment_svg/3,y1:RESIZE_SIZE$$module$build$src$core$workspace_comment_svg-1,x2:RESIZE_SIZE$$module$build$src$core$workspace_comment_svg-1,y2:2*RESIZE_SIZE$$module$build$src$core$workspace_comment_svg/3},this.resizeGroup_);}},{key:"addDeleteDom_",value:function addDeleteDom_(){this.deleteGroup_=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.G,{"class":"blocklyCommentDeleteIcon"},this.svgGroup_);this.deleteIconBorder_=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.CIRCLE,{"class":"blocklyDeleteIconShape",r:"7",cx:"7.5",cy:"7.5"},this.deleteGroup_);createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.LINE,{x1:"5",y1:"10",x2:"10",y2:"5",stroke:"#fff","stroke-width":"2"},this.deleteGroup_);createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.LINE,{x1:"5",y1:"5",x2:"10",y2:"10",stroke:"#fff","stroke-width":"2"},this.deleteGroup_);}},{key:"resizeMouseDown_",value:function resizeMouseDown_(a){this.unbindDragEvents_();isRightButton$$module$build$src$core$browser_events(a)||(this.workspace.startDrag(a,new Coordinate$$module$build$src$core$utils$coordinate(this.workspace.RTL?-this.width_:this.width_,this.height_)),this.onMouseUpWrapper_=conditionalBind$$module$build$src$core$browser_events(document,"mouseup",this,this.resizeMouseUp_),this.onMouseMoveWrapper_=conditionalBind$$module$build$src$core$browser_events(document,"mousemove",this,this.resizeMouseMove_),this.workspace.hideChaff());a.stopPropagation();}},{key:"deleteMouseDown_",value:function deleteMouseDown_(a){this.deleteIconBorder_&&addClass$$module$build$src$core$utils$dom(this.deleteIconBorder_,"blocklyDeleteIconHighlighted");a.stopPropagation();}},{key:"deleteMouseOut_",value:function deleteMouseOut_(a){this.deleteIconBorder_&&removeClass$$module$build$src$core$utils$dom(this.deleteIconBorder_,"blocklyDeleteIconHighlighted");}},{key:"deleteMouseUp_",value:function deleteMouseUp_(a){this.dispose();a.stopPropagation();}},{key:"unbindDragEvents_",value:function unbindDragEvents_(){this.onMouseUpWrapper_&&(unbind$$module$build$src$core$browser_events(this.onMouseUpWrapper_),this.onMouseUpWrapper_=null);this.onMouseMoveWrapper_&&(unbind$$module$build$src$core$browser_events(this.onMouseMoveWrapper_),this.onMouseMoveWrapper_=null);}},{key:"resizeMouseUp_",value:function resizeMouseUp_(a){clearTouchIdentifier$$module$build$src$core$touch();this.unbindDragEvents_();}},{key:"resizeMouseMove_",value:function resizeMouseMove_(a){this.autoLayout_=!1;a=this.workspace.moveDrag(a);this.setSize_(this.RTL?-a.x:a.x,a.y);}},{key:"resizeComment_",value:function resizeComment_(){var a=this.getHeightWidth(),b=WorkspaceCommentSvg$$module$build$src$core$workspace_comment_svg.TOP_OFFSET,c=2*TEXTAREA_OFFSET$$module$build$src$core$workspace_comment_svg;this.foreignObject_.setAttribute("width",a.width);this.foreignObject_.setAttribute("height",(a.height-b).toString());this.RTL&&this.foreignObject_.setAttribute("x",(-a.width).toString());this.textarea_.style.width=a.width-c+"px";this.textarea_.style.height=a.height-c-b+"px";}},{key:"setSize_",value:function setSize_(a,b){a=Math.max(a,45);b=Math.max(b,20+WorkspaceCommentSvg$$module$build$src$core$workspace_comment_svg.TOP_OFFSET);this.width_=a;this.height_=b;this.svgRect_.setAttribute("width",a);this.svgRect_.setAttribute("height",b);this.svgRectTarget_.setAttribute("width",a);this.svgRectTarget_.setAttribute("height",b);this.svgHandleTarget_.setAttribute("width",a);this.svgHandleTarget_.setAttribute("height",WorkspaceCommentSvg$$module$build$src$core$workspace_comment_svg.TOP_OFFSET);this.RTL&&(this.svgRect_.setAttribute("transform","scale(-1 1)"),this.svgRectTarget_.setAttribute("transform","scale(-1 1)"));this.resizeGroup_&&(this.RTL?(this.resizeGroup_.setAttribute("transform","translate("+(-a+RESIZE_SIZE$$module$build$src$core$workspace_comment_svg)+","+(b-RESIZE_SIZE$$module$build$src$core$workspace_comment_svg)+") scale(-1 1)"),this.deleteGroup_.setAttribute("transform","translate("+(-a+RESIZE_SIZE$$module$build$src$core$workspace_comment_svg)+","+-RESIZE_SIZE$$module$build$src$core$workspace_comment_svg+") scale(-1 1)")):(this.resizeGroup_.setAttribute("transform","translate("+(a-RESIZE_SIZE$$module$build$src$core$workspace_comment_svg)+","+(b-RESIZE_SIZE$$module$build$src$core$workspace_comment_svg)+")"),this.deleteGroup_.setAttribute("transform","translate("+(a-RESIZE_SIZE$$module$build$src$core$workspace_comment_svg)+","+-RESIZE_SIZE$$module$build$src$core$workspace_comment_svg+")")));this.resizeComment_();}},{key:"disposeInternal_",value:function disposeInternal_(){this.svgHandleTarget_=this.svgRectTarget_=this.foreignObject_=this.textarea_=null;this.disposed_=!0;}},{key:"setFocus",value:function setFocus(){var _this6=this;this.focused_=!0;setTimeout(function(){_this6.disposed_||(_this6.textarea_.focus(),_this6.addFocus(),_this6.svgRectTarget_&&addClass$$module$build$src$core$utils$dom(_this6.svgRectTarget_,"blocklyCommentTargetFocused"),_this6.svgHandleTarget_&&addClass$$module$build$src$core$utils$dom(_this6.svgHandleTarget_,"blocklyCommentHandleTargetFocused"));},0);}},{key:"blurFocus",value:function blurFocus(){var _this7=this;this.focused_=!1;setTimeout(function(){_this7.disposed_||(_this7.textarea_.blur(),_this7.removeFocus(),_this7.svgRectTarget_&&removeClass$$module$build$src$core$utils$dom(_this7.svgRectTarget_,"blocklyCommentTargetFocused"),_this7.svgHandleTarget_&&removeClass$$module$build$src$core$utils$dom(_this7.svgHandleTarget_,"blocklyCommentHandleTargetFocused"));},0);}}],[{key:"fromXmlRendered",value:function fromXmlRendered(a,b,c){disable$$module$build$src$core$events$utils();var d;try{var e=WorkspaceComment$$module$build$src$core$workspace_comment.parseAttributes(a);d=new WorkspaceCommentSvg$$module$build$src$core$workspace_comment_svg(b,e.content,e.h,e.w,e.id);b.rendered&&(d.initSvg(!0),d.render());if(!isNaN(e.x)&&!isNaN(e.y))if(b.RTL){var f=c||b.getWidth();d.moveBy(f-e.x,e.y);}else d.moveBy(e.x,e.y);}finally{enable$$module$build$src$core$events$utils();}WorkspaceComment$$module$build$src$core$workspace_comment.fireCreateEvent(d);return d;}}]);return WorkspaceCommentSvg$$module$build$src$core$workspace_comment_svg;}(WorkspaceComment$$module$build$src$core$workspace_comment);WorkspaceCommentSvg$$module$build$src$core$workspace_comment_svg.DEFAULT_SIZE=100;WorkspaceCommentSvg$$module$build$src$core$workspace_comment_svg.TOP_OFFSET=10;register$$module$build$src$core$css("\n.blocklyCommentForeignObject {\n  position: relative;\n  z-index: 0;\n}\n\n.blocklyCommentRect {\n  fill: #E7DE8E;\n  stroke: #bcA903;\n  stroke-width: 1px;\n}\n\n.blocklyCommentTarget {\n  fill: transparent;\n  stroke: #bcA903;\n}\n\n.blocklyCommentTargetFocused {\n  fill: none;\n}\n\n.blocklyCommentHandleTarget {\n  fill: none;\n}\n\n.blocklyCommentHandleTargetFocused {\n  fill: transparent;\n}\n\n.blocklyFocused>.blocklyCommentRect {\n  fill: #B9B272;\n  stroke: #B9B272;\n}\n\n.blocklySelected>.blocklyCommentTarget {\n  stroke: #fc3;\n  stroke-width: 3px;\n}\n\n.blocklyCommentDeleteIcon {\n  cursor: pointer;\n  fill: #000;\n  display: none;\n}\n\n.blocklySelected > .blocklyCommentDeleteIcon {\n  display: block;\n}\n\n.blocklyDeleteIconShape {\n  fill: #000;\n  stroke: #000;\n  stroke-width: 1px;\n}\n\n.blocklyDeleteIconShape.blocklyDeleteIconHighlighted {\n  stroke: #fc3;\n}\n");var module$build$src$core$workspace_comment_svg={};module$build$src$core$workspace_comment_svg.WorkspaceCommentSvg=WorkspaceCommentSvg$$module$build$src$core$workspace_comment_svg;$.module$build$src$core$xml={};$.module$build$src$core$xml.appendDomToWorkspace=appendDomToWorkspace$$module$build$src$core$xml;$.module$build$src$core$xml.blockToDom=blockToDom$$module$build$src$core$xml;$.module$build$src$core$xml.blockToDomWithXY=blockToDomWithXY$$module$build$src$core$xml;$.module$build$src$core$xml.clearWorkspaceAndLoadFromXml=clearWorkspaceAndLoadFromXml$$module$build$src$core$xml;$.module$build$src$core$xml.deleteNext=deleteNext$$module$build$src$core$xml;$.module$build$src$core$xml.domToBlock=domToBlock$$module$build$src$core$xml;$.module$build$src$core$xml.domToPrettyText=domToPrettyText$$module$build$src$core$xml;$.module$build$src$core$xml.domToText=domToText$$module$build$src$core$xml;$.module$build$src$core$xml.domToVariables=domToVariables$$module$build$src$core$xml;$.module$build$src$core$xml.domToWorkspace=domToWorkspace$$module$build$src$core$xml;$.module$build$src$core$xml.textToDom=textToDom$$module$build$src$core$xml;$.module$build$src$core$xml.variablesToDom=variablesToDom$$module$build$src$core$xml;$.module$build$src$core$xml.workspaceToDom=workspaceToDom$$module$build$src$core$xml;var BlockBase$$module$build$src$core$events$events_block_base=/*#__PURE__*/function(_Abstract$$module$bui3){_inherits(BlockBase$$module$build$src$core$events$events_block_base,_Abstract$$module$bui3);var _super6=_createSuper(BlockBase$$module$build$src$core$events$events_block_base);function BlockBase$$module$build$src$core$events$events_block_base(a){var _this8;_classCallCheck(this,BlockBase$$module$build$src$core$events$events_block_base);_this8=_super6.call(this);_this8.isBlank=!!a;a&&(_this8.blockId=a.id,_this8.workspaceId=a.workspace.id);return _this8;}_createClass(BlockBase$$module$build$src$core$events$events_block_base,[{key:"toJson",value:function toJson(){var a=_get(_getPrototypeOf(BlockBase$$module$build$src$core$events$events_block_base.prototype),"toJson",this).call(this);if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");a.blockId=this.blockId;return a;}},{key:"fromJson",value:function fromJson(a){_get(_getPrototypeOf(BlockBase$$module$build$src$core$events$events_block_base.prototype),"fromJson",this).call(this,a);this.blockId=a.blockId;}}]);return BlockBase$$module$build$src$core$events$events_block_base;}(Abstract$$module$build$src$core$events$events_abstract),module$build$src$core$events$events_block_base={};module$build$src$core$events$events_block_base.BlockBase=BlockBase$$module$build$src$core$events$events_block_base;var BlockChange$$module$build$src$core$events$events_block_change=/*#__PURE__*/function(_BlockBase$$module$bu){_inherits(BlockChange$$module$build$src$core$events$events_block_change,_BlockBase$$module$bu);var _super7=_createSuper(BlockChange$$module$build$src$core$events$events_block_change);function BlockChange$$module$build$src$core$events$events_block_change(a,b,c,d,e){var _this9;_classCallCheck(this,BlockChange$$module$build$src$core$events$events_block_change);_this9=_super7.call(this,a);_this9.type=CHANGE$$module$build$src$core$events$utils;a&&(_this9.element=b,_this9.name=c||void 0,_this9.oldValue=d,_this9.newValue=e);return _this9;}_createClass(BlockChange$$module$build$src$core$events$events_block_change,[{key:"toJson",value:function toJson(){var a=_get(_getPrototypeOf(BlockChange$$module$build$src$core$events$events_block_change.prototype),"toJson",this).call(this);if(!this.element)throw Error("The changed element is undefined. Either pass an element to the constructor, or call fromJson");a.element=this.element;a.name=this.name;a.oldValue=this.oldValue;a.newValue=this.newValue;return a;}},{key:"fromJson",value:function fromJson(a){_get(_getPrototypeOf(BlockChange$$module$build$src$core$events$events_block_change.prototype),"fromJson",this).call(this,a);this.element=a.element;this.name=a.name;this.oldValue=a.oldValue;this.newValue=a.newValue;}},{key:"isNull",value:function isNull(){return this.oldValue===this.newValue;}},{key:"run",value:function run(a){var b=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");b=b.getBlockById(this.blockId);if(!b)throw Error("The associated block is undefined. Either pass a block to the constructor, or call fromJson");b.mutator&&b.mutator.setVisible(!1);a=a?this.newValue:this.oldValue;switch(this.element){case"field":(b=b.getField(this.name))?b.setValue(a):console.warn("Can't set non-existent field: "+this.name);break;case"comment":b.setCommentText(a||null);break;case"collapsed":b.setCollapsed(!!a);break;case"disabled":b.setEnabled(!a);break;case"inline":b.setInputsInline(!!a);break;case"mutation":var c=BlockChange$$module$build$src$core$events$events_block_change.getExtraBlockState_(b);b.loadExtraState?b.loadExtraState(JSON.parse(a||"{}")):b.domToMutation&&b.domToMutation(textToDom$$module$build$src$core$xml(a||"<mutation/>"));fire$$module$build$src$core$events$utils(new BlockChange$$module$build$src$core$events$events_block_change(b,"mutation",null,c,a));break;default:console.warn("Unknown change type: "+this.element);}}}],[{key:"getExtraBlockState_",value:function getExtraBlockState_(a){return a.saveExtraState?(a=a.saveExtraState())?JSON.stringify(a):"":a.mutationToDom?(a=a.mutationToDom())?domToText$$module$build$src$core$xml(a):"":"";}}]);return BlockChange$$module$build$src$core$events$events_block_change;}(BlockBase$$module$build$src$core$events$events_block_base);register$$module$build$src$core$registry(Type$$module$build$src$core$registry.EVENT,CHANGE$$module$build$src$core$events$utils,BlockChange$$module$build$src$core$events$events_block_change);var module$build$src$core$events$events_block_change={};module$build$src$core$events$events_block_change.BlockChange=BlockChange$$module$build$src$core$events$events_block_change;var MarkerManager$$module$build$src$core$marker_manager=/*#__PURE__*/function(){function MarkerManager$$module$build$src$core$marker_manager(a){_classCallCheck(this,MarkerManager$$module$build$src$core$marker_manager);this.workspace=a;this.cursorSvg_=this.cursor_=null;this.markers=new Map();this.markerSvg_=null;}_createClass(MarkerManager$$module$build$src$core$marker_manager,[{key:"registerMarker",value:function registerMarker(a,b){this.markers.has(a)&&this.unregisterMarker(a);b.setDrawer(this.workspace.getRenderer().makeMarkerDrawer(this.workspace,b));this.setMarkerSvg(b.getDrawer().createDom());this.markers.set(a,b);}},{key:"unregisterMarker",value:function unregisterMarker(a){var b=this.markers.get(a);if(b)b.dispose(),this.markers["delete"](a);else throw Error("Marker with ID "+a+" does not exist. Can only unregister markers that exist.");}},{key:"getCursor",value:function getCursor(){return this.cursor_;}},{key:"getMarker",value:function getMarker(a){return this.markers.get(a)||null;}},{key:"setCursor",value:function setCursor(a){this.cursor_&&this.cursor_.getDrawer()&&this.cursor_.getDrawer().dispose();if(this.cursor_=a)a=this.workspace.getRenderer().makeMarkerDrawer(this.workspace,this.cursor_),this.cursor_.setDrawer(a),this.setCursorSvg(this.cursor_.getDrawer().createDom());}},{key:"setCursorSvg",value:function setCursorSvg(a){a?(this.workspace.getBlockCanvas().appendChild(a),this.cursorSvg_=a):this.cursorSvg_=null;}},{key:"setMarkerSvg",value:function setMarkerSvg(a){a?this.workspace.getBlockCanvas()&&(this.cursorSvg_?this.workspace.getBlockCanvas().insertBefore(a,this.cursorSvg_):this.workspace.getBlockCanvas().appendChild(a)):this.markerSvg_=null;}},{key:"updateMarkers",value:function updateMarkers(){this.workspace.keyboardAccessibilityMode&&this.cursorSvg_&&this.workspace.getCursor().draw();}},{key:"dispose",value:function dispose(){var a=Object.keys(this.markers);for(var b=0,c;c=a[b];b++){this.unregisterMarker(c);}this.markers.clear();this.cursor_&&(this.cursor_.dispose(),this.cursor_=null);}}]);return MarkerManager$$module$build$src$core$marker_manager;}();MarkerManager$$module$build$src$core$marker_manager.LOCAL_MARKER="local_marker_1";var module$build$src$core$marker_manager={};module$build$src$core$marker_manager.MarkerManager=MarkerManager$$module$build$src$core$marker_manager;$.module$build$src$core$utils$string={};$.module$build$src$core$utils$string.commonWordPrefix=commonWordPrefix$$module$build$src$core$utils$string;$.module$build$src$core$utils$string.commonWordSuffix=commonWordSuffix$$module$build$src$core$utils$string;$.module$build$src$core$utils$string.isNumber=isNumber$$module$build$src$core$utils$string;$.module$build$src$core$utils$string.shortestStringLength=shortestStringLength$$module$build$src$core$utils$string;$.module$build$src$core$utils$string.startsWith=startsWith$$module$build$src$core$utils$string;$.module$build$src$core$utils$string.wrap=wrap$$module$build$src$core$utils$string;var customTooltip$$module$build$src$core$tooltip=void 0,visible$$module$build$src$core$tooltip=!1,blocked$$module$build$src$core$tooltip=!1,LIMIT$$module$build$src$core$tooltip=50,mouseOutPid$$module$build$src$core$tooltip=0,showPid$$module$build$src$core$tooltip=0,lastX$$module$build$src$core$tooltip=0,lastY$$module$build$src$core$tooltip=0,element$$module$build$src$core$tooltip=null,poisonedElement$$module$build$src$core$tooltip=null,OFFSET_X$$module$build$src$core$tooltip=0,OFFSET_Y$$module$build$src$core$tooltip=10,RADIUS_OK$$module$build$src$core$tooltip=10,HOVER_MS$$module$build$src$core$tooltip=750,MARGINS$$module$build$src$core$tooltip=5,containerDiv$$module$build$src$core$tooltip=null,module$build$src$core$tooltip={};module$build$src$core$tooltip.HOVER_MS=HOVER_MS$$module$build$src$core$tooltip;module$build$src$core$tooltip.LIMIT=LIMIT$$module$build$src$core$tooltip;module$build$src$core$tooltip.MARGINS=MARGINS$$module$build$src$core$tooltip;module$build$src$core$tooltip.OFFSET_X=OFFSET_X$$module$build$src$core$tooltip;module$build$src$core$tooltip.OFFSET_Y=OFFSET_Y$$module$build$src$core$tooltip;module$build$src$core$tooltip.RADIUS_OK=RADIUS_OK$$module$build$src$core$tooltip;module$build$src$core$tooltip.bindMouseEvents=bindMouseEvents$$module$build$src$core$tooltip;module$build$src$core$tooltip.block=block$$module$build$src$core$tooltip;module$build$src$core$tooltip.createDom=createDom$$module$build$src$core$tooltip;module$build$src$core$tooltip.dispose=dispose$$module$build$src$core$tooltip;module$build$src$core$tooltip.getCustomTooltip=getCustomTooltip$$module$build$src$core$tooltip;module$build$src$core$tooltip.getDiv=getDiv$$module$build$src$core$tooltip;module$build$src$core$tooltip.getTooltipOfObject=getTooltipOfObject$$module$build$src$core$tooltip;module$build$src$core$tooltip.hide=hide$$module$build$src$core$tooltip;module$build$src$core$tooltip.isVisible=isVisible$$module$build$src$core$tooltip;module$build$src$core$tooltip.setCustomTooltip=setCustomTooltip$$module$build$src$core$tooltip;module$build$src$core$tooltip.unbindMouseEvents=unbindMouseEvents$$module$build$src$core$tooltip;module$build$src$core$tooltip.unblock=unblock$$module$build$src$core$tooltip;var hsvSaturation$$module$build$src$core$utils$colour=.45,hsvValue$$module$build$src$core$utils$colour=.65,names$$module$build$src$core$utils$colour={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00"},module$build$src$core$utils$colour={};module$build$src$core$utils$colour.blend=blend$$module$build$src$core$utils$colour;module$build$src$core$utils$colour.getHsvSaturation=getHsvSaturation$$module$build$src$core$utils$colour;module$build$src$core$utils$colour.getHsvValue=getHsvValue$$module$build$src$core$utils$colour;module$build$src$core$utils$colour.hexToRgb=hexToRgb$$module$build$src$core$utils$colour;module$build$src$core$utils$colour.hsvToHex=hsvToHex$$module$build$src$core$utils$colour;module$build$src$core$utils$colour.hueToHex=hueToHex$$module$build$src$core$utils$colour;module$build$src$core$utils$colour.names=names$$module$build$src$core$utils$colour;module$build$src$core$utils$colour.parse=parse$$module$build$src$core$utils$colour;module$build$src$core$utils$colour.rgbToHex=rgbToHex$$module$build$src$core$utils$colour;module$build$src$core$utils$colour.setHsvSaturation=setHsvSaturation$$module$build$src$core$utils$colour;module$build$src$core$utils$colour.setHsvValue=setHsvValue$$module$build$src$core$utils$colour;var module$build$src$core$utils$parsing={};module$build$src$core$utils$parsing.checkMessageReferences=checkMessageReferences$$module$build$src$core$utils$parsing;module$build$src$core$utils$parsing.parseBlockColour=parseBlockColour$$module$build$src$core$utils$parsing;module$build$src$core$utils$parsing.replaceMessageReferences=replaceMessageReferences$$module$build$src$core$utils$parsing;module$build$src$core$utils$parsing.tokenizeInterpolation=tokenizeInterpolation$$module$build$src$core$utils$parsing;var Sentinel$$module$build$src$core$utils$sentinel=/*#__PURE__*/_createClass(function Sentinel$$module$build$src$core$utils$sentinel(){_classCallCheck(this,Sentinel$$module$build$src$core$utils$sentinel);}),module$build$src$core$utils$sentinel={};module$build$src$core$utils$sentinel.Sentinel=Sentinel$$module$build$src$core$utils$sentinel;var owner$$module$build$src$core$widgetdiv=null,dispose$$module$build$src$core$widgetdiv=null,rendererClassName$$module$build$src$core$widgetdiv="",themeClassName$$module$build$src$core$widgetdiv="",containerDiv$$module$build$src$core$widgetdiv,module$build$src$core$widgetdiv={};module$build$src$core$widgetdiv.createDom=createDom$$module$build$src$core$widgetdiv;module$build$src$core$widgetdiv.getDiv=getDiv$$module$build$src$core$widgetdiv;module$build$src$core$widgetdiv.hide=hide$$module$build$src$core$widgetdiv;module$build$src$core$widgetdiv.hideIfOwner=hideIfOwner$$module$build$src$core$widgetdiv;module$build$src$core$widgetdiv.isVisible=isVisible$$module$build$src$core$widgetdiv;module$build$src$core$widgetdiv.positionWithAnchor=positionWithAnchor$$module$build$src$core$widgetdiv;module$build$src$core$widgetdiv.show=show$$module$build$src$core$widgetdiv;module$build$src$core$widgetdiv.testOnly_setDiv=testOnly_setDiv$$module$build$src$core$widgetdiv;var Field$$module$build$src$core$field=/*#__PURE__*/function(){function Field$$module$build$src$core$field(a,b,c){_classCallCheck(this,Field$$module$build$src$core$field);this.name=void 0;this.constants_=this.mouseDownWrapper_=this.textContent_=this.textElement_=this.borderRect_=this.fieldGroup_=this.markerSvg_=this.cursorSvg_=this.tooltip_=this.validator_=null;this.disposed=!1;this.maxDisplayLength=50;this.sourceBlock_=null;this.enabled_=this.visible_=this.isDirty_=!0;this.suffixField=this.prefixField=this.clickTarget_=null;this.EDITABLE=!0;this.SERIALIZABLE=!1;this.CURSOR="";this.value_="DEFAULT_VALUE"in(this instanceof Field$$module$build$src$core$field?this.constructor:void 0).prototype?(this instanceof Field$$module$build$src$core$field?this.constructor:void 0).prototype.DEFAULT_VALUE:null;this.size_=new Size$$module$build$src$core$utils$size(0,0);a!==Field$$module$build$src$core$field.SKIP_SETUP&&(c&&this.configure_(c),this.setValue(a),b&&this.setValidator(b));}_createClass(Field$$module$build$src$core$field,[{key:"configure_",value:function configure_(a){a.tooltip&&this.setTooltip(replaceMessageReferences$$module$build$src$core$utils$parsing(a.tooltip));}},{key:"setSourceBlock",value:function setSourceBlock(a){if(this.sourceBlock_)throw Error("Field already bound to a block");this.sourceBlock_=a;}},{key:"getConstants",value:function getConstants(){!this.constants_&&this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying()&&this.sourceBlock_.workspace.rendered&&(this.constants_=this.sourceBlock_.workspace.getRenderer().getConstants());return this.constants_;}},{key:"getSourceBlock",value:function getSourceBlock(){return this.sourceBlock_;}},{key:"init",value:function init(){this.fieldGroup_||(this.fieldGroup_=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.G,{}),this.isVisible()||(this.fieldGroup_.style.display="none"),this.sourceBlock_.getSvgRoot().appendChild(this.fieldGroup_),this.initView(),this.updateEditable(),this.setTooltip(this.tooltip_),this.bindEvents_(),this.initModel());}},{key:"initView",value:function initView(){this.createBorderRect_();this.createTextElement_();}},{key:"initModel",value:function initModel(){}},{key:"createBorderRect_",value:function createBorderRect_(){this.borderRect_=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.RECT,{rx:this.getConstants().FIELD_BORDER_RECT_RADIUS,ry:this.getConstants().FIELD_BORDER_RECT_RADIUS,x:0,y:0,height:this.size_.height,width:this.size_.width,"class":"blocklyFieldRect"},this.fieldGroup_);}},{key:"createTextElement_",value:function createTextElement_(){this.textElement_=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.TEXT,{"class":"blocklyText"},this.fieldGroup_);this.getConstants().FIELD_TEXT_BASELINE_CENTER&&this.textElement_.setAttribute("dominant-baseline","central");this.textContent_=document.createTextNode("");this.textElement_.appendChild(this.textContent_);}},{key:"bindEvents_",value:function bindEvents_(){var a=this.getClickTarget_();if(!a)throw Error("A click target has not been set.");bindMouseEvents$$module$build$src$core$tooltip(a);this.mouseDownWrapper_=conditionalBind$$module$build$src$core$browser_events(a,"mousedown",this,this.onMouseDown_);}},{key:"fromXml",value:function fromXml(a){this.setValue(a.textContent);}},{key:"toXml",value:function toXml(a){a.textContent=this.getValue();return a;}},{key:"saveState",value:function saveState(a){a=this.saveLegacyState(Field$$module$build$src$core$field);return null!==a?a:this.getValue();}},{key:"loadState",value:function loadState(a){this.loadLegacyState(Field$$module$build$src$core$field,a)||this.setValue(a);}},{key:"saveLegacyState",value:function saveLegacyState(a){return a.prototype.saveState===this.saveState&&a.prototype.toXml!==this.toXml?(a=createElement$$module$build$src$core$utils$xml("field"),a.setAttribute("name",this.name||""),domToText$$module$build$src$core$xml(this.toXml(a)).replace(' xmlns="https://developers.google.com/blockly/xml"',"")):null;}},{key:"loadLegacyState",value:function loadLegacyState(a,b){return a.prototype.loadState===this.loadState&&a.prototype.fromXml!==this.fromXml?(this.fromXml(textToDom$$module$build$src$core$xml(b)),!0):!1;}},{key:"dispose",value:function dispose(){hideIfOwner$$module$build$src$core$dropdowndiv(this);hideIfOwner$$module$build$src$core$widgetdiv(this);unbindMouseEvents$$module$build$src$core$tooltip(this.getClickTarget_());this.mouseDownWrapper_&&unbind$$module$build$src$core$browser_events(this.mouseDownWrapper_);removeNode$$module$build$src$core$utils$dom(this.fieldGroup_);this.disposed=!0;}},{key:"updateEditable",value:function updateEditable(){var a=this.fieldGroup_,b=this.getSourceBlock();this.EDITABLE&&a&&b&&(this.enabled_&&b.isEditable()?(addClass$$module$build$src$core$utils$dom(a,"blocklyEditableText"),removeClass$$module$build$src$core$utils$dom(a,"blocklyNonEditableText"),a.style.cursor=this.CURSOR):(addClass$$module$build$src$core$utils$dom(a,"blocklyNonEditableText"),removeClass$$module$build$src$core$utils$dom(a,"blocklyEditableText"),a.style.cursor=""));}},{key:"setEnabled",value:function setEnabled(a){this.enabled_=a;this.updateEditable();}},{key:"isEnabled",value:function isEnabled(){return this.enabled_;}},{key:"isClickable",value:function isClickable(){return this.enabled_&&!!this.sourceBlock_&&this.sourceBlock_.isEditable()&&this.showEditor_!==Field$$module$build$src$core$field.prototype.showEditor_;}},{key:"isCurrentlyEditable",value:function isCurrentlyEditable(){return this.enabled_&&this.EDITABLE&&!!this.sourceBlock_&&this.sourceBlock_.isEditable();}},{key:"isSerializable",value:function isSerializable(){var a=!1;this.name&&(this.SERIALIZABLE?a=!0:this.EDITABLE&&(console.warn("Detected an editable field that was not serializable. Please define SERIALIZABLE property as true on all editable custom fields. Proceeding with serialization."),a=!0));return a;}},{key:"isVisible",value:function isVisible(){return this.visible_;}},{key:"setVisible",value:function setVisible(a){if(this.visible_!==a){this.visible_=a;var b=this.fieldGroup_;b&&(b.style.display=a?"block":"none");}}},{key:"setValidator",value:function setValidator(a){this.validator_=a;}},{key:"getValidator",value:function getValidator(){return this.validator_;}},{key:"getSvgRoot",value:function getSvgRoot(){return this.fieldGroup_;}},{key:"getBorderRect",value:function getBorderRect(){if(!this.borderRect_)throw Error("The border rectangle is ".concat(this.borderRect_,"."));return this.borderRect_;}},{key:"getTextElement",value:function getTextElement(){if(!this.textElement_)throw Error("The text element is ".concat(this.textElement_,"."));return this.textElement_;}},{key:"getTextContent",value:function getTextContent(){if(!this.textContent_)throw Error("The text content is ".concat(this.textContent_,"."));return this.textContent_;}},{key:"applyColour",value:function applyColour(){}},{key:"render_",value:function render_(){this.textContent_&&(this.textContent_.nodeValue=this.getDisplayText_());this.updateSize_();}},{key:"showEditor",value:function showEditor(a){this.isClickable()&&this.showEditor_(a);}},{key:"showEditor_",value:function showEditor_(a){}},{key:"updateSize_",value:function updateSize_(a){var b=this.getConstants();a=void 0!==a?a:this.borderRect_?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0;var c=2*a,d=b.FIELD_TEXT_HEIGHT,e=0;this.textElement_&&(e=getFastTextWidth$$module$build$src$core$utils$dom(this.textElement_,b.FIELD_TEXT_FONTSIZE,b.FIELD_TEXT_FONTWEIGHT,b.FIELD_TEXT_FONTFAMILY),c+=e);this.borderRect_&&(d=Math.max(d,b.FIELD_BORDER_RECT_HEIGHT));this.size_.height=d;this.size_.width=c;this.positionTextElement_(a,e);this.positionBorderRect_();}},{key:"positionTextElement_",value:function positionTextElement_(a,b){if(this.textElement_){var c=this.getConstants(),d=this.size_.height/2,e;this.textElement_.setAttribute("x","".concat((null==(e=this.getSourceBlock())?0:e.RTL)?this.size_.width-b-a:a));this.textElement_.setAttribute("y","".concat(c.FIELD_TEXT_BASELINE_CENTER?d:d-c.FIELD_TEXT_HEIGHT/2+c.FIELD_TEXT_BASELINE));}}},{key:"positionBorderRect_",value:function positionBorderRect_(){this.borderRect_&&(this.borderRect_.setAttribute("width","".concat(this.size_.width)),this.borderRect_.setAttribute("height","".concat(this.size_.height)),this.borderRect_.setAttribute("rx","".concat(this.getConstants().FIELD_BORDER_RECT_RADIUS)),this.borderRect_.setAttribute("ry","".concat(this.getConstants().FIELD_BORDER_RECT_RADIUS)));}},{key:"getSize",value:function getSize(){if(!this.isVisible())return new Size$$module$build$src$core$utils$size(0,0);this.isDirty_?(this.render_(),this.isDirty_=!1):this.visible_&&0===this.size_.width&&(this.render_(),0!==this.size_.width&&console.warn("Deprecated use of setting size_.width to 0 to rerender a field. Set field.isDirty_ to true instead."));return this.size_;}},{key:"getScaledBBox",value:function getScaledBBox(){var a;var b=this.getSourceBlock();if(!b)throw new UnattachedFieldError$$module$build$src$core$field();if(this.borderRect_){var c=this.borderRect_.getBoundingClientRect();a=getPageOffset$$module$build$src$core$utils$style(this.borderRect_);b=c.width;c=c.height;}else{c=this.sourceBlock_.getHeightWidth();var d=b.workspace.scale;a=this.getAbsoluteXY_();b=(c.width+1)*d;c=(c.height+1)*d;GECKO$$module$build$src$core$utils$useragent?(a.x+=1.5*d,a.y+=1.5*d):(a.x-=.5*d,a.y-=.5*d);}return new Rect$$module$build$src$core$utils$rect(a.y,a.y+c,a.x,a.x+b);}},{key:"getDisplayText_",value:function getDisplayText_(){var a=this.getText();if(!a)return Field$$module$build$src$core$field.NBSP;a.length>this.maxDisplayLength&&(a=a.substring(0,this.maxDisplayLength-2)+"\u2026");a=a.replace(/\s/g,Field$$module$build$src$core$field.NBSP);this.sourceBlock_&&this.sourceBlock_.RTL&&(a+="\u200F");return a;}},{key:"getText",value:function getText(){var a=this.getText_();return null!==a?String(a):String(this.getValue());}},{key:"getText_",value:function getText_(){return null;}},{key:"markDirty",value:function markDirty(){this.isDirty_=!0;this.constants_=null;}},{key:"forceRerender",value:function forceRerender(){this.isDirty_=!0;this.sourceBlock_&&this.sourceBlock_.rendered&&(this.sourceBlock_.render(),this.sourceBlock_.bumpNeighbours(),this.updateMarkers_());}},{key:"setValue",value:function setValue(a){if(null!==a){var b=this.doClassValidation_(a);a=this.processValidation_(a,b);if(!(a instanceof Error)){if(b=this.getValidator())if(b=b.call(this,a),a=this.processValidation_(a,b),a instanceof Error)return;b=this.sourceBlock_;if(!b||!b.disposed){var c=this.getValue();c===a?this.doValueUpdate_(a):(this.doValueUpdate_(a),b&&isEnabled$$module$build$src$core$events$utils()&&fire$$module$build$src$core$events$utils(new(get$$module$build$src$core$events$utils(CHANGE$$module$build$src$core$events$utils))(b,"field",this.name||null,c,a)),this.isDirty_&&this.forceRerender());}}}}},{key:"processValidation_",value:function processValidation_(a,b){if(null===b)return this.doValueInvalid_(a),this.isDirty_&&this.forceRerender(),Error();void 0!==b&&(a=b);return a;}},{key:"getValue",value:function getValue(){return this.value_;}},{key:"doClassValidation_",value:function doClassValidation_(a){return null===a||void 0===a?null:a;}},{key:"doValueUpdate_",value:function doValueUpdate_(a){this.value_=a;this.isDirty_=!0;}},{key:"doValueInvalid_",value:function doValueInvalid_(a){}},{key:"onMouseDown_",value:function onMouseDown_(a){this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying()&&(a=this.sourceBlock_.workspace.getGesture(a))&&a.setStartField(this);}},{key:"setTooltip",value:function setTooltip(a){a||""===a||(a=this.sourceBlock_);var b=this.getClickTarget_();b?b.tooltip=a:this.tooltip_=a;}},{key:"getTooltip",value:function getTooltip(){var a=this.getClickTarget_();return a?getTooltipOfObject$$module$build$src$core$tooltip(a):getTooltipOfObject$$module$build$src$core$tooltip({tooltip:this.tooltip_});}},{key:"getClickTarget_",value:function getClickTarget_(){return this.clickTarget_||this.getSvgRoot();}},{key:"getAbsoluteXY_",value:function getAbsoluteXY_(){return getPageOffset$$module$build$src$core$utils$style(this.getClickTarget_());}},{key:"referencesVariables",value:function referencesVariables(){return!1;}},{key:"refreshVariableName",value:function refreshVariableName(){}},{key:"getParentInput",value:function getParentInput(){var a=null;var b=this.getSourceBlock();if(!b)throw new UnattachedFieldError$$module$build$src$core$field();var c=b.inputList;for(var d=0;d<b.inputList.length;d++){var e=c[d],f=e.fieldRow;for(var g=0;g<f.length;g++){if(f[g]===this){a=e;break;}}}return a;}},{key:"getFlipRtl",value:function getFlipRtl(){return!1;}},{key:"isTabNavigable",value:function isTabNavigable(){return!1;}},{key:"onShortcut",value:function onShortcut(a){return!1;}},{key:"setCursorSvg",value:function setCursorSvg(a){if(a){if(!this.fieldGroup_)throw Error("The field group is ".concat(this.fieldGroup_,"."));this.fieldGroup_.appendChild(a);this.cursorSvg_=a;}else this.cursorSvg_=null;}},{key:"setMarkerSvg",value:function setMarkerSvg(a){if(a){if(!this.fieldGroup_)throw Error("The field group is ".concat(this.fieldGroup_,"."));this.fieldGroup_.appendChild(a);this.markerSvg_=a;}else this.markerSvg_=null;}},{key:"updateMarkers_",value:function updateMarkers_(){var a=this.getSourceBlock();if(!a)throw new UnattachedFieldError$$module$build$src$core$field();a=a.workspace;a.keyboardAccessibilityMode&&this.cursorSvg_&&a.getCursor().draw();a.keyboardAccessibilityMode&&this.markerSvg_&&a.getMarker(MarkerManager$$module$build$src$core$marker_manager.LOCAL_MARKER).draw();}}]);return Field$$module$build$src$core$field;}();Field$$module$build$src$core$field.NBSP="\xA0";Field$$module$build$src$core$field.SKIP_SETUP=new Sentinel$$module$build$src$core$utils$sentinel();var UnattachedFieldError$$module$build$src$core$field=/*#__PURE__*/function(_Error){_inherits(UnattachedFieldError$$module$build$src$core$field,_Error);var _super8=_createSuper(UnattachedFieldError$$module$build$src$core$field);function UnattachedFieldError$$module$build$src$core$field(){_classCallCheck(this,UnattachedFieldError$$module$build$src$core$field);return _super8.call(this,"The field has not yet been attached to its input. Call appendField to attach it.");}return _createClass(UnattachedFieldError$$module$build$src$core$field);}(/*#__PURE__*/_wrapNativeSuper(Error)),module$build$src$core$field={};module$build$src$core$field.Field=Field$$module$build$src$core$field;module$build$src$core$field.UnattachedFieldError=UnattachedFieldError$$module$build$src$core$field;var TEST_ONLY$$module$build$src$core$field_registry={fromJsonInternal:fromJsonInternal$$module$build$src$core$field_registry},module$build$src$core$field_registry={};module$build$src$core$field_registry.TEST_ONLY=TEST_ONLY$$module$build$src$core$field_registry;module$build$src$core$field_registry.fromJson=fromJson$$module$build$src$core$field_registry;module$build$src$core$field_registry.register=register$$module$build$src$core$field_registry;module$build$src$core$field_registry.unregister=unregister$$module$build$src$core$field_registry;var ARIA_PREFIX$$module$build$src$core$utils$aria="aria-",ROLE_ATTRIBUTE$$module$build$src$core$utils$aria="role",Role$$module$build$src$core$utils$aria;(function(a){a.GRID="grid";a.GRIDCELL="gridcell";a.GROUP="group";a.LISTBOX="listbox";a.MENU="menu";a.MENUITEM="menuitem";a.MENUITEMCHECKBOX="menuitemcheckbox";a.OPTION="option";a.PRESENTATION="presentation";a.ROW="row";a.TREE="tree";a.TREEITEM="treeitem";})(Role$$module$build$src$core$utils$aria||(Role$$module$build$src$core$utils$aria={}));var State$$module$build$src$core$utils$aria;(function(a){a.ACTIVEDESCENDANT="activedescendant";a.COLCOUNT="colcount";a.DISABLED="disabled";a.EXPANDED="expanded";a.INVALID="invalid";a.LABEL="label";a.LABELLEDBY="labelledby";a.LEVEL="level";a.ORIENTATION="orientation";a.POSINSET="posinset";a.ROWCOUNT="rowcount";a.SELECTED="selected";a.SETSIZE="setsize";a.VALUEMAX="valuemax";a.VALUEMIN="valuemin";})(State$$module$build$src$core$utils$aria||(State$$module$build$src$core$utils$aria={}));var module$build$src$core$utils$aria={};module$build$src$core$utils$aria.Role=Role$$module$build$src$core$utils$aria;module$build$src$core$utils$aria.State=State$$module$build$src$core$utils$aria;module$build$src$core$utils$aria.setRole=setRole$$module$build$src$core$utils$aria;module$build$src$core$utils$aria.setState=setState$$module$build$src$core$utils$aria;var KeyCodes$$module$build$src$core$utils$keycodes;(function(a){a[a.WIN_KEY_FF_LINUX=0]="WIN_KEY_FF_LINUX";a[a.MAC_ENTER=3]="MAC_ENTER";a[a.BACKSPACE=8]="BACKSPACE";a[a.TAB=9]="TAB";a[a.NUM_CENTER=12]="NUM_CENTER";a[a.ENTER=13]="ENTER";a[a.SHIFT=16]="SHIFT";a[a.CTRL=17]="CTRL";a[a.ALT=18]="ALT";a[a.PAUSE=19]="PAUSE";a[a.CAPS_LOCK=20]="CAPS_LOCK";a[a.ESC=27]="ESC";a[a.SPACE=32]="SPACE";a[a.PAGE_UP=33]="PAGE_UP";a[a.PAGE_DOWN=34]="PAGE_DOWN";a[a.END=35]="END";a[a.HOME=36]="HOME";a[a.LEFT=37]="LEFT";a[a.UP=38]="UP";a[a.RIGHT=39]="RIGHT";a[a.DOWN=40]="DOWN";a[a.PLUS_SIGN=43]="PLUS_SIGN";a[a.PRINT_SCREEN=44]="PRINT_SCREEN";a[a.INSERT=45]="INSERT";a[a.DELETE=46]="DELETE";a[a.ZERO=48]="ZERO";a[a.ONE=49]="ONE";a[a.TWO=50]="TWO";a[a.THREE=51]="THREE";a[a.FOUR=52]="FOUR";a[a.FIVE=53]="FIVE";a[a.SIX=54]="SIX";a[a.SEVEN=55]="SEVEN";a[a.EIGHT=56]="EIGHT";a[a.NINE=57]="NINE";a[a.FF_SEMICOLON=59]="FF_SEMICOLON";a[a.FF_EQUALS=61]="FF_EQUALS";a[a.FF_DASH=173]="FF_DASH";a[a.FF_HASH=163]="FF_HASH";a[a.QUESTION_MARK=63]="QUESTION_MARK";a[a.AT_SIGN=64]="AT_SIGN";a[a.A=65]="A";a[a.B=66]="B";a[a.C=67]="C";a[a.D=68]="D";a[a.E=69]="E";a[a.F=70]="F";a[a.G=71]="G";a[a.H=72]="H";a[a.I=73]="I";a[a.J=74]="J";a[a.K=75]="K";a[a.L=76]="L";a[a.M=77]="M";a[a.N=78]="N";a[a.O=79]="O";a[a.P=80]="P";a[a.Q=81]="Q";a[a.R=82]="R";a[a.S=83]="S";a[a.T=84]="T";a[a.U=85]="U";a[a.V=86]="V";a[a.W=87]="W";a[a.X=88]="X";a[a.Y=89]="Y";a[a.Z=90]="Z";a[a.META=91]="META";a[a.WIN_KEY_RIGHT=92]="WIN_KEY_RIGHT";a[a.CONTEXT_MENU=93]="CONTEXT_MENU";a[a.NUM_ZERO=96]="NUM_ZERO";a[a.NUM_ONE=97]="NUM_ONE";a[a.NUM_TWO=98]="NUM_TWO";a[a.NUM_THREE=99]="NUM_THREE";a[a.NUM_FOUR=100]="NUM_FOUR";a[a.NUM_FIVE=101]="NUM_FIVE";a[a.NUM_SIX=102]="NUM_SIX";a[a.NUM_SEVEN=103]="NUM_SEVEN";a[a.NUM_EIGHT=104]="NUM_EIGHT";a[a.NUM_NINE=105]="NUM_NINE";a[a.NUM_MULTIPLY=106]="NUM_MULTIPLY";a[a.NUM_PLUS=107]="NUM_PLUS";a[a.NUM_MINUS=109]="NUM_MINUS";a[a.NUM_PERIOD=110]="NUM_PERIOD";a[a.NUM_DIVISION=111]="NUM_DIVISION";a[a.F1=112]="F1";a[a.F2=113]="F2";a[a.F3=114]="F3";a[a.F4=115]="F4";a[a.F5=116]="F5";a[a.F6=117]="F6";a[a.F7=118]="F7";a[a.F8=119]="F8";a[a.F9=120]="F9";a[a.F10=121]="F10";a[a.F11=122]="F11";a[a.F12=123]="F12";a[a.NUMLOCK=144]="NUMLOCK";a[a.SCROLL_LOCK=145]="SCROLL_LOCK";a[a.FIRST_MEDIA_KEY=166]="FIRST_MEDIA_KEY";a[a.LAST_MEDIA_KEY=183]="LAST_MEDIA_KEY";a[a.SEMICOLON=186]="SEMICOLON";a[a.DASH=189]="DASH";a[a.EQUALS=187]="EQUALS";a[a.COMMA=188]="COMMA";a[a.PERIOD=190]="PERIOD";a[a.SLASH=191]="SLASH";a[a.APOSTROPHE=192]="APOSTROPHE";a[a.TILDE=192]="TILDE";a[a.SINGLE_QUOTE=222]="SINGLE_QUOTE";a[a.OPEN_SQUARE_BRACKET=219]="OPEN_SQUARE_BRACKET";a[a.BACKSLASH=220]="BACKSLASH";a[a.CLOSE_SQUARE_BRACKET=221]="CLOSE_SQUARE_BRACKET";a[a.WIN_KEY=224]="WIN_KEY";a[a.MAC_FF_META=224]="MAC_FF_META";a[a.MAC_WK_CMD_LEFT=91]="MAC_WK_CMD_LEFT";a[a.MAC_WK_CMD_RIGHT=93]="MAC_WK_CMD_RIGHT";a[a.WIN_IME=229]="WIN_IME";a[a.VK_NONAME=252]="VK_NONAME";a[a.PHANTOM=255]="PHANTOM";})(KeyCodes$$module$build$src$core$utils$keycodes||(KeyCodes$$module$build$src$core$utils$keycodes={}));var module$build$src$core$utils$keycodes={};module$build$src$core$utils$keycodes.KeyCodes=KeyCodes$$module$build$src$core$utils$keycodes;var Menu$$module$build$src$core$menu=/*#__PURE__*/function(){function Menu$$module$build$src$core$menu(){_classCallCheck(this,Menu$$module$build$src$core$menu);this.menuItems=[];this.roleName=this.element=this.onKeyDownHandler=this.mouseLeaveHandler=this.mouseEnterHandler=this.clickHandler=this.mouseOverHandler=this.highlightedItem=this.openingCoords=null;}_createClass(Menu$$module$build$src$core$menu,[{key:"addChild",value:function addChild(a){this.menuItems.push(a);}},{key:"render",value:function render(a){var b=document.createElement("div");b.className="blocklyMenu goog-menu blocklyNonSelectable";b.tabIndex=0;this.roleName&&setRole$$module$build$src$core$utils$aria(b,this.roleName);this.element=b;for(var c=0,d;d=this.menuItems[c];c++){b.appendChild(d.createDom());}this.mouseOverHandler=conditionalBind$$module$build$src$core$browser_events(b,"mouseover",this,this.handleMouseOver,!0);this.clickHandler=conditionalBind$$module$build$src$core$browser_events(b,"click",this,this.handleClick,!0);this.mouseEnterHandler=conditionalBind$$module$build$src$core$browser_events(b,"mouseenter",this,this.handleMouseEnter,!0);this.mouseLeaveHandler=conditionalBind$$module$build$src$core$browser_events(b,"mouseleave",this,this.handleMouseLeave,!0);this.onKeyDownHandler=conditionalBind$$module$build$src$core$browser_events(b,"keydown",this,this.handleKeyEvent);a.appendChild(b);return b;}},{key:"getElement",value:function getElement(){return this.element;}},{key:"focus",value:function focus(){var a=this.getElement();a&&(a.focus({preventScroll:!0}),addClass$$module$build$src$core$utils$dom(a,"blocklyFocused"));}},{key:"blur",value:function blur(){var a=this.getElement();a&&(a.blur(),removeClass$$module$build$src$core$utils$dom(a,"blocklyFocused"));}},{key:"setRole",value:function setRole(a){this.roleName=a;}},{key:"dispose",value:function dispose(){this.mouseOverHandler&&(unbind$$module$build$src$core$browser_events(this.mouseOverHandler),this.mouseOverHandler=null);this.clickHandler&&(unbind$$module$build$src$core$browser_events(this.clickHandler),this.clickHandler=null);this.mouseEnterHandler&&(unbind$$module$build$src$core$browser_events(this.mouseEnterHandler),this.mouseEnterHandler=null);this.mouseLeaveHandler&&(unbind$$module$build$src$core$browser_events(this.mouseLeaveHandler),this.mouseLeaveHandler=null);this.onKeyDownHandler&&(unbind$$module$build$src$core$browser_events(this.onKeyDownHandler),this.onKeyDownHandler=null);for(var a=0,b;b=this.menuItems[a];a++){b.dispose();}this.element=null;}},{key:"getMenuItem",value:function getMenuItem(a){var b=this.getElement();for(;a&&a!==b;){if(a.classList.contains("blocklyMenuItem"))for(var c=0,d;d=this.menuItems[c];c++){if(d.getElement()===a)return d;}a=a.parentElement;}return null;}},{key:"setHighlighted",value:function setHighlighted(a){var b=this.highlightedItem;b&&(b.setHighlighted(!1),this.highlightedItem=null);a&&(a.setHighlighted(!0),this.highlightedItem=a,b=this.getElement(),scrollIntoContainerView$$module$build$src$core$utils$style(a.getElement(),b),setState$$module$build$src$core$utils$aria(b,State$$module$build$src$core$utils$aria.ACTIVEDESCENDANT,a.getId()));}},{key:"highlightNext",value:function highlightNext(){var a=this.highlightedItem?this.menuItems.indexOf(this.highlightedItem):-1;this.highlightHelper(a,1);}},{key:"highlightPrevious",value:function highlightPrevious(){var a=this.highlightedItem?this.menuItems.indexOf(this.highlightedItem):-1;this.highlightHelper(0>a?this.menuItems.length:a,-1);}},{key:"highlightFirst",value:function highlightFirst(){this.highlightHelper(-1,1);}},{key:"highlightLast",value:function highlightLast(){this.highlightHelper(this.menuItems.length,-1);}},{key:"highlightHelper",value:function highlightHelper(a,b){a+=b;var c;for(;c=this.menuItems[a];){if(c.isEnabled()){this.setHighlighted(c);break;}a+=b;}}},{key:"handleMouseOver",value:function handleMouseOver(a){(a=this.getMenuItem(a.target))&&(a.isEnabled()?this.highlightedItem!==a&&this.setHighlighted(a):this.setHighlighted(null));}},{key:"handleClick",value:function handleClick(a){var b=this.openingCoords;this.openingCoords=null;if(b&&"number"===typeof a.clientX){var c=new Coordinate$$module$build$src$core$utils$coordinate(a.clientX,a.clientY);if(1>Coordinate$$module$build$src$core$utils$coordinate.distance(b,c))return;}(a=this.getMenuItem(a.target))&&a.performAction();}},{key:"handleMouseEnter",value:function handleMouseEnter(a){this.focus();}},{key:"handleMouseLeave",value:function handleMouseLeave(a){this.getElement()&&(this.blur(),this.setHighlighted(null));}},{key:"handleKeyEvent",value:function handleKeyEvent(a){if(this.menuItems.length&&!(a.shiftKey||a.ctrlKey||a.metaKey||a.altKey)){var b=this.highlightedItem;switch(a.keyCode){case KeyCodes$$module$build$src$core$utils$keycodes.ENTER:case KeyCodes$$module$build$src$core$utils$keycodes.SPACE:b&&b.performAction();break;case KeyCodes$$module$build$src$core$utils$keycodes.UP:this.highlightPrevious();break;case KeyCodes$$module$build$src$core$utils$keycodes.DOWN:this.highlightNext();break;case KeyCodes$$module$build$src$core$utils$keycodes.PAGE_UP:case KeyCodes$$module$build$src$core$utils$keycodes.HOME:this.highlightFirst();break;case KeyCodes$$module$build$src$core$utils$keycodes.PAGE_DOWN:case KeyCodes$$module$build$src$core$utils$keycodes.END:this.highlightLast();break;default:return;}a.preventDefault();a.stopPropagation();}}},{key:"getSize",value:function getSize(){var a=this.getElement(),b=getSize$$module$build$src$core$utils$style(a);b.height=a.scrollHeight;return b;}}]);return Menu$$module$build$src$core$menu;}(),module$build$src$core$menu={};module$build$src$core$menu.Menu=Menu$$module$build$src$core$menu;var MenuItem$$module$build$src$core$menuitem=/*#__PURE__*/function(){function MenuItem$$module$build$src$core$menuitem(a,b){_classCallCheck(this,MenuItem$$module$build$src$core$menuitem);this.content=a;this.opt_value=b;this.enabled=!0;this.element=null;this.rightToLeft=!1;this.roleName=null;this.highlight=this.checked=this.checkable=!1;this.actionHandler=null;}_createClass(MenuItem$$module$build$src$core$menuitem,[{key:"createDom",value:function createDom(){var a=document.createElement("div");a.id=getNextUniqueId$$module$build$src$core$utils$idgenerator();this.element=a;a.className="blocklyMenuItem goog-menuitem "+(this.enabled?"":"blocklyMenuItemDisabled goog-menuitem-disabled ")+(this.checked?"blocklyMenuItemSelected goog-option-selected ":"")+(this.highlight?"blocklyMenuItemHighlight goog-menuitem-highlight ":"")+(this.rightToLeft?"blocklyMenuItemRtl goog-menuitem-rtl ":"");var b=document.createElement("div");b.className="blocklyMenuItemContent goog-menuitem-content";if(this.checkable){var c=document.createElement("div");c.className="blocklyMenuItemCheckbox goog-menuitem-checkbox";b.appendChild(c);}c=this.content;"string"===typeof this.content&&(c=document.createTextNode(this.content));b.appendChild(c);a.appendChild(b);this.roleName&&setRole$$module$build$src$core$utils$aria(a,this.roleName);setState$$module$build$src$core$utils$aria(a,State$$module$build$src$core$utils$aria.SELECTED,this.checkable&&this.checked||!1);setState$$module$build$src$core$utils$aria(a,State$$module$build$src$core$utils$aria.DISABLED,!this.enabled);return a;}},{key:"dispose",value:function dispose(){this.element=null;}},{key:"getElement",value:function getElement(){return this.element;}},{key:"getId",value:function getId(){return this.element.id;}},{key:"getValue",value:function getValue(){var a;return null!=(a=this.opt_value)?a:null;}},{key:"setRightToLeft",value:function setRightToLeft(a){this.rightToLeft=a;}},{key:"setRole",value:function setRole(a){this.roleName=a;}},{key:"setCheckable",value:function setCheckable(a){this.checkable=a;}},{key:"setChecked",value:function setChecked(a){this.checked=a;}},{key:"setHighlighted",value:function setHighlighted(a){this.highlight=a;var b=this.getElement();b&&this.isEnabled()&&(a?(addClass$$module$build$src$core$utils$dom(b,"blocklyMenuItemHighlight"),addClass$$module$build$src$core$utils$dom(b,"goog-menuitem-highlight")):(removeClass$$module$build$src$core$utils$dom(b,"blocklyMenuItemHighlight"),removeClass$$module$build$src$core$utils$dom(b,"goog-menuitem-highlight")));}},{key:"isEnabled",value:function isEnabled(){return this.enabled;}},{key:"setEnabled",value:function setEnabled(a){this.enabled=a;}},{key:"performAction",value:function performAction(){this.isEnabled()&&this.actionHandler&&this.actionHandler(this);}},{key:"onAction",value:function onAction(a,b){this.actionHandler=a.bind(b);}}]);return MenuItem$$module$build$src$core$menuitem;}(),module$build$src$core$menuitem={};module$build$src$core$menuitem.MenuItem=MenuItem$$module$build$src$core$menuitem;var FieldDropdown$$module$build$src$core$field_dropdown=/*#__PURE__*/function(_Field$$module$build$){_inherits(FieldDropdown$$module$build$src$core$field_dropdown,_Field$$module$build$);var _super9=_createSuper(FieldDropdown$$module$build$src$core$field_dropdown);function FieldDropdown$$module$build$src$core$field_dropdown(a,b,c){var _this10;_classCallCheck(this,FieldDropdown$$module$build$src$core$field_dropdown);_this10=_super9.call(this,Field$$module$build$src$core$field.SKIP_SETUP);_this10.svgArrow_=_this10.arrow_=_this10.imageElement_=_this10.menu_=_this10.selectedMenuItem_=null;_this10.SERIALIZABLE=!0;_this10.CURSOR="default";_this10.clickTarget_=_this10.suffixField=_this10.prefixField=_this10.generatedOptions_=null;isMenuGenerator$$module$build$src$core$field_dropdown(a)&&(Array.isArray(a)?(validateOptions$$module$build$src$core$field_dropdown(a),a=trimOptions$$module$build$src$core$field_dropdown(a),_this10.menuGenerator_=a.options,_this10.prefixField=a.prefix||null,_this10.suffixField=a.suffix||null):_this10.menuGenerator_=a,_this10.selectedOption_=_this10.getOptions(!1)[0],c&&_this10.configure_(c),_this10.setValue(_this10.selectedOption_[1]),b&&_this10.setValidator(b));return _this10;}_createClass(FieldDropdown$$module$build$src$core$field_dropdown,[{key:"fromXml",value:function fromXml(a){this.isOptionListDynamic()&&this.getOptions(!1);this.setValue(a.textContent);}},{key:"loadState",value:function loadState(a){this.loadLegacyState(FieldDropdown$$module$build$src$core$field_dropdown,a)||(this.isOptionListDynamic()&&this.getOptions(!1),this.setValue(a));}},{key:"initView",value:function initView(){this.shouldAddBorderRect_()?this.createBorderRect_():this.clickTarget_=this.sourceBlock_.getSvgRoot();this.createTextElement_();this.imageElement_=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.IMAGE,{},this.fieldGroup_);this.getConstants().FIELD_DROPDOWN_SVG_ARROW?this.createSVGArrow_():this.createTextArrow_();this.borderRect_&&addClass$$module$build$src$core$utils$dom(this.borderRect_,"blocklyDropdownRect");}},{key:"shouldAddBorderRect_",value:function shouldAddBorderRect_(){var a;return!this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW||this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW&&!(null==(a=this.getSourceBlock())?0:a.isShadow());}},{key:"createTextArrow_",value:function createTextArrow_(){this.arrow_=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.TSPAN,{},this.textElement_);var a;this.arrow_.appendChild(document.createTextNode((null==(a=this.getSourceBlock())?0:a.RTL)?FieldDropdown$$module$build$src$core$field_dropdown.ARROW_CHAR+" ":" "+FieldDropdown$$module$build$src$core$field_dropdown.ARROW_CHAR));var b;(null==(b=this.getSourceBlock())?0:b.RTL)?this.getTextElement().insertBefore(this.arrow_,this.textContent_):this.getTextElement().appendChild(this.arrow_);}},{key:"createSVGArrow_",value:function createSVGArrow_(){this.svgArrow_=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.IMAGE,{height:this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE+"px",width:this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE+"px"},this.fieldGroup_);this.svgArrow_.setAttributeNS(XLINK_NS$$module$build$src$core$utils$dom,"xlink:href",this.getConstants().FIELD_DROPDOWN_SVG_ARROW_DATAURI);}},{key:"showEditor_",value:function showEditor_(a){var b=this.getSourceBlock();if(!b)throw new UnattachedFieldError$$module$build$src$core$field();this.dropdownCreate_();this.menu_.openingCoords=a&&"number"===typeof a.clientX?new Coordinate$$module$build$src$core$utils$coordinate(a.clientX,a.clientY):null;clearContent$$module$build$src$core$dropdowndiv();a=this.menu_.render(getContentDiv$$module$build$src$core$dropdowndiv());addClass$$module$build$src$core$utils$dom(a,"blocklyDropdownMenu");this.getConstants().FIELD_DROPDOWN_COLOURED_DIV&&(a=b.isShadow()?b.getParent().getColour():b.getColour(),b=b.isShadow()?b.getParent().style.colourTertiary:this.sourceBlock_.style.colourTertiary,setColour$$module$build$src$core$dropdowndiv(a,b));showPositionedByField$$module$build$src$core$dropdowndiv(this,this.dropdownDispose_.bind(this));this.menu_.focus();this.selectedMenuItem_&&this.menu_.setHighlighted(this.selectedMenuItem_);this.applyColour();}},{key:"dropdownCreate_",value:function dropdownCreate_(){var a=this.getSourceBlock();if(!a)throw new UnattachedFieldError$$module$build$src$core$field();var b=new Menu$$module$build$src$core$menu();b.setRole(Role$$module$build$src$core$utils$aria.LISTBOX);this.menu_=b;var c=this.getOptions(!1);this.selectedMenuItem_=null;for(var e=0;e<c.length;e++){var _c$e=_slicedToArray(c[e],2),f=_c$e[0],g=_c$e[1];if("object"===_typeof(f)){var d=new Image(f.width,f.height);d.src=f.src;d.alt=f.alt||"";}else d=f;d=new MenuItem$$module$build$src$core$menuitem(d,g);d.setRole(Role$$module$build$src$core$utils$aria.OPTION);d.setRightToLeft(a.RTL);d.setCheckable(!0);b.addChild(d);d.setChecked(g===this.value_);g===this.value_&&(this.selectedMenuItem_=d);d.onAction(this.handleMenuActionEvent_,this);}}},{key:"dropdownDispose_",value:function dropdownDispose_(){this.menu_&&this.menu_.dispose();this.selectedMenuItem_=this.menu_=null;this.applyColour();}},{key:"handleMenuActionEvent_",value:function handleMenuActionEvent_(a){hideIfOwner$$module$build$src$core$dropdowndiv(this,!0);this.onItemSelected_(this.menu_,a);}},{key:"onItemSelected_",value:function onItemSelected_(a,b){this.setValue(b.getValue());}},{key:"isOptionListDynamic",value:function isOptionListDynamic(){return"function"===typeof this.menuGenerator_;}},{key:"getOptions",value:function getOptions(a){if(!this.menuGenerator_)throw TypeError("A menu generator was never defined.");if(Array.isArray(this.menuGenerator_))return this.menuGenerator_;if(a&&this.generatedOptions_)return this.generatedOptions_;this.generatedOptions_=this.menuGenerator_();validateOptions$$module$build$src$core$field_dropdown(this.generatedOptions_);return this.generatedOptions_;}},{key:"doClassValidation_",value:function doClassValidation_(a){return this.getOptions(!0).some(function(b){return b[1]===a;})?a:(this.sourceBlock_&&console.warn("Cannot set the dropdown's value to an unavailable option. Block type: "+this.sourceBlock_.type+", Field name: "+this.name+", Value: "+a),null);}},{key:"doValueUpdate_",value:function doValueUpdate_(a){_get(_getPrototypeOf(FieldDropdown$$module$build$src$core$field_dropdown.prototype),"doValueUpdate_",this).call(this,a);a=this.getOptions(!0);for(var b=0,c;c=a[b];b++){c[1]===this.value_&&(this.selectedOption_=c);}}},{key:"applyColour",value:function applyColour(){var a=this.sourceBlock_.style;this.borderRect_&&(this.borderRect_.setAttribute("stroke",a.colourTertiary),this.menu_?this.borderRect_.setAttribute("fill",a.colourTertiary):this.borderRect_.setAttribute("fill","transparent"));this.sourceBlock_&&this.arrow_&&(this.sourceBlock_.isShadow()?this.arrow_.style.fill=a.colourSecondary:this.arrow_.style.fill=a.colourPrimary);}},{key:"render_",value:function render_(){this.getTextContent().nodeValue="";this.imageElement_.style.display="none";var a=this.selectedOption_&&this.selectedOption_[0];a&&"object"===_typeof(a)?this.renderSelectedImage_(a):this.renderSelectedText_();this.positionBorderRect_();}},{key:"renderSelectedImage_",value:function renderSelectedImage_(a){var b=this.getSourceBlock();if(!b)throw new UnattachedFieldError$$module$build$src$core$field();this.imageElement_.style.display="";this.imageElement_.setAttributeNS(XLINK_NS$$module$build$src$core$utils$dom,"xlink:href",a.src);this.imageElement_.setAttribute("height","".concat(a.height));this.imageElement_.setAttribute("width","".concat(a.width));var c=Number(a.height);a=Number(a.width);var d=!!this.borderRect_;var e=Math.max(d?this.getConstants().FIELD_DROPDOWN_BORDER_RECT_HEIGHT:0,c+IMAGE_Y_PADDING$$module$build$src$core$field_dropdown);d=d?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0;var f;f=this.svgArrow_?this.positionSVGArrow_(a+d,e/2-this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE/2):getFastTextWidth$$module$build$src$core$utils$dom(this.arrow_,this.getConstants().FIELD_TEXT_FONTSIZE,this.getConstants().FIELD_TEXT_FONTWEIGHT,this.getConstants().FIELD_TEXT_FONTFAMILY);this.size_.width=a+f+2*d;this.size_.height=e;var g=0;b.RTL?this.imageElement_.setAttribute("x",(d+f).toString()):(g=a+f,this.getTextElement().setAttribute("text-anchor","end"),this.imageElement_.setAttribute("x",d.toString()));this.imageElement_.setAttribute("y",(e/2-c/2).toString());this.positionTextElement_(g+d,a+f);}},{key:"renderSelectedText_",value:function renderSelectedText_(){this.getTextContent().nodeValue=this.getDisplayText_();var a=this.getTextElement();addClass$$module$build$src$core$utils$dom(a,"blocklyDropdownText");a.setAttribute("text-anchor","start");var b=!!this.borderRect_;a=Math.max(b?this.getConstants().FIELD_DROPDOWN_BORDER_RECT_HEIGHT:0,this.getConstants().FIELD_TEXT_HEIGHT);var c=getFastTextWidth$$module$build$src$core$utils$dom(this.getTextElement(),this.getConstants().FIELD_TEXT_FONTSIZE,this.getConstants().FIELD_TEXT_FONTWEIGHT,this.getConstants().FIELD_TEXT_FONTFAMILY);b=b?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0;var d=0;this.svgArrow_&&(d=this.positionSVGArrow_(c+b,a/2-this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE/2));this.size_.width=c+d+2*b;this.size_.height=a;this.positionTextElement_(b,c);}},{key:"positionSVGArrow_",value:function positionSVGArrow_(a,b){if(!this.svgArrow_)return 0;var c=this.getSourceBlock();if(!c)throw new UnattachedFieldError$$module$build$src$core$field();var d=this.borderRect_?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0,e=this.getConstants().FIELD_DROPDOWN_SVG_ARROW_PADDING,f=this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE;this.svgArrow_.setAttribute("transform","translate("+(c.RTL?d:a+e)+","+b+")");return f+e;}},{key:"getText_",value:function getText_(){if(!this.selectedOption_)return null;var a=this.selectedOption_[0];return"object"===_typeof(a)?a.alt:a;}}],[{key:"fromJson",value:function fromJson(a){if(!a.options)throw Error("options are required for the dropdown field. The options property must be assigned an array of [humanReadableValue, languageNeutralValue] tuples.");return new this(a.options,void 0,a);}}]);return FieldDropdown$$module$build$src$core$field_dropdown;}(Field$$module$build$src$core$field);FieldDropdown$$module$build$src$core$field_dropdown.CHECKMARK_OVERHANG=25;FieldDropdown$$module$build$src$core$field_dropdown.MAX_MENU_HEIGHT_VH=.45;FieldDropdown$$module$build$src$core$field_dropdown.ARROW_CHAR="\u25BE";var IMAGE_Y_OFFSET$$module$build$src$core$field_dropdown=5,IMAGE_Y_PADDING$$module$build$src$core$field_dropdown=2*IMAGE_Y_OFFSET$$module$build$src$core$field_dropdown;register$$module$build$src$core$field_registry("field_dropdown",FieldDropdown$$module$build$src$core$field_dropdown);$.module$build$src$core$field_dropdown={};$.module$build$src$core$field_dropdown.FieldDropdown=FieldDropdown$$module$build$src$core$field_dropdown;var BubbleOpen$$module$build$src$core$events$events_bubble_open=/*#__PURE__*/function(_UiBase$$module$build2){_inherits(BubbleOpen$$module$build$src$core$events$events_bubble_open,_UiBase$$module$build2);var _super10=_createSuper(BubbleOpen$$module$build$src$core$events$events_bubble_open);function BubbleOpen$$module$build$src$core$events$events_bubble_open(a,b,c){var _this11;_classCallCheck(this,BubbleOpen$$module$build$src$core$events$events_bubble_open);_this11=_super10.call(this,a?a.workspace.id:void 0);_this11.type=BUBBLE_OPEN$$module$build$src$core$events$utils;a&&(_this11.blockId=a.id,_this11.isOpen=b,_this11.bubbleType=c);return _this11;}_createClass(BubbleOpen$$module$build$src$core$events$events_bubble_open,[{key:"toJson",value:function toJson(){var a=_get(_getPrototypeOf(BubbleOpen$$module$build$src$core$events$events_bubble_open.prototype),"toJson",this).call(this);if(void 0===this.isOpen)throw Error("Whether this event is for opening the bubble is undefined. Either pass the value to the constructor, or call fromJson");if(!this.bubbleType)throw Error("The type of bubble is undefined. Either pass the value to the constructor, or call fromJson");a.isOpen=this.isOpen;a.bubbleType=this.bubbleType;a.blockId=this.blockId||"";return a;}},{key:"fromJson",value:function fromJson(a){_get(_getPrototypeOf(BubbleOpen$$module$build$src$core$events$events_bubble_open.prototype),"fromJson",this).call(this,a);this.isOpen=a.isOpen;this.bubbleType=a.bubbleType;this.blockId=a.blockId;}}]);return BubbleOpen$$module$build$src$core$events$events_bubble_open;}(UiBase$$module$build$src$core$events$events_ui_base),BubbleType$$module$build$src$core$events$events_bubble_open;(function(a){a.MUTATOR="mutator";a.COMMENT="comment";a.WARNING="warning";})(BubbleType$$module$build$src$core$events$events_bubble_open||(BubbleType$$module$build$src$core$events$events_bubble_open={}));register$$module$build$src$core$registry(Type$$module$build$src$core$registry.EVENT,BUBBLE_OPEN$$module$build$src$core$events$utils,BubbleOpen$$module$build$src$core$events$events_bubble_open);var module$build$src$core$events$events_bubble_open={};module$build$src$core$events$events_bubble_open.BubbleOpen=BubbleOpen$$module$build$src$core$events$events_bubble_open;module$build$src$core$events$events_bubble_open.BubbleType=BubbleType$$module$build$src$core$events$events_bubble_open;var Scrollbar$$module$build$src$core$scrollbar=/*#__PURE__*/function(){function Scrollbar$$module$build$src$core$scrollbar(a,b,c,d,e){_classCallCheck(this,Scrollbar$$module$build$src$core$scrollbar);this.workspace=a;this.horizontal=b;this.oldHostMetrics=null;this.ratio=1;this.origin=new Coordinate$$module$build$src$core$utils$coordinate(0,0);this.startDragHandle=this.handlePosition=this.handleLength=this.scrollbarLength=this.startDragMouse=0;this.containerVisible=this.isHandleVisible=!0;this.position=new Coordinate$$module$build$src$core$utils$coordinate(0,0);this.onMouseMoveWrapper_=this.onMouseUpWrapper_=null;this.pair=c||!1;this.margin=void 0!==e?e:Scrollbar$$module$build$src$core$scrollbar.DEFAULT_SCROLLBAR_MARGIN;a="blocklyScrollbar"+(this.horizontal?"Horizontal":"Vertical");d&&(a+=" "+d);this.outerSvg=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.SVG,{"class":a});d=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.G,{},this.outerSvg);this.svgBackground=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.RECT,{"class":"blocklyScrollbarBackground"},d);a=Math.floor((Scrollbar$$module$build$src$core$scrollbar.scrollbarThickness-5)/2);this.svgHandle=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.RECT,{"class":"blocklyScrollbarHandle",rx:a,ry:a},d);this.workspace.getThemeManager().subscribe(this.svgHandle,"scrollbarColour","fill");this.workspace.getThemeManager().subscribe(this.svgHandle,"scrollbarOpacity","fill-opacity");insertAfter$$module$build$src$core$utils$dom(this.outerSvg,this.workspace.getParentSvg());this.setInitialThickness();b?(this.lengthAttribute_="width",this.positionAttribute_="x"):(this.lengthAttribute_="height",this.positionAttribute_="y");this.onMouseDownBarWrapper_=conditionalBind$$module$build$src$core$browser_events(this.svgBackground,"mousedown",this,this.onMouseDownBar);this.onMouseDownHandleWrapper_=conditionalBind$$module$build$src$core$browser_events(this.svgHandle,"mousedown",this,this.onMouseDownHandle);}_createClass(Scrollbar$$module$build$src$core$scrollbar,[{key:"setInitialThickness",value:function setInitialThickness(){var a=Scrollbar$$module$build$src$core$scrollbar.scrollbarThickness;this.horizontal?(this.svgBackground.setAttribute("height",String(a)),this.outerSvg.setAttribute("height",String(a)),this.svgHandle.setAttribute("height",String(a-5)),this.svgHandle.setAttribute("y","2.5")):(this.svgBackground.setAttribute("width",String(a)),this.outerSvg.setAttribute("width",String(a)),this.svgHandle.setAttribute("width",String(a-5)),this.svgHandle.setAttribute("x","2.5"));}},{key:"dispose",value:function dispose(){this.cleanUp();unbind$$module$build$src$core$browser_events(this.onMouseDownBarWrapper_);unbind$$module$build$src$core$browser_events(this.onMouseDownHandleWrapper_);removeNode$$module$build$src$core$utils$dom(this.outerSvg);this.workspace.getThemeManager().unsubscribe(this.svgHandle);}},{key:"constrainHandleLength",value:function constrainHandleLength(a){return a=0>=a||isNaN(a)?0:Math.min(a,this.scrollbarLength);}},{key:"setHandleLength",value:function setHandleLength(a){this.handleLength=a;this.svgHandle.setAttribute(this.lengthAttribute_,String(this.handleLength));}},{key:"constrainHandlePosition",value:function constrainHandlePosition(a){return a=0>=a||isNaN(a)?0:Math.min(a,this.scrollbarLength-this.handleLength);}},{key:"setHandlePosition",value:function setHandlePosition(a){this.handlePosition=a;this.svgHandle.setAttribute(this.positionAttribute_,String(this.handlePosition));}},{key:"setScrollbarLength",value:function setScrollbarLength(a){this.scrollbarLength=a;this.outerSvg.setAttribute(this.lengthAttribute_,String(this.scrollbarLength));this.svgBackground.setAttribute(this.lengthAttribute_,String(this.scrollbarLength));}},{key:"setPosition",value:function setPosition(a,b){this.position.x=a;this.position.y=b;setCssTransform$$module$build$src$core$utils$dom(this.outerSvg,"translate("+(this.position.x+this.origin.x)+"px,"+(this.position.y+this.origin.y)+"px)");}},{key:"resize",value:function resize(a){if(!a&&(a=this.workspace.getMetrics(),!a))return;this.oldHostMetrics&&Scrollbar$$module$build$src$core$scrollbar.metricsAreEquivalent(a,this.oldHostMetrics)||(this.horizontal?this.resizeHorizontal(a):this.resizeVertical(a),this.oldHostMetrics=a,this.updateMetrics());}},{key:"requiresViewResize",value:function requiresViewResize(a){return this.oldHostMetrics?this.oldHostMetrics.viewWidth!==a.viewWidth||this.oldHostMetrics.viewHeight!==a.viewHeight||this.oldHostMetrics.absoluteLeft!==a.absoluteLeft||this.oldHostMetrics.absoluteTop!==a.absoluteTop:!0;}},{key:"resizeHorizontal",value:function resizeHorizontal(a){this.requiresViewResize(a)?this.resizeViewHorizontal(a):this.resizeContentHorizontal(a);}},{key:"resizeViewHorizontal",value:function resizeViewHorizontal(a){var b=a.viewWidth-2*this.margin;this.pair&&(b-=Scrollbar$$module$build$src$core$scrollbar.scrollbarThickness);this.setScrollbarLength(Math.max(0,b));b=a.absoluteLeft+this.margin;this.pair&&this.workspace.RTL&&(b+=Scrollbar$$module$build$src$core$scrollbar.scrollbarThickness);this.setPosition(b,a.absoluteTop+a.viewHeight-Scrollbar$$module$build$src$core$scrollbar.scrollbarThickness-this.margin);this.resizeContentHorizontal(a);}},{key:"resizeContentHorizontal",value:function resizeContentHorizontal(a){if(a.viewWidth>=a.scrollWidth)this.setHandleLength(this.scrollbarLength),this.setHandlePosition(0),this.pair||this.setVisible(!1);else{this.pair||this.setVisible(!0);var b=this.scrollbarLength*a.viewWidth/a.scrollWidth;b=this.constrainHandleLength(b);this.setHandleLength(b);b=a.scrollWidth-a.viewWidth;var c=this.scrollbarLength-this.handleLength;a=(a.viewLeft-a.scrollLeft)/b*c;a=this.constrainHandlePosition(a);this.setHandlePosition(a);this.ratio=c/b;}}},{key:"resizeVertical",value:function resizeVertical(a){this.requiresViewResize(a)?this.resizeViewVertical(a):this.resizeContentVertical(a);}},{key:"resizeViewVertical",value:function resizeViewVertical(a){var b=a.viewHeight-2*this.margin;this.pair&&(b-=Scrollbar$$module$build$src$core$scrollbar.scrollbarThickness);this.setScrollbarLength(Math.max(0,b));this.setPosition(this.workspace.RTL?a.absoluteLeft+this.margin:a.absoluteLeft+a.viewWidth-Scrollbar$$module$build$src$core$scrollbar.scrollbarThickness-this.margin,a.absoluteTop+this.margin);this.resizeContentVertical(a);}},{key:"resizeContentVertical",value:function resizeContentVertical(a){if(a.viewHeight>=a.scrollHeight)this.setHandleLength(this.scrollbarLength),this.setHandlePosition(0),this.pair||this.setVisible(!1);else{this.pair||this.setVisible(!0);var b=this.scrollbarLength*a.viewHeight/a.scrollHeight;b=this.constrainHandleLength(b);this.setHandleLength(b);b=a.scrollHeight-a.viewHeight;var c=this.scrollbarLength-this.handleLength;a=(a.viewTop-a.scrollTop)/b*c;a=this.constrainHandlePosition(a);this.setHandlePosition(a);this.ratio=c/b;}}},{key:"isVisible",value:function isVisible(){return this.isHandleVisible;}},{key:"setContainerVisible",value:function setContainerVisible(a){var b=a!==this.containerVisible;this.containerVisible=a;b&&this.updateDisplay_();}},{key:"setVisible",value:function setVisible(a){var b=a!==this.isVisible();if(this.pair)throw Error("Unable to toggle visibility of paired scrollbars.");this.isHandleVisible=a;b&&this.updateDisplay_();}},{key:"updateDisplay_",value:function updateDisplay_(){this.containerVisible&&this.isVisible()?this.outerSvg.setAttribute("display","block"):this.outerSvg.setAttribute("display","none");}},{key:"onMouseDownBar",value:function onMouseDownBar(a){this.workspace.markFocused();clearTouchIdentifier$$module$build$src$core$touch();this.cleanUp();if(isRightButton$$module$build$src$core$browser_events(a))a.stopPropagation();else{var b=mouseToSvg$$module$build$src$core$browser_events(a,this.workspace.getParentSvg(),this.workspace.getInverseScreenCTM());b=this.horizontal?b.x:b.y;var c=getInjectionDivXY$$module$build$src$core$utils$svg_math(this.svgHandle);c=this.horizontal?c.x:c.y;var d=this.handlePosition,e=.95*this.handleLength;b<=c?d-=e:b>=c+this.handleLength&&(d+=e);this.setHandlePosition(this.constrainHandlePosition(d));this.updateMetrics();a.stopPropagation();a.preventDefault();}}},{key:"onMouseDownHandle",value:function onMouseDownHandle(a){this.workspace.markFocused();this.cleanUp();isRightButton$$module$build$src$core$browser_events(a)?a.stopPropagation():(this.startDragHandle=this.handlePosition,this.workspace.setupDragSurface(),this.startDragMouse=this.horizontal?a.clientX:a.clientY,this.onMouseUpWrapper_=conditionalBind$$module$build$src$core$browser_events(document,"mouseup",this,this.onMouseUpHandle),this.onMouseMoveWrapper_=conditionalBind$$module$build$src$core$browser_events(document,"mousemove",this,this.onMouseMoveHandle),a.stopPropagation(),a.preventDefault());}},{key:"onMouseMoveHandle",value:function onMouseMoveHandle(a){this.setHandlePosition(this.constrainHandlePosition(this.startDragHandle+((this.horizontal?a.clientX:a.clientY)-this.startDragMouse)));this.updateMetrics();}},{key:"onMouseUpHandle",value:function onMouseUpHandle(){this.workspace.resetDragSurface();clearTouchIdentifier$$module$build$src$core$touch();this.cleanUp();}},{key:"cleanUp",value:function cleanUp(){this.workspace.hideChaff(!0);this.onMouseUpWrapper_&&(unbind$$module$build$src$core$browser_events(this.onMouseUpWrapper_),this.onMouseUpWrapper_=null);this.onMouseMoveWrapper_&&(unbind$$module$build$src$core$browser_events(this.onMouseMoveWrapper_),this.onMouseMoveWrapper_=null);}},{key:"getRatio_",value:function getRatio_(){var a=this.handlePosition/(this.scrollbarLength-this.handleLength);isNaN(a)&&(a=0);return a;}},{key:"updateMetrics",value:function updateMetrics(){var a=this.getRatio_();this.horizontal?this.workspace.setMetrics({x:a}):this.workspace.setMetrics({y:a});}},{key:"set",value:function set(a,b){this.setHandlePosition(this.constrainHandlePosition(a*this.ratio));(b||void 0===b)&&this.updateMetrics();}},{key:"setOrigin",value:function setOrigin(a,b){this.origin=new Coordinate$$module$build$src$core$utils$coordinate(a,b);}}],[{key:"metricsAreEquivalent",value:function metricsAreEquivalent(a,b){return a.viewWidth===b.viewWidth&&a.viewHeight===b.viewHeight&&a.viewLeft===b.viewLeft&&a.viewTop===b.viewTop&&a.absoluteTop===b.absoluteTop&&a.absoluteLeft===b.absoluteLeft&&a.scrollWidth===b.scrollWidth&&a.scrollHeight===b.scrollHeight&&a.scrollLeft===b.scrollLeft&&a.scrollTop===b.scrollTop;}}]);return Scrollbar$$module$build$src$core$scrollbar;}();Scrollbar$$module$build$src$core$scrollbar.scrollbarThickness=TOUCH_ENABLED$$module$build$src$core$touch?25:15;Scrollbar$$module$build$src$core$scrollbar.DEFAULT_SCROLLBAR_MARGIN=.5;var module$build$src$core$scrollbar={};module$build$src$core$scrollbar.Scrollbar=Scrollbar$$module$build$src$core$scrollbar;var Bubble$$module$build$src$core$bubble=/*#__PURE__*/function(){function Bubble$$module$build$src$core$bubble(a,b,c,d,e,f){_classCallCheck(this,Bubble$$module$build$src$core$bubble);this.resizeGroup=this.bubbleBack=this.bubbleArrow=this.bubbleGroup=null;this.height=this.width=this.relativeTop=this.relativeLeft=0;this.autoLayout=!0;this.onMouseDownResizeWrapper=this.onMouseDownBubbleWrapper=this.moveCallback=this.resizeCallback=null;this.rendered=this.disposed=!1;this.workspace_=a;this.content_=b;this.shape_=c;c=Bubble$$module$build$src$core$bubble.ARROW_ANGLE;this.workspace_.RTL&&(c=-c);this.arrowRadians=toRadians$$module$build$src$core$utils$math(c);a.getBubbleCanvas().appendChild(this.createDom(b,!(!e||!f)));this.setAnchorLocation(d);e&&f||(a=this.content_.getBBox(),e=a.width+2*Bubble$$module$build$src$core$bubble.BORDER_WIDTH,f=a.height+2*Bubble$$module$build$src$core$bubble.BORDER_WIDTH);this.setBubbleSize(e,f);this.positionBubble();this.renderArrow();this.rendered=!0;}_createClass(Bubble$$module$build$src$core$bubble,[{key:"createDom",value:function createDom(a,b){this.bubbleGroup=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.G,{});var c={filter:"url(#"+this.workspace_.getRenderer().getConstants().embossFilterId+")"};JavaFx$$module$build$src$core$utils$useragent&&(c={});c=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.G,c,this.bubbleGroup);this.bubbleArrow=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.PATH,{},c);this.bubbleBack=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.RECT,{"class":"blocklyDraggable",x:0,y:0,rx:Bubble$$module$build$src$core$bubble.BORDER_WIDTH,ry:Bubble$$module$build$src$core$bubble.BORDER_WIDTH},c);b?(this.resizeGroup=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.G,{"class":this.workspace_.RTL?"blocklyResizeSW":"blocklyResizeSE"},this.bubbleGroup),b=2*Bubble$$module$build$src$core$bubble.BORDER_WIDTH,createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.POLYGON,{points:"0,x x,x x,0".replace(/x/g,b.toString())},this.resizeGroup),createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.LINE,{"class":"blocklyResizeLine",x1:b/3,y1:b-1,x2:b-1,y2:b/3},this.resizeGroup),createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.LINE,{"class":"blocklyResizeLine",x1:2*b/3,y1:b-1,x2:b-1,y2:2*b/3},this.resizeGroup)):this.resizeGroup=null;this.workspace_.options.readOnly||(this.onMouseDownBubbleWrapper=conditionalBind$$module$build$src$core$browser_events(this.bubbleBack,"mousedown",this,this.bubbleMouseDown),this.resizeGroup&&(this.onMouseDownResizeWrapper=conditionalBind$$module$build$src$core$browser_events(this.resizeGroup,"mousedown",this,this.resizeMouseDown)));this.bubbleGroup.appendChild(a);return this.bubbleGroup;}},{key:"getSvgRoot",value:function getSvgRoot(){return this.bubbleGroup;}},{key:"setSvgId",value:function setSvgId(a){var b;null==(b=this.bubbleGroup)||b.setAttribute("data-block-id",a);}},{key:"bubbleMouseDown",value:function bubbleMouseDown(a){var b=this.workspace_.getGesture(a);b&&b.handleBubbleStart(a,this);}},{key:"showContextMenu",value:function showContextMenu(a){}},{key:"isDeletable",value:function isDeletable(){return!1;}},{key:"setDeleteStyle",value:function setDeleteStyle(a){}},{key:"resizeMouseDown",value:function resizeMouseDown(a){this.promote();Bubble$$module$build$src$core$bubble.unbindDragEvents();isRightButton$$module$build$src$core$browser_events(a)||(this.workspace_.startDrag(a,new Coordinate$$module$build$src$core$utils$coordinate(this.workspace_.RTL?-this.width:this.width,this.height)),Bubble$$module$build$src$core$bubble.onMouseUpWrapper=conditionalBind$$module$build$src$core$browser_events(document,"mouseup",this,Bubble$$module$build$src$core$bubble.bubbleMouseUp),Bubble$$module$build$src$core$bubble.onMouseMoveWrapper=conditionalBind$$module$build$src$core$browser_events(document,"mousemove",this,this.resizeMouseMove),this.workspace_.hideChaff());a.stopPropagation();}},{key:"resizeMouseMove",value:function resizeMouseMove(a){this.autoLayout=!1;a=this.workspace_.moveDrag(a);this.setBubbleSize(this.workspace_.RTL?-a.x:a.x,a.y);this.workspace_.RTL&&this.positionBubble();}},{key:"registerResizeEvent",value:function registerResizeEvent(a){this.resizeCallback=a;}},{key:"registerMoveEvent",value:function registerMoveEvent(a){this.moveCallback=a;}},{key:"promote",value:function promote(){var a;var b=null==(a=this.bubbleGroup)?void 0:a.parentNode;return(null==b?void 0:b.lastChild)!==this.bubbleGroup&&this.bubbleGroup?(null==b||b.appendChild(this.bubbleGroup),!0):!1;}},{key:"setAnchorLocation",value:function setAnchorLocation(a){this.anchorXY=a;this.rendered&&this.positionBubble();}},{key:"layoutBubble",value:function layoutBubble(){var a=this.workspace_.getMetricsManager().getViewMetrics(!0),b=this.getOptimalRelativeLeft(a),c=this.getOptimalRelativeTop(a),d=this.shape_.getBBox();var e={x:b,y:-this.height-this.workspace_.getRenderer().getConstants().MIN_BLOCK_HEIGHT},f={x:-this.width-30,y:c};c={x:d.width,y:c};var g={x:b,y:d.height};b=d.width<d.height?c:g;d=d.width<d.height?g:c;c=this.getOverlap(e,a);g=this.getOverlap(f,a);var h=this.getOverlap(b,a);a=this.getOverlap(d,a);a=Math.max(c,g,h,a);c===a?(this.relativeLeft=e.x,this.relativeTop=e.y):g===a?(this.relativeLeft=f.x,this.relativeTop=f.y):h===a?(this.relativeLeft=b.x,this.relativeTop=b.y):(this.relativeLeft=d.x,this.relativeTop=d.y);}},{key:"getOverlap",value:function getOverlap(a,b){var c=this.workspace_.RTL?this.anchorXY.x-a.x-this.width:a.x+this.anchorXY.x;a=a.y+this.anchorXY.y;return Math.max(0,Math.min(1,(Math.min(c+this.width,b.left+b.width)-Math.max(c,b.left))*(Math.min(a+this.height,b.top+b.height)-Math.max(a,b.top))/(this.width*this.height)));}},{key:"getOptimalRelativeLeft",value:function getOptimalRelativeLeft(a){var b=-this.width/4;if(this.width>a.width)return b;if(this.workspace_.RTL){var c=this.anchorXY.x-b,d=a.left+a.width;a=a.left+Scrollbar$$module$build$src$core$scrollbar.scrollbarThickness/this.workspace_.scale;c-this.width<a?b=-(a-this.anchorXY.x+this.width):c>d&&(b=-(d-this.anchorXY.x));}else{c=b+this.anchorXY.x;d=c+this.width;var e=a.left;a=a.left+a.width-Scrollbar$$module$build$src$core$scrollbar.scrollbarThickness/this.workspace_.scale;c<e?b=e-this.anchorXY.x:d>a&&(b=a-this.anchorXY.x-this.width);}return b;}},{key:"getOptimalRelativeTop",value:function getOptimalRelativeTop(a){var b=-this.height/4;if(this.height>a.height)return b;var c=this.anchorXY.y+b,d=c+this.height,e=a.top;a=a.top+a.height-Scrollbar$$module$build$src$core$scrollbar.scrollbarThickness/this.workspace_.scale;var f=this.anchorXY.y;c<e?b=e-f:d>a&&(b=a-f-this.height);return b;}},{key:"positionBubble",value:function positionBubble(){var a=this.anchorXY.x;a=this.workspace_.RTL?a-(this.relativeLeft+this.width):a+this.relativeLeft;this.moveTo(a,this.relativeTop+this.anchorXY.y);}},{key:"moveTo",value:function moveTo(a,b){var c;null==(c=this.bubbleGroup)||c.setAttribute("transform","translate("+a+","+b+")");}},{key:"setDragging",value:function setDragging(a){!a&&this.moveCallback&&this.moveCallback();}},{key:"getBubbleSize",value:function getBubbleSize(){return new Size$$module$build$src$core$utils$size(this.width,this.height);}},{key:"setBubbleSize",value:function setBubbleSize(a,b){var c=2*Bubble$$module$build$src$core$bubble.BORDER_WIDTH;a=Math.max(a,c+45);b=Math.max(b,c+20);this.width=a;this.height=b;var d;null==(d=this.bubbleBack)||d.setAttribute("width",a.toString());var e;null==(e=this.bubbleBack)||e.setAttribute("height",b.toString());this.resizeGroup&&(this.workspace_.RTL?this.resizeGroup.setAttribute("transform","translate("+2*Bubble$$module$build$src$core$bubble.BORDER_WIDTH+","+(b-c)+") scale(-1 1)"):this.resizeGroup.setAttribute("transform","translate("+(a-c)+","+(b-c)+")"));this.autoLayout&&this.layoutBubble();this.positionBubble();this.renderArrow();this.resizeCallback&&this.resizeCallback();}},{key:"renderArrow",value:function renderArrow(){var a=[];var b=this.width/2,c=this.height/2,d=-this.relativeLeft,e=-this.relativeTop;if(b===d&&c===e)a.push("M "+b+","+c);else{e-=c;d-=b;this.workspace_.RTL&&(d*=-1);var f=Math.sqrt(e*e+d*d),g=Math.acos(d/f);0>e&&(g=2*Math.PI-g);var h=g+Math.PI/2;h>2*Math.PI&&(h-=2*Math.PI);var k=Math.sin(h);var n=Math.cos(h);var l=this.getBubbleSize();h=(l.width+l.height)/Bubble$$module$build$src$core$bubble.ARROW_THICKNESS;h=Math.min(h,l.width,l.height)/4;l=1-Bubble$$module$build$src$core$bubble.ANCHOR_RADIUS/f;d=b+l*d;e=c+l*e;l=b+h*n;var p=c+h*k;b-=h*n;c-=h*k;k=g+this.arrowRadians;k>2*Math.PI&&(k-=2*Math.PI);g=Math.sin(k)*f/Bubble$$module$build$src$core$bubble.ARROW_BEND;f=Math.cos(k)*f/Bubble$$module$build$src$core$bubble.ARROW_BEND;a.push("M"+l+","+p);a.push("C"+(l+f)+","+(p+g)+" "+d+","+e+" "+d+","+e);a.push("C"+d+","+e+" "+(b+f)+","+(c+g)+" "+b+","+c);}a.push("z");var m;null==(m=this.bubbleArrow)||m.setAttribute("d",a.join(" "));}},{key:"setColour",value:function setColour(a){var b;null==(b=this.bubbleBack)||b.setAttribute("fill",a);var c;null==(c=this.bubbleArrow)||c.setAttribute("fill",a);}},{key:"dispose",value:function dispose(){this.onMouseDownBubbleWrapper&&unbind$$module$build$src$core$browser_events(this.onMouseDownBubbleWrapper);this.onMouseDownResizeWrapper&&unbind$$module$build$src$core$browser_events(this.onMouseDownResizeWrapper);Bubble$$module$build$src$core$bubble.unbindDragEvents();removeNode$$module$build$src$core$utils$dom(this.bubbleGroup);this.disposed=!0;}},{key:"moveDuringDrag",value:function moveDuringDrag(a,b){a?a.translateSurface(b.x,b.y):this.moveTo(b.x,b.y);this.relativeLeft=this.workspace_.RTL?this.anchorXY.x-b.x-this.width:b.x-this.anchorXY.x;this.relativeTop=b.y-this.anchorXY.y;this.renderArrow();}},{key:"getRelativeToSurfaceXY",value:function getRelativeToSurfaceXY(){return new Coordinate$$module$build$src$core$utils$coordinate(this.workspace_.RTL?-this.relativeLeft+this.anchorXY.x-this.width:this.anchorXY.x+this.relativeLeft,this.anchorXY.y+this.relativeTop);}},{key:"setAutoLayout",value:function setAutoLayout(a){this.autoLayout=a;}}],[{key:"unbindDragEvents",value:function unbindDragEvents(){Bubble$$module$build$src$core$bubble.onMouseUpWrapper&&(unbind$$module$build$src$core$browser_events(Bubble$$module$build$src$core$bubble.onMouseUpWrapper),Bubble$$module$build$src$core$bubble.onMouseUpWrapper=null);Bubble$$module$build$src$core$bubble.onMouseMoveWrapper&&(unbind$$module$build$src$core$browser_events(Bubble$$module$build$src$core$bubble.onMouseMoveWrapper),Bubble$$module$build$src$core$bubble.onMouseMoveWrapper=null);}},{key:"bubbleMouseUp",value:function bubbleMouseUp(a){clearTouchIdentifier$$module$build$src$core$touch();Bubble$$module$build$src$core$bubble.unbindDragEvents();}},{key:"textToDom",value:function textToDom(a){var b=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.TEXT,{"class":"blocklyText blocklyBubbleText blocklyNoPointerEvents",y:Bubble$$module$build$src$core$bubble.BORDER_WIDTH});a=a.split("\n");for(var c=0;c<a.length;c++){var d=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.TSPAN,{dy:"1em",x:Bubble$$module$build$src$core$bubble.BORDER_WIDTH},b),e=document.createTextNode(a[c]);d.appendChild(e);}return b;}},{key:"createNonEditableBubble",value:function createNonEditableBubble(a,b,c){c=new Bubble$$module$build$src$core$bubble(b.workspace,a,b.pathObject.svgPath,c,null,null);c.setSvgId(b.id);if(b.RTL){b=a.getBBox().width;for(var d=0,e;e=a.childNodes[d];d++){e.setAttribute("text-anchor","end"),e.setAttribute("x",(b+Bubble$$module$build$src$core$bubble.BORDER_WIDTH).toString());}}return c;}}]);return Bubble$$module$build$src$core$bubble;}();Bubble$$module$build$src$core$bubble.BORDER_WIDTH=6;Bubble$$module$build$src$core$bubble.ARROW_THICKNESS=5;Bubble$$module$build$src$core$bubble.ARROW_ANGLE=20;Bubble$$module$build$src$core$bubble.ARROW_BEND=4;Bubble$$module$build$src$core$bubble.ANCHOR_RADIUS=8;Bubble$$module$build$src$core$bubble.onMouseUpWrapper=null;Bubble$$module$build$src$core$bubble.onMouseMoveWrapper=null;var module$build$src$core$bubble={};module$build$src$core$bubble.Bubble=Bubble$$module$build$src$core$bubble;var DEFAULT_SNAP_RADIUS$$module$build$src$core$config,module$build$src$core$config;DEFAULT_SNAP_RADIUS$$module$build$src$core$config=28;$.config$$module$build$src$core$config={dragRadius:5,flyoutDragRadius:10,snapRadius:DEFAULT_SNAP_RADIUS$$module$build$src$core$config,connectingSnapRadius:DEFAULT_SNAP_RADIUS$$module$build$src$core$config,currentConnectionPreference:8,bumpDelay:250};module$build$src$core$config={};module$build$src$core$config.config=$.config$$module$build$src$core$config;var Icon$$module$build$src$core$icon=/*#__PURE__*/function(){function Icon$$module$build$src$core$icon(a){_classCallCheck(this,Icon$$module$build$src$core$icon);this.iconGroup_=null;this.collapseHidden=!0;this.SIZE=17;this.iconXY_=this.bubble_=null;a||warn$$module$build$src$core$utils$deprecation("Calling the Icon constructor with a null block","version 9","version 10","a non-null block");this.block_=a;}_createClass(Icon$$module$build$src$core$icon,[{key:"createIcon",value:function createIcon(){this.iconGroup_||(this.iconGroup_=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.G,{"class":"blocklyIconGroup"}),this.getBlock().isInFlyout&&addClass$$module$build$src$core$utils$dom(this.iconGroup_,"blocklyIconGroupReadonly"),this.drawIcon_(this.iconGroup_),this.getBlock().getSvgRoot().appendChild(this.iconGroup_),conditionalBind$$module$build$src$core$browser_events(this.iconGroup_,"mouseup",this,this.iconClick_),this.updateEditable());}},{key:"dispose",value:function dispose(){removeNode$$module$build$src$core$utils$dom(this.iconGroup_);this.setVisible(!1);}},{key:"updateEditable",value:function updateEditable(){}},{key:"isVisible",value:function isVisible(){return!!this.bubble_;}},{key:"iconClick_",value:function iconClick_(a){this.getBlock().workspace.isDragging()||this.getBlock().isInFlyout||isRightButton$$module$build$src$core$browser_events(a)||this.setVisible(!this.isVisible());}},{key:"applyColour",value:function applyColour(){this.bubble_&&this.isVisible()&&this.bubble_.setColour(this.getBlock().style.colourPrimary);}},{key:"setIconLocation",value:function setIconLocation(a){this.iconXY_=a;this.bubble_&&this.isVisible()&&this.bubble_.setAnchorLocation(a);}},{key:"computeIconLocation",value:function computeIconLocation(){var a=this.getBlock().getRelativeToSurfaceXY();var b=getRelativeXY$$module$build$src$core$utils$svg_math(this.iconGroup_);a=new Coordinate$$module$build$src$core$utils$coordinate(a.x+b.x+this.SIZE/2,a.y+b.y+this.SIZE/2);Coordinate$$module$build$src$core$utils$coordinate.equals(this.getIconLocation(),a)||this.setIconLocation(a);}},{key:"getIconLocation",value:function getIconLocation(){return this.iconXY_;}},{key:"getCorrectedSize",value:function getCorrectedSize(){return new Size$$module$build$src$core$utils$size(this.SIZE,this.SIZE-2);}},{key:"drawIcon_",value:function drawIcon_(a){}},{key:"setVisible",value:function setVisible(a){}},{key:"getBlock",value:function getBlock(){if(!this.block_)throw Error("Block is not set for this icon.");return this.block_;}}]);return Icon$$module$build$src$core$icon;}(),module$build$src$core$icon={};module$build$src$core$icon.Icon=Icon$$module$build$src$core$icon;var module$build$src$core$utils$object={};module$build$src$core$utils$object.deepMerge=deepMerge$$module$build$src$core$utils$object;module$build$src$core$utils$object.inherits=inherits$$module$build$src$core$utils$object;module$build$src$core$utils$object.mixin=mixin$$module$build$src$core$utils$object;module$build$src$core$utils$object.values=values$$module$build$src$core$utils$object;var Theme$$module$build$src$core$theme=/*#__PURE__*/function(){function Theme$$module$build$src$core$theme(a,b,c,d){_classCallCheck(this,Theme$$module$build$src$core$theme);this.name=a;this.startHats=!1;this.blockStyles=b||Object.create(null);this.categoryStyles=c||Object.create(null);this.componentStyles=d||Object.create(null);this.fontStyle=Object.create(null);register$$module$build$src$core$registry(Type$$module$build$src$core$registry.THEME,a,this);}_createClass(Theme$$module$build$src$core$theme,[{key:"getClassName",value:function getClassName(){return this.name+"-theme";}},{key:"setBlockStyle",value:function setBlockStyle(a,b){this.blockStyles[a]=b;}},{key:"setCategoryStyle",value:function setCategoryStyle(a,b){this.categoryStyles[a]=b;}},{key:"getComponentStyle",value:function getComponentStyle(a){return(a=this.componentStyles[a])&&"string"===typeof a&&this.getComponentStyle(a)?this.getComponentStyle(a):a?String(a):null;}},{key:"setComponentStyle",value:function setComponentStyle(a,b){this.componentStyles[a]=b;}},{key:"setFontStyle",value:function setFontStyle(a){this.fontStyle=a;}},{key:"setStartHats",value:function setStartHats(a){this.startHats=a;}}],[{key:"defineTheme",value:function defineTheme(a,b){a=a.toLowerCase();var c=new Theme$$module$build$src$core$theme(a);var d=b.base;if(d){if("string"===typeof d){var e;d=null!=(e=getObject$$module$build$src$core$registry(Type$$module$build$src$core$registry.THEME,d))?e:void 0;}d instanceof Theme$$module$build$src$core$theme&&(deepMerge$$module$build$src$core$utils$object(c,d),c.name=a);}deepMerge$$module$build$src$core$utils$object(c.blockStyles,b.blockStyles);deepMerge$$module$build$src$core$utils$object(c.categoryStyles,b.categoryStyles);deepMerge$$module$build$src$core$utils$object(c.componentStyles,b.componentStyles);deepMerge$$module$build$src$core$utils$object(c.fontStyle,b.fontStyle);null!==b.startHats&&(c.startHats=b.startHats);return c;}}]);return Theme$$module$build$src$core$theme;}(),module$build$src$core$theme={};module$build$src$core$theme.Theme=Theme$$module$build$src$core$theme;var defaultBlockStyles$$module$build$src$core$theme$classic={colour_blocks:{colourPrimary:"20"},list_blocks:{colourPrimary:"260"},logic_blocks:{colourPrimary:"210"},loop_blocks:{colourPrimary:"120"},math_blocks:{colourPrimary:"230"},procedure_blocks:{colourPrimary:"290"},text_blocks:{colourPrimary:"160"},variable_blocks:{colourPrimary:"330"},variable_dynamic_blocks:{colourPrimary:"310"},hat_blocks:{colourPrimary:"330",hat:"cap"}},categoryStyles$$module$build$src$core$theme$classic={colour_category:{colour:"20"},list_category:{colour:"260"},logic_category:{colour:"210"},loop_category:{colour:"120"},math_category:{colour:"230"},procedure_category:{colour:"290"},text_category:{colour:"160"},variable_category:{colour:"330"},variable_dynamic_category:{colour:"310"}},Classic$$module$build$src$core$theme$classic=new Theme$$module$build$src$core$theme("classic",defaultBlockStyles$$module$build$src$core$theme$classic,categoryStyles$$module$build$src$core$theme$classic),module$build$src$core$theme$classic={};module$build$src$core$theme$classic.Classic=Classic$$module$build$src$core$theme$classic;var CATEGORY_TOOLBOX_KIND$$module$build$src$core$utils$toolbox="categoryToolbox",FLYOUT_TOOLBOX_KIND$$module$build$src$core$utils$toolbox="flyoutToolbox",Position$$module$build$src$core$utils$toolbox;(function(a){a[a.TOP=0]="TOP";a[a.BOTTOM=1]="BOTTOM";a[a.LEFT=2]="LEFT";a[a.RIGHT=3]="RIGHT";})(Position$$module$build$src$core$utils$toolbox||(Position$$module$build$src$core$utils$toolbox={}));var TEST_ONLY$$module$build$src$core$utils$toolbox={hasCategoriesInternal:hasCategoriesInternal$$module$build$src$core$utils$toolbox},module$build$src$core$utils$toolbox={};module$build$src$core$utils$toolbox.Position=Position$$module$build$src$core$utils$toolbox;module$build$src$core$utils$toolbox.TEST_ONLY=TEST_ONLY$$module$build$src$core$utils$toolbox;module$build$src$core$utils$toolbox.convertFlyoutDefToJsonArray=convertFlyoutDefToJsonArray$$module$build$src$core$utils$toolbox;module$build$src$core$utils$toolbox.convertToolboxDefToJson=convertToolboxDefToJson$$module$build$src$core$utils$toolbox;module$build$src$core$utils$toolbox.hasCategories=hasCategories$$module$build$src$core$utils$toolbox;module$build$src$core$utils$toolbox.isCategoryCollapsible=isCategoryCollapsible$$module$build$src$core$utils$toolbox;module$build$src$core$utils$toolbox.parseToolboxTree=parseToolboxTree$$module$build$src$core$utils$toolbox;var Options$$module$build$src$core$options=/*#__PURE__*/function(){function Options$$module$build$src$core$options(a){_classCallCheck(this,Options$$module$build$src$core$options);this.gridPattern=null;this.getMetrics=this.setMetrics=void 0;var b=null,c=!1;var d=!1,e=!1,f=!1,g=!1,h=!1;var k=!!a.readOnly;if(!k){var l;b=convertToolboxDefToJson$$module$build$src$core$utils$toolbox(null!=(l=a.toolbox)?l:null);c=hasCategories$$module$build$src$core$utils$toolbox(b);d=a.trashcan;d=void 0===d?c:d;e=a.collapse;e=void 0===e?c:e;f=a.comments;f=void 0===f?c:f;g=a.disable;g=void 0===g?c:g;h=a.sounds;h=void 0===h?!0:h;}l=a.maxTrashcanContents;d?void 0===l&&(l=32):l=0;var m=!!a.rtl;var n=a.horizontalLayout;void 0===n&&(n=!1);var p="end"!==a.toolboxPosition;p=n?p?Position$$module$build$src$core$utils$toolbox.TOP:Position$$module$build$src$core$utils$toolbox.BOTTOM:p===m?Position$$module$build$src$core$utils$toolbox.RIGHT:Position$$module$build$src$core$utils$toolbox.LEFT;var r=a.css;void 0===r&&(r=!0);var q="https://blockly-demo.appspot.com/static/media/";a.media?q=a.media.endsWith("/")?a.media:a.media+"/":"path"in a&&(warn$$module$build$src$core$utils$deprecation("path","Nov 2014","Jul 2023","media"),q=a.path+"media/");var t=a.oneBasedIndex,x=a.renderer||"geras",y=a.plugins||{};this.RTL=m;this.oneBasedIndex=void 0===t?!0:t;this.collapse=e;this.comments=f;this.disable=g;this.readOnly=k;this.maxBlocks=a.maxBlocks||Infinity;var u;this.maxInstances=null!=(u=a.maxInstances)?u:null;this.pathToMedia=q;this.hasCategories=c;this.moveOptions=Options$$module$build$src$core$options.parseMoveOptions_(a,c);this.hasScrollbars=!!this.moveOptions.scrollbars;this.hasTrashcan=d;this.maxTrashcanContents=l;this.hasSounds=h;this.hasCss=r;this.horizontalLayout=n;this.languageTree=b;this.gridOptions=Options$$module$build$src$core$options.parseGridOptions_(a);this.zoomOptions=Options$$module$build$src$core$options.parseZoomOptions_(a);this.toolboxPosition=p;this.theme=Options$$module$build$src$core$options.parseThemeOptions_(a);this.renderer=x;var v;this.rendererOverrides=null!=(v=a.rendererOverrides)?v:null;var w;this.parentWorkspace=null!=(w=a.parentWorkspace)?w:null;this.plugins=y;}_createClass(Options$$module$build$src$core$options,null,[{key:"parseMoveOptions_",value:function parseMoveOptions_(a,b){var c=a.move||{},d={};void 0===c.scrollbars&&void 0===a.scrollbars?d.scrollbars=b:"object"===_typeof(c.scrollbars)?(d.scrollbars={horizontal:!!c.scrollbars.horizontal,vertical:!!c.scrollbars.vertical},d.scrollbars.horizontal&&d.scrollbars.vertical?d.scrollbars=!0:d.scrollbars.horizontal||d.scrollbars.vertical||(d.scrollbars=!1)):d.scrollbars=!!c.scrollbars||!!a.scrollbars;d.wheel=d.scrollbars&&void 0!==c.wheel?!!c.wheel:"object"===_typeof(d.scrollbars);d.drag=d.scrollbars?void 0===c.drag?!0:!!c.drag:!1;return d;}},{key:"parseZoomOptions_",value:function parseZoomOptions_(a){a=a.zoom||{};var b={};b.controls=void 0===a.controls?!1:!!a.controls;b.wheel=void 0===a.wheel?!1:!!a.wheel;b.startScale=void 0===a.startScale?1:Number(a.startScale);b.maxScale=void 0===a.maxScale?3:Number(a.maxScale);b.minScale=void 0===a.minScale?.3:Number(a.minScale);b.scaleSpeed=void 0===a.scaleSpeed?1.2:Number(a.scaleSpeed);b.pinch=void 0===a.pinch?b.wheel||b.controls:!!a.pinch;return b;}},{key:"parseGridOptions_",value:function parseGridOptions_(a){a=a.grid||{};var b={};b.spacing=Number(a.spacing)||0;b.colour=a.colour||"#888";b.length=void 0===a.length?1:Number(a.length);b.snap=0<b.spacing&&!!a.snap;return b;}},{key:"parseThemeOptions_",value:function parseThemeOptions_(a){a=a.theme||Classic$$module$build$src$core$theme$classic;return"string"===typeof a?getObject$$module$build$src$core$registry(Type$$module$build$src$core$registry.THEME,a):a instanceof Theme$$module$build$src$core$theme?a:Theme$$module$build$src$core$theme.defineTheme(a.name||"builtin"+getNextUniqueId$$module$build$src$core$utils$idgenerator(),a);}}]);return Options$$module$build$src$core$options;}(),module$build$src$core$options={};module$build$src$core$options.Options=Options$$module$build$src$core$options;var module$build$src$core$mutator;$.Mutator$$module$build$src$core$mutator=/*#__PURE__*/function(_Icon$$module$build$s){_inherits(_class,_Icon$$module$build$s);var _super11=_createSuper(_class);function _class(a,b){var _this12;_classCallCheck(this,_class);b||warn$$module$build$src$core$utils$deprecation("Calling the Mutator constructor without passing the block it is attached to","version 9","version 10","the constructor by passing the list of subblocks and the block instance to attach the mutator to");_this12=_super11.call(this,null!=b?b:null);_this12.workspace=null;_this12.workspaceHeight=_this12.workspaceWidth=0;_this12.updateWorkspacePid=_this12.sourceListener=_this12.rootBlock=_this12.svgDialog=null;_this12.quarkNames=a;return _this12;}_createClass(_class,[{key:"setBlock",value:function setBlock(a){this.block_=a;}},{key:"getWorkspace",value:function getWorkspace(){return this.workspace;}},{key:"drawIcon_",value:function drawIcon_(a){createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.RECT,{"class":"blocklyIconShape",rx:"4",ry:"4",height:"16",width:"16"},a);createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.PATH,{"class":"blocklyIconSymbol",d:"m4.203,7.296 0,1.368 -0.92,0.677 -0.11,0.41 0.9,1.559 0.41,0.11 1.043,-0.457 1.187,0.683 0.127,1.134 0.3,0.3 1.8,0 0.3,-0.299 0.127,-1.138 1.185,-0.682 1.046,0.458 0.409,-0.11 0.9,-1.559 -0.11,-0.41 -0.92,-0.677 0,-1.366 0.92,-0.677 0.11,-0.41 -0.9,-1.559 -0.409,-0.109 -1.046,0.458 -1.185,-0.682 -0.127,-1.138 -0.3,-0.299 -1.8,0 -0.3,0.3 -0.126,1.135 -1.187,0.682 -1.043,-0.457 -0.41,0.11 -0.899,1.559 0.108,0.409z"},a);createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.CIRCLE,{"class":"blocklyIconShape",r:"2.7",cx:"8",cy:"8"},a);}},{key:"iconClick_",value:function iconClick_(a){this.getBlock().isEditable()&&_get(_getPrototypeOf(_class.prototype),"iconClick_",this).call(this,a);}},{key:"createEditor",value:function createEditor(){this.svgDialog=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.SVG,{x:Bubble$$module$build$src$core$bubble.BORDER_WIDTH,y:Bubble$$module$build$src$core$bubble.BORDER_WIDTH});if(this.quarkNames.length){var a=createElement$$module$build$src$core$utils$xml("xml");for(var d=0,e;e=this.quarkNames[d];d++){var b=createElement$$module$build$src$core$utils$xml("block");b.setAttribute("type",e);a.appendChild(b);}}else a=null;var c=this.getBlock();b=new Options$$module$build$src$core$options({disable:!1,parentWorkspace:c.workspace,media:c.workspace.options.pathToMedia,rtl:c.RTL,horizontalLayout:!1,renderer:c.workspace.options.renderer,rendererOverrides:c.workspace.options.rendererOverrides});b.toolboxPosition=c.RTL?Position$$module$build$src$core$utils$toolbox.RIGHT:Position$$module$build$src$core$utils$toolbox.LEFT;if(c=!!a)b.languageTree=convertToolboxDefToJson$$module$build$src$core$utils$toolbox(a);this.workspace=this.newWorkspaceSvg(b);this.workspace.internalIsMutator=!0;this.workspace.addChangeListener(disableOrphans$$module$build$src$core$events$utils);a=c?this.workspace.addFlyout(Svg$$module$build$src$core$utils$svg.G):null;b=this.workspace.createDom("blocklyMutatorBackground");a&&b.insertBefore(a,this.workspace.svgBlockCanvas_);this.svgDialog.appendChild(b);return this.svgDialog;}},{key:"newWorkspaceSvg",value:function newWorkspaceSvg(a){throw Error("The implementation of newWorkspaceSvg should be monkey-patched in by blockly.ts");}},{key:"updateEditable",value:function updateEditable(){_get(_getPrototypeOf(_class.prototype),"updateEditable",this).call(this);this.getBlock().isInFlyout||(this.getBlock().isEditable()?this.iconGroup_&&removeClass$$module$build$src$core$utils$dom(this.iconGroup_,"blocklyIconGroupReadonly"):(this.setVisible(!1),this.iconGroup_&&addClass$$module$build$src$core$utils$dom(this.iconGroup_,"blocklyIconGroupReadonly")));}},{key:"resizeBubble",value:function resizeBubble(){if(this.workspace){var a=2*Bubble$$module$build$src$core$bubble.BORDER_WIDTH,b=this.workspace.getCanvas(),c=b.getBBox(),d=c.width+c.x,e=c.height+3*a,f=this.workspace.getFlyout();if(f){var g=f.getWorkspace().getMetricsManager().getScrollMetrics();e=Math.max(e,g.height+20);d+=f.getWidth();}(f=this.getBlock().RTL)&&(d=-c.x);d+=3*a;if(Math.abs(this.workspaceWidth-d)>a||Math.abs(this.workspaceHeight-e)>a)this.workspaceWidth=d,this.workspaceHeight=e,this.bubble_.setBubbleSize(d+a,e+a),this.svgDialog.setAttribute("width","".concat(d)),this.svgDialog.setAttribute("height","".concat(e)),this.workspace.setCachedParentSvgSize(d,e);f&&b.setAttribute("transform","translate(".concat(this.workspaceWidth,", 0)"));this.workspace.resize();}}},{key:"onBubbleMove",value:function onBubbleMove(){this.workspace&&this.workspace.recordDragTargets();}},{key:"setVisible",value:function setVisible(a){var _this13=this;if(a!==this.isVisible()){var b=this.getBlock();fire$$module$build$src$core$events$utils(new(get$$module$build$src$core$events$utils(BUBBLE_OPEN$$module$build$src$core$events$utils))(b,a,"mutator"));if(a){this.bubble_=new Bubble$$module$build$src$core$bubble(b.workspace,this.createEditor(),b.pathObject.svgPath,this.iconXY_,null,null);a=this.workspace;this.bubble_.setSvgId(b.id);this.bubble_.registerMoveEvent(this.onBubbleMove.bind(this));var c=a.options.languageTree,d=a.getFlyout();c&&(d.init(a),d.show(c));this.rootBlock=b.decompose(a);c=this.rootBlock.getDescendants(!1);for(var e=0,f;f=c[e];e++){f.render();}this.rootBlock.setMovable(!1);this.rootBlock.setDeletable(!1);d?(c=2*d.CORNER_RADIUS,d=this.rootBlock.RTL?d.getWidth()+c:c):d=c=16;b.RTL&&(d=-d);this.rootBlock.moveBy(d,c);if(b.saveConnections){var _e2=this.rootBlock;b.saveConnections(_e2);this.sourceListener=function(){var f=_this13.getBlock();f.saveConnections&&f.saveConnections(_e2);};b.workspace.addChangeListener(this.sourceListener);}this.resizeBubble();a.addChangeListener(this.workspaceChanged.bind(this));this.updateWorkspace();this.applyColour();}else this.svgDialog=null,this.workspace.dispose(),this.rootBlock=this.workspace=null,null==(d=this.bubble_)||d.dispose(),this.bubble_=null,this.workspaceHeight=this.workspaceWidth=0,this.sourceListener&&(b.workspace.removeChangeListener(this.sourceListener),this.sourceListener=null);}}},{key:"workspaceChanged",value:function workspaceChanged(a){var _this14=this;this.shouldIgnoreMutatorEvent_(a)||this.updateWorkspacePid||(this.updateWorkspacePid=setTimeout(function(){_this14.updateWorkspacePid=null;_this14.updateWorkspace();},0));}},{key:"shouldIgnoreMutatorEvent_",value:function shouldIgnoreMutatorEvent_(a){return a.isUiEvent||a.type===CREATE$$module$build$src$core$events$utils||a.type===CHANGE$$module$build$src$core$events$utils&&"disabled"===a.element;}},{key:"updateWorkspace",value:function updateWorkspace(){var _this15=this;if(!this.workspace.isDragging()){var a=this.workspace.getTopBlocks(!1);for(var d=0,e;e=a[d];d++){var b=e.getRelativeToSurfaceXY();20>b.y&&e.moveBy(0,20-b.y);if(e.RTL){var c=-20;var f=this.workspace.getFlyout();f&&(c-=f.getWidth());b.x>c&&e.moveBy(c-b.x,0);}else 20>b.x&&e.moveBy(20-b.x,0);}}if(this.rootBlock&&this.rootBlock.workspace===this.workspace){(a=getGroup$$module$build$src$core$events$utils())||setGroup$$module$build$src$core$events$utils(!0);var _d3=this.getBlock();b=BlockChange$$module$build$src$core$events$events_block_change.getExtraBlockState_(_d3);c=_d3.rendered;_d3.rendered=!1;_d3.compose(this.rootBlock);_d3.rendered=c;_d3.initSvg();_d3.rendered&&_d3.render();c=BlockChange$$module$build$src$core$events$events_block_change.getExtraBlockState_(_d3);if(b!==c){fire$$module$build$src$core$events$utils(new(get$$module$build$src$core$events$utils(CHANGE$$module$build$src$core$events$utils))(_d3,"mutation",null,b,c));var _e3=getGroup$$module$build$src$core$events$utils();setTimeout(function(){var f=getGroup$$module$build$src$core$events$utils();setGroup$$module$build$src$core$events$utils(_e3);_d3.bumpNeighbours();setGroup$$module$build$src$core$events$utils(f);},$.config$$module$build$src$core$config.bumpDelay);}this.workspace.isDragging()||setTimeout(function(){return _this15.resizeBubble();},0);setGroup$$module$build$src$core$events$utils(a);}}},{key:"dispose",value:function dispose(){this.getBlock().mutator=null;_get(_getPrototypeOf(_class.prototype),"dispose",this).call(this);}},{key:"updateBlockStyle",value:function updateBlockStyle(){var a=this.workspace;if(a&&a.getAllBlocks(!1)){var b=a.getAllBlocks(!1);for(var c=0,d;d=b[c];c++){d.setStyle(d.getStyleName());}if(a=a.getFlyout()){a=a.getWorkspace().getAllBlocks(!1);for(var _c=0,_d4;_d4=a[_c];_c++){_d4.setStyle(_d4.getStyleName());}}}}}],[{key:"reconnect",value:function reconnect(a,b,c){if(!a||!a.getSourceBlock().workspace)return!1;c=b.getInput(c).connection;var d=a.targetBlock();return d&&d!==b||!c||c.targetConnection===a?!1:(c.isConnected()&&c.disconnect(),c.connect(a),!0);}},{key:"findParentWs",value:function findParentWs(a){var b=null;if(a&&a.options){var c=a.options.parentWorkspace;a.isFlyout?c&&c.options&&(b=c.options.parentWorkspace):c&&(b=c);}return b;}}]);return _class;}(Icon$$module$build$src$core$icon);module$build$src$core$mutator={};module$build$src$core$mutator.Mutator=$.Mutator$$module$build$src$core$mutator;var allExtensions$$module$build$src$core$extensions=Object.create(null),TEST_ONLY$$module$build$src$core$extensions={allExtensions:allExtensions$$module$build$src$core$extensions};register$$module$build$src$core$extensions("parent_tooltip_when_inline",extensionParentTooltip$$module$build$src$core$extensions);$.module$build$src$core$extensions={};$.module$build$src$core$extensions.TEST_ONLY=TEST_ONLY$$module$build$src$core$extensions;$.module$build$src$core$extensions.apply=apply$$module$build$src$core$extensions;$.module$build$src$core$extensions.buildTooltipForDropdown=buildTooltipForDropdown$$module$build$src$core$extensions;$.module$build$src$core$extensions.buildTooltipWithFieldText=buildTooltipWithFieldText$$module$build$src$core$extensions;$.module$build$src$core$extensions.isRegistered=isRegistered$$module$build$src$core$extensions;$.module$build$src$core$extensions.register=register$$module$build$src$core$extensions;$.module$build$src$core$extensions.registerMixin=registerMixin$$module$build$src$core$extensions;$.module$build$src$core$extensions.registerMutator=registerMutator$$module$build$src$core$extensions;$.module$build$src$core$extensions.runAfterPageLoad=runAfterPageLoad$$module$build$src$core$extensions;$.module$build$src$core$extensions.unregister=unregister$$module$build$src$core$extensions;var module$build$src$core$utils$array={};module$build$src$core$utils$array.removeElem=removeElem$$module$build$src$core$utils$array;var module$build$src$core$utils$svg_paths={};module$build$src$core$utils$svg_paths.arc=arc$$module$build$src$core$utils$svg_paths;module$build$src$core$utils$svg_paths.curve=curve$$module$build$src$core$utils$svg_paths;module$build$src$core$utils$svg_paths.line=line$$module$build$src$core$utils$svg_paths;module$build$src$core$utils$svg_paths.lineOnAxis=lineOnAxis$$module$build$src$core$utils$svg_paths;module$build$src$core$utils$svg_paths.lineTo=lineTo$$module$build$src$core$utils$svg_paths;module$build$src$core$utils$svg_paths.moveBy=moveBy$$module$build$src$core$utils$svg_paths;module$build$src$core$utils$svg_paths.moveTo=moveTo$$module$build$src$core$utils$svg_paths;module$build$src$core$utils$svg_paths.point=point$$module$build$src$core$utils$svg_paths;var getInjectionDivXY_$$module$build$src$core$utils=getInjectionDivXY$$module$build$src$core$utils,module$build$src$core$utils={};module$build$src$core$utils.Coordinate=Coordinate$$module$build$src$core$utils$coordinate;module$build$src$core$utils.KeyCodes=KeyCodes$$module$build$src$core$utils$keycodes;module$build$src$core$utils.Rect=Rect$$module$build$src$core$utils$rect;module$build$src$core$utils.Size=Size$$module$build$src$core$utils$size;module$build$src$core$utils.Svg=Svg$$module$build$src$core$utils$svg;module$build$src$core$utils.aria=module$build$src$core$utils$aria;module$build$src$core$utils.array=module$build$src$core$utils$array;module$build$src$core$utils.arrayRemove=arrayRemove$$module$build$src$core$utils;module$build$src$core$utils.browserEvents=module$build$src$core$browser_events;module$build$src$core$utils.checkMessageReferences=checkMessageReferences$$module$build$src$core$utils;module$build$src$core$utils.colour=module$build$src$core$utils$colour;module$build$src$core$utils.deprecation=module$build$src$core$utils$deprecation;module$build$src$core$utils.dom=module$build$src$core$utils$dom;module$build$src$core$utils.extensions=$.module$build$src$core$extensions;module$build$src$core$utils.getBlockTypeCounts=getBlockTypeCounts$$module$build$src$core$utils;module$build$src$core$utils.getDocumentScroll=getDocumentScroll$$module$build$src$core$utils;module$build$src$core$utils.getInjectionDivXY_=getInjectionDivXY$$module$build$src$core$utils;module$build$src$core$utils.getRelativeXY=getRelativeXY$$module$build$src$core$utils;module$build$src$core$utils.getViewportBBox=getViewportBBox$$module$build$src$core$utils;module$build$src$core$utils.idGenerator=module$build$src$core$utils$idgenerator;module$build$src$core$utils.is3dSupported=is3dSupported$$module$build$src$core$utils;module$build$src$core$utils.math=module$build$src$core$utils$math;module$build$src$core$utils.object=module$build$src$core$utils$object;module$build$src$core$utils.parseBlockColour=parseBlockColour$$module$build$src$core$utils;module$build$src$core$utils.parsing=module$build$src$core$utils$parsing;module$build$src$core$utils.replaceMessageReferences=replaceMessageReferences$$module$build$src$core$utils;module$build$src$core$utils.runAfterPageLoad=runAfterPageLoad$$module$build$src$core$utils;module$build$src$core$utils.screenToWsCoordinates=screenToWsCoordinates$$module$build$src$core$utils;module$build$src$core$utils.string=$.module$build$src$core$utils$string;module$build$src$core$utils.style=module$build$src$core$utils$style;module$build$src$core$utils.svgMath=module$build$src$core$utils$svg_math;module$build$src$core$utils.svgPaths=module$build$src$core$utils$svg_paths;module$build$src$core$utils.tokenizeInterpolation=tokenizeInterpolation$$module$build$src$core$utils;module$build$src$core$utils.toolbox=module$build$src$core$utils$toolbox;module$build$src$core$utils.userAgent=module$build$src$core$utils$useragent;module$build$src$core$utils.xml=$.module$build$src$core$utils$xml;var TrashcanOpen$$module$build$src$core$events$events_trashcan_open=/*#__PURE__*/function(_UiBase$$module$build3){_inherits(TrashcanOpen$$module$build$src$core$events$events_trashcan_open,_UiBase$$module$build3);var _super12=_createSuper(TrashcanOpen$$module$build$src$core$events$events_trashcan_open);function TrashcanOpen$$module$build$src$core$events$events_trashcan_open(a,b){var _this16;_classCallCheck(this,TrashcanOpen$$module$build$src$core$events$events_trashcan_open);_this16=_super12.call(this,b);_this16.type=TRASHCAN_OPEN$$module$build$src$core$events$utils;_this16.isOpen=a;return _this16;}_createClass(TrashcanOpen$$module$build$src$core$events$events_trashcan_open,[{key:"toJson",value:function toJson(){var a=_get(_getPrototypeOf(TrashcanOpen$$module$build$src$core$events$events_trashcan_open.prototype),"toJson",this).call(this);if(void 0===this.isOpen)throw Error("Whether this is already open or not is undefined. Either pass a value to the constructor, or call fromJson");a.isOpen=this.isOpen;return a;}},{key:"fromJson",value:function fromJson(a){_get(_getPrototypeOf(TrashcanOpen$$module$build$src$core$events$events_trashcan_open.prototype),"fromJson",this).call(this,a);this.isOpen=a.isOpen;}}]);return TrashcanOpen$$module$build$src$core$events$events_trashcan_open;}(UiBase$$module$build$src$core$events$events_ui_base);register$$module$build$src$core$registry(Type$$module$build$src$core$registry.EVENT,TRASHCAN_OPEN$$module$build$src$core$events$utils,TrashcanOpen$$module$build$src$core$events$events_trashcan_open);var module$build$src$core$events$events_trashcan_open={};module$build$src$core$events$events_trashcan_open.TrashcanOpen=TrashcanOpen$$module$build$src$core$events$events_trashcan_open;var Capability$$module$build$src$core$component_manager=/*#__PURE__*/function(){function Capability$$module$build$src$core$component_manager(a){_classCallCheck(this,Capability$$module$build$src$core$component_manager);this.name_=a;}_createClass(Capability$$module$build$src$core$component_manager,[{key:"toString",value:function toString(){return this.name_;}}]);return Capability$$module$build$src$core$component_manager;}();Capability$$module$build$src$core$component_manager.POSITIONABLE=new Capability$$module$build$src$core$component_manager("positionable");Capability$$module$build$src$core$component_manager.DRAG_TARGET=new Capability$$module$build$src$core$component_manager("drag_target");Capability$$module$build$src$core$component_manager.DELETE_AREA=new Capability$$module$build$src$core$component_manager("delete_area");Capability$$module$build$src$core$component_manager.AUTOHIDEABLE=new Capability$$module$build$src$core$component_manager("autohideable");var ComponentManager$$module$build$src$core$component_manager=/*#__PURE__*/function(){function ComponentManager$$module$build$src$core$component_manager(){_classCallCheck(this,ComponentManager$$module$build$src$core$component_manager);this.componentData=new Map();this.capabilityToComponentIds=new Map();}_createClass(ComponentManager$$module$build$src$core$component_manager,[{key:"addComponent",value:function addComponent(a,b){var c=a.component.id;if(!b&&this.componentData.has(c)){var d;throw Error('Plugin "'+c+'" with capabilities "'+(null==(d=this.componentData.get(c))?void 0:d.capabilities)+'" already added.');}this.componentData.set(c,a);b=[];for(d=0;d<a.capabilities.length;d++){var e=String(a.capabilities[d]).toLowerCase();b.push(e);if(this.capabilityToComponentIds.has(e)){var f=void 0;null==(f=this.capabilityToComponentIds.get(e))||f.push(c);}else this.capabilityToComponentIds.set(e,[c]);}this.componentData.get(c).capabilities=b;}},{key:"removeComponent",value:function removeComponent(a){var b=this.componentData.get(a);if(b){for(var c=0;c<b.capabilities.length;c++){var d=String(b.capabilities[c]).toLowerCase();removeElem$$module$build$src$core$utils$array(this.capabilityToComponentIds.get(d),a);}this.componentData["delete"](a);}}},{key:"addCapability",value:function addCapability(a,b){if(!this.getComponent(a))throw Error('Cannot add capability, "'+b+'". Plugin "'+a+'" has not been added to the ComponentManager');if(this.hasCapability(a,b))console.warn('Plugin "'+a+'already has capability "'+b+'"');else{b=String(b).toLowerCase();var c;null==(c=this.componentData.get(a))||c.capabilities.push(b);var d;null==(d=this.capabilityToComponentIds.get(b))||d.push(a);}}},{key:"removeCapability",value:function removeCapability(a,b){if(!this.getComponent(a))throw Error('Cannot remove capability, "'+b+'". Plugin "'+a+'" has not been added to the ComponentManager');this.hasCapability(a,b)?(b=String(b).toLowerCase(),removeElem$$module$build$src$core$utils$array(this.componentData.get(a).capabilities,b),removeElem$$module$build$src$core$utils$array(this.capabilityToComponentIds.get(b),a)):console.warn('Plugin "'+a+"doesn't have capability \""+b+'" to remove');}},{key:"hasCapability",value:function hasCapability(a,b){b=String(b).toLowerCase();return this.componentData.has(a)&&-1!==this.componentData.get(a).capabilities.indexOf(b);}},{key:"getComponent",value:function getComponent(a){var b;return null==(b=this.componentData.get(a))?void 0:b.component;}},{key:"getComponents",value:function getComponents(a,b){var _this17=this;a=String(a).toLowerCase();a=this.capabilityToComponentIds.get(a);if(!a)return[];var c=[];if(b){var d=[];a.forEach(function(e){d.push(_this17.componentData.get(e));});d.sort(function(e,f){return e.weight-f.weight;});d.forEach(function(e){c.push(e.component);});}else a.forEach(function(d){c.push(_this17.componentData.get(d).component);});return c;}}]);return ComponentManager$$module$build$src$core$component_manager;}();ComponentManager$$module$build$src$core$component_manager.Capability=Capability$$module$build$src$core$component_manager;var module$build$src$core$component_manager={};module$build$src$core$component_manager.ComponentManager=ComponentManager$$module$build$src$core$component_manager;var DeserializationError$$module$build$src$core$serialization$exceptions=/*#__PURE__*/function(_Error2){_inherits(DeserializationError$$module$build$src$core$serialization$exceptions,_Error2);var _super13=_createSuper(DeserializationError$$module$build$src$core$serialization$exceptions);function DeserializationError$$module$build$src$core$serialization$exceptions(){_classCallCheck(this,DeserializationError$$module$build$src$core$serialization$exceptions);return _super13.apply(this,arguments);}return _createClass(DeserializationError$$module$build$src$core$serialization$exceptions);}(/*#__PURE__*/_wrapNativeSuper(Error)),MissingBlockType$$module$build$src$core$serialization$exceptions=/*#__PURE__*/function(_DeserializationError){_inherits(MissingBlockType$$module$build$src$core$serialization$exceptions,_DeserializationError);var _super14=_createSuper(MissingBlockType$$module$build$src$core$serialization$exceptions);function MissingBlockType$$module$build$src$core$serialization$exceptions(a){var _this18;_classCallCheck(this,MissingBlockType$$module$build$src$core$serialization$exceptions);_this18=_super14.call(this,"Expected to find a 'type' property, defining the block type");_this18.state=a;return _this18;}return _createClass(MissingBlockType$$module$build$src$core$serialization$exceptions);}(DeserializationError$$module$build$src$core$serialization$exceptions),MissingConnection$$module$build$src$core$serialization$exceptions=/*#__PURE__*/function(_DeserializationError2){_inherits(MissingConnection$$module$build$src$core$serialization$exceptions,_DeserializationError2);var _super15=_createSuper(MissingConnection$$module$build$src$core$serialization$exceptions);function MissingConnection$$module$build$src$core$serialization$exceptions(a,b,c){var _this19;_classCallCheck(this,MissingConnection$$module$build$src$core$serialization$exceptions);_this19=_super15.call(this,"The block ".concat(b.toDevString()," is missing a(n) ").concat(a,"\nconnection"));_this19.block=b;_this19.state=c;return _this19;}return _createClass(MissingConnection$$module$build$src$core$serialization$exceptions);}(DeserializationError$$module$build$src$core$serialization$exceptions),BadConnectionCheck$$module$build$src$core$serialization$exceptions=/*#__PURE__*/function(_DeserializationError3){_inherits(BadConnectionCheck$$module$build$src$core$serialization$exceptions,_DeserializationError3);var _super16=_createSuper(BadConnectionCheck$$module$build$src$core$serialization$exceptions);function BadConnectionCheck$$module$build$src$core$serialization$exceptions(a,b,c,d){var _this20;_classCallCheck(this,BadConnectionCheck$$module$build$src$core$serialization$exceptions);_this20=_super16.call(this,"The block ".concat(c.toDevString()," could not connect its\n").concat(b," to its parent, because: ").concat(a));_this20.childBlock=c;_this20.childState=d;return _this20;}return _createClass(BadConnectionCheck$$module$build$src$core$serialization$exceptions);}(DeserializationError$$module$build$src$core$serialization$exceptions),RealChildOfShadow$$module$build$src$core$serialization$exceptions=/*#__PURE__*/function(_DeserializationError4){_inherits(RealChildOfShadow$$module$build$src$core$serialization$exceptions,_DeserializationError4);var _super17=_createSuper(RealChildOfShadow$$module$build$src$core$serialization$exceptions);function RealChildOfShadow$$module$build$src$core$serialization$exceptions(a){var _this21;_classCallCheck(this,RealChildOfShadow$$module$build$src$core$serialization$exceptions);_this21=_super17.call(this,"Encountered a real block which is defined as a child of a shadow\nblock. It is an invariant of Blockly that shadow blocks only have shadow\nchildren");_this21.state=a;return _this21;}return _createClass(RealChildOfShadow$$module$build$src$core$serialization$exceptions);}(DeserializationError$$module$build$src$core$serialization$exceptions),module$build$src$core$serialization$exceptions={};module$build$src$core$serialization$exceptions.BadConnectionCheck=BadConnectionCheck$$module$build$src$core$serialization$exceptions;module$build$src$core$serialization$exceptions.DeserializationError=DeserializationError$$module$build$src$core$serialization$exceptions;module$build$src$core$serialization$exceptions.MissingBlockType=MissingBlockType$$module$build$src$core$serialization$exceptions;module$build$src$core$serialization$exceptions.MissingConnection=MissingConnection$$module$build$src$core$serialization$exceptions;module$build$src$core$serialization$exceptions.RealChildOfShadow=RealChildOfShadow$$module$build$src$core$serialization$exceptions;var VARIABLES$$module$build$src$core$serialization$priorities=100,PROCEDURES$$module$build$src$core$serialization$priorities=75,BLOCKS$$module$build$src$core$serialization$priorities=50,module$build$src$core$serialization$priorities={};module$build$src$core$serialization$priorities.BLOCKS=BLOCKS$$module$build$src$core$serialization$priorities;module$build$src$core$serialization$priorities.PROCEDURES=PROCEDURES$$module$build$src$core$serialization$priorities;module$build$src$core$serialization$priorities.VARIABLES=VARIABLES$$module$build$src$core$serialization$priorities;var module$build$src$core$serialization$registry={};module$build$src$core$serialization$registry.register=register$$module$build$src$core$serialization$registry;module$build$src$core$serialization$registry.unregister=unregister$$module$build$src$core$serialization$registry;var saveBlock$$module$build$src$core$serialization$blocks=save$$module$build$src$core$serialization$blocks,BlockSerializer$$module$build$src$core$serialization$blocks=/*#__PURE__*/function(){function BlockSerializer$$module$build$src$core$serialization$blocks(){_classCallCheck(this,BlockSerializer$$module$build$src$core$serialization$blocks);this.priority=BLOCKS$$module$build$src$core$serialization$priorities;}_createClass(BlockSerializer$$module$build$src$core$serialization$blocks,[{key:"save",value:function save(a){var b=[];var _iterator5=_createForOfIteratorHelper(a.getTopBlocks(!1)),_step5;try{for(_iterator5.s();!(_step5=_iterator5.n()).done;){var c=_step5.value;(a=save$$module$build$src$core$serialization$blocks(c,{addCoordinates:!0,doFullSerialization:!1}))&&b.push(a);}}catch(err){_iterator5.e(err);}finally{_iterator5.f();}return b.length?{languageVersion:0,blocks:b}:null;}},{key:"load",value:function load(a,b){a=a.blocks;var _iterator6=_createForOfIteratorHelper(a),_step6;try{for(_iterator6.s();!(_step6=_iterator6.n()).done;){var c=_step6.value;append$$module$build$src$core$serialization$blocks(c,b,{recordUndo:getRecordUndo$$module$build$src$core$events$utils()});}}catch(err){_iterator6.e(err);}finally{_iterator6.f();}}},{key:"clear",value:function clear(a){var _iterator7=_createForOfIteratorHelper(a.getTopBlocks(!1)),_step7;try{for(_iterator7.s();!(_step7=_iterator7.n()).done;){var b=_step7.value;b.dispose(!1);}}catch(err){_iterator7.e(err);}finally{_iterator7.f();}}}]);return BlockSerializer$$module$build$src$core$serialization$blocks;}();register$$module$build$src$core$serialization$registry("blocks",new BlockSerializer$$module$build$src$core$serialization$blocks());var module$build$src$core$serialization$blocks={};module$build$src$core$serialization$blocks.BlockSerializer=BlockSerializer$$module$build$src$core$serialization$blocks;module$build$src$core$serialization$blocks.append=append$$module$build$src$core$serialization$blocks;module$build$src$core$serialization$blocks.appendInternal=appendInternal$$module$build$src$core$serialization$blocks;module$build$src$core$serialization$blocks.save=save$$module$build$src$core$serialization$blocks;var BlockCreate$$module$build$src$core$events$events_block_create=/*#__PURE__*/function(_BlockBase$$module$bu2){_inherits(BlockCreate$$module$build$src$core$events$events_block_create,_BlockBase$$module$bu2);var _super18=_createSuper(BlockCreate$$module$build$src$core$events$events_block_create);function BlockCreate$$module$build$src$core$events$events_block_create(a){var _this22;_classCallCheck(this,BlockCreate$$module$build$src$core$events$events_block_create);_this22=_super18.call(this,a);_this22.type=CREATE$$module$build$src$core$events$utils;a&&(a.isShadow()&&(_this22.recordUndo=!1),_this22.xml=blockToDomWithXY$$module$build$src$core$xml(a),_this22.ids=getDescendantIds$$module$build$src$core$events$utils(a),_this22.json=save$$module$build$src$core$serialization$blocks(a,{addCoordinates:!0}));return _this22;}_createClass(BlockCreate$$module$build$src$core$events$events_block_create,[{key:"toJson",value:function toJson(){var a=_get(_getPrototypeOf(BlockCreate$$module$build$src$core$events$events_block_create.prototype),"toJson",this).call(this);if(!this.xml)throw Error("The block XML is undefined. Either pass a block to the constructor, or call fromJson");if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(!this.json)throw Error("The block JSON is undefined. Either pass a block to the constructor, or call fromJson");a.xml=domToText$$module$build$src$core$xml(this.xml);a.ids=this.ids;a.json=this.json;this.recordUndo||(a.recordUndo=this.recordUndo);return a;}},{key:"fromJson",value:function fromJson(a){_get(_getPrototypeOf(BlockCreate$$module$build$src$core$events$events_block_create.prototype),"fromJson",this).call(this,a);this.xml=textToDom$$module$build$src$core$xml(a.xml);this.ids=a.ids;this.json=a.json;void 0!==a.recordUndo&&(this.recordUndo=a.recordUndo);}},{key:"run",value:function run(a){var b=this.getEventWorkspace_();if(!this.json)throw Error("The block JSON is undefined. Either pass a block to the constructor, or call fromJson");if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(a)append$$module$build$src$core$serialization$blocks(this.json,b);else for(a=0;a<this.ids.length;a++){var c=this.ids[a],d=b.getBlockById(c);d?d.dispose(!1):c===this.blockId&&console.warn("Can't uncreate non-existent block: "+c);}}}]);return BlockCreate$$module$build$src$core$events$events_block_create;}(BlockBase$$module$build$src$core$events$events_block_base);register$$module$build$src$core$registry(Type$$module$build$src$core$registry.EVENT,CREATE$$module$build$src$core$events$utils,BlockCreate$$module$build$src$core$events$events_block_create);var module$build$src$core$events$events_block_create={};module$build$src$core$events$events_block_create.BlockCreate=BlockCreate$$module$build$src$core$events$events_block_create;var BlockDelete$$module$build$src$core$events$events_block_delete=/*#__PURE__*/function(_BlockBase$$module$bu3){_inherits(BlockDelete$$module$build$src$core$events$events_block_delete,_BlockBase$$module$bu3);var _super19=_createSuper(BlockDelete$$module$build$src$core$events$events_block_delete);function BlockDelete$$module$build$src$core$events$events_block_delete(a){var _this23;_classCallCheck(this,BlockDelete$$module$build$src$core$events$events_block_delete);_this23=_super19.call(this,a);_this23.type=DELETE$$module$build$src$core$events$utils;if(a){if(a.getParent())throw Error("Connected blocks cannot be deleted.");a.isShadow()&&(_this23.recordUndo=!1);_this23.oldXml=blockToDomWithXY$$module$build$src$core$xml(a);_this23.ids=getDescendantIds$$module$build$src$core$events$utils(a);_this23.wasShadow=a.isShadow();_this23.oldJson=save$$module$build$src$core$serialization$blocks(a,{addCoordinates:!0});}return _this23;}_createClass(BlockDelete$$module$build$src$core$events$events_block_delete,[{key:"toJson",value:function toJson(){var a=_get(_getPrototypeOf(BlockDelete$$module$build$src$core$events$events_block_delete.prototype),"toJson",this).call(this);if(!this.oldXml)throw Error("The old block XML is undefined. Either pass a block to the constructor, or call fromJson");if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(void 0===this.wasShadow)throw Error("Whether the block was a shadow is undefined. Either pass a block to the constructor, or call fromJson");if(!this.oldJson)throw Error("The old block JSON is undefined. Either pass a block to the constructor, or call fromJson");a.oldXml=domToText$$module$build$src$core$xml(this.oldXml);a.ids=this.ids;a.wasShadow=this.wasShadow;a.oldJson=this.oldJson;this.recordUndo||(a.recordUndo=this.recordUndo);return a;}},{key:"fromJson",value:function fromJson(a){_get(_getPrototypeOf(BlockDelete$$module$build$src$core$events$events_block_delete.prototype),"fromJson",this).call(this,a);this.oldXml=textToDom$$module$build$src$core$xml(a.oldXml);this.ids=a.ids;this.wasShadow=a.wasShadow||"shadow"===this.oldXml.tagName.toLowerCase();this.oldJson=a.oldJson;void 0!==a.recordUndo&&(this.recordUndo=a.recordUndo);}},{key:"run",value:function run(a){var b=this.getEventWorkspace_();if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(!this.oldJson)throw Error("The old block JSON is undefined. Either pass a block to the constructor, or call fromJson");if(a)for(a=0;a<this.ids.length;a++){var c=this.ids[a],d=b.getBlockById(c);d?d.dispose(!1):c===this.blockId&&console.warn("Can't delete non-existent block: "+c);}else append$$module$build$src$core$serialization$blocks(this.oldJson,b);}}]);return BlockDelete$$module$build$src$core$events$events_block_delete;}(BlockBase$$module$build$src$core$events$events_block_base);register$$module$build$src$core$registry(Type$$module$build$src$core$registry.EVENT,DELETE$$module$build$src$core$events$utils,BlockDelete$$module$build$src$core$events$events_block_delete);var module$build$src$core$events$events_block_delete={};module$build$src$core$events$events_block_delete.BlockDelete=BlockDelete$$module$build$src$core$events$events_block_delete;var ConnectionType$$module$build$src$core$connection_type;(function(a){a[a.INPUT_VALUE=1]="INPUT_VALUE";a[a.OUTPUT_VALUE=2]="OUTPUT_VALUE";a[a.NEXT_STATEMENT=3]="NEXT_STATEMENT";a[a.PREVIOUS_STATEMENT=4]="PREVIOUS_STATEMENT";})(ConnectionType$$module$build$src$core$connection_type||(ConnectionType$$module$build$src$core$connection_type={}));$.module$build$src$core$connection_type={};$.module$build$src$core$connection_type.ConnectionType=ConnectionType$$module$build$src$core$connection_type;var Connection$$module$build$src$core$connection=/*#__PURE__*/function(){function Connection$$module$build$src$core$connection(a,b){_classCallCheck(this,Connection$$module$build$src$core$connection);this.type=b;this.targetConnection=null;this.disposed=!1;this.shadowDom_=this.check_=null;this.y=this.x=0;this.shadowState_=null;this.sourceBlock_=a;}_createClass(Connection$$module$build$src$core$connection,[{key:"connect_",value:function connect_(a){var b=ConnectionType$$module$build$src$core$connection_type.INPUT_VALUE,c=this.getSourceBlock();var d=a.getSourceBlock();a.isConnected()&&a.disconnect();var e;if(this.isConnected()){var g=this.stashShadowState_(),h=this.targetBlock();h.isShadow()?h.dispose(!1):(this.disconnect(),e=h);this.applyShadowState_(g);}var f;isEnabled$$module$build$src$core$events$utils()&&(f=new(get$$module$build$src$core$events$utils(MOVE$$module$build$src$core$events$utils))(d));connectReciprocally$$module$build$src$core$connection(this,a);d.setParent(c);f&&(f.recordNew(),fire$$module$build$src$core$events$utils(f));if(e)if(a=this.type===b?e.outputConnection:e.previousConnection,d=Connection$$module$build$src$core$connection.getConnectionForOrphanedConnection(d,a))a.connect(d);else a.onFailedConnect(this);}},{key:"dispose",value:function dispose(){if(this.isConnected()){this.setShadowStateInternal_();var a=this.targetBlock();a&&a.unplug();}this.disposed=!0;}},{key:"getSourceBlock",value:function getSourceBlock(){return this.sourceBlock_;}},{key:"isSuperior",value:function isSuperior(){return this.type===ConnectionType$$module$build$src$core$connection_type.INPUT_VALUE||this.type===ConnectionType$$module$build$src$core$connection_type.NEXT_STATEMENT;}},{key:"isConnected",value:function isConnected(){return!!this.targetConnection;}},{key:"getConnectionChecker",value:function getConnectionChecker(){return this.sourceBlock_.workspace.connectionChecker;}},{key:"onFailedConnect",value:function onFailedConnect(a){}},{key:"connect",value:function connect(a){if(this.targetConnection===a)return!0;if(this.getConnectionChecker().canConnect(this,a,!1)){var b=getGroup$$module$build$src$core$events$utils();b||setGroup$$module$build$src$core$events$utils(!0);this.isSuperior()?this.connect_(a):a.connect_(this);b||setGroup$$module$build$src$core$events$utils(!1);}return this.isConnected();}},{key:"disconnect",value:function disconnect(){var a=this.targetConnection;if(!a)throw Error("Source connection not connected.");if(a.targetConnection!==this)throw Error("Target connection not connected to source connection.");var b,c;this.isSuperior()?(b=this.sourceBlock_,c=a.getSourceBlock(),a=this):(b=a.getSourceBlock(),c=this.sourceBlock_);var d=getGroup$$module$build$src$core$events$utils();d||setGroup$$module$build$src$core$events$utils(!0);this.disconnectInternal_(b,c);c.isShadow()||a.respawnShadow_();d||setGroup$$module$build$src$core$events$utils(!1);}},{key:"disconnectInternal_",value:function disconnectInternal_(a,b){var c;isEnabled$$module$build$src$core$events$utils()&&(c=new(get$$module$build$src$core$events$utils(MOVE$$module$build$src$core$events$utils))(b));if(a=this.targetConnection)a.targetConnection=null;this.targetConnection=null;b.setParent(null);c&&(c.recordNew(),fire$$module$build$src$core$events$utils(c));}},{key:"respawnShadow_",value:function respawnShadow_(){this.createShadowBlock_(!0);}},{key:"targetBlock",value:function targetBlock(){if(this.isConnected()){var a,b;return null!=(b=null==(a=this.targetConnection)?void 0:a.getSourceBlock())?b:null;}return null;}},{key:"onCheckChanged_",value:function onCheckChanged_(){!this.isConnected()||this.targetConnection&&this.getConnectionChecker().canConnect(this,this.targetConnection,!1)||(this.isSuperior()?this.targetBlock():this.sourceBlock_).unplug();}},{key:"setCheck",value:function setCheck(a){a?(Array.isArray(a)||(a=[a]),this.check_=a,this.onCheckChanged_()):this.check_=null;return this;}},{key:"getCheck",value:function getCheck(){return this.check_;}},{key:"setShadowDom",value:function setShadowDom(a){this.setShadowStateInternal_({shadowDom:a});}},{key:"getShadowDom",value:function getShadowDom(a){return a&&this.targetBlock().isShadow()?blockToDom$$module$build$src$core$xml(this.targetBlock()):this.shadowDom_;}},{key:"setShadowState",value:function setShadowState(a){this.setShadowStateInternal_({shadowState:a});}},{key:"getShadowState",value:function getShadowState(a){return a&&this.targetBlock()&&this.targetBlock().isShadow()?save$$module$build$src$core$serialization$blocks(this.targetBlock()):this.shadowState_;}},{key:"neighbours",value:function neighbours(a){return[];}},{key:"getParentInput",value:function getParentInput(){var a=null;var b=this.sourceBlock_.inputList;for(var c=0;c<b.length;c++){if(b[c].connection===this){a=b[c];break;}}return a;}},{key:"toString",value:function toString(){var a=this.sourceBlock_;if(!a)return"Orphan Connection";if(a.outputConnection===this)var b="Output Connection of ";else if(a.previousConnection===this)b="Previous Connection of ";else if(a.nextConnection===this)b="Next Connection of ";else{b=null;for(var c=0,d;d=a.inputList[c];c++){if(d.connection===this){b=d;break;}}if(b)b='Input "'+b.name+'" connection on ';else return console.warn("Connection not actually connected to sourceBlock_"),"Orphan Connection";}return b+a.toDevString();}},{key:"stashShadowState_",value:function stashShadowState_(){var a=this.getShadowDom(!0),b=this.getShadowState(!0);this.shadowState_=this.shadowDom_=null;return{shadowDom:a,shadowState:b};}},{key:"applyShadowState_",value:function applyShadowState_(_ref12){var a=_ref12.shadowDom,b=_ref12.shadowState;this.shadowDom_=a;this.shadowState_=b;}},{key:"setShadowStateInternal_",value:function setShadowStateInternal_(){var _ref13=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},_ref13$shadowDom=_ref13.shadowDom,a=_ref13$shadowDom===void 0?null:_ref13$shadowDom,_ref13$shadowState=_ref13.shadowState,b=_ref13$shadowState===void 0?null:_ref13$shadowState;this.shadowDom_=a;this.shadowState_=b;(a=this.targetBlock())?a.isShadow()?(a.dispose(!1),this.respawnShadow_(),this.targetBlock()&&this.targetBlock().isShadow()&&this.serializeShadow_(this.targetBlock())):(a=this.createShadowBlock_(!1),this.serializeShadow_(a),a&&a.dispose(!1)):(this.respawnShadow_(),this.targetBlock()&&this.targetBlock().isShadow()&&this.serializeShadow_(this.targetBlock()));}},{key:"createShadowBlock_",value:function createShadowBlock_(a){var b=this.getSourceBlock();var c=this.getShadowState(),d=this.getShadowDom();if(b.isDeadOrDying()||!c&&!d)return null;if(c)return b=appendInternal$$module$build$src$core$serialization$blocks(c,b.workspace,{parentConnection:a?this:void 0,isShadow:!0,recordUndo:!1});if(d){b=domToBlock$$module$build$src$core$xml(d,b.workspace);if(a)if(this.type===ConnectionType$$module$build$src$core$connection_type.INPUT_VALUE){if(!b.outputConnection)throw Error("Shadow block is missing an output connection");if(!this.connect(b.outputConnection))throw Error("Could not connect shadow block to connection");}else if(this.type===ConnectionType$$module$build$src$core$connection_type.NEXT_STATEMENT){if(!b.previousConnection)throw Error("Shadow block is missing previous connection");if(!this.connect(b.previousConnection))throw Error("Could not connect shadow block to connection");}else throw Error("Cannot connect a shadow block to a previous/output connection");return b;}return null;}},{key:"serializeShadow_",value:function serializeShadow_(a){a&&(this.shadowDom_=blockToDom$$module$build$src$core$xml(a),this.shadowState_=save$$module$build$src$core$serialization$blocks(a));}}],[{key:"getConnectionForOrphanedConnection",value:function getConnectionForOrphanedConnection(a,b){if(b.type===ConnectionType$$module$build$src$core$connection_type.OUTPUT_VALUE)return getConnectionForOrphanedOutput$$module$build$src$core$connection(a,b.getSourceBlock());a=a.lastConnectionInStack(!0);var c=b.getConnectionChecker();return a&&c.canConnect(b,a,!1)?a:null;}}]);return Connection$$module$build$src$core$connection;}();Connection$$module$build$src$core$connection.CAN_CONNECT=0;Connection$$module$build$src$core$connection.REASON_SELF_CONNECTION=1;Connection$$module$build$src$core$connection.REASON_WRONG_TYPE=2;Connection$$module$build$src$core$connection.REASON_TARGET_NULL=3;Connection$$module$build$src$core$connection.REASON_CHECKS_FAILED=4;Connection$$module$build$src$core$connection.REASON_DIFFERENT_WORKSPACES=5;Connection$$module$build$src$core$connection.REASON_SHADOW_PARENT=6;Connection$$module$build$src$core$connection.REASON_DRAG_CHECKS_FAILED=7;Connection$$module$build$src$core$connection.REASON_PREVIOUS_AND_OUTPUT=8;var module$build$src$core$connection={};module$build$src$core$connection.Connection=Connection$$module$build$src$core$connection;var COLLAPSED_INPUT_NAME$$module$build$src$core$constants="_TEMP_COLLAPSED_INPUT",COLLAPSED_FIELD_NAME$$module$build$src$core$constants="_TEMP_COLLAPSED_FIELD",module$build$src$core$constants={};module$build$src$core$constants.COLLAPSED_FIELD_NAME=COLLAPSED_FIELD_NAME$$module$build$src$core$constants;module$build$src$core$constants.COLLAPSED_INPUT_NAME=COLLAPSED_INPUT_NAME$$module$build$src$core$constants;$.FieldLabel$$module$build$src$core$field_label=/*#__PURE__*/function(_Field$$module$build$2){_inherits(_class2,_Field$$module$build$2);var _super20=_createSuper(_class2);function _class2(a,b,c){var _this24;_classCallCheck(this,_class2);_this24=_super20.call(this,Field$$module$build$src$core$field.SKIP_SETUP);_this24.class_=null;_this24.EDITABLE=!1;a!==Field$$module$build$src$core$field.SKIP_SETUP&&(c?_this24.configure_(c):_this24.class_=b||null,_this24.setValue(a));return _this24;}_createClass(_class2,[{key:"configure_",value:function configure_(a){_get(_getPrototypeOf(_class2.prototype),"configure_",this).call(this,a);a["class"]&&(this.class_=a["class"]);}},{key:"initView",value:function initView(){this.createTextElement_();this.class_&&addClass$$module$build$src$core$utils$dom(this.getTextElement(),this.class_);}},{key:"doClassValidation_",value:function doClassValidation_(a){return null===a||void 0===a?null:String(a);}},{key:"setClass",value:function setClass(a){this.textElement_&&(this.class_&&removeClass$$module$build$src$core$utils$dom(this.textElement_,this.class_),a&&addClass$$module$build$src$core$utils$dom(this.textElement_,a));this.class_=a;}}],[{key:"fromJson",value:function fromJson(a){return new this(replaceMessageReferences$$module$build$src$core$utils$parsing(a.text),void 0,a);}}]);return _class2;}(Field$$module$build$src$core$field);register$$module$build$src$core$field_registry("field_label",$.FieldLabel$$module$build$src$core$field_label);$.FieldLabel$$module$build$src$core$field_label.prototype.DEFAULT_VALUE="";var module$build$src$core$field_label={};module$build$src$core$field_label.FieldLabel=$.FieldLabel$$module$build$src$core$field_label;var Input$$module$build$src$core$input=/*#__PURE__*/function(){function Input$$module$build$src$core$input(a,b,c,d){_classCallCheck(this,Input$$module$build$src$core$input);this.type=a;this.name=b;this.connection=d;this.fieldRow=[];this.visible_=!0;if(a!==inputTypes$$module$build$src$core$input_types.DUMMY&&!b)throw Error("Value inputs and statement inputs must have non-empty name.");this.sourceBlock_=c;this.align=$.Align$$module$build$src$core$input.LEFT;}_createClass(Input$$module$build$src$core$input,[{key:"getSourceBlock",value:function getSourceBlock(){return this.sourceBlock_;}},{key:"appendField",value:function appendField(a,b){this.insertFieldAt(this.fieldRow.length,a,b);return this;}},{key:"insertFieldAt",value:function insertFieldAt(a,b,c){if(0>a||a>this.fieldRow.length)throw Error("index "+a+" out of bounds.");if(!(b||""===b&&c))return a;"string"===typeof b&&(b=fromJson$$module$build$src$core$field_registry({type:"field_label",text:b}));b.setSourceBlock(this.sourceBlock_);this.sourceBlock_.rendered&&(b.init(),b.applyColour());b.name=c;b.setVisible(this.isVisible());b.prefixField&&(a=this.insertFieldAt(a,b.prefixField));this.fieldRow.splice(a,0,b);a++;b.suffixField&&(a=this.insertFieldAt(a,b.suffixField));this.sourceBlock_.rendered&&(this.sourceBlock_.render(),this.sourceBlock_.bumpNeighbours());return a;}},{key:"removeField",value:function removeField(a,b){for(var c=0,d;d=this.fieldRow[c];c++){if(d.name===a)return d.dispose(),this.fieldRow.splice(c,1),this.sourceBlock_.rendered&&(this.sourceBlock_.render(),this.sourceBlock_.bumpNeighbours()),!0;}if(b)return!1;throw Error('Field "'+a+'" not found.');}},{key:"isVisible",value:function isVisible(){return this.visible_;}},{key:"setVisible",value:function setVisible(a){var b=[];if(this.visible_===a)return b;this.visible_=a;for(var d=0,e;e=this.fieldRow[d];d++){e.setVisible(a);}if(this.connection){var c=this.connection;a?b=c.startTrackingAll():c.stopTrackingAll();if(c=c.targetBlock())c.getSvgRoot().style.display=a?"block":"none";}return b;}},{key:"markDirty",value:function markDirty(){for(var a=0,b;b=this.fieldRow[a];a++){b.markDirty();}}},{key:"setCheck",value:function setCheck(a){if(!this.connection)throw Error("This input does not have a connection.");this.connection.setCheck(a);return this;}},{key:"setAlign",value:function setAlign(a){this.align=a;this.sourceBlock_.rendered&&this.sourceBlock_.render();return this;}},{key:"setShadowDom",value:function setShadowDom(a){if(!this.connection)throw Error("This input does not have a connection.");this.connection.setShadowDom(a);return this;}},{key:"getShadowDom",value:function getShadowDom(){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.getShadowDom();}},{key:"init",value:function init(){if(this.sourceBlock_.workspace.rendered)for(var a=0;a<this.fieldRow.length;a++){this.fieldRow[a].init();}}},{key:"dispose",value:function dispose(){for(var a=0,b;b=this.fieldRow[a];a++){b.dispose();}this.connection&&this.connection.dispose();}}]);return Input$$module$build$src$core$input;}(),module$build$src$core$input;(function(a){a=a.Align||(a.Align={});a[a.LEFT=-1]="LEFT";a[a.CENTRE=0]="CENTRE";a[a.RIGHT=1]="RIGHT";})(Input$$module$build$src$core$input||(Input$$module$build$src$core$input={}));$.Align$$module$build$src$core$input=Input$$module$build$src$core$input.Align;module$build$src$core$input={};module$build$src$core$input.Align=$.Align$$module$build$src$core$input;module$build$src$core$input.Input=Input$$module$build$src$core$input;var _ASTNode$$module$build$src$core$keyboard_nav$ast_node=/*#__PURE__*/function(){function ASTNode$$module$build$src$core$keyboard_nav$ast_node(a,b,c){_classCallCheck(this,ASTNode$$module$build$src$core$keyboard_nav$ast_node);this.wsCoordinate_=null;if(!b)throw Error("Cannot create a node without a location.");this.type_=a;this.isConnection_=_ASTNode$$module$build$src$core$keyboard_nav$ast_node.isConnectionType_(a);this.location_=b;this.processParams_(c||null);}_createClass(ASTNode$$module$build$src$core$keyboard_nav$ast_node,[{key:"processParams_",value:function processParams_(a){a&&a.wsCoordinate&&(this.wsCoordinate_=a.wsCoordinate);}},{key:"getLocation",value:function getLocation(){return this.location_;}},{key:"getType",value:function getType(){return this.type_;}},{key:"getWsCoordinate",value:function getWsCoordinate(){return this.wsCoordinate_;}},{key:"isConnection",value:function isConnection(){return this.isConnection_;}},{key:"findNextForInput_",value:function findNextForInput_(){var a=this.location_.getParentInput();var b=a.getSourceBlock();a=b.inputList.indexOf(a);for(a+=1;a<b.inputList.length;a++){var c=b.inputList[a],d=c.fieldRow;for(var e=0;e<d.length;e++){var f=d[e];if(f.isClickable()||_ASTNode$$module$build$src$core$keyboard_nav$ast_node.NAVIGATE_ALL_FIELDS)return _ASTNode$$module$build$src$core$keyboard_nav$ast_node.createFieldNode(f);}if(c.connection)return _ASTNode$$module$build$src$core$keyboard_nav$ast_node.createInputNode(c);}return null;}},{key:"findNextForField_",value:function findNextForField_(){var a=this.location_,b=a.getParentInput();var c=a.getSourceBlock();if(!c)throw Error("The current AST location is not associated with a block");var d=c.inputList.indexOf(b);for(a=b.fieldRow.indexOf(a)+1;d<c.inputList.length;d++){b=c.inputList[d];var e=b.fieldRow;for(;a<e.length;){if(e[a].isClickable()||_ASTNode$$module$build$src$core$keyboard_nav$ast_node.NAVIGATE_ALL_FIELDS)return _ASTNode$$module$build$src$core$keyboard_nav$ast_node.createFieldNode(e[a]);a++;}a=0;if(b.connection)return _ASTNode$$module$build$src$core$keyboard_nav$ast_node.createInputNode(b);}return null;}},{key:"findPrevForInput_",value:function findPrevForInput_(){var a=this.location_.getParentInput(),b=a.getSourceBlock();for(var c=b.inputList.indexOf(a);0<=c;c--){var d=b.inputList[c];if(d.connection&&d!==a)return _ASTNode$$module$build$src$core$keyboard_nav$ast_node.createInputNode(d);d=d.fieldRow;for(var e=d.length-1;0<=e;e--){var f=d[e];if(f.isClickable()||_ASTNode$$module$build$src$core$keyboard_nav$ast_node.NAVIGATE_ALL_FIELDS)return _ASTNode$$module$build$src$core$keyboard_nav$ast_node.createFieldNode(f);}}return null;}},{key:"findPrevForField_",value:function findPrevForField_(){var a=this.location_;var b=a.getParentInput(),c=a.getSourceBlock();if(!c)throw Error("The current AST location is not associated with a block");var d=c.inputList.indexOf(b);for(a=b.fieldRow.indexOf(a)-1;0<=d;d--){var e=c.inputList[d];if(e.connection&&e!==b)return _ASTNode$$module$build$src$core$keyboard_nav$ast_node.createInputNode(e);for(e=e.fieldRow;-1<a;){if(e[a].isClickable()||_ASTNode$$module$build$src$core$keyboard_nav$ast_node.NAVIGATE_ALL_FIELDS)return _ASTNode$$module$build$src$core$keyboard_nav$ast_node.createFieldNode(e[a]);a--;}0<=d-1&&(a=c.inputList[d-1].fieldRow.length-1);}return null;}},{key:"navigateBetweenStacks_",value:function navigateBetweenStacks_(a){var b=this.getLocation();if(b.getSourceBlock){var c=b.getSourceBlock();c&&(b=c);}if(!b||b.isDeadOrDying())return null;c=b.getRootBlock();b=c.workspace.getTopBlocks(!0);for(var d=0;d<b.length;d++){if(c.id===b[d].id)return a=d+(a?1:-1),-1===a||a===b.length?null:_ASTNode$$module$build$src$core$keyboard_nav$ast_node.createStackNode(b[a]);}throw Error("Couldn't find "+(a?"next":"previous")+" stack?!");}},{key:"findTopASTNodeForBlock_",value:function findTopASTNodeForBlock_(a){var b=getParentConnection$$module$build$src$core$keyboard_nav$ast_node(a);return b?_ASTNode$$module$build$src$core$keyboard_nav$ast_node.createConnectionNode(b):_ASTNode$$module$build$src$core$keyboard_nav$ast_node.createBlockNode(a);}},{key:"getOutAstNodeForBlock_",value:function getOutAstNodeForBlock_(a){if(!a)return null;a=a.getTopStackBlock();var b=getParentConnection$$module$build$src$core$keyboard_nav$ast_node(a);return b&&b.targetConnection&&b.targetConnection.getParentInput()?_ASTNode$$module$build$src$core$keyboard_nav$ast_node.createInputNode(b.targetConnection.getParentInput()):_ASTNode$$module$build$src$core$keyboard_nav$ast_node.createStackNode(a);}},{key:"findFirstFieldOrInput_",value:function findFirstFieldOrInput_(a){a=a.inputList;for(var b=0;b<a.length;b++){var c=a[b],d=c.fieldRow;for(var e=0;e<d.length;e++){var f=d[e];if(f.isClickable()||_ASTNode$$module$build$src$core$keyboard_nav$ast_node.NAVIGATE_ALL_FIELDS)return _ASTNode$$module$build$src$core$keyboard_nav$ast_node.createFieldNode(f);}if(c.connection)return _ASTNode$$module$build$src$core$keyboard_nav$ast_node.createInputNode(c);}return null;}},{key:"getSourceBlock",value:function getSourceBlock(){return this.getType()===_ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.BLOCK?this.getLocation():this.getType()===_ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.STACK?this.getLocation():this.getType()===_ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.WORKSPACE?null:this.getLocation().getSourceBlock();}},{key:"next",value:function next(){switch(this.type_){case _ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.STACK:return this.navigateBetweenStacks_(!0);case _ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.OUTPUT:return _ASTNode$$module$build$src$core$keyboard_nav$ast_node.createBlockNode(this.location_.getSourceBlock());case _ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.FIELD:return this.findNextForField_();case _ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.INPUT:return this.findNextForInput_();case _ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.BLOCK:return _ASTNode$$module$build$src$core$keyboard_nav$ast_node.createConnectionNode(this.location_.nextConnection);case _ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.PREVIOUS:return _ASTNode$$module$build$src$core$keyboard_nav$ast_node.createBlockNode(this.location_.getSourceBlock());case _ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.NEXT:return _ASTNode$$module$build$src$core$keyboard_nav$ast_node.createConnectionNode(this.location_.targetConnection);}return null;}},{key:"in",value:function _in(){switch(this.type_){case _ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.WORKSPACE:var a=this.location_.getTopBlocks(!0);if(0<a.length)return _ASTNode$$module$build$src$core$keyboard_nav$ast_node.createStackNode(a[0]);break;case _ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.STACK:return this.findTopASTNodeForBlock_(this.location_);case _ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.BLOCK:return this.findFirstFieldOrInput_(this.location_);case _ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.INPUT:return _ASTNode$$module$build$src$core$keyboard_nav$ast_node.createConnectionNode(this.location_.targetConnection);}return null;}},{key:"prev",value:function prev(){switch(this.type_){case _ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.STACK:return this.navigateBetweenStacks_(!1);case _ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.FIELD:return this.findPrevForField_();case _ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.INPUT:return this.findPrevForInput_();case _ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.BLOCK:var a=getParentConnection$$module$build$src$core$keyboard_nav$ast_node(this.location_);return _ASTNode$$module$build$src$core$keyboard_nav$ast_node.createConnectionNode(a);case _ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.PREVIOUS:if((a=this.location_.targetConnection)&&!a.getParentInput())return _ASTNode$$module$build$src$core$keyboard_nav$ast_node.createConnectionNode(a);break;case _ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.NEXT:return _ASTNode$$module$build$src$core$keyboard_nav$ast_node.createBlockNode(this.location_.getSourceBlock());}return null;}},{key:"out",value:function out(){switch(this.type_){case _ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.STACK:var a=this.location_,b=a.getRelativeToSurfaceXY();b=new Coordinate$$module$build$src$core$utils$coordinate(b.x,b.y+_ASTNode$$module$build$src$core$keyboard_nav$ast_node.DEFAULT_OFFSET_Y);return _ASTNode$$module$build$src$core$keyboard_nav$ast_node.createWorkspaceNode(a.workspace,b);case _ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.OUTPUT:return a=this.location_,(b=a.targetConnection)?_ASTNode$$module$build$src$core$keyboard_nav$ast_node.createConnectionNode(b):_ASTNode$$module$build$src$core$keyboard_nav$ast_node.createStackNode(a.getSourceBlock());case _ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.FIELD:a=this.location_.getSourceBlock();if(!a)throw Error("The current AST location is not associated with a block");return _ASTNode$$module$build$src$core$keyboard_nav$ast_node.createBlockNode(a);case _ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.INPUT:return _ASTNode$$module$build$src$core$keyboard_nav$ast_node.createBlockNode(this.location_.getSourceBlock());case _ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.BLOCK:return this.getOutAstNodeForBlock_(this.location_);case _ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.PREVIOUS:return this.getOutAstNodeForBlock_(this.location_.getSourceBlock());case _ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.NEXT:return this.getOutAstNodeForBlock_(this.location_.getSourceBlock());}return null;}}],[{key:"isConnectionType_",value:function isConnectionType_(a){switch(a){case _ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.PREVIOUS:case _ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.NEXT:case _ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.INPUT:case _ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.OUTPUT:return!0;}return!1;}},{key:"createFieldNode",value:function createFieldNode(a){return a?new _ASTNode$$module$build$src$core$keyboard_nav$ast_node(_ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.FIELD,a):null;}},{key:"createConnectionNode",value:function createConnectionNode(a){if(!a)return null;var b=a.type;return b===ConnectionType$$module$build$src$core$connection_type.INPUT_VALUE||b===ConnectionType$$module$build$src$core$connection_type.NEXT_STATEMENT&&a.getParentInput()?_ASTNode$$module$build$src$core$keyboard_nav$ast_node.createInputNode(a.getParentInput()):b===ConnectionType$$module$build$src$core$connection_type.NEXT_STATEMENT?new _ASTNode$$module$build$src$core$keyboard_nav$ast_node(_ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.NEXT,a):b===ConnectionType$$module$build$src$core$connection_type.OUTPUT_VALUE?new _ASTNode$$module$build$src$core$keyboard_nav$ast_node(_ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.OUTPUT,a):b===ConnectionType$$module$build$src$core$connection_type.PREVIOUS_STATEMENT?new _ASTNode$$module$build$src$core$keyboard_nav$ast_node(_ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.PREVIOUS,a):null;}},{key:"createInputNode",value:function createInputNode(a){return a&&a.connection?new _ASTNode$$module$build$src$core$keyboard_nav$ast_node(_ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.INPUT,a.connection):null;}},{key:"createBlockNode",value:function createBlockNode(a){return a?new _ASTNode$$module$build$src$core$keyboard_nav$ast_node(_ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.BLOCK,a):null;}},{key:"createStackNode",value:function createStackNode(a){return a?new _ASTNode$$module$build$src$core$keyboard_nav$ast_node(_ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.STACK,a):null;}},{key:"createWorkspaceNode",value:function createWorkspaceNode(a,b){return b&&a?new _ASTNode$$module$build$src$core$keyboard_nav$ast_node(_ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.WORKSPACE,a,{wsCoordinate:b}):null;}},{key:"createTopNode",value:function createTopNode(a){var b=getParentConnection$$module$build$src$core$keyboard_nav$ast_node(a);return b?_ASTNode$$module$build$src$core$keyboard_nav$ast_node.createConnectionNode(b):_ASTNode$$module$build$src$core$keyboard_nav$ast_node.createBlockNode(a);}}]);return ASTNode$$module$build$src$core$keyboard_nav$ast_node;}();_ASTNode$$module$build$src$core$keyboard_nav$ast_node.NAVIGATE_ALL_FIELDS=!1;_ASTNode$$module$build$src$core$keyboard_nav$ast_node.DEFAULT_OFFSET_Y=-20;(function(a){a=a.types||(a.types={});a.FIELD="field";a.BLOCK="block";a.INPUT="input";a.OUTPUT="output";a.NEXT="next";a.PREVIOUS="previous";a.STACK="stack";a.WORKSPACE="workspace";})(_ASTNode$$module$build$src$core$keyboard_nav$ast_node||(_ASTNode$$module$build$src$core$keyboard_nav$ast_node={}));var module$build$src$core$keyboard_nav$ast_node={};module$build$src$core$keyboard_nav$ast_node.ASTNode=_ASTNode$$module$build$src$core$keyboard_nav$ast_node;var Block$$module$build$src$core$block=/*#__PURE__*/function(){function Block$$module$build$src$core$block(a,b,c){_classCallCheck(this,Block$$module$build$src$core$block);this.data=null;this.disposed=!1;this.hue_=null;this.colour_="#000000";this.styleName_="";this.loadExtraState=this.saveExtraState=this.domToMutation=this.mutationToDom=this.init=void 0;this.suppressPrefixSuffix=!1;this.decompose=this.compose=this.getDeveloperVariables=void 0;this.previousConnection=this.nextConnection=this.outputConnection=null;this.inputList=[];this.inputsInline=void 0;this.disabled=!1;this.tooltip="";this.contextMenu=!0;this.parentBlock_=null;this.childBlocks_=[];this.editable_=this.movable_=this.deletable_=!0;this.collapsed_=this.isShadow_=!1;this.outputShape_=null;this.disposing=!1;this.comment=null;this.isInsertionMarker_=!1;this.hat=void 0;this.onchangeWrapper_=this.helpUrl=this.rendered=null;this.statementInputCount=0;this.workspace=a;this.id=c&&!a.getBlockById(c)?c:genUid$$module$build$src$core$utils$idgenerator();a.setBlockById(this.id,this);this.commentModel={text:null,pinned:!1,size:new Size$$module$build$src$core$utils$size(160,80)};this.xy_=new Coordinate$$module$build$src$core$utils$coordinate(0,0);this.isInFlyout=a.isFlyout;this.isInMutator=a.isMutator;this.RTL=a.RTL;if(b){this.type=b;c=Blocks$$module$build$src$core$blocks[b];if(!c||"object"!==_typeof(c))throw TypeError("Invalid block definition for type: "+b);Object.assign(this,c);}a.addTopBlock(this);a.addTypedBlock(this);(this instanceof Block$$module$build$src$core$block?this.constructor:void 0)===Block$$module$build$src$core$block&&this.doInit_();}_createClass(Block$$module$build$src$core$block,[{key:"doInit_",value:function doInit_(){var a=getGroup$$module$build$src$core$events$utils();a||setGroup$$module$build$src$core$events$utils(!0);var b=getRecordUndo$$module$build$src$core$events$utils();try{"function"===typeof this.init&&(setRecordUndo$$module$build$src$core$events$utils(!1),this.init(),setRecordUndo$$module$build$src$core$events$utils(b)),isEnabled$$module$build$src$core$events$utils()&&fire$$module$build$src$core$events$utils(new(get$$module$build$src$core$events$utils(CREATE$$module$build$src$core$events$utils))(this));}finally{a||setGroup$$module$build$src$core$events$utils(!1),setRecordUndo$$module$build$src$core$events$utils(b);}this.inputsInlineDefault=this.inputsInline;"function"===typeof this.onchange&&this.setOnChange(this.onchange);}},{key:"dispose",value:function dispose(a){if(!this.isDeadOrDying()){this.unplug(a);isEnabled$$module$build$src$core$events$utils()&&fire$$module$build$src$core$events$utils(new(get$$module$build$src$core$events$utils(DELETE$$module$build$src$core$events$utils))(this));this.onchangeWrapper_&&this.workspace.removeChangeListener(this.onchangeWrapper_);disable$$module$build$src$core$events$utils();try{this.workspace.removeTopBlock(this);this.workspace.removeTypedBlock(this);this.workspace.removeBlockById(this.id);this.disposing=!0;for(var c=this.childBlocks_.length-1;0<=c;c--){this.childBlocks_[c].dispose(!1);}for(var _c2=0,d;d=this.inputList[_c2];_c2++){d.dispose();}this.inputList.length=0;var b=this.getConnections_(!0);for(var _c3=0,_d5;_d5=b[_c3];_c3++){_d5.dispose();}}finally{enable$$module$build$src$core$events$utils(),this.disposed=!0;}}}},{key:"isDeadOrDying",value:function isDeadOrDying(){return this.disposing||this.disposed;}},{key:"initModel",value:function initModel(){for(var a=0,b;b=this.inputList[a];a++){for(var c=0,d;d=b.fieldRow[c];c++){d.initModel&&d.initModel();}}}},{key:"unplug",value:function unplug(a){this.outputConnection&&this.unplugFromRow_(a);this.previousConnection&&this.unplugFromStack_(a);}},{key:"unplugFromRow_",value:function unplugFromRow_(a){var b=null;this.outputConnection.isConnected()&&(b=this.outputConnection.targetConnection,this.outputConnection.disconnect());b&&a&&(a=this.getOnlyValueConnection_())&&a.isConnected()&&!a.targetBlock().isShadow()&&(a=a.targetConnection,null==a||a.disconnect(),this.workspace.connectionChecker.canConnect(a,b,!1)?b.connect(a):null==a||a.onFailedConnect(b));}},{key:"getOnlyValueConnection_",value:function getOnlyValueConnection_(){var a=null;for(var b=0;b<this.inputList.length;b++){var c=this.inputList[b].connection;if(c&&c.type===ConnectionType$$module$build$src$core$connection_type.INPUT_VALUE&&c.targetConnection){if(a)return null;a=c;}}return a;}},{key:"unplugFromStack_",value:function unplugFromStack_(a){var b=null;this.previousConnection.isConnected()&&(b=this.previousConnection.targetConnection,this.previousConnection.disconnect());var c=this.getNextBlock();a&&c&&!c.isShadow()&&(a=this.nextConnection.targetConnection,null==a||a.disconnect(),b&&this.workspace.connectionChecker.canConnect(b,a,!1)&&b.connect(a));}},{key:"getConnections_",value:function getConnections_(a){a=[];this.outputConnection&&a.push(this.outputConnection);this.previousConnection&&a.push(this.previousConnection);this.nextConnection&&a.push(this.nextConnection);for(var b=0,c;c=this.inputList[b];b++){c.connection&&a.push(c.connection);}return a;}},{key:"lastConnectionInStack",value:function lastConnectionInStack(a){var b=this.nextConnection;for(;b;){var c=b.targetBlock();if(!c||a&&c.isShadow())return b;b=c.nextConnection;}return null;}},{key:"bumpNeighbours",value:function bumpNeighbours(){}},{key:"getParent",value:function getParent(){return this.parentBlock_;}},{key:"getInputWithBlock",value:function getInputWithBlock(a){for(var b=0,c;c=this.inputList[b];b++){if(c.connection&&c.connection.targetBlock()===a)return c;}return null;}},{key:"getSurroundParent",value:function getSurroundParent(){var a=this,b;do{if(b=a,a=a.getParent(),!a)return null;}while(a.getNextBlock()===b);return a;}},{key:"getNextBlock",value:function getNextBlock(){return this.nextConnection&&this.nextConnection.targetBlock();}},{key:"getPreviousBlock",value:function getPreviousBlock(){return this.previousConnection&&this.previousConnection.targetBlock();}},{key:"getFirstStatementConnection",value:function getFirstStatementConnection(){for(var a=0,b;b=this.inputList[a];a++){if(b.connection&&b.connection.type===ConnectionType$$module$build$src$core$connection_type.NEXT_STATEMENT)return b.connection;}return null;}},{key:"getRootBlock",value:function getRootBlock(){var a,b=this;do{a=b,b=a.parentBlock_;}while(b);return a;}},{key:"getTopStackBlock",value:function getTopStackBlock(){var a=this,b;do{b=a.getPreviousBlock();}while(b&&b.getNextBlock()===a&&(a=b));return a;}},{key:"getChildren",value:function getChildren(a){if(!a)return this.childBlocks_;a=[];for(var c=0,d;d=this.inputList[c];c++){if(d.connection){var b=d.connection.targetBlock();b&&a.push(b);}}(b=this.getNextBlock())&&a.push(b);return a;}},{key:"setParent",value:function setParent(a){if(a!==this.parentBlock_){var b=this.previousConnection&&this.previousConnection.targetBlock()||this.outputConnection&&this.outputConnection.targetBlock(),c=!!b;if(c&&a&&b!==a)throw Error("Block connected to superior one that is not new parent.");if(!c&&a)throw Error("Block not connected to new parent.");if(c&&!a)throw Error("Cannot set parent to null while block is still connected to superior block.");this.parentBlock_?removeElem$$module$build$src$core$utils$array(this.parentBlock_.childBlocks_,this):this.workspace.removeTopBlock(this);(this.parentBlock_=a)?a.childBlocks_.push(this):this.workspace.addTopBlock(this);}}},{key:"getDescendants",value:function getDescendants(a){var b=[this],c=this.getChildren(a);for(var d,e=0;d=c[e];e++){b.push.apply(b,_toConsumableArray(d.getDescendants(a)));}return b;}},{key:"isDeletable",value:function isDeletable(){return this.deletable_&&!this.isShadow_&&!this.isDeadOrDying()&&!this.workspace.options.readOnly;}},{key:"setDeletable",value:function setDeletable(a){this.deletable_=a;}},{key:"isMovable",value:function isMovable(){return this.movable_&&!this.isShadow_&&!this.isDeadOrDying()&&!this.workspace.options.readOnly;}},{key:"setMovable",value:function setMovable(a){this.movable_=a;}},{key:"isDuplicatable",value:function isDuplicatable(){return this.workspace.hasBlockLimits()?this.workspace.isCapacityAvailable(getBlockTypeCounts$$module$build$src$core$common(this,!0)):!0;}},{key:"isShadow",value:function isShadow(){return this.isShadow_;}},{key:"setShadow",value:function setShadow(a){this.isShadow_=a;}},{key:"isInsertionMarker",value:function isInsertionMarker(){return this.isInsertionMarker_;}},{key:"setInsertionMarker",value:function setInsertionMarker(a){this.isInsertionMarker_=a;}},{key:"isEditable",value:function isEditable(){return this.editable_&&!this.isDeadOrDying()&&!this.workspace.options.readOnly;}},{key:"setEditable",value:function setEditable(a){this.editable_=a;for(var b=0,c;c=this.inputList[b];b++){for(var d=0,e;e=c.fieldRow[d];d++){e.updateEditable();}}}},{key:"isDisposed",value:function isDisposed(){return this.disposed;}},{key:"getMatchingConnection",value:function getMatchingConnection(a,b){var c=this.getConnections_(!0);a=a.getConnections_(!0);if(c.length!==a.length)throw Error("Connection lists did not match in length.");for(var d=0;d<a.length;d++){if(a[d]===b)return c[d];}return null;}},{key:"setHelpUrl",value:function setHelpUrl(a){this.helpUrl=a;}},{key:"setTooltip",value:function setTooltip(a){this.tooltip=a;}},{key:"getTooltip",value:function getTooltip(){return getTooltipOfObject$$module$build$src$core$tooltip(this);}},{key:"getColour",value:function getColour(){return this.colour_;}},{key:"getStyleName",value:function getStyleName(){return this.styleName_;}},{key:"getHue",value:function getHue(){return this.hue_;}},{key:"setColour",value:function setColour(a){a=parseBlockColour$$module$build$src$core$utils$parsing(a);this.hue_=a.hue;this.colour_=a.hex;}},{key:"setStyle",value:function setStyle(a){this.styleName_=a;}},{key:"setOnChange",value:function setOnChange(a){if(a&&"function"!==typeof a)throw Error("onchange must be a function.");this.onchangeWrapper_&&this.workspace.removeChangeListener(this.onchangeWrapper_);this.onchange=a;this.onchangeWrapper_=a.bind(this);this.workspace.addChangeListener(this.onchangeWrapper_);}},{key:"getField",value:function getField(a){if("string"!==typeof a)throw TypeError("Block.prototype.getField expects a string with the field name but received "+(void 0===a?"nothing":a+" of type "+_typeof(a))+" instead");for(var b=0,c;c=this.inputList[b];b++){for(var d=0,e;e=c.fieldRow[d];d++){if(e.name===a)return e;}}return null;}},{key:"getVars",value:function getVars(){var a=[];for(var b=0,c;c=this.inputList[b];b++){for(var d=0,e;e=c.fieldRow[d];d++){e.referencesVariables()&&a.push(e.getValue());}}return a;}},{key:"getVarModels",value:function getVarModels(){var a=[];for(var b=0,c;c=this.inputList[b];b++){for(var d=0,e;e=c.fieldRow[d];d++){if(e.referencesVariables()){var f=this.workspace.getVariableById(e.getValue());f&&a.push(f);}}}return a;}},{key:"updateVarName",value:function updateVarName(a){for(var b=0,c;c=this.inputList[b];b++){for(var d=0,e;e=c.fieldRow[d];d++){e.referencesVariables()&&a.getId()===e.getValue()&&e.refreshVariableName();}}}},{key:"renameVarById",value:function renameVarById(a,b){for(var c=0,d;d=this.inputList[c];c++){for(var e=0,f;f=d.fieldRow[e];e++){f.referencesVariables()&&a===f.getValue()&&f.setValue(b);}}}},{key:"getFieldValue",value:function getFieldValue(a){return(a=this.getField(a))?a.getValue():null;}},{key:"setFieldValue",value:function setFieldValue(a,b){var c=this.getField(b);if(!c)throw Error('Field "'+b+'" not found.');c.setValue(a);}},{key:"setPreviousStatement",value:function setPreviousStatement(a,b){if(a)void 0===b&&(b=null),this.previousConnection||(this.previousConnection=this.makeConnection_(ConnectionType$$module$build$src$core$connection_type.PREVIOUS_STATEMENT)),this.previousConnection.setCheck(b);else if(this.previousConnection){if(this.previousConnection.isConnected())throw Error("Must disconnect previous statement before removing connection.");this.previousConnection.dispose();this.previousConnection=null;}}},{key:"setNextStatement",value:function setNextStatement(a,b){if(a)void 0===b&&(b=null),this.nextConnection||(this.nextConnection=this.makeConnection_(ConnectionType$$module$build$src$core$connection_type.NEXT_STATEMENT)),this.nextConnection.setCheck(b);else if(this.nextConnection){if(this.nextConnection.isConnected())throw Error("Must disconnect next statement before removing connection.");this.nextConnection.dispose();this.nextConnection=null;}}},{key:"setOutput",value:function setOutput(a,b){if(a)void 0===b&&(b=null),this.outputConnection||(this.outputConnection=this.makeConnection_(ConnectionType$$module$build$src$core$connection_type.OUTPUT_VALUE)),this.outputConnection.setCheck(b);else if(this.outputConnection){if(this.outputConnection.isConnected())throw Error("Must disconnect output value before removing connection.");this.outputConnection.dispose();this.outputConnection=null;}}},{key:"setInputsInline",value:function setInputsInline(a){this.inputsInline!==a&&(fire$$module$build$src$core$events$utils(new(get$$module$build$src$core$events$utils(CHANGE$$module$build$src$core$events$utils))(this,"inline",null,this.inputsInline,a)),this.inputsInline=a);}},{key:"getInputsInline",value:function getInputsInline(){if(void 0!==this.inputsInline)return this.inputsInline;for(var a=1;a<this.inputList.length;a++){if(this.inputList[a-1].type===inputTypes$$module$build$src$core$input_types.DUMMY&&this.inputList[a].type===inputTypes$$module$build$src$core$input_types.DUMMY)return!1;}for(a=1;a<this.inputList.length;a++){if(this.inputList[a-1].type===inputTypes$$module$build$src$core$input_types.VALUE&&this.inputList[a].type===inputTypes$$module$build$src$core$input_types.DUMMY)return!0;}return!1;}},{key:"setOutputShape",value:function setOutputShape(a){this.outputShape_=a;}},{key:"getOutputShape",value:function getOutputShape(){return this.outputShape_;}},{key:"isEnabled",value:function isEnabled(){return!this.disabled;}},{key:"setEnabled",value:function setEnabled(a){if(this.isEnabled()!==a){var b=this.disabled;this.disabled=!a;fire$$module$build$src$core$events$utils(new(get$$module$build$src$core$events$utils(CHANGE$$module$build$src$core$events$utils))(this,"disabled",null,b,!a));}}},{key:"getInheritedDisabled",value:function getInheritedDisabled(){var a=this.getSurroundParent();for(;a;){if(a.disabled)return!0;a=a.getSurroundParent();}return!1;}},{key:"isCollapsed",value:function isCollapsed(){return this.collapsed_;}},{key:"setCollapsed",value:function setCollapsed(a){this.collapsed_!==a&&(fire$$module$build$src$core$events$utils(new(get$$module$build$src$core$events$utils(CHANGE$$module$build$src$core$events$utils))(this,"collapsed",null,this.collapsed_,a)),this.collapsed_=a);}},{key:"toString",value:function toString(a,b){function c(l){var m=l.getCheck();!m&&l.targetConnection&&(m=l.targetConnection.getCheck());return!!m&&(-1!==m.indexOf("Boolean")||-1!==m.indexOf("Number"));}function d(){var l,m;g&&g.getType()===(null==(l=h)?void 0:l.getType())&&g.getLocation()===(null==(m=h)?void 0:m.getLocation())&&(g=null);}var e=[];b=b||"?";var f=_ASTNode$$module$build$src$core$keyboard_nav$ast_node.NAVIGATE_ALL_FIELDS;_ASTNode$$module$build$src$core$keyboard_nav$ast_node.NAVIGATE_ALL_FIELDS=!0;var g=_ASTNode$$module$build$src$core$keyboard_nav$ast_node.createBlockNode(this);var h=g;for(;g;){switch(g.getType()){case _ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.INPUT:var k=g.getLocation();g["in"]()?c(k)&&e.push("("):e.push(b);break;case _ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.FIELD:k=g.getLocation(),k.name!==COLLAPSED_FIELD_NAME$$module$build$src$core$constants&&e.push(k.getText());}k=g;g=k["in"]()||k.next();if(!g){g=k.out();for(d();g&&!g.next();){g=g.out(),d(),g&&g.getType()===_ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.INPUT&&c(g.getLocation())&&e.push(")");}g&&(g=g.next());}}_ASTNode$$module$build$src$core$keyboard_nav$ast_node.NAVIGATE_ALL_FIELDS=f;for(b=2;b<e.length;b++){"("===e[b-2]&&")"===e[b]&&(e[b-2]=e[b-1],e.splice(b-1,2));}e=e.reduce(function(l,m){return l+("("===l.substr(-1)||")"===m?"":" ")+m;},"");e=e.trim()||"???";a&&e.length>a&&(e=e.substring(0,a-3)+"...");return e;}},{key:"appendValueInput",value:function appendValueInput(a){return this.appendInput_(inputTypes$$module$build$src$core$input_types.VALUE,a);}},{key:"appendStatementInput",value:function appendStatementInput(a){return this.appendInput_(inputTypes$$module$build$src$core$input_types.STATEMENT,a);}},{key:"appendDummyInput",value:function appendDummyInput(a){return this.appendInput_(inputTypes$$module$build$src$core$input_types.DUMMY,a||"");}},{key:"jsonInit",value:function jsonInit(a){var b=a.type?'Block "'+a.type+'": ':"";if(a.output&&a.previousStatement)throw Error(b+"Must not have both an output and a previousStatement.");a.style&&a.style.hat&&(this.hat=a.style.hat,a.style=null);if(a.style&&a.colour)throw Error(b+"Must not have both a colour and a style.");a.style?this.jsonInitStyle_(a,b):this.jsonInitColour_(a,b);for(var c=0;void 0!==a["message"+c];){this.interpolate_(a["message"+c],a["args"+c]||[],a["lastDummyAlign"+c],b),c++;}void 0!==a.inputsInline&&this.setInputsInline(a.inputsInline);void 0!==a.output&&this.setOutput(!0,a.output);void 0!==a.outputShape&&this.setOutputShape(a.outputShape);void 0!==a.previousStatement&&this.setPreviousStatement(!0,a.previousStatement);void 0!==a.nextStatement&&this.setNextStatement(!0,a.nextStatement);void 0!==a.tooltip&&(c=replaceMessageReferences$$module$build$src$core$utils$parsing(a.tooltip),this.setTooltip(c));void 0!==a.enableContextMenu&&(this.contextMenu=!!a.enableContextMenu);void 0!==a.suppressPrefixSuffix&&(this.suppressPrefixSuffix=!!a.suppressPrefixSuffix);void 0!==a.helpUrl&&(c=replaceMessageReferences$$module$build$src$core$utils$parsing(a.helpUrl),this.setHelpUrl(c));"string"===typeof a.extensions&&(console.warn(b+"JSON attribute 'extensions' should be an array of strings. Found raw string in JSON for '"+a.type+"' block."),a.extensions=[a.extensions]);void 0!==a.mutator&&apply$$module$build$src$core$extensions(a.mutator,this,!0);a=a.extensions;if(Array.isArray(a))for(b=0;b<a.length;b++){apply$$module$build$src$core$extensions(a[b],this,!1);}}},{key:"jsonInitColour_",value:function jsonInitColour_(a,b){if("colour"in a)if(void 0===a.colour)console.warn(b+"Undefined colour value.");else{a=a.colour;try{this.setColour(a);}catch(c){console.warn(b+"Illegal colour value: ",a);}}}},{key:"jsonInitStyle_",value:function jsonInitStyle_(a,b){a=a.style;try{this.setStyle(a);}catch(c){console.warn(b+"Style does not exist: ",a);}}},{key:"mixin",value:function mixin(a,b){if(void 0!==b&&"boolean"!==typeof b)throw Error("opt_disableCheck must be a boolean if provided");if(!b){b=[];for(var c in a){void 0!==this[c]&&b.push(c);}if(b.length)throw Error("Mixin will overwrite block members: "+JSON.stringify(b));}Object.assign(this,a);}},{key:"interpolate_",value:function interpolate_(a,b,c,d){a=tokenizeInterpolation$$module$build$src$core$utils$parsing(a);this.validateTokens_(a,b.length);b=this.interpolateArguments_(a,b,c);c=[];for(var e=0,f;f=b[e];e++){if(this.isInputKeyword_(f.type)){if(a=this.inputFromJson_(f,d)){for(var g=0,h;h=c[g];g++){a.appendField(h[0],h[1]);}c.length=0;}}else(a=this.fieldFromJson_(f))&&c.push([a,f.name]);}}},{key:"validateTokens_",value:function validateTokens_(a,b){var c=[];var d=0;for(var e=0;e<a.length;e++){var f=a[e];if("number"===typeof f){if(1>f||f>b)throw Error('Block "'+this.type+'": Message index %'+f+" out of range.");if(c[f])throw Error('Block "'+this.type+'": Message index %'+f+" duplicated.");c[f]=!0;d++;}}if(d!==b)throw Error('Block "'+this.type+'": Message does not reference all '+b+" arg(s).");}},{key:"interpolateArguments_",value:function interpolateArguments_(a,b,c){var d=[];for(var e=0;e<a.length;e++){var f=a[e];"number"===typeof f&&(f=b[f-1]);if("string"===typeof f&&(f=this.stringToFieldJson_(f),!f))continue;d.push(f);}(a=d.length)&&!this.isInputKeyword_(d[a-1].type)&&(a={type:"input_dummy"},c&&(a.align=c),d.push(a));return d;}},{key:"fieldFromJson_",value:function fieldFromJson_(a){var b=fromJson$$module$build$src$core$field_registry(a);return!b&&a.alt?"string"===typeof a.alt?(a=this.stringToFieldJson_(a.alt))?this.fieldFromJson_(a):null:this.fieldFromJson_(a.alt):b;}},{key:"inputFromJson_",value:function inputFromJson_(a,b){var c={LEFT:$.Align$$module$build$src$core$input.LEFT,RIGHT:$.Align$$module$build$src$core$input.RIGHT,CENTRE:$.Align$$module$build$src$core$input.CENTRE,CENTER:$.Align$$module$build$src$core$input.CENTRE};var d=null;switch(a.type){case"input_value":d=this.appendValueInput(a.name);break;case"input_statement":d=this.appendStatementInput(a.name);break;case"input_dummy":d=this.appendDummyInput(a.name);}if(!d)return null;a.check&&d.setCheck(a.check);a.align&&(c=c[a.align.toUpperCase()],void 0===c?console.warn(b+"Illegal align value: ",a.align):d.setAlign(c));return d;}},{key:"isInputKeyword_",value:function isInputKeyword_(a){return"input_value"===a||"input_statement"===a||"input_dummy"===a;}},{key:"stringToFieldJson_",value:function stringToFieldJson_(a){return(a=a.trim())?{type:"field_label",text:a}:null;}},{key:"appendInput_",value:function appendInput_(a,b){var c=null;if(a===inputTypes$$module$build$src$core$input_types.VALUE||a===inputTypes$$module$build$src$core$input_types.STATEMENT)c=this.makeConnection_(a);a===inputTypes$$module$build$src$core$input_types.STATEMENT&&this.statementInputCount++;a=new Input$$module$build$src$core$input(a,b,this,c);this.inputList.push(a);return a;}},{key:"moveInputBefore",value:function moveInputBefore(a,b){if(a!==b){var c=-1,d=b?-1:this.inputList.length;for(var e=0,f;f=this.inputList[e];e++){if(f.name===a){if(c=e,-1!==d)break;}else if(b&&f.name===b&&(d=e,-1!==c))break;}if(-1===c)throw Error('Named input "'+a+'" not found.');if(-1===d)throw Error('Reference input "'+b+'" not found.');this.moveNumberedInputBefore(c,d);}}},{key:"moveNumberedInputBefore",value:function moveNumberedInputBefore(a,b){if(a===b)throw Error("Can't move input to itself.");if(a>=this.inputList.length)throw RangeError("Input index "+a+" out of bounds.");if(b>this.inputList.length)throw RangeError("Reference input "+b+" out of bounds.");var c=this.inputList[a];this.inputList.splice(a,1);a<b&&b--;this.inputList.splice(b,0,c);}},{key:"removeInput",value:function removeInput(a,b){for(var c=0,d;d=this.inputList[c];c++){if(d.name===a)return d.type===inputTypes$$module$build$src$core$input_types.STATEMENT&&this.statementInputCount--,d.dispose(),this.inputList.splice(c,1),!0;}if(b)return!1;throw Error("Input not found: "+a);}},{key:"getInput",value:function getInput(a){for(var b=0,c;c=this.inputList[b];b++){if(c.name===a)return c;}return null;}},{key:"getInputTargetBlock",value:function getInputTargetBlock(a){return(a=this.getInput(a))&&a.connection&&a.connection.targetBlock();}},{key:"getCommentText",value:function getCommentText(){return this.commentModel.text;}},{key:"setCommentText",value:function setCommentText(a){this.commentModel.text!==a&&(fire$$module$build$src$core$events$utils(new(get$$module$build$src$core$events$utils(CHANGE$$module$build$src$core$events$utils))(this,"comment",null,this.commentModel.text,a)),this.comment=this.commentModel.text=a);}},{key:"setWarningText",value:function setWarningText(a,b){}},{key:"setMutator",value:function setMutator(a){}},{key:"getRelativeToSurfaceXY",value:function getRelativeToSurfaceXY(){return this.xy_;}},{key:"moveBy",value:function moveBy(a,b){if(this.parentBlock_)throw Error("Block has parent.");var c=new(get$$module$build$src$core$events$utils(MOVE$$module$build$src$core$events$utils))(this);this.xy_.translate(a,b);c.recordNew();fire$$module$build$src$core$events$utils(c);}},{key:"makeConnection_",value:function makeConnection_(a){return new Connection$$module$build$src$core$connection(this,a);}},{key:"allInputsFilled",value:function allInputsFilled(a){void 0===a&&(a=!0);if(!a&&this.isShadow())return!1;for(var c=0,d;d=this.inputList[c];c++){if(d.connection){var b=d.connection.targetBlock();if(!b||!b.allInputsFilled(a))return!1;}}return(b=this.getNextBlock())?b.allInputsFilled(a):!0;}},{key:"toDevString",value:function toDevString(){var a=this.type?'"'+this.type+'" block':"Block";this.id&&(a+=' (id="'+this.id+'")');return a;}}]);return Block$$module$build$src$core$block;}();Block$$module$build$src$core$block.COLLAPSED_INPUT_NAME=COLLAPSED_INPUT_NAME$$module$build$src$core$constants;Block$$module$build$src$core$block.COLLAPSED_FIELD_NAME=COLLAPSED_FIELD_NAME$$module$build$src$core$constants;var module$build$src$core$block={};module$build$src$core$block.Block=Block$$module$build$src$core$block;var disconnectPid$$module$build$src$core$block_animations=null,disconnectGroup$$module$build$src$core$block_animations=null,module$build$src$core$block_animations={};module$build$src$core$block_animations.connectionUiEffect=connectionUiEffect$$module$build$src$core$block_animations;module$build$src$core$block_animations.disconnectUiEffect=disconnectUiEffect$$module$build$src$core$block_animations;module$build$src$core$block_animations.disconnectUiStop=disconnectUiStop$$module$build$src$core$block_animations;module$build$src$core$block_animations.disposeUiEffect=disposeUiEffect$$module$build$src$core$block_animations;var Comment$$module$build$src$core$comment=/*#__PURE__*/function(_Icon$$module$build$s2){_inherits(Comment$$module$build$src$core$comment,_Icon$$module$build$s2);var _super21=_createSuper(Comment$$module$build$src$core$comment);function Comment$$module$build$src$core$comment(a){var _this25;_classCallCheck(this,Comment$$module$build$src$core$comment);_this25=_super21.call(this,a);_this25.cachedText="";_this25.paragraphElement_=_this25.textarea_=_this25.foreignObject=_this25.onInputWrapper=_this25.onChangeWrapper=_this25.onWheelWrapper=_this25.onMouseUpWrapper=null;_this25.model=a.commentModel;var b;_this25.model.text=null!=(b=_this25.model.text)?b:"";_this25.createIcon();return _this25;}_createClass(Comment$$module$build$src$core$comment,[{key:"drawIcon_",value:function drawIcon_(a){createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.CIRCLE,{"class":"blocklyIconShape",r:"8",cx:"8",cy:"8"},a);createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.PATH,{"class":"blocklyIconSymbol",d:"m6.8,10h2c0.003,-0.617 0.271,-0.962 0.633,-1.266 2.875,-2.4050.607,-5.534 -3.765,-3.874v1.7c3.12,-1.657 3.698,0.118 2.336,1.25-1.201,0.998 -1.201,1.528 -1.204,2.19z"},a);createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.RECT,{"class":"blocklyIconSymbol",x:"6.8",y:"10.78",height:"2",width:"2"},a);}},{key:"createEditor",value:function createEditor(){this.foreignObject=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.FOREIGNOBJECT,{x:Bubble$$module$build$src$core$bubble.BORDER_WIDTH,y:Bubble$$module$build$src$core$bubble.BORDER_WIDTH});var a=document.createElementNS(HTML_NS$$module$build$src$core$utils$dom,"body");a.setAttribute("xmlns",HTML_NS$$module$build$src$core$utils$dom);a.className="blocklyMinimalBody";var b=this.textarea_=document.createElementNS(HTML_NS$$module$build$src$core$utils$dom,"textarea");b.className="blocklyCommentTextarea";b.setAttribute("dir",this.getBlock().RTL?"RTL":"LTR");var c;b.value=null!=(c=this.model.text)?c:"";this.resizeTextarea();a.appendChild(b);this.foreignObject.appendChild(a);this.onMouseUpWrapper=conditionalBind$$module$build$src$core$browser_events(b,"mouseup",this,this.startEdit,!0,!0);this.onWheelWrapper=conditionalBind$$module$build$src$core$browser_events(b,"wheel",this,function(d){d.stopPropagation();});this.onChangeWrapper=conditionalBind$$module$build$src$core$browser_events(b,"change",this,function(d){this.cachedText!==this.model.text&&fire$$module$build$src$core$events$utils(new(get$$module$build$src$core$events$utils(CHANGE$$module$build$src$core$events$utils))(this.getBlock(),"comment",null,this.cachedText,this.model.text));});this.onInputWrapper=conditionalBind$$module$build$src$core$browser_events(b,"input",this,function(d){this.model.text=b.value;});setTimeout(b.focus.bind(b),0);return this.foreignObject;}},{key:"updateEditable",value:function updateEditable(){_get(_getPrototypeOf(Comment$$module$build$src$core$comment.prototype),"updateEditable",this).call(this);this.isVisible()&&(this.disposeBubble(),this.createBubble());}},{key:"onBubbleResize",value:function onBubbleResize(){this.isVisible()&&this.bubble_&&(this.model.size=this.bubble_.getBubbleSize(),this.resizeTextarea());}},{key:"resizeTextarea",value:function resizeTextarea(){if(this.textarea_&&this.foreignObject){var a=this.model.size,b=2*Bubble$$module$build$src$core$bubble.BORDER_WIDTH,c=a.width-b;a=a.height-b;this.foreignObject.setAttribute("width","".concat(c));this.foreignObject.setAttribute("height","".concat(a));this.textarea_.style.width=c-4+"px";this.textarea_.style.height=a-4+"px";}}},{key:"setVisible",value:function setVisible(a){a!==this.isVisible()&&(fire$$module$build$src$core$events$utils(new(get$$module$build$src$core$events$utils(BUBBLE_OPEN$$module$build$src$core$events$utils))(this.getBlock(),a,"comment")),(this.model.pinned=a)?this.createBubble():this.disposeBubble());}},{key:"createBubble",value:function createBubble(){this.getBlock().isEditable()?this.createEditableBubble():this.createNonEditableBubble();}},{key:"createEditableBubble",value:function createEditableBubble(){var a=this.getBlock();this.bubble_=new Bubble$$module$build$src$core$bubble(a.workspace,this.createEditor(),a.pathObject.svgPath,this.iconXY_,this.model.size.width,this.model.size.height);this.bubble_.setSvgId(a.id);this.bubble_.registerResizeEvent(this.onBubbleResize.bind(this));this.applyColour();}},{key:"createNonEditableBubble",value:function createNonEditableBubble(){var a;this.paragraphElement_=Bubble$$module$build$src$core$bubble.textToDom(null!=(a=this.model.text)?a:"");this.bubble_=Bubble$$module$build$src$core$bubble.createNonEditableBubble(this.paragraphElement_,this.getBlock(),this.iconXY_);this.applyColour();}},{key:"disposeBubble",value:function disposeBubble(){this.onMouseUpWrapper&&(unbind$$module$build$src$core$browser_events(this.onMouseUpWrapper),this.onMouseUpWrapper=null);this.onWheelWrapper&&(unbind$$module$build$src$core$browser_events(this.onWheelWrapper),this.onWheelWrapper=null);this.onChangeWrapper&&(unbind$$module$build$src$core$browser_events(this.onChangeWrapper),this.onChangeWrapper=null);this.onInputWrapper&&(unbind$$module$build$src$core$browser_events(this.onInputWrapper),this.onInputWrapper=null);this.bubble_&&(this.bubble_.dispose(),this.bubble_=null);this.paragraphElement_=this.foreignObject=this.textarea_=null;}},{key:"startEdit",value:function startEdit(a){var b;(null==(b=this.bubble_)?0:b.promote())&&this.textarea_.focus();this.cachedText=this.model.text;}},{key:"getBubbleSize",value:function getBubbleSize(){return this.model.size;}},{key:"setBubbleSize",value:function setBubbleSize(a,b){this.bubble_?this.bubble_.setBubbleSize(a,b):(this.model.size.width=a,this.model.size.height=b);}},{key:"updateText",value:function updateText(){if(this.textarea_){var a;this.textarea_.value=null!=(a=this.model.text)?a:"";}else this.paragraphElement_&&(this.paragraphElement_.firstChild.textContent=this.model.text);}},{key:"dispose",value:function dispose(){this.getBlock().comment=null;_get(_getPrototypeOf(Comment$$module$build$src$core$comment.prototype),"dispose",this).call(this);}}]);return Comment$$module$build$src$core$comment;}(Icon$$module$build$src$core$icon);register$$module$build$src$core$css("\n.blocklyCommentTextarea {\n  background-color: #fef49c;\n  border: 0;\n  display: block;\n  margin: 0;\n  outline: 0;\n  padding: 3px;\n  resize: none;\n  text-overflow: hidden;\n}\n");var module$build$src$core$comment={};module$build$src$core$comment.Comment=Comment$$module$build$src$core$comment;var copyData$$module$build$src$core$clipboard=null,TEST_ONLY$$module$build$src$core$clipboard={duplicateInternal:duplicateInternal$$module$build$src$core$clipboard,copyInternal:copyInternal$$module$build$src$core$clipboard},module$build$src$core$clipboard={};module$build$src$core$clipboard.TEST_ONLY=TEST_ONLY$$module$build$src$core$clipboard;module$build$src$core$clipboard.copy=copy$$module$build$src$core$clipboard;module$build$src$core$clipboard.duplicate=duplicate$$module$build$src$core$clipboard;module$build$src$core$clipboard.paste=paste$$module$build$src$core$clipboard;var currentBlock$$module$build$src$core$contextmenu,dummyOwner$$module$build$src$core$contextmenu,menu_$$module$build$src$core$contextmenu;currentBlock$$module$build$src$core$contextmenu=null;dummyOwner$$module$build$src$core$contextmenu={};menu_$$module$build$src$core$contextmenu=null;$.module$build$src$core$contextmenu={};$.module$build$src$core$contextmenu.callbackFactory=callbackFactory$$module$build$src$core$contextmenu;$.module$build$src$core$contextmenu.commentDeleteOption=commentDeleteOption$$module$build$src$core$contextmenu;$.module$build$src$core$contextmenu.commentDuplicateOption=commentDuplicateOption$$module$build$src$core$contextmenu;$.module$build$src$core$contextmenu.dispose=dispose$$module$build$src$core$contextmenu;$.module$build$src$core$contextmenu.getCurrentBlock=getCurrentBlock$$module$build$src$core$contextmenu;$.module$build$src$core$contextmenu.hide=hide$$module$build$src$core$contextmenu;$.module$build$src$core$contextmenu.setCurrentBlock=setCurrentBlock$$module$build$src$core$contextmenu;$.module$build$src$core$contextmenu.show=show$$module$build$src$core$contextmenu;$.module$build$src$core$contextmenu.workspaceCommentOption=workspaceCommentOption$$module$build$src$core$contextmenu;var ContextMenuRegistry$$module$build$src$core$contextmenu_registry=/*#__PURE__*/function(){function ContextMenuRegistry$$module$build$src$core$contextmenu_registry(){_classCallCheck(this,ContextMenuRegistry$$module$build$src$core$contextmenu_registry);this.registry_=new Map();this.reset();}_createClass(ContextMenuRegistry$$module$build$src$core$contextmenu_registry,[{key:"reset",value:function reset(){this.registry_.clear();}},{key:"register",value:function register(a){if(this.registry_.has(a.id))throw Error('Menu item with ID "'+a.id+'" is already registered.');this.registry_.set(a.id,a);}},{key:"unregister",value:function unregister(a){if(!this.registry_.has(a))throw Error('Menu item with ID "'+a+'" not found.');this.registry_["delete"](a);}},{key:"getItem",value:function getItem(a){var b;return null!=(b=this.registry_.get(a))?b:null;}},{key:"getContextMenuOptions",value:function getContextMenuOptions(a,b){var c=[];var _iterator8=_createForOfIteratorHelper(this.registry_.values()),_step8;try{for(_iterator8.s();!(_step8=_iterator8.n()).done;){var e=_step8.value;if(a===e.scopeType){var d=e.preconditionFn(b);"hidden"!==d&&(d={text:"function"===typeof e.displayText?e.displayText(b):e.displayText,enabled:"enabled"===d,callback:e.callback,scope:b,weight:e.weight},c.push(d));}}}catch(err){_iterator8.e(err);}finally{_iterator8.f();}c.sort(function(e,f){return e.weight-f.weight;});return c;}}]);return ContextMenuRegistry$$module$build$src$core$contextmenu_registry;}();(function(a){var b=a.ScopeType||(a.ScopeType={});b.BLOCK="block";b.WORKSPACE="workspace";a.registry=new a();})(ContextMenuRegistry$$module$build$src$core$contextmenu_registry||(ContextMenuRegistry$$module$build$src$core$contextmenu_registry={}));var ScopeType$$module$build$src$core$contextmenu_registry=ContextMenuRegistry$$module$build$src$core$contextmenu_registry.ScopeType,module$build$src$core$contextmenu_registry={};module$build$src$core$contextmenu_registry.ContextMenuRegistry=ContextMenuRegistry$$module$build$src$core$contextmenu_registry;module$build$src$core$contextmenu_registry.ScopeType=ScopeType$$module$build$src$core$contextmenu_registry;var COLLAPSE_CHARS$$module$build$src$core$internal_constants=30,DRAG_STACK$$module$build$src$core$internal_constants=!0,OPPOSITE_TYPE$$module$build$src$core$internal_constants=[];OPPOSITE_TYPE$$module$build$src$core$internal_constants[ConnectionType$$module$build$src$core$connection_type.INPUT_VALUE]=ConnectionType$$module$build$src$core$connection_type.OUTPUT_VALUE;OPPOSITE_TYPE$$module$build$src$core$internal_constants[ConnectionType$$module$build$src$core$connection_type.OUTPUT_VALUE]=ConnectionType$$module$build$src$core$connection_type.INPUT_VALUE;OPPOSITE_TYPE$$module$build$src$core$internal_constants[ConnectionType$$module$build$src$core$connection_type.NEXT_STATEMENT]=ConnectionType$$module$build$src$core$connection_type.PREVIOUS_STATEMENT;OPPOSITE_TYPE$$module$build$src$core$internal_constants[ConnectionType$$module$build$src$core$connection_type.PREVIOUS_STATEMENT]=ConnectionType$$module$build$src$core$connection_type.NEXT_STATEMENT;var RENAME_VARIABLE_ID$$module$build$src$core$internal_constants="RENAME_VARIABLE_ID",DELETE_VARIABLE_ID$$module$build$src$core$internal_constants="DELETE_VARIABLE_ID",module$build$src$core$internal_constants={};module$build$src$core$internal_constants.COLLAPSE_CHARS=COLLAPSE_CHARS$$module$build$src$core$internal_constants;module$build$src$core$internal_constants.DELETE_VARIABLE_ID=DELETE_VARIABLE_ID$$module$build$src$core$internal_constants;module$build$src$core$internal_constants.DRAG_STACK=DRAG_STACK$$module$build$src$core$internal_constants;module$build$src$core$internal_constants.OPPOSITE_TYPE=OPPOSITE_TYPE$$module$build$src$core$internal_constants;module$build$src$core$internal_constants.RENAME_VARIABLE_ID=RENAME_VARIABLE_ID$$module$build$src$core$internal_constants;var Marker$$module$build$src$core$keyboard_nav$marker=/*#__PURE__*/function(){function Marker$$module$build$src$core$keyboard_nav$marker(){_classCallCheck(this,Marker$$module$build$src$core$keyboard_nav$marker);this.drawer_=this.curNode_=this.colour=null;this.type="marker";}_createClass(Marker$$module$build$src$core$keyboard_nav$marker,[{key:"setDrawer",value:function setDrawer(a){this.drawer_=a;}},{key:"getDrawer",value:function getDrawer(){return this.drawer_;}},{key:"getCurNode",value:function getCurNode(){return this.curNode_;}},{key:"setCurNode",value:function setCurNode(a){var b=this.curNode_;this.curNode_=a;this.drawer_&&this.drawer_.draw(b,this.curNode_);}},{key:"draw",value:function draw(){this.drawer_&&this.drawer_.draw(this.curNode_,this.curNode_);}},{key:"hide",value:function hide(){this.drawer_&&this.drawer_.hide();}},{key:"dispose",value:function dispose(){this.getDrawer()&&this.getDrawer().dispose();}}]);return Marker$$module$build$src$core$keyboard_nav$marker;}(),module$build$src$core$keyboard_nav$marker={};module$build$src$core$keyboard_nav$marker.Marker=Marker$$module$build$src$core$keyboard_nav$marker;var Cursor$$module$build$src$core$keyboard_nav$cursor=/*#__PURE__*/function(_Marker$$module$build){_inherits(Cursor$$module$build$src$core$keyboard_nav$cursor,_Marker$$module$build);var _super22=_createSuper(Cursor$$module$build$src$core$keyboard_nav$cursor);function Cursor$$module$build$src$core$keyboard_nav$cursor(){var _this26;_classCallCheck(this,Cursor$$module$build$src$core$keyboard_nav$cursor);_this26=_super22.call(this);_this26.type="cursor";return _this26;}_createClass(Cursor$$module$build$src$core$keyboard_nav$cursor,[{key:"next",value:function next(){var a=this.getCurNode();if(!a)return null;for(a=a.next();a&&a.next()&&(a.getType()===_ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.NEXT||a.getType()===_ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.BLOCK);){a=a.next();}a&&this.setCurNode(a);return a;}},{key:"in",value:function _in(){var a=this.getCurNode();if(!a)return null;if(a.getType()===_ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.PREVIOUS||a.getType()===_ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.OUTPUT)a=a.next();var b,c;(a=null!=(c=null==(b=a)?void 0:b["in"]())?c:null)&&this.setCurNode(a);return a;}},{key:"prev",value:function prev(){var a=this.getCurNode();if(!a)return null;for(a=a.prev();a&&a.prev()&&(a.getType()===_ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.NEXT||a.getType()===_ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.BLOCK);){a=a.prev();}a&&this.setCurNode(a);return a;}},{key:"out",value:function out(){var a=this.getCurNode();if(!a)return null;(a=a.out())&&a.getType()===_ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.BLOCK&&(a=a.prev()||a);a&&this.setCurNode(a);return a;}}]);return Cursor$$module$build$src$core$keyboard_nav$cursor;}(Marker$$module$build$src$core$keyboard_nav$marker);register$$module$build$src$core$registry(Type$$module$build$src$core$registry.CURSOR,DEFAULT$$module$build$src$core$registry,Cursor$$module$build$src$core$keyboard_nav$cursor);var module$build$src$core$keyboard_nav$cursor={};module$build$src$core$keyboard_nav$cursor.Cursor=Cursor$$module$build$src$core$keyboard_nav$cursor;var BasicCursor$$module$build$src$core$keyboard_nav$basic_cursor=/*#__PURE__*/function(_Cursor$$module$build){_inherits(BasicCursor$$module$build$src$core$keyboard_nav$basic_cursor,_Cursor$$module$build);var _super23=_createSuper(BasicCursor$$module$build$src$core$keyboard_nav$basic_cursor);function BasicCursor$$module$build$src$core$keyboard_nav$basic_cursor(){_classCallCheck(this,BasicCursor$$module$build$src$core$keyboard_nav$basic_cursor);return _super23.call(this);}_createClass(BasicCursor$$module$build$src$core$keyboard_nav$basic_cursor,[{key:"next",value:function next(){var a=this.getCurNode();if(!a)return null;(a=this.getNextNode_(a,this.validNode_))&&this.setCurNode(a);return a;}},{key:"in",value:function _in(){return this.next();}},{key:"prev",value:function prev(){var a=this.getCurNode();if(!a)return null;(a=this.getPreviousNode_(a,this.validNode_))&&this.setCurNode(a);return a;}},{key:"out",value:function out(){return this.prev();}},{key:"getNextNode_",value:function getNextNode_(a,b){if(!a)return null;var c=a["in"]()||a.next();if(b(c))return c;if(c)return this.getNextNode_(c,b);a=this.findSiblingOrParent_(a.out());return b(a)?a:a?this.getNextNode_(a,b):null;}},{key:"getPreviousNode_",value:function getPreviousNode_(a,b){if(!a)return null;var c=a.prev();c=c?this.getRightMostChild_(c):a.out();return b(c)?c:c?this.getPreviousNode_(c,b):null;}},{key:"validNode_",value:function validNode_(a){var b=!1;a=a&&a.getType();if(a===_ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.OUTPUT||a===_ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.INPUT||a===_ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.FIELD||a===_ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.NEXT||a===_ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.PREVIOUS||a===_ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.WORKSPACE)b=!0;return b;}},{key:"findSiblingOrParent_",value:function findSiblingOrParent_(a){if(!a)return null;var b=a.next();return b?b:this.findSiblingOrParent_(a.out());}},{key:"getRightMostChild_",value:function getRightMostChild_(a){if(!a["in"]())return a;for(a=a["in"]();a&&a.next();){a=a.next();}return this.getRightMostChild_(a);}}]);return BasicCursor$$module$build$src$core$keyboard_nav$basic_cursor;}(Cursor$$module$build$src$core$keyboard_nav$cursor);BasicCursor$$module$build$src$core$keyboard_nav$basic_cursor.registrationName="basicCursor";register$$module$build$src$core$registry(Type$$module$build$src$core$registry.CURSOR,BasicCursor$$module$build$src$core$keyboard_nav$basic_cursor.registrationName,BasicCursor$$module$build$src$core$keyboard_nav$basic_cursor);var module$build$src$core$keyboard_nav$basic_cursor={};module$build$src$core$keyboard_nav$basic_cursor.BasicCursor=BasicCursor$$module$build$src$core$keyboard_nav$basic_cursor;var TabNavigateCursor$$module$build$src$core$keyboard_nav$tab_navigate_cursor=/*#__PURE__*/function(_BasicCursor$$module$){_inherits(TabNavigateCursor$$module$build$src$core$keyboard_nav$tab_navigate_cursor,_BasicCursor$$module$);var _super24=_createSuper(TabNavigateCursor$$module$build$src$core$keyboard_nav$tab_navigate_cursor);function TabNavigateCursor$$module$build$src$core$keyboard_nav$tab_navigate_cursor(){_classCallCheck(this,TabNavigateCursor$$module$build$src$core$keyboard_nav$tab_navigate_cursor);return _super24.apply(this,arguments);}_createClass(TabNavigateCursor$$module$build$src$core$keyboard_nav$tab_navigate_cursor,[{key:"validNode_",value:function validNode_(a){var b=!1;var c=a&&a.getType();a&&(a=a.getLocation(),c===_ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.FIELD&&a&&a.isTabNavigable()&&a.isClickable()&&(b=!0));return b;}}]);return TabNavigateCursor$$module$build$src$core$keyboard_nav$tab_navigate_cursor;}(BasicCursor$$module$build$src$core$keyboard_nav$basic_cursor),module$build$src$core$keyboard_nav$tab_navigate_cursor={};module$build$src$core$keyboard_nav$tab_navigate_cursor.TabNavigateCursor=TabNavigateCursor$$module$build$src$core$keyboard_nav$tab_navigate_cursor;var BUMP_RANDOMNESS$$module$build$src$core$rendered_connection=10,_RenderedConnection$$module$build$src$core$rendered_connection=/*#__PURE__*/function(_Connection$$module$b){_inherits(RenderedConnection$$module$build$src$core$rendered_connection,_Connection$$module$b);var _super25=_createSuper(RenderedConnection$$module$build$src$core$rendered_connection);function RenderedConnection$$module$build$src$core$rendered_connection(a,b){var _this27;_classCallCheck(this,RenderedConnection$$module$build$src$core$rendered_connection);_this27=_super25.call(this,a,b);_this27.targetConnection=_this27.highlightPath=null;_this27.db_=a.workspace.connectionDBList[b];_this27.dbOpposite_=a.workspace.connectionDBList[OPPOSITE_TYPE$$module$build$src$core$internal_constants[b]];_this27.offsetInBlock_=new Coordinate$$module$build$src$core$utils$coordinate(0,0);_this27.trackedState_=_RenderedConnection$$module$build$src$core$rendered_connection.TrackedState.WILL_TRACK;return _this27;}_createClass(RenderedConnection$$module$build$src$core$rendered_connection,[{key:"dispose",value:function dispose(){_get(_getPrototypeOf(RenderedConnection$$module$build$src$core$rendered_connection.prototype),"dispose",this).call(this);this.trackedState_===_RenderedConnection$$module$build$src$core$rendered_connection.TrackedState.TRACKED&&this.db_.removeConnection(this,this.y);}},{key:"getSourceBlock",value:function getSourceBlock(){return _get(_getPrototypeOf(RenderedConnection$$module$build$src$core$rendered_connection.prototype),"getSourceBlock",this).call(this);}},{key:"targetBlock",value:function targetBlock(){return _get(_getPrototypeOf(RenderedConnection$$module$build$src$core$rendered_connection.prototype),"targetBlock",this).call(this);}},{key:"distanceFrom",value:function distanceFrom(a){var b=this.x-a.x;a=this.y-a.y;return Math.sqrt(b*b+a*a);}},{key:"bumpAwayFrom",value:function bumpAwayFrom(a){if(!this.sourceBlock_.workspace.isDragging()){var b=this.sourceBlock_.getRootBlock();if(!b.isInFlyout){var c=!1;if(!b.isMovable()){b=a.getSourceBlock().getRootBlock();if(!b.isMovable())return;a=this;c=!0;}var d=getSelected$$module$build$src$core$common()==b;d||b.addSelect();var e=a.x+$.config$$module$build$src$core$config.snapRadius+Math.floor(Math.random()*BUMP_RANDOMNESS$$module$build$src$core$rendered_connection)-this.x,f=a.y+$.config$$module$build$src$core$config.snapRadius+Math.floor(Math.random()*BUMP_RANDOMNESS$$module$build$src$core$rendered_connection)-this.y;c&&(f=-f);b.RTL&&(e=a.x-$.config$$module$build$src$core$config.snapRadius-Math.floor(Math.random()*BUMP_RANDOMNESS$$module$build$src$core$rendered_connection)-this.x);b.moveBy(e,f);d||b.removeSelect();}}}},{key:"moveTo",value:function moveTo(a,b){this.trackedState_===_RenderedConnection$$module$build$src$core$rendered_connection.TrackedState.WILL_TRACK?(this.db_.addConnection(this,b),this.trackedState_=_RenderedConnection$$module$build$src$core$rendered_connection.TrackedState.TRACKED):this.trackedState_===_RenderedConnection$$module$build$src$core$rendered_connection.TrackedState.TRACKED&&(this.db_.removeConnection(this,this.y),this.db_.addConnection(this,b));this.x=a;this.y=b;}},{key:"moveBy",value:function moveBy(a,b){this.moveTo(this.x+a,this.y+b);}},{key:"moveToOffset",value:function moveToOffset(a){this.moveTo(a.x+this.offsetInBlock_.x,a.y+this.offsetInBlock_.y);}},{key:"setOffsetInBlock",value:function setOffsetInBlock(a,b){this.offsetInBlock_.x=a;this.offsetInBlock_.y=b;}},{key:"getOffsetInBlock",value:function getOffsetInBlock(){return this.offsetInBlock_;}},{key:"tighten",value:function tighten(){var a=this.targetConnection.x-this.x,b=this.targetConnection.y-this.y;if(0!==a||0!==b){var d=this.targetBlock();var c=d.getSvgRoot();if(!c)throw Error("block is not rendered.");c=getRelativeXY$$module$build$src$core$utils$svg_math(c);d.getSvgRoot().setAttribute("transform","translate("+(c.x-a)+","+(c.y-b)+")");d.moveConnections(-a,-b);}}},{key:"closest",value:function closest(a,b){return this.dbOpposite_.searchForClosest(this,a,b);}},{key:"highlight",value:function highlight(){if(!this.highlightPath){var a=this.sourceBlock_.workspace.getRenderer().getConstants();var b=a.shapeFor(this);this.type===ConnectionType$$module$build$src$core$connection_type.INPUT_VALUE||this.type===ConnectionType$$module$build$src$core$connection_type.OUTPUT_VALUE?(a=a.TAB_OFFSET_FROM_TOP,b=moveBy$$module$build$src$core$utils$svg_paths(0,-a)+lineOnAxis$$module$build$src$core$utils$svg_paths("v",a)+b.pathDown+lineOnAxis$$module$build$src$core$utils$svg_paths("v",a)):(a=a.NOTCH_OFFSET_LEFT-a.CORNER_RADIUS,b=moveBy$$module$build$src$core$utils$svg_paths(-a,0)+lineOnAxis$$module$build$src$core$utils$svg_paths("h",a)+b.pathLeft+lineOnAxis$$module$build$src$core$utils$svg_paths("h",a));a=this.sourceBlock_.getRelativeToSurfaceXY();this.highlightPath=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.PATH,{"class":"blocklyHighlightedConnectionPath",d:b,transform:"translate("+(this.x-a.x)+","+(this.y-a.y)+")"+(this.sourceBlock_.RTL?" scale(-1 1)":"")},this.sourceBlock_.getSvgRoot());}}},{key:"unhighlight",value:function unhighlight(){this.highlightPath&&(removeNode$$module$build$src$core$utils$dom(this.highlightPath),this.highlightPath=null);}},{key:"setTracking",value:function setTracking(a){a&&this.trackedState_===_RenderedConnection$$module$build$src$core$rendered_connection.TrackedState.TRACKED||!a&&this.trackedState_===_RenderedConnection$$module$build$src$core$rendered_connection.TrackedState.UNTRACKED||this.sourceBlock_.isInFlyout||(a?(this.db_.addConnection(this,this.y),this.trackedState_=_RenderedConnection$$module$build$src$core$rendered_connection.TrackedState.TRACKED):(this.trackedState_===_RenderedConnection$$module$build$src$core$rendered_connection.TrackedState.TRACKED&&this.db_.removeConnection(this,this.y),this.trackedState_=_RenderedConnection$$module$build$src$core$rendered_connection.TrackedState.UNTRACKED));}},{key:"stopTrackingAll",value:function stopTrackingAll(){this.setTracking(!1);if(this.targetConnection){var c=this.targetBlock().getDescendants(!1);for(var d=0;d<c.length;d++){var a=c[d],b=a.getConnections_(!0);for(var e=0;e<b.length;e++){b[e].setTracking(!1);}a=a.getIcons();for(b=0;b<a.length;b++){a[b].setVisible(!1);}}}}},{key:"startTrackingAll",value:function startTrackingAll(){this.setTracking(!0);var a=[];if(this.type!==ConnectionType$$module$build$src$core$connection_type.INPUT_VALUE&&this.type!==ConnectionType$$module$build$src$core$connection_type.NEXT_STATEMENT)return a;var b=this.targetBlock();if(b){var c;b.isCollapsed()?(c=[],b.outputConnection&&c.push(b.outputConnection),b.nextConnection&&c.push(b.nextConnection),b.previousConnection&&c.push(b.previousConnection)):c=b.getConnections_(!0);for(var d=0;d<c.length;d++){var _a;(_a=a).push.apply(_a,_toConsumableArray(c[d].startTrackingAll()));}a.length||(a=[b]);}return a;}},{key:"onFailedConnect",value:function onFailedConnect(a){var b=this.getSourceBlock();if(getRecordUndo$$module$build$src$core$events$utils()){var c=getGroup$$module$build$src$core$events$utils();setTimeout(function(){b.isDisposed()||b.getParent()||(setGroup$$module$build$src$core$events$utils(c),this.bumpAwayFrom(a),setGroup$$module$build$src$core$events$utils(!1));}.bind(this),$.config$$module$build$src$core$config.bumpDelay);}}},{key:"disconnectInternal_",value:function disconnectInternal_(a,b){_get(_getPrototypeOf(RenderedConnection$$module$build$src$core$rendered_connection.prototype),"disconnectInternal_",this).call(this,a,b);a.rendered&&a.render();b.rendered&&(b.updateDisabled(),b.render(),b.getSvgRoot().style.display="block");}},{key:"respawnShadow_",value:function respawnShadow_(){_get(_getPrototypeOf(RenderedConnection$$module$build$src$core$rendered_connection.prototype),"respawnShadow_",this).call(this);var a=this.targetBlock();a&&(a.initSvg(),a.render(!1),a=this.getSourceBlock(),a.rendered&&a.render());}},{key:"neighbours",value:function neighbours(a){return this.dbOpposite_.getNeighbours(this,a);}},{key:"connect_",value:function connect_(a){_get(_getPrototypeOf(RenderedConnection$$module$build$src$core$rendered_connection.prototype),"connect_",this).call(this,a);var b=this.getSourceBlock();a=a.getSourceBlock();var c=b.rendered,d=a.rendered;c&&b.updateDisabled();d&&a.updateDisabled();c&&d&&(this.type===ConnectionType$$module$build$src$core$connection_type.NEXT_STATEMENT||this.type===ConnectionType$$module$build$src$core$connection_type.PREVIOUS_STATEMENT?a.render():b.render());if(b=b.getInputWithBlock(a))b=b.isVisible(),a.getSvgRoot().style.display=b?"block":"none";}},{key:"onCheckChanged_",value:function onCheckChanged_(){!this.isConnected()||this.targetConnection&&this.getConnectionChecker().canConnect(this,this.targetConnection,!1)||((this.isSuperior()?this.targetBlock():this.sourceBlock_).unplug(),this.sourceBlock_.bumpNeighbours());}}]);return RenderedConnection$$module$build$src$core$rendered_connection;}(Connection$$module$build$src$core$connection);(function(a){a=a.TrackedState||(a.TrackedState={});a[a.WILL_TRACK=-1]="WILL_TRACK";a[a.UNTRACKED=0]="UNTRACKED";a[a.TRACKED=1]="TRACKED";})(_RenderedConnection$$module$build$src$core$rendered_connection||(_RenderedConnection$$module$build$src$core$rendered_connection={}));var TrackedState$$module$build$src$core$rendered_connection=_RenderedConnection$$module$build$src$core$rendered_connection.TrackedState,module$build$src$core$rendered_connection={};module$build$src$core$rendered_connection.RenderedConnection=_RenderedConnection$$module$build$src$core$rendered_connection;module$build$src$core$rendered_connection.TrackedState=TrackedState$$module$build$src$core$rendered_connection;var Warning$$module$build$src$core$warning=/*#__PURE__*/function(_Icon$$module$build$s3){_inherits(Warning$$module$build$src$core$warning,_Icon$$module$build$s3);var _super26=_createSuper(Warning$$module$build$src$core$warning);function Warning$$module$build$src$core$warning(a){var _this28;_classCallCheck(this,Warning$$module$build$src$core$warning);_this28=_super26.call(this,a);_this28.paragraphElement=null;_this28.collapseHidden=!1;_this28.createIcon();_this28.text=Object.create(null);return _this28;}_createClass(Warning$$module$build$src$core$warning,[{key:"drawIcon_",value:function drawIcon_(a){createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.PATH,{"class":"blocklyIconShape",d:"M2,15Q-1,15 0.5,12L6.5,1.7Q8,-1 9.5,1.7L15.5,12Q17,15 14,15z"},a);createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.PATH,{"class":"blocklyIconSymbol",d:"m7,4.8v3.16l0.27,2.27h1.46l0.27,-2.27v-3.16z"},a);createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.RECT,{"class":"blocklyIconSymbol",x:"7",y:"11",height:"2",width:"2"},a);}},{key:"setVisible",value:function setVisible(a){a!==this.isVisible()&&(fire$$module$build$src$core$events$utils(new(get$$module$build$src$core$events$utils(BUBBLE_OPEN$$module$build$src$core$events$utils))(this.getBlock(),a,"warning")),a?this.createBubble():this.disposeBubble());}},{key:"createBubble",value:function createBubble(){this.paragraphElement=Bubble$$module$build$src$core$bubble.textToDom(this.getText());this.bubble_=Bubble$$module$build$src$core$bubble.createNonEditableBubble(this.paragraphElement,this.getBlock(),this.iconXY_);this.applyColour();}},{key:"disposeBubble",value:function disposeBubble(){this.bubble_&&(this.bubble_.dispose(),this.bubble_=null);this.paragraphElement=null;}},{key:"setText",value:function setText(a,b){this.text[b]!==a&&(a?this.text[b]=a:delete this.text[b],this.isVisible()&&(this.setVisible(!1),this.setVisible(!0)));}},{key:"getText",value:function getText(){var a=[];for(var b in this.text){a.push(this.text[b]);}return a.join("\n");}},{key:"dispose",value:function dispose(){this.getBlock().warning=null;_get(_getPrototypeOf(Warning$$module$build$src$core$warning.prototype),"dispose",this).call(this);}}]);return Warning$$module$build$src$core$warning;}(Icon$$module$build$src$core$icon),module$build$src$core$warning={};module$build$src$core$warning.Warning=Warning$$module$build$src$core$warning;var BlockSvg$$module$build$src$core$block_svg=/*#__PURE__*/function(_Block$$module$build$){_inherits(BlockSvg$$module$build$src$core$block_svg,_Block$$module$build$);var _super27=_createSuper(BlockSvg$$module$build$src$core$block_svg);function BlockSvg$$module$build$src$core$block_svg(a,b,c){var _this29;_classCallCheck(this,BlockSvg$$module$build$src$core$block_svg);_this29=_super27.call(this,a,b,c);_this29.renderingDebugger=null;_this29.width=_this29.height=0;_this29.warningTextDb=new Map();_this29.warning=_this29.commentIcon_=_this29.mutator=null;_this29.eventsInit_=_this29.renderIsInProgress_=_this29.rendered=!1;_this29.workspace=a;_this29.decompose=_this29.decompose;_this29.compose=_this29.compose;_this29.saveConnections=_this29.saveConnections;_this29.customContextMenu=_this29.customContextMenu;_this29.svgGroup_=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.G,{});_this29.svgGroup_.translate_="";_this29.style=a.getRenderer().getConstants().getBlockStyle(null);_this29.pathObject=a.getRenderer().makePathObject(_this29.svgGroup_,_this29.style);_this29.useDragSurface_=!!a.getBlockDragSurface();a=_this29.pathObject.svgPath;a.tooltip=_assertThisInitialized(_this29);bindMouseEvents$$module$build$src$core$tooltip(a);_this29.svgGroup_.setAttribute("data-id",_this29.id);_this29.doInit_();return _this29;}_createClass(BlockSvg$$module$build$src$core$block_svg,[{key:"initSvg",value:function initSvg(){if(!this.workspace.rendered)throw TypeError("Workspace is headless.");for(var b=0,c;c=this.inputList[b];b++){c.init();}var a=this.getIcons();for(var _b=0;_b<a.length;_b++){a[_b].createIcon();}this.applyColour();this.pathObject.updateMovable(this.isMovable());a=this.getSvgRoot();this.workspace.options.readOnly||this.eventsInit_||!a||conditionalBind$$module$build$src$core$browser_events(a,"mousedown",this,this.onMouseDown_);this.eventsInit_=!0;a.parentNode||this.workspace.getCanvas().appendChild(a);}},{key:"getColourSecondary",value:function getColourSecondary(){return this.style.colourSecondary;}},{key:"getColourTertiary",value:function getColourTertiary(){return this.style.colourTertiary;}},{key:"select",value:function select(){if(this.isShadow()&&this.getParent())this.getParent().select();else if(getSelected$$module$build$src$core$common()!==this){var a=null;if(getSelected$$module$build$src$core$common()){a=getSelected$$module$build$src$core$common().id;disable$$module$build$src$core$events$utils();try{getSelected$$module$build$src$core$common().unselect();}finally{enable$$module$build$src$core$events$utils();}}a=new(get$$module$build$src$core$events$utils(SELECTED$$module$build$src$core$events$utils))(a,this.id,this.workspace.id);fire$$module$build$src$core$events$utils(a);setSelected$$module$build$src$core$common(this);this.addSelect();}}},{key:"unselect",value:function unselect(){if(getSelected$$module$build$src$core$common()===this){var a=new(get$$module$build$src$core$events$utils(SELECTED$$module$build$src$core$events$utils))(this.id,null,this.workspace.id);a.workspaceId=this.workspace.id;fire$$module$build$src$core$events$utils(a);setSelected$$module$build$src$core$common(null);this.removeSelect();}}},{key:"getIcons",value:function getIcons(){var a=[];this.mutator&&a.push(this.mutator);this.commentIcon_&&a.push(this.commentIcon_);this.warning&&a.push(this.warning);return a;}},{key:"setParent",value:function setParent(a){var b=this.parentBlock_;if(a!==b){startTextWidthCache$$module$build$src$core$utils$dom();_get(_getPrototypeOf(BlockSvg$$module$build$src$core$block_svg.prototype),"setParent",this).call(this,a);stopTextWidthCache$$module$build$src$core$utils$dom();var c=this.getSvgRoot();if(!this.workspace.isClearing&&c){var d=this.getRelativeToSurfaceXY();a?(a.getSvgRoot().appendChild(c),a=this.getRelativeToSurfaceXY(),this.moveConnections(a.x-d.x,a.y-d.y)):b&&(this.workspace.getCanvas().appendChild(c),this.translate(d.x,d.y));this.applyColour();}}}},{key:"getRelativeToSurfaceXY",value:function getRelativeToSurfaceXY(){var a=0,b=0;var c=this.useDragSurface_?this.workspace.getBlockDragSurface().getGroup():null;var d=this.getSvgRoot();if(d){do{var e=getRelativeXY$$module$build$src$core$utils$svg_math(d);a+=e.x;b+=e.y;this.useDragSurface_&&this.workspace.getBlockDragSurface().getCurrentBlock()===d&&(e=this.workspace.getBlockDragSurface().getSurfaceTranslation(),a+=e.x,b+=e.y);d=d.parentNode;}while(d&&d!==this.workspace.getCanvas()&&d!==c);}return new Coordinate$$module$build$src$core$utils$coordinate(a,b);}},{key:"moveBy",value:function moveBy(a,b){if(this.parentBlock_)throw Error("Block has parent.");var c=isEnabled$$module$build$src$core$events$utils();var d=null;c&&(d=new(get$$module$build$src$core$events$utils(MOVE$$module$build$src$core$events$utils))(this));var e=this.getRelativeToSurfaceXY();this.translate(e.x+a,e.y+b);this.moveConnections(a,b);c&&d&&(d.recordNew(),fire$$module$build$src$core$events$utils(d));this.workspace.resizeContents();}},{key:"translate",value:function translate(a,b){this.getSvgRoot().setAttribute("transform","translate("+a+","+b+")");}},{key:"moveToDragSurface",value:function moveToDragSurface(){if(this.useDragSurface_){var a=this.getRelativeToSurfaceXY();this.clearTransformAttributes_();this.workspace.getBlockDragSurface().translateSurface(a.x,a.y);(a=this.getSvgRoot())&&this.workspace.getBlockDragSurface().setBlocksAndShow(a);}}},{key:"moveTo",value:function moveTo(a){var b=this.getRelativeToSurfaceXY();this.moveBy(a.x-b.x,a.y-b.y);}},{key:"moveOffDragSurface",value:function moveOffDragSurface(a){this.useDragSurface_&&(this.translate(a.x,a.y),this.workspace.getBlockDragSurface().clearAndHide(this.workspace.getCanvas()));}},{key:"moveDuringDrag",value:function moveDuringDrag(a){this.useDragSurface_?this.workspace.getBlockDragSurface().translateSurface(a.x,a.y):(this.svgGroup_.translate_="translate("+a.x+","+a.y+")",this.svgGroup_.setAttribute("transform",this.svgGroup_.translate_+this.svgGroup_.skew_));}},{key:"clearTransformAttributes_",value:function clearTransformAttributes_(){this.getSvgRoot().removeAttribute("transform");}},{key:"snapToGrid",value:function snapToGrid(){if(!(this.isDeadOrDying()||this.workspace.isDragging()||this.getParent()||this.isInFlyout)){var a=this.workspace.getGrid();if(a&&a.shouldSnap()){var b=a.getSpacing(),c=b/2,d=this.getRelativeToSurfaceXY();a=Math.round(Math.round((d.x-c)/b)*b+c-d.x);b=Math.round(Math.round((d.y-c)/b)*b+c-d.y);(a||b)&&this.moveBy(a,b);}}}},{key:"getBoundingRectangle",value:function getBoundingRectangle(){var a=this.getRelativeToSurfaceXY(),b=this.getHeightWidth();var c,d;this.RTL?(c=a.x-b.width,d=a.x):(c=a.x,d=a.x+b.width);return new Rect$$module$build$src$core$utils$rect(a.y,a.y+b.height,c,d);}},{key:"markDirty",value:function markDirty(){this.pathObject.constants=this.workspace.getRenderer().getConstants();for(var a=0,b;b=this.inputList[a];a++){b.markDirty();}}},{key:"setCollapsed",value:function setCollapsed(a){this.collapsed_!==a&&(_get(_getPrototypeOf(BlockSvg$$module$build$src$core$block_svg.prototype),"setCollapsed",this).call(this,a),a?this.rendered&&this.render():this.updateCollapsed_());}},{key:"updateCollapsed_",value:function updateCollapsed_(){var a=this.isCollapsed();var b=COLLAPSED_INPUT_NAME$$module$build$src$core$constants,c=COLLAPSED_FIELD_NAME$$module$build$src$core$constants;for(var e=0,f;f=this.inputList[e];e++){f.name!==b&&f.setVisible(!a);}if(a){a=this.getIcons();for(var _e4=0,_f3;_f3=a[_e4];_e4++){_f3.setVisible(!1);}a=this.toString(COLLAPSE_CHARS$$module$build$src$core$internal_constants);var d=this.getField(c);d?d.setValue(a):(this.getInput(b)||this.appendDummyInput(b)).appendField(new $.FieldLabel$$module$build$src$core$field_label(a),c);}else this.updateDisabled(),this.removeInput(b);}},{key:"tab",value:function tab(a,b){var c=new TabNavigateCursor$$module$build$src$core$keyboard_nav$tab_navigate_cursor();c.setCurNode(_ASTNode$$module$build$src$core$keyboard_nav$ast_node.createFieldNode(a));a=c.getCurNode();b?c.next():c.prev();(b=c.getCurNode())&&b!==a&&(b.getLocation().showEditor(),this.workspace.keyboardAccessibilityMode&&this.workspace.getCursor().setCurNode(b));}},{key:"onMouseDown_",value:function onMouseDown_(a){var b=this.workspace.getGesture(a);b&&b.handleBlockStart(a,this);}},{key:"showHelp",value:function showHelp(){var a="function"===typeof this.helpUrl?this.helpUrl():this.helpUrl;a&&window.open(a);}},{key:"generateContextMenu",value:function generateContextMenu(){if(this.workspace.options.readOnly||!this.contextMenu)return null;var a=ContextMenuRegistry$$module$build$src$core$contextmenu_registry.registry.getContextMenuOptions(ContextMenuRegistry$$module$build$src$core$contextmenu_registry.ScopeType.BLOCK,{block:this});this.customContextMenu&&this.customContextMenu(a);return a;}},{key:"showContextMenu",value:function showContextMenu(a){var b=this.generateContextMenu();b&&b.length&&(show$$module$build$src$core$contextmenu(a,b,this.RTL),setCurrentBlock$$module$build$src$core$contextmenu(this));}},{key:"moveConnections",value:function moveConnections(a,b){if(this.rendered){var c=this.getConnections_(!1);for(var d=0;d<c.length;d++){c[d].moveBy(a,b);}c=this.getIcons();for(d=0;d<c.length;d++){c[d].computeIconLocation();}for(c=0;c<this.childBlocks_.length;c++){this.childBlocks_[c].moveConnections(a,b);}}}},{key:"setDragging",value:function setDragging(a){if(a){var _draggingConnections$;var b=this.getSvgRoot();b.translate_="";b.skew_="";(_draggingConnections$=draggingConnections$$module$build$src$core$common).push.apply(_draggingConnections$,_toConsumableArray(this.getConnections_(!0)));addClass$$module$build$src$core$utils$dom(this.svgGroup_,"blocklyDragging");}else draggingConnections$$module$build$src$core$common.length=0,removeClass$$module$build$src$core$utils$dom(this.svgGroup_,"blocklyDragging");for(b=0;b<this.childBlocks_.length;b++){this.childBlocks_[b].setDragging(a);}}},{key:"setMovable",value:function setMovable(a){_get(_getPrototypeOf(BlockSvg$$module$build$src$core$block_svg.prototype),"setMovable",this).call(this,a);this.pathObject.updateMovable(a);}},{key:"setEditable",value:function setEditable(a){_get(_getPrototypeOf(BlockSvg$$module$build$src$core$block_svg.prototype),"setEditable",this).call(this,a);a=this.getIcons();for(var b=0;b<a.length;b++){a[b].updateEditable();}}},{key:"setShadow",value:function setShadow(a){_get(_getPrototypeOf(BlockSvg$$module$build$src$core$block_svg.prototype),"setShadow",this).call(this,a);this.applyColour();}},{key:"setInsertionMarker",value:function setInsertionMarker(a){this.isInsertionMarker_!==a&&(this.isInsertionMarker_=a)&&(this.setColour(this.workspace.getRenderer().getConstants().INSERTION_MARKER_COLOUR),this.pathObject.updateInsertionMarker(!0));}},{key:"getSvgRoot",value:function getSvgRoot(){return this.svgGroup_;}},{key:"dispose",value:function dispose(a,b){if(!this.isDeadOrDying()){dispose$$module$build$src$core$tooltip();unbindMouseEvents$$module$build$src$core$tooltip(this.pathObject.svgPath);startTextWidthCache$$module$build$src$core$utils$dom();var c=this.workspace;getSelected$$module$build$src$core$common()===this&&(this.unselect(),this.workspace.cancelCurrentGesture());getCurrentBlock$$module$build$src$core$contextmenu()===this&&hide$$module$build$src$core$contextmenu();b&&this.rendered&&(this.unplug(a),disposeUiEffect$$module$build$src$core$block_animations(this));this.rendered=!1;var _iterator9=_createForOfIteratorHelper(this.warningTextDb.values()),_step9;try{for(_iterator9.s();!(_step9=_iterator9.n()).done;){var d=_step9.value;clearTimeout(d);}}catch(err){_iterator9.e(err);}finally{_iterator9.f();}this.warningTextDb.clear();b=this.getIcons();for(d=0;d<b.length;d++){b[d].dispose();}getSelected$$module$build$src$core$common()===this&&setSelected$$module$build$src$core$common(null);_get(_getPrototypeOf(BlockSvg$$module$build$src$core$block_svg.prototype),"dispose",this).call(this,!!a);removeNode$$module$build$src$core$utils$dom(this.svgGroup_);c.resizeContents();this.svgGroup_=null;stopTextWidthCache$$module$build$src$core$utils$dom();}}},{key:"checkAndDelete",value:function checkAndDelete(){this.workspace.isFlyout||(setGroup$$module$build$src$core$events$utils(!0),this.workspace.hideChaff(),this.outputConnection?this.dispose(!1,!0):this.dispose(!0,!0),setGroup$$module$build$src$core$events$utils(!1));}},{key:"toCopyData",value:function toCopyData(){return this.isInsertionMarker_?null:{saveInfo:save$$module$build$src$core$serialization$blocks(this,{addCoordinates:!0,addNextBlocks:!1}),source:this.workspace,typeCounts:getBlockTypeCounts$$module$build$src$core$common(this,!0)};}},{key:"applyColour",value:function applyColour(){this.pathObject.applyColour(this);var a=this.getIcons();for(var b=0;b<a.length;b++){a[b].applyColour();}for(var _b2=0,c;c=this.inputList[_b2];_b2++){for(var d=0,e;e=c.fieldRow[d];d++){e.applyColour();}}}},{key:"updateDisabled",value:function updateDisabled(){var a=this.getChildren(!1);this.applyColour();if(!this.isCollapsed())for(var b=0,c;c=a[b];b++){c.rendered&&c.updateDisabled();}}},{key:"getCommentIcon",value:function getCommentIcon(){return this.commentIcon_;}},{key:"setCommentText",value:function setCommentText(a){this.commentModel.text!==a&&(_get(_getPrototypeOf(BlockSvg$$module$build$src$core$block_svg.prototype),"setCommentText",this).call(this,a),a=null!==a,!!this.commentIcon_===a?this.commentIcon_.updateText():(a?this.comment=this.commentIcon_=new Comment$$module$build$src$core$comment(this):(this.commentIcon_.dispose(),this.comment=this.commentIcon_=null),this.rendered&&(this.render(),this.bumpNeighbours())));}},{key:"setWarningText",value:function setWarningText(a,b){var _this30=this;var c=b||"";if(c)this.warningTextDb.has(c)&&(clearTimeout(this.warningTextDb.get(c)),this.warningTextDb["delete"](c));else{var _iterator10=_createForOfIteratorHelper(this.warningTextDb.values()),_step10;try{for(_iterator10.s();!(_step10=_iterator10.n()).done;){var d=_step10.value;clearTimeout(d);}}catch(err){_iterator10.e(err);}finally{_iterator10.f();}this.warningTextDb.clear();}if(this.workspace.isDragging())this.warningTextDb.set(c,setTimeout(function(){_this30.isDeadOrDying()||(_this30.warningTextDb["delete"](c),_this30.setWarningText(a,c));},100));else{this.isInFlyout&&(a=null);b=!1;if("string"===typeof a){d=this.getSurroundParent();var e=null;for(;d;){d.isCollapsed()&&(e=d),d=d.getSurroundParent();}e&&e.setWarningText(Msg$$module$build$src$core$msg.COLLAPSED_WARNINGS_WARNING,BlockSvg$$module$build$src$core$block_svg.COLLAPSED_WARNING_ID);this.warning||(this.warning=new Warning$$module$build$src$core$warning(this),b=!0);this.warning.setText(a,c);}else this.warning&&!c?(this.warning.dispose(),b=!0):this.warning&&(b=this.warning.getText(),this.warning.setText("",c),(d=this.warning.getText())||this.warning.dispose(),b=b!==d);b&&this.rendered&&(this.render(),this.bumpNeighbours());}}},{key:"setMutator",value:function setMutator(a){this.mutator&&this.mutator!==a&&this.mutator.dispose();a&&(a.setBlock(this),this.mutator=a,a.createIcon());this.rendered&&(this.render(),this.bumpNeighbours());}},{key:"setEnabled",value:function setEnabled(a){this.isEnabled()!==a&&(_get(_getPrototypeOf(BlockSvg$$module$build$src$core$block_svg.prototype),"setEnabled",this).call(this,a),this.rendered&&!this.getInheritedDisabled()&&this.updateDisabled());}},{key:"setHighlighted",value:function setHighlighted(a){this.rendered&&this.pathObject.updateHighlighted(a);}},{key:"addSelect",value:function addSelect(){this.pathObject.updateSelected(!0);}},{key:"removeSelect",value:function removeSelect(){this.pathObject.updateSelected(!1);}},{key:"setDeleteStyle",value:function setDeleteStyle(a){this.pathObject.updateDraggingDelete(a);}},{key:"getColour",value:function getColour(){return this.style.colourPrimary;}},{key:"setColour",value:function setColour(a){_get(_getPrototypeOf(BlockSvg$$module$build$src$core$block_svg.prototype),"setColour",this).call(this,a);a=this.workspace.getRenderer().getConstants().getBlockStyleForColour(this.colour_);this.pathObject.setStyle(a.style);this.style=a.style;this.styleName_=a.name;this.applyColour();}},{key:"setStyle",value:function setStyle(a){var b=this.workspace.getRenderer().getConstants().getBlockStyle(a);this.styleName_=a;if(b)this.hat=b.hat,this.pathObject.setStyle(b),this.colour_=b.colourPrimary,this.style=b,this.applyColour();else throw Error("Invalid style name: "+a);}},{key:"bringToFront",value:function bringToFront(){var a=this;do{var b=a.getSvgRoot(),c=b.parentNode,d=c.childNodes;d[d.length-1]!==b&&c.appendChild(b);a=a.getParent();}while(a);}},{key:"setPreviousStatement",value:function setPreviousStatement(a,b){_get(_getPrototypeOf(BlockSvg$$module$build$src$core$block_svg.prototype),"setPreviousStatement",this).call(this,a,b);this.rendered&&(this.render(),this.bumpNeighbours());}},{key:"setNextStatement",value:function setNextStatement(a,b){_get(_getPrototypeOf(BlockSvg$$module$build$src$core$block_svg.prototype),"setNextStatement",this).call(this,a,b);this.rendered&&(this.render(),this.bumpNeighbours());}},{key:"setOutput",value:function setOutput(a,b){_get(_getPrototypeOf(BlockSvg$$module$build$src$core$block_svg.prototype),"setOutput",this).call(this,a,b);this.rendered&&(this.render(),this.bumpNeighbours());}},{key:"setInputsInline",value:function setInputsInline(a){_get(_getPrototypeOf(BlockSvg$$module$build$src$core$block_svg.prototype),"setInputsInline",this).call(this,a);this.rendered&&(this.render(),this.bumpNeighbours());}},{key:"removeInput",value:function removeInput(a,b){a=_get(_getPrototypeOf(BlockSvg$$module$build$src$core$block_svg.prototype),"removeInput",this).call(this,a,b);this.rendered&&(this.render(),this.bumpNeighbours());return a;}},{key:"moveNumberedInputBefore",value:function moveNumberedInputBefore(a,b){_get(_getPrototypeOf(BlockSvg$$module$build$src$core$block_svg.prototype),"moveNumberedInputBefore",this).call(this,a,b);this.rendered&&(this.render(),this.bumpNeighbours());}},{key:"appendInput_",value:function appendInput_(a,b){a=_get(_getPrototypeOf(BlockSvg$$module$build$src$core$block_svg.prototype),"appendInput_",this).call(this,a,b);this.rendered&&(this.render(),this.bumpNeighbours());return a;}},{key:"setConnectionTracking",value:function setConnectionTracking(a){this.previousConnection&&this.previousConnection.setTracking(a);this.outputConnection&&this.outputConnection.setTracking(a);if(this.nextConnection){this.nextConnection.setTracking(a);var b=this.nextConnection.targetBlock();b&&b.setConnectionTracking(a);}if(!this.collapsed_)for(b=0;b<this.inputList.length;b++){var c=this.inputList[b].connection;c&&(c.setTracking(a),(c=c.targetBlock())&&c.setConnectionTracking(a));}}},{key:"getConnections_",value:function getConnections_(a){var b=[];if(a||this.rendered)if(this.outputConnection&&b.push(this.outputConnection),this.previousConnection&&b.push(this.previousConnection),this.nextConnection&&b.push(this.nextConnection),a||!this.collapsed_)for(var c=0,d;d=this.inputList[c];c++){d.connection&&b.push(d.connection);}return b;}},{key:"lastConnectionInStack",value:function lastConnectionInStack(a){return _get(_getPrototypeOf(BlockSvg$$module$build$src$core$block_svg.prototype),"lastConnectionInStack",this).call(this,a);}},{key:"getMatchingConnection",value:function getMatchingConnection(a,b){return _get(_getPrototypeOf(BlockSvg$$module$build$src$core$block_svg.prototype),"getMatchingConnection",this).call(this,a,b);}},{key:"makeConnection_",value:function makeConnection_(a){return new _RenderedConnection$$module$build$src$core$rendered_connection(this,a);}},{key:"getNextBlock",value:function getNextBlock(){return _get(_getPrototypeOf(BlockSvg$$module$build$src$core$block_svg.prototype),"getNextBlock",this).call(this);}},{key:"getPreviousBlock",value:function getPreviousBlock(){return _get(_getPrototypeOf(BlockSvg$$module$build$src$core$block_svg.prototype),"getPreviousBlock",this).call(this);}},{key:"bumpNeighbours",value:function bumpNeighbours(){this.getRootBlock().bumpNeighboursInternal();}},{key:"bumpNeighboursInternal",value:function bumpNeighboursInternal(){var a=this.getRootBlock();if(!(this.isDeadOrDying()||this.workspace.isDragging()||a.isInFlyout)){var _iterator11=_createForOfIteratorHelper(this.getConnections_(!1)),_step11;try{for(_iterator11.s();!(_step11=_iterator11.n()).done;){var b=_step11.value;if(b.isSuperior()){var c=void 0;null==(c=b.targetBlock())||c.bumpNeighboursInternal();}var _iterator12=_createForOfIteratorHelper(b.neighbours($.config$$module$build$src$core$config.snapRadius)),_step12;try{for(_iterator12.s();!(_step12=_iterator12.n()).done;){var _c4=_step12.value;_c4.getSourceBlock().getRootBlock()!==a&&(b.isConnected()&&_c4.isConnected()||(b.isSuperior()?_c4.bumpAwayFrom(b):b.bumpAwayFrom(_c4)));}}catch(err){_iterator12.e(err);}finally{_iterator12.f();}}}catch(err){_iterator11.e(err);}finally{_iterator11.f();}}}},{key:"scheduleSnapAndBump",value:function scheduleSnapAndBump(){var _this31=this;var a=getGroup$$module$build$src$core$events$utils();setTimeout(function(){setGroup$$module$build$src$core$events$utils(a);_this31.snapToGrid();setGroup$$module$build$src$core$events$utils(!1);},$.config$$module$build$src$core$config.bumpDelay/2);setTimeout(function(){setGroup$$module$build$src$core$events$utils(a);_this31.bumpNeighbours();setGroup$$module$build$src$core$events$utils(!1);},$.config$$module$build$src$core$config.bumpDelay);}},{key:"positionNearConnection",value:function positionNearConnection(a,b){a.type!==ConnectionType$$module$build$src$core$connection_type.NEXT_STATEMENT&&a.type!==ConnectionType$$module$build$src$core$connection_type.INPUT_VALUE||this.moveBy(b.x-a.x,b.y-a.y);}},{key:"getFirstStatementConnection",value:function getFirstStatementConnection(){return _get(_getPrototypeOf(BlockSvg$$module$build$src$core$block_svg.prototype),"getFirstStatementConnection",this).call(this);}},{key:"getChildren",value:function getChildren(a){return _get(_getPrototypeOf(BlockSvg$$module$build$src$core$block_svg.prototype),"getChildren",this).call(this,a);}},{key:"render",value:function render(a){if(!this.renderIsInProgress_){this.renderIsInProgress_=!0;try{this.rendered=!0;startTextWidthCache$$module$build$src$core$utils$dom();this.isCollapsed()&&this.updateCollapsed_();this.workspace.getRenderer().render(this);this.updateConnectionLocations_();if(!1!==a){var b=this.getParent();b?b.render(!0):this.workspace.resizeContents();}stopTextWidthCache$$module$build$src$core$utils$dom();this.updateMarkers_();}finally{this.renderIsInProgress_=!1;}}}},{key:"updateMarkers_",value:function updateMarkers_(){this.workspace.keyboardAccessibilityMode&&this.pathObject.cursorSvg&&this.workspace.getCursor().draw();this.workspace.keyboardAccessibilityMode&&this.pathObject.markerSvg&&this.workspace.getMarker(MarkerManager$$module$build$src$core$marker_manager.LOCAL_MARKER).draw();}},{key:"updateConnectionLocations_",value:function updateConnectionLocations_(){var a=this.getRelativeToSurfaceXY();this.previousConnection&&this.previousConnection.moveToOffset(a);this.outputConnection&&this.outputConnection.moveToOffset(a);for(var b=0;b<this.inputList.length;b++){var c=this.inputList[b].connection;c&&(c.moveToOffset(a),c.isConnected()&&c.tighten());}this.nextConnection&&(this.nextConnection.moveToOffset(a),this.nextConnection.isConnected()&&this.nextConnection.tighten());}},{key:"setCursorSvg",value:function setCursorSvg(a){this.pathObject.setCursorSvg(a);}},{key:"setMarkerSvg",value:function setMarkerSvg(a){this.pathObject.setMarkerSvg(a);}},{key:"getHeightWidth",value:function getHeightWidth(){var a=this.height,b=this.width;var c=this.getNextBlock();if(c){c=c.getHeightWidth();var d=this.workspace.getRenderer().getConstants().NOTCH_HEIGHT;a+=c.height-d;b=Math.max(b,c.width);}return{height:a,width:b};}},{key:"fadeForReplacement",value:function fadeForReplacement(a){this.pathObject.updateReplacementFade(a);}},{key:"highlightShapeForInput",value:function highlightShapeForInput(a,b){this.pathObject.updateShapeForInputHighlight(a,b);}}]);return BlockSvg$$module$build$src$core$block_svg;}(Block$$module$build$src$core$block);BlockSvg$$module$build$src$core$block_svg.INLINE=-1;BlockSvg$$module$build$src$core$block_svg.COLLAPSED_WARNING_ID="TEMP_COLLAPSED_WARNING_";var module$build$src$core$block_svg={};module$build$src$core$block_svg.BlockSvg=BlockSvg$$module$build$src$core$block_svg;var DragTarget$$module$build$src$core$drag_target=/*#__PURE__*/function(){function DragTarget$$module$build$src$core$drag_target(){_classCallCheck(this,DragTarget$$module$build$src$core$drag_target);}_createClass(DragTarget$$module$build$src$core$drag_target,[{key:"onDragEnter",value:function onDragEnter(a){}},{key:"onDragOver",value:function onDragOver(a){}},{key:"onDragExit",value:function onDragExit(a){}},{key:"onDrop",value:function onDrop(a){}},{key:"getClientRect",value:function getClientRect(){return null;}},{key:"shouldPreventMove",value:function shouldPreventMove(a){return!1;}}]);return DragTarget$$module$build$src$core$drag_target;}(),module$build$src$core$drag_target={};module$build$src$core$drag_target.DragTarget=DragTarget$$module$build$src$core$drag_target;var DeleteArea$$module$build$src$core$delete_area=/*#__PURE__*/function(_DragTarget$$module$b){_inherits(DeleteArea$$module$build$src$core$delete_area,_DragTarget$$module$b);var _super28=_createSuper(DeleteArea$$module$build$src$core$delete_area);function DeleteArea$$module$build$src$core$delete_area(){var _this32;_classCallCheck(this,DeleteArea$$module$build$src$core$delete_area);_this32=_super28.call(this);_this32.wouldDelete_=!1;return _this32;}_createClass(DeleteArea$$module$build$src$core$delete_area,[{key:"wouldDelete",value:function wouldDelete(a,b){a instanceof BlockSvg$$module$build$src$core$block_svg?(a=!a.getParent()&&a.isDeletable(),this.updateWouldDelete_(a&&!b)):this.updateWouldDelete_(a.isDeletable());return this.wouldDelete_;}},{key:"updateWouldDelete_",value:function updateWouldDelete_(a){this.wouldDelete_=a;}}]);return DeleteArea$$module$build$src$core$delete_area;}(DragTarget$$module$build$src$core$drag_target),module$build$src$core$delete_area={};module$build$src$core$delete_area.DeleteArea=DeleteArea$$module$build$src$core$delete_area;var verticalPosition$$module$build$src$core$positionable_helpers;(function(a){a[a.TOP=0]="TOP";a[a.BOTTOM=1]="BOTTOM";})(verticalPosition$$module$build$src$core$positionable_helpers||(verticalPosition$$module$build$src$core$positionable_helpers={}));var horizontalPosition$$module$build$src$core$positionable_helpers;(function(a){a[a.LEFT=0]="LEFT";a[a.RIGHT=1]="RIGHT";})(horizontalPosition$$module$build$src$core$positionable_helpers||(horizontalPosition$$module$build$src$core$positionable_helpers={}));var bumpDirection$$module$build$src$core$positionable_helpers;(function(a){a[a.UP=0]="UP";a[a.DOWN=1]="DOWN";})(bumpDirection$$module$build$src$core$positionable_helpers||(bumpDirection$$module$build$src$core$positionable_helpers={}));var module$build$src$core$positionable_helpers={};module$build$src$core$positionable_helpers.bumpDirection=bumpDirection$$module$build$src$core$positionable_helpers;module$build$src$core$positionable_helpers.bumpPositionRect=bumpPositionRect$$module$build$src$core$positionable_helpers;module$build$src$core$positionable_helpers.getCornerOppositeToolbox=getCornerOppositeToolbox$$module$build$src$core$positionable_helpers;module$build$src$core$positionable_helpers.getStartPositionRect=getStartPositionRect$$module$build$src$core$positionable_helpers;module$build$src$core$positionable_helpers.horizontalPosition=horizontalPosition$$module$build$src$core$positionable_helpers;module$build$src$core$positionable_helpers.verticalPosition=verticalPosition$$module$build$src$core$positionable_helpers;var SPRITE$$module$build$src$core$sprites={width:96,height:124,url:"sprites.png"},module$build$src$core$sprites={};module$build$src$core$sprites.SPRITE=SPRITE$$module$build$src$core$sprites;var Trashcan$$module$build$src$core$trashcan=/*#__PURE__*/function(_DeleteArea$$module$b){_inherits(Trashcan$$module$build$src$core$trashcan,_DeleteArea$$module$b);var _super29=_createSuper(Trashcan$$module$build$src$core$trashcan);function Trashcan$$module$build$src$core$trashcan(a){var _this33;_classCallCheck(this,Trashcan$$module$build$src$core$trashcan);_this33=_super29.call(this);_this33.workspace=a;_this33.id="trashcan";_this33.contents_=[];_this33.flyout=null;_this33.isLidOpen=!1;_this33.minOpenness_=0;_this33.lidTask_=_this33.svgLid_=_this33.svgGroup_=null;_this33.top_=_this33.left_=_this33.lidOpen_=0;_this33.initialized_=!1;0>=_this33.workspace.options.maxTrashcanContents||(a=new Options$$module$build$src$core$options({scrollbars:!0,parentWorkspace:_this33.workspace,rtl:_this33.workspace.RTL,oneBasedIndex:_this33.workspace.options.oneBasedIndex,renderer:_this33.workspace.options.renderer,rendererOverrides:_this33.workspace.options.rendererOverrides,move:{scrollbars:!0}}),_this33.workspace.horizontalLayout?(a.toolboxPosition=_this33.workspace.toolboxPosition===Position$$module$build$src$core$utils$toolbox.TOP?Position$$module$build$src$core$utils$toolbox.BOTTOM:Position$$module$build$src$core$utils$toolbox.TOP,_this33.flyout=new(getClassFromOptions$$module$build$src$core$registry(Type$$module$build$src$core$registry.FLYOUTS_HORIZONTAL_TOOLBOX,_this33.workspace.options,!0))(a)):(a.toolboxPosition=_this33.workspace.toolboxPosition===Position$$module$build$src$core$utils$toolbox.RIGHT?Position$$module$build$src$core$utils$toolbox.LEFT:Position$$module$build$src$core$utils$toolbox.RIGHT,_this33.flyout=new(getClassFromOptions$$module$build$src$core$registry(Type$$module$build$src$core$registry.FLYOUTS_VERTICAL_TOOLBOX,_this33.workspace.options,!0))(a)),_this33.workspace.addChangeListener(_this33.onDelete_.bind(_assertThisInitialized(_this33))));return _this33;}_createClass(Trashcan$$module$build$src$core$trashcan,[{key:"createDom",value:function createDom(){this.svgGroup_=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.G,{"class":"blocklyTrash"});var a;var b=String(Math.random()).substring(2);a=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.CLIPPATH,{id:"blocklyTrashBodyClipPath"+b},this.svgGroup_);createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.RECT,{width:WIDTH$$module$build$src$core$trashcan,height:BODY_HEIGHT$$module$build$src$core$trashcan,y:LID_HEIGHT$$module$build$src$core$trashcan},a);var c=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.IMAGE,{width:SPRITE$$module$build$src$core$sprites.width,x:-SPRITE_LEFT$$module$build$src$core$trashcan,height:SPRITE$$module$build$src$core$sprites.height,y:-SPRITE_TOP$$module$build$src$core$trashcan,"clip-path":"url(#blocklyTrashBodyClipPath"+b+")"},this.svgGroup_);c.setAttributeNS(XLINK_NS$$module$build$src$core$utils$dom,"xlink:href",this.workspace.options.pathToMedia+SPRITE$$module$build$src$core$sprites.url);a=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.CLIPPATH,{id:"blocklyTrashLidClipPath"+b},this.svgGroup_);createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.RECT,{width:WIDTH$$module$build$src$core$trashcan,height:LID_HEIGHT$$module$build$src$core$trashcan},a);this.svgLid_=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.IMAGE,{width:SPRITE$$module$build$src$core$sprites.width,x:-SPRITE_LEFT$$module$build$src$core$trashcan,height:SPRITE$$module$build$src$core$sprites.height,y:-SPRITE_TOP$$module$build$src$core$trashcan,"clip-path":"url(#blocklyTrashLidClipPath"+b+")"},this.svgGroup_);this.svgLid_.setAttributeNS(XLINK_NS$$module$build$src$core$utils$dom,"xlink:href",this.workspace.options.pathToMedia+SPRITE$$module$build$src$core$sprites.url);bind$$module$build$src$core$browser_events(this.svgGroup_,"mousedown",this,this.blockMouseDownWhenOpenable_);bind$$module$build$src$core$browser_events(this.svgGroup_,"mouseup",this,this.click);bind$$module$build$src$core$browser_events(c,"mouseover",this,this.mouseOver_);bind$$module$build$src$core$browser_events(c,"mouseout",this,this.mouseOut_);this.animateLid_();return this.svgGroup_;}},{key:"init",value:function init(){0<this.workspace.options.maxTrashcanContents&&(insertAfter$$module$build$src$core$utils$dom(this.flyout.createDom(Svg$$module$build$src$core$utils$svg.SVG),this.workspace.getParentSvg()),this.flyout.init(this.workspace));this.workspace.getComponentManager().addComponent({component:this,weight:1,capabilities:[ComponentManager$$module$build$src$core$component_manager.Capability.AUTOHIDEABLE,ComponentManager$$module$build$src$core$component_manager.Capability.DELETE_AREA,ComponentManager$$module$build$src$core$component_manager.Capability.DRAG_TARGET,ComponentManager$$module$build$src$core$component_manager.Capability.POSITIONABLE]});this.initialized_=!0;this.setLidOpen(!1);}},{key:"dispose",value:function dispose(){this.workspace.getComponentManager().removeComponent("trashcan");this.svgGroup_&&(removeNode$$module$build$src$core$utils$dom(this.svgGroup_),this.svgGroup_=null);this.svgLid_=null;this.lidTask_&&clearTimeout(this.lidTask_);}},{key:"hasContents_",value:function hasContents_(){return!!this.contents_.length;}},{key:"contentsIsOpen",value:function contentsIsOpen(){return!!this.flyout&&this.flyout.isVisible();}},{key:"openFlyout",value:function openFlyout(){if(!this.contentsIsOpen()){var a=this.contents_.map(function(c){return JSON.parse(c);}),b;null==(b=this.flyout)||b.show(a);this.fireUiEvent_(!0);}}},{key:"closeFlyout",value:function closeFlyout(){if(this.contentsIsOpen()){var a;null==(a=this.flyout)||a.hide();this.fireUiEvent_(!1);this.workspace.recordDragTargets();}}},{key:"autoHide",value:function autoHide(a){!a&&this.flyout&&this.closeFlyout();}},{key:"emptyContents",value:function emptyContents(){this.hasContents_()&&(this.contents_.length=0,this.setMinOpenness_(0),this.closeFlyout());}},{key:"position",value:function position(a,b){if(this.initialized_){var c=getCornerOppositeToolbox$$module$build$src$core$positionable_helpers(this.workspace,a);a=getStartPositionRect$$module$build$src$core$positionable_helpers(c,new Size$$module$build$src$core$utils$size(WIDTH$$module$build$src$core$trashcan,BODY_HEIGHT$$module$build$src$core$trashcan+LID_HEIGHT$$module$build$src$core$trashcan),MARGIN_HORIZONTAL$$module$build$src$core$trashcan,MARGIN_VERTICAL$$module$build$src$core$trashcan,a,this.workspace);b=bumpPositionRect$$module$build$src$core$positionable_helpers(a,MARGIN_VERTICAL$$module$build$src$core$trashcan,c.vertical===verticalPosition$$module$build$src$core$positionable_helpers.TOP?bumpDirection$$module$build$src$core$positionable_helpers.DOWN:bumpDirection$$module$build$src$core$positionable_helpers.UP,b);this.top_=b.top;this.left_=b.left;var d;null==(d=this.svgGroup_)||d.setAttribute("transform","translate("+this.left_+","+this.top_+")");}}},{key:"getBoundingRectangle",value:function getBoundingRectangle(){return new Rect$$module$build$src$core$utils$rect(this.top_,this.top_+BODY_HEIGHT$$module$build$src$core$trashcan+LID_HEIGHT$$module$build$src$core$trashcan,this.left_,this.left_+WIDTH$$module$build$src$core$trashcan);}},{key:"getClientRect",value:function getClientRect(){if(!this.svgGroup_)return null;var a=this.svgGroup_.getBoundingClientRect();var b=a.top+SPRITE_TOP$$module$build$src$core$trashcan-MARGIN_HOTSPOT$$module$build$src$core$trashcan;a=a.left+SPRITE_LEFT$$module$build$src$core$trashcan-MARGIN_HOTSPOT$$module$build$src$core$trashcan;return new Rect$$module$build$src$core$utils$rect(b,b+LID_HEIGHT$$module$build$src$core$trashcan+BODY_HEIGHT$$module$build$src$core$trashcan+2*MARGIN_HOTSPOT$$module$build$src$core$trashcan,a,a+WIDTH$$module$build$src$core$trashcan+2*MARGIN_HOTSPOT$$module$build$src$core$trashcan);}},{key:"onDragOver",value:function onDragOver(a){this.setLidOpen(this.wouldDelete_);}},{key:"onDragExit",value:function onDragExit(a){this.setLidOpen(!1);}},{key:"onDrop",value:function onDrop(a){setTimeout(this.setLidOpen.bind(this,!1),100);}},{key:"setLidOpen",value:function setLidOpen(a){this.isLidOpen!==a&&(this.lidTask_&&clearTimeout(this.lidTask_),this.isLidOpen=a,this.animateLid_());}},{key:"animateLid_",value:function animateLid_(){var a=ANIMATION_FRAMES$$module$build$src$core$trashcan;var b=1/(a+1);this.lidOpen_+=this.isLidOpen?b:-b;this.lidOpen_=Math.min(Math.max(this.lidOpen_,this.minOpenness_),1);this.setLidAngle_(this.lidOpen_*MAX_LID_ANGLE$$module$build$src$core$trashcan);b=OPACITY_MIN$$module$build$src$core$trashcan+this.lidOpen_*(OPACITY_MAX$$module$build$src$core$trashcan-OPACITY_MIN$$module$build$src$core$trashcan);this.svgGroup_&&(this.svgGroup_.style.opacity=b.toString());this.lidOpen_>this.minOpenness_&&1>this.lidOpen_&&(this.lidTask_=setTimeout(this.animateLid_.bind(this),ANIMATION_LENGTH$$module$build$src$core$trashcan/a));}},{key:"setLidAngle_",value:function setLidAngle_(a){var b=this.workspace.toolboxPosition===Position$$module$build$src$core$utils$toolbox.RIGHT||this.workspace.horizontalLayout&&this.workspace.RTL;var c;null==(c=this.svgLid_)||c.setAttribute("transform","rotate("+(b?-a:a)+","+(b?4:WIDTH$$module$build$src$core$trashcan-4)+","+(LID_HEIGHT$$module$build$src$core$trashcan-2)+")");}},{key:"setMinOpenness_",value:function setMinOpenness_(a){this.minOpenness_=a;this.isLidOpen||this.setLidAngle_(a*MAX_LID_ANGLE$$module$build$src$core$trashcan);}},{key:"closeLid",value:function closeLid(){this.setLidOpen(!1);}},{key:"click",value:function click(){this.hasContents_()&&this.openFlyout();}},{key:"fireUiEvent_",value:function fireUiEvent_(a){a=new(get$$module$build$src$core$events$utils(TRASHCAN_OPEN$$module$build$src$core$events$utils))(a,this.workspace.id);fire$$module$build$src$core$events$utils(a);}},{key:"blockMouseDownWhenOpenable_",value:function blockMouseDownWhenOpenable_(a){!this.contentsIsOpen()&&this.hasContents_()&&a.stopPropagation();}},{key:"mouseOver_",value:function mouseOver_(){this.hasContents_()&&this.setLidOpen(!0);}},{key:"mouseOut_",value:function mouseOut_(){this.setLidOpen(!1);}},{key:"onDelete_",value:function onDelete_(a){if(!(0>=this.workspace.options.maxTrashcanContents||a.type!==DELETE$$module$build$src$core$events$utils||a.type!==DELETE$$module$build$src$core$events$utils||a.wasShadow)){if(!a.oldJson)throw Error("Encountered a delete event without proper oldJson");a=JSON.stringify(this.cleanBlockJson_(a.oldJson));if(-1===this.contents_.indexOf(a)){for(this.contents_.unshift(a);this.contents_.length>this.workspace.options.maxTrashcanContents;){this.contents_.pop();}this.setMinOpenness_(HAS_BLOCKS_LID_ANGLE$$module$build$src$core$trashcan);}}}},{key:"cleanBlockJson_",value:function cleanBlockJson_(a){function b(c){if(c){delete c.id;delete c.x;delete c.y;delete c.enabled;if(c.icons&&c.icons.comment){var d=c.icons.comment;delete d.height;delete d.width;delete d.pinned;}d=c.inputs;for(var e in d){var f=d[e];var g=f.block;f=f.shadow;g&&b(g);f&&b(f);}c.next&&(e=c.next,c=e.block,e=e.shadow,c&&b(c),e&&b(e));}}a=JSON.parse(JSON.stringify(a));b(a);return Object.assign({},{kind:"BLOCK"},a);}}]);return Trashcan$$module$build$src$core$trashcan;}(DeleteArea$$module$build$src$core$delete_area),WIDTH$$module$build$src$core$trashcan=47,BODY_HEIGHT$$module$build$src$core$trashcan=44,LID_HEIGHT$$module$build$src$core$trashcan=16,MARGIN_VERTICAL$$module$build$src$core$trashcan=20,MARGIN_HORIZONTAL$$module$build$src$core$trashcan=20,MARGIN_HOTSPOT$$module$build$src$core$trashcan=10,SPRITE_LEFT$$module$build$src$core$trashcan=0,SPRITE_TOP$$module$build$src$core$trashcan=32,HAS_BLOCKS_LID_ANGLE$$module$build$src$core$trashcan=.1,ANIMATION_LENGTH$$module$build$src$core$trashcan=80,ANIMATION_FRAMES$$module$build$src$core$trashcan=4,OPACITY_MIN$$module$build$src$core$trashcan=.4,OPACITY_MAX$$module$build$src$core$trashcan=.8,MAX_LID_ANGLE$$module$build$src$core$trashcan=45,module$build$src$core$trashcan={};module$build$src$core$trashcan.Trashcan=Trashcan$$module$build$src$core$trashcan;var ToolboxItemSelect$$module$build$src$core$events$events_toolbox_item_select=/*#__PURE__*/function(_UiBase$$module$build4){_inherits(ToolboxItemSelect$$module$build$src$core$events$events_toolbox_item_select,_UiBase$$module$build4);var _super30=_createSuper(ToolboxItemSelect$$module$build$src$core$events$events_toolbox_item_select);function ToolboxItemSelect$$module$build$src$core$events$events_toolbox_item_select(a,b,c){var _this34;_classCallCheck(this,ToolboxItemSelect$$module$build$src$core$events$events_toolbox_item_select);_this34=_super30.call(this,c);_this34.type=TOOLBOX_ITEM_SELECT$$module$build$src$core$events$utils;_this34.oldItem=null!=a?a:void 0;_this34.newItem=null!=b?b:void 0;return _this34;}_createClass(ToolboxItemSelect$$module$build$src$core$events$events_toolbox_item_select,[{key:"toJson",value:function toJson(){var a=_get(_getPrototypeOf(ToolboxItemSelect$$module$build$src$core$events$events_toolbox_item_select.prototype),"toJson",this).call(this);a.oldItem=this.oldItem;a.newItem=this.newItem;return a;}},{key:"fromJson",value:function fromJson(a){_get(_getPrototypeOf(ToolboxItemSelect$$module$build$src$core$events$events_toolbox_item_select.prototype),"fromJson",this).call(this,a);this.oldItem=a.oldItem;this.newItem=a.newItem;}}]);return ToolboxItemSelect$$module$build$src$core$events$events_toolbox_item_select;}(UiBase$$module$build$src$core$events$events_ui_base);register$$module$build$src$core$registry(Type$$module$build$src$core$registry.EVENT,TOOLBOX_ITEM_SELECT$$module$build$src$core$events$utils,ToolboxItemSelect$$module$build$src$core$events$events_toolbox_item_select);var module$build$src$core$events$events_toolbox_item_select={};module$build$src$core$events$events_toolbox_item_select.ToolboxItemSelect=ToolboxItemSelect$$module$build$src$core$events$events_toolbox_item_select;var ToolboxItem$$module$build$src$core$toolbox$toolbox_item=/*#__PURE__*/function(){function ToolboxItem$$module$build$src$core$toolbox$toolbox_item(a,b,c){_classCallCheck(this,ToolboxItem$$module$build$src$core$toolbox$toolbox_item);this.id_=a.toolboxitemid||getNextUniqueId$$module$build$src$core$utils$idgenerator();this.level_=(this.parent_=c||null)?this.parent_.getLevel()+1:0;this.toolboxItemDef_=a;this.parentToolbox_=b;this.workspace_=this.parentToolbox_.getWorkspace();}_createClass(ToolboxItem$$module$build$src$core$toolbox$toolbox_item,[{key:"init",value:function init(){}},{key:"getDiv",value:function getDiv(){return null;}},{key:"getClickTarget",value:function getClickTarget(){return null;}},{key:"getId",value:function getId(){return this.id_;}},{key:"getParent",value:function getParent(){return null;}},{key:"getLevel",value:function getLevel(){return this.level_;}},{key:"isSelectable",value:function isSelectable(){return!1;}},{key:"isCollapsible",value:function isCollapsible(){return!1;}},{key:"dispose",value:function dispose(){}},{key:"setVisible_",value:function setVisible_(a){}}]);return ToolboxItem$$module$build$src$core$toolbox$toolbox_item;}(),module$build$src$core$toolbox$toolbox_item={};module$build$src$core$toolbox$toolbox_item.ToolboxItem=ToolboxItem$$module$build$src$core$toolbox$toolbox_item;var ToolboxCategory$$module$build$src$core$toolbox$category=/*#__PURE__*/function(_ToolboxItem$$module$){_inherits(ToolboxCategory$$module$build$src$core$toolbox$category,_ToolboxItem$$module$);var _super31=_createSuper(ToolboxCategory$$module$build$src$core$toolbox$category);function ToolboxCategory$$module$build$src$core$toolbox$category(a,b,c){var _this35;_classCallCheck(this,ToolboxCategory$$module$build$src$core$toolbox$category);_this35=_super31.call(this,a,b,c);_this35.colour_=_this35.name_="";_this35.labelDom_=_this35.iconDom_=_this35.rowContents_=_this35.rowDiv_=_this35.htmlDiv_=null;_this35.isDisabled_=_this35.isHidden_=!1;_this35.flyoutItems_=[];_this35.cssConfig_=_this35.makeDefaultCssConfig_();return _this35;}_createClass(ToolboxCategory$$module$build$src$core$toolbox$category,[{key:"init",value:function init(){this.parseCategoryDef_(this.toolboxItemDef_);this.parseContents_(this.toolboxItemDef_);this.createDom_();"true"===this.toolboxItemDef_.hidden&&this.hide();}},{key:"makeDefaultCssConfig_",value:function makeDefaultCssConfig_(){return{container:"blocklyToolboxCategory",row:"blocklyTreeRow",rowcontentcontainer:"blocklyTreeRowContentContainer",icon:"blocklyTreeIcon",label:"blocklyTreeLabel",contents:"blocklyToolboxContents",selected:"blocklyTreeSelected",openicon:"blocklyTreeIconOpen",closedicon:"blocklyTreeIconClosed"};}},{key:"parseContents_",value:function parseContents_(a){if("custom"in a)this.flyoutItems_=a.custom;else if(a=a.contents)for(var b=0;b<a.length;b++){var c=a[b];Array.isArray(this.flyoutItems_)&&this.flyoutItems_.push(c);}}},{key:"parseCategoryDef_",value:function parseCategoryDef_(a){this.name_="name"in a?replaceMessageReferences$$module$build$src$core$utils$parsing(a.name):"";this.colour_=this.getColour_(a);Object.assign(this.cssConfig_,a.cssconfig||a.cssConfig);}},{key:"createDom_",value:function createDom_(){this.htmlDiv_=this.createContainer_();setRole$$module$build$src$core$utils$aria(this.htmlDiv_,Role$$module$build$src$core$utils$aria.TREEITEM);setState$$module$build$src$core$utils$aria(this.htmlDiv_,State$$module$build$src$core$utils$aria.SELECTED,!1);setState$$module$build$src$core$utils$aria(this.htmlDiv_,State$$module$build$src$core$utils$aria.LEVEL,this.level_);this.rowDiv_=this.createRowContainer_();this.rowDiv_.style.pointerEvents="auto";this.htmlDiv_.appendChild(this.rowDiv_);this.rowContents_=this.createRowContentsContainer_();this.rowContents_.style.pointerEvents="none";this.rowDiv_.appendChild(this.rowContents_);this.iconDom_=this.createIconDom_();setRole$$module$build$src$core$utils$aria(this.iconDom_,Role$$module$build$src$core$utils$aria.PRESENTATION);this.rowContents_.appendChild(this.iconDom_);this.labelDom_=this.createLabelDom_(this.name_);this.rowContents_.appendChild(this.labelDom_);var a=this.labelDom_.getAttribute("id");a&&setState$$module$build$src$core$utils$aria(this.htmlDiv_,State$$module$build$src$core$utils$aria.LABELLEDBY,a);this.addColourBorder_(this.colour_);return this.htmlDiv_;}},{key:"createContainer_",value:function createContainer_(){var a=document.createElement("div"),b=this.cssConfig_.container;b&&addClass$$module$build$src$core$utils$dom(a,b);return a;}},{key:"createRowContainer_",value:function createRowContainer_(){var a=document.createElement("div");var b=this.cssConfig_.row;b&&addClass$$module$build$src$core$utils$dom(a,b);b="".concat(ToolboxCategory$$module$build$src$core$toolbox$category.nestedPadding*this.getLevel(),"px");this.workspace_.RTL?a.style.paddingRight=b:a.style.paddingLeft=b;return a;}},{key:"createRowContentsContainer_",value:function createRowContentsContainer_(){var a=document.createElement("div"),b=this.cssConfig_.rowcontentcontainer;b&&addClass$$module$build$src$core$utils$dom(a,b);return a;}},{key:"createIconDom_",value:function createIconDom_(){var a=document.createElement("span");if(!this.parentToolbox_.isHorizontal()){var b=this.cssConfig_.icon;b&&addClass$$module$build$src$core$utils$dom(a,b);}a.style.display="inline-block";return a;}},{key:"createLabelDom_",value:function createLabelDom_(a){var b=document.createElement("span");b.setAttribute("id",this.getId()+".label");b.textContent=a;(a=this.cssConfig_.label)&&addClass$$module$build$src$core$utils$dom(b,a);return b;}},{key:"refreshTheme",value:function refreshTheme(){this.colour_=this.getColour_(this.toolboxItemDef_);this.addColourBorder_(this.colour_);}},{key:"addColourBorder_",value:function addColourBorder_(a){a&&(a=ToolboxCategory$$module$build$src$core$toolbox$category.borderWidth+"px solid "+(a||"#ddd"),this.workspace_.RTL?this.rowDiv_.style.borderRight=a:this.rowDiv_.style.borderLeft=a);}},{key:"getColour_",value:function getColour_(a){var b=a.categorystyle||a.categoryStyle;if((a=a.colour)&&b)console.warn('Toolbox category "'+this.name_+'" must not have both a style and a colour');else{if(b)return this.getColourfromStyle_(b);if(a)return this.parseColour_(a);}return"";}},{key:"getColourfromStyle_",value:function getColourfromStyle_(a){var b=this.workspace_.getTheme();if(a&&b){if((b=b.categoryStyles[a])&&b.colour)return this.parseColour_(b.colour);console.warn('Style "'+a+'" must exist and contain a colour value');}return"";}},{key:"getClickTarget",value:function getClickTarget(){return this.rowDiv_;}},{key:"parseColour_",value:function parseColour_(a){a=replaceMessageReferences$$module$build$src$core$utils$parsing(a);if(null==a||""===a)return"";var b=Number(a);if(isNaN(b)){if(b=parse$$module$build$src$core$utils$colour(a))return b;console.warn('Toolbox category "'+this.name_+'" has unrecognized colour attribute: '+a);return"";}return hueToHex$$module$build$src$core$utils$colour(b);}},{key:"openIcon_",value:function openIcon_(a){if(a){var b=this.cssConfig_.closedicon;b&&removeClasses$$module$build$src$core$utils$dom(a,b);(b=this.cssConfig_.openicon)&&addClass$$module$build$src$core$utils$dom(a,b);}}},{key:"closeIcon_",value:function closeIcon_(a){if(a){var b=this.cssConfig_.openicon;b&&removeClasses$$module$build$src$core$utils$dom(a,b);(b=this.cssConfig_.closedicon)&&addClass$$module$build$src$core$utils$dom(a,b);}}},{key:"setVisible_",value:function setVisible_(a){this.htmlDiv_.style.display=a?"block":"none";this.isHidden_=!a;this.parentToolbox_.getSelectedItem()===this&&this.parentToolbox_.clearSelection();}},{key:"hide",value:function hide(){this.setVisible_(!1);}},{key:"show",value:function show(){this.setVisible_(!0);}},{key:"isVisible",value:function isVisible(){return!this.isHidden_&&this.allAncestorsExpanded_();}},{key:"allAncestorsExpanded_",value:function allAncestorsExpanded_(){var a=this;for(;a.getParent();){if(a=a.getParent(),!a.isExpanded())return!1;}return!0;}},{key:"isSelectable",value:function isSelectable(){return this.isVisible()&&!this.isDisabled_;}},{key:"onClick",value:function onClick(a){}},{key:"setSelected",value:function setSelected(a){if(this.rowDiv_){var b=this.cssConfig_.selected;if(a){var c=this.parseColour_(ToolboxCategory$$module$build$src$core$toolbox$category.defaultBackgroundColour);this.rowDiv_.style.backgroundColor=this.colour_||c;b&&addClass$$module$build$src$core$utils$dom(this.rowDiv_,b);}else this.rowDiv_.style.backgroundColor="",b&&removeClass$$module$build$src$core$utils$dom(this.rowDiv_,b);setState$$module$build$src$core$utils$aria(this.htmlDiv_,State$$module$build$src$core$utils$aria.SELECTED,a);}}},{key:"setDisabled",value:function setDisabled(a){this.isDisabled_=a;this.getDiv().setAttribute("disabled","".concat(a));a?this.getDiv().setAttribute("disabled","true"):this.getDiv().removeAttribute("disabled");}},{key:"getName",value:function getName(){return this.name_;}},{key:"getParent",value:function getParent(){return this.parent_;}},{key:"getDiv",value:function getDiv(){return this.htmlDiv_;}},{key:"getContents",value:function getContents(){return this.flyoutItems_;}},{key:"updateFlyoutContents",value:function updateFlyoutContents(a){this.flyoutItems_=[];this.toolboxItemDef_="string"===typeof a?{kind:this.toolboxItemDef_.kind,custom:a,id:this.toolboxItemDef_.id,categorystyle:this.toolboxItemDef_.categorystyle,colour:this.toolboxItemDef_.colour,cssconfig:this.toolboxItemDef_.cssconfig,hidden:this.toolboxItemDef_.hidden}:{kind:this.toolboxItemDef_.kind,name:"name"in this.toolboxItemDef_?this.toolboxItemDef_.name:"",contents:convertFlyoutDefToJsonArray$$module$build$src$core$utils$toolbox(a),id:this.toolboxItemDef_.id,categorystyle:this.toolboxItemDef_.categorystyle,colour:this.toolboxItemDef_.colour,cssconfig:this.toolboxItemDef_.cssconfig,hidden:this.toolboxItemDef_.hidden};this.parseContents_(this.toolboxItemDef_);}},{key:"dispose",value:function dispose(){removeNode$$module$build$src$core$utils$dom(this.htmlDiv_);}}]);return ToolboxCategory$$module$build$src$core$toolbox$category;}(ToolboxItem$$module$build$src$core$toolbox$toolbox_item);ToolboxCategory$$module$build$src$core$toolbox$category.registrationName="category";ToolboxCategory$$module$build$src$core$toolbox$category.nestedPadding=19;ToolboxCategory$$module$build$src$core$toolbox$category.borderWidth=8;ToolboxCategory$$module$build$src$core$toolbox$category.defaultBackgroundColour="#57e";register$$module$build$src$core$css('\n.blocklyTreeRow:not(.blocklyTreeSelected):hover {\n  background-color: rgba(255, 255, 255, .2);\n}\n\n.blocklyToolboxDiv[layout="h"] .blocklyToolboxCategory {\n  margin: 1px 5px 1px 0;\n}\n\n.blocklyToolboxDiv[dir="RTL"][layout="h"] .blocklyToolboxCategory {\n  margin: 1px 0 1px 5px;\n}\n\n.blocklyTreeRow {\n  height: 22px;\n  line-height: 22px;\n  margin-bottom: 3px;\n  padding-right: 8px;\n  white-space: nowrap;\n}\n\n.blocklyToolboxDiv[dir="RTL"] .blocklyTreeRow {\n  margin-left: 8px;\n  padding-right: 0;\n}\n\n.blocklyTreeIcon {\n  background-image: url(<<<PATH>>>/sprites.png);\n  height: 16px;\n  vertical-align: middle;\n  visibility: hidden;\n  width: 16px;\n}\n\n.blocklyTreeIconClosed {\n  background-position: -32px -1px;\n}\n\n.blocklyToolboxDiv[dir="RTL"] .blocklyTreeIconClosed {\n  background-position: 0 -1px;\n}\n\n.blocklyTreeSelected>.blocklyTreeIconClosed {\n  background-position: -32px -17px;\n}\n\n.blocklyToolboxDiv[dir="RTL"] .blocklyTreeSelected>.blocklyTreeIconClosed {\n  background-position: 0 -17px;\n}\n\n.blocklyTreeIconOpen {\n  background-position: -16px -1px;\n}\n\n.blocklyTreeSelected>.blocklyTreeIconOpen {\n  background-position: -16px -17px;\n}\n\n.blocklyTreeLabel {\n  cursor: default;\n  font: 16px sans-serif;\n  padding: 0 3px;\n  vertical-align: middle;\n}\n\n.blocklyToolboxDelete .blocklyTreeLabel {\n  cursor: url("<<<PATH>>>/handdelete.cur"), auto;\n}\n\n.blocklyTreeSelected .blocklyTreeLabel {\n  color: #fff;\n}\n');register$$module$build$src$core$registry(Type$$module$build$src$core$registry.TOOLBOX_ITEM,ToolboxCategory$$module$build$src$core$toolbox$category.registrationName,ToolboxCategory$$module$build$src$core$toolbox$category);var module$build$src$core$toolbox$category={};module$build$src$core$toolbox$category.ToolboxCategory=ToolboxCategory$$module$build$src$core$toolbox$category;var ToolboxSeparator$$module$build$src$core$toolbox$separator=/*#__PURE__*/function(_ToolboxItem$$module$2){_inherits(ToolboxSeparator$$module$build$src$core$toolbox$separator,_ToolboxItem$$module$2);var _super32=_createSuper(ToolboxSeparator$$module$build$src$core$toolbox$separator);function ToolboxSeparator$$module$build$src$core$toolbox$separator(a,b){var _this36;_classCallCheck(this,ToolboxSeparator$$module$build$src$core$toolbox$separator);_this36=_super32.call(this,a,b);_this36.cssConfig_={container:"blocklyTreeSeparator"};_this36.htmlDiv_=null;Object.assign(_this36.cssConfig_,a.cssconfig||a.cssConfig);return _this36;}_createClass(ToolboxSeparator$$module$build$src$core$toolbox$separator,[{key:"init",value:function init(){this.createDom_();}},{key:"createDom_",value:function createDom_(){var a=document.createElement("div"),b=this.cssConfig_.container;b&&addClass$$module$build$src$core$utils$dom(a,b);return this.htmlDiv_=a;}},{key:"getDiv",value:function getDiv(){return this.htmlDiv_;}},{key:"dispose",value:function dispose(){removeNode$$module$build$src$core$utils$dom(this.htmlDiv_);}}]);return ToolboxSeparator$$module$build$src$core$toolbox$separator;}(ToolboxItem$$module$build$src$core$toolbox$toolbox_item);ToolboxSeparator$$module$build$src$core$toolbox$separator.registrationName="sep";register$$module$build$src$core$css('\n.blocklyTreeSeparator {\n  border-bottom: solid #e5e5e5 1px;\n  height: 0;\n  margin: 5px 0;\n}\n\n.blocklyToolboxDiv[layout="h"] .blocklyTreeSeparator {\n  border-right: solid #e5e5e5 1px;\n  border-bottom: none;\n  height: auto;\n  margin: 0 5px 0 5px;\n  padding: 5px 0;\n  width: 0;\n}\n');register$$module$build$src$core$registry(Type$$module$build$src$core$registry.TOOLBOX_ITEM,ToolboxSeparator$$module$build$src$core$toolbox$separator.registrationName,ToolboxSeparator$$module$build$src$core$toolbox$separator);var module$build$src$core$toolbox$separator={};module$build$src$core$toolbox$separator.ToolboxSeparator=ToolboxSeparator$$module$build$src$core$toolbox$separator;var CollapsibleToolboxCategory$$module$build$src$core$toolbox$collapsible_category=/*#__PURE__*/function(_ToolboxCategory$$mod){_inherits(CollapsibleToolboxCategory$$module$build$src$core$toolbox$collapsible_category,_ToolboxCategory$$mod);var _super33=_createSuper(CollapsibleToolboxCategory$$module$build$src$core$toolbox$collapsible_category);function CollapsibleToolboxCategory$$module$build$src$core$toolbox$collapsible_category(a,b,c){var _this37;_classCallCheck(this,CollapsibleToolboxCategory$$module$build$src$core$toolbox$collapsible_category);_this37=_super33.call(this,a,b,c);_this37.subcategoriesDiv_=null;_this37.expanded_=!1;_this37.toolboxItems_=[];return _this37;}_createClass(CollapsibleToolboxCategory$$module$build$src$core$toolbox$collapsible_category,[{key:"makeDefaultCssConfig_",value:function makeDefaultCssConfig_(){var a=_get(_getPrototypeOf(CollapsibleToolboxCategory$$module$build$src$core$toolbox$collapsible_category.prototype),"makeDefaultCssConfig_",this).call(this);a.contents="blocklyToolboxContents";return a;}},{key:"parseContents_",value:function parseContents_(a){var b=a.contents;var c=!0;if(a.custom)this.flyoutItems_=a.custom;else if(b)for(a=0;a<b.length;a++){var d=b[a];!hasItem$$module$build$src$core$registry(Type$$module$build$src$core$registry.TOOLBOX_ITEM,d.kind)||d.kind.toLowerCase()===ToolboxSeparator$$module$build$src$core$toolbox$separator.registrationName&&c?(this.flyoutItems_.push(d),c=!0):(this.createToolboxItem_(d),c=!1);}}},{key:"createToolboxItem_",value:function createToolboxItem_(a){var b=a.kind;"CATEGORY"===b.toUpperCase()&&isCategoryCollapsible$$module$build$src$core$utils$toolbox(a)&&(b=CollapsibleToolboxCategory$$module$build$src$core$toolbox$collapsible_category.registrationName);a=new(getClass$$module$build$src$core$registry(Type$$module$build$src$core$registry.TOOLBOX_ITEM,b))(a,this.parentToolbox_,this);this.toolboxItems_.push(a);}},{key:"init",value:function init(){_get(_getPrototypeOf(CollapsibleToolboxCategory$$module$build$src$core$toolbox$collapsible_category.prototype),"init",this).call(this);this.setExpanded("true"===this.toolboxItemDef_.expanded||this.toolboxItemDef_.expanded);}},{key:"createDom_",value:function createDom_(){_get(_getPrototypeOf(CollapsibleToolboxCategory$$module$build$src$core$toolbox$collapsible_category.prototype),"createDom_",this).call(this);var a=this.getChildToolboxItems();this.subcategoriesDiv_=this.createSubCategoriesDom_(a);setRole$$module$build$src$core$utils$aria(this.subcategoriesDiv_,Role$$module$build$src$core$utils$aria.GROUP);this.htmlDiv_.appendChild(this.subcategoriesDiv_);return this.htmlDiv_;}},{key:"createIconDom_",value:function createIconDom_(){var a=document.createElement("span");if(!this.parentToolbox_.isHorizontal()){var b=this.cssConfig_.icon;b&&addClass$$module$build$src$core$utils$dom(a,b);a.style.visibility="visible";}a.style.display="inline-block";return a;}},{key:"createSubCategoriesDom_",value:function createSubCategoriesDom_(a){var b=document.createElement("div");var c=this.cssConfig_.contents;c&&addClass$$module$build$src$core$utils$dom(b,c);for(c=0;c<a.length;c++){var d=a[c];d.init();var e=d.getDiv();b.appendChild(e);if(d.getClickTarget){var f=void 0;null==(f=d.getClickTarget())||f.setAttribute("id",d.getId());}}return b;}},{key:"setExpanded",value:function setExpanded(a){this.expanded_!==a&&((this.expanded_=a)?(this.subcategoriesDiv_.style.display="block",this.openIcon_(this.iconDom_)):(this.subcategoriesDiv_.style.display="none",this.closeIcon_(this.iconDom_)),setState$$module$build$src$core$utils$aria(this.htmlDiv_,State$$module$build$src$core$utils$aria.EXPANDED,a),this.parentToolbox_.handleToolboxItemResize());}},{key:"setVisible_",value:function setVisible_(a){this.htmlDiv_.style.display=a?"block":"none";var b=this.getChildToolboxItems();for(var c=0;c<b.length;c++){b[c].setVisible_(a);}this.isHidden_=!a;this.parentToolbox_.getSelectedItem()===this&&this.parentToolbox_.clearSelection();}},{key:"isExpanded",value:function isExpanded(){return this.expanded_;}},{key:"isCollapsible",value:function isCollapsible(){return!0;}},{key:"onClick",value:function onClick(a){this.toggleExpanded();}},{key:"toggleExpanded",value:function toggleExpanded(){this.setExpanded(!this.expanded_);}},{key:"getDiv",value:function getDiv(){return this.htmlDiv_;}},{key:"getChildToolboxItems",value:function getChildToolboxItems(){return this.toolboxItems_;}}]);return CollapsibleToolboxCategory$$module$build$src$core$toolbox$collapsible_category;}(ToolboxCategory$$module$build$src$core$toolbox$category);CollapsibleToolboxCategory$$module$build$src$core$toolbox$collapsible_category.registrationName="collapsibleCategory";register$$module$build$src$core$registry(Type$$module$build$src$core$registry.TOOLBOX_ITEM,CollapsibleToolboxCategory$$module$build$src$core$toolbox$collapsible_category.registrationName,CollapsibleToolboxCategory$$module$build$src$core$toolbox$collapsible_category);var module$build$src$core$toolbox$collapsible_category={};module$build$src$core$toolbox$collapsible_category.CollapsibleToolboxCategory=CollapsibleToolboxCategory$$module$build$src$core$toolbox$collapsible_category;var Toolbox$$module$build$src$core$toolbox$toolbox=/*#__PURE__*/function(_DeleteArea$$module$b2){_inherits(Toolbox$$module$build$src$core$toolbox$toolbox,_DeleteArea$$module$b2);var _super34=_createSuper(Toolbox$$module$build$src$core$toolbox$toolbox);function Toolbox$$module$build$src$core$toolbox$toolbox(a){var _this38;_classCallCheck(this,Toolbox$$module$build$src$core$toolbox$toolbox);_this38=_super34.call(this);_this38.id="toolbox";_this38.contentsDiv_=_this38.HtmlDiv=null;_this38.isVisible_=!1;_this38.contents_=[];_this38.height_=_this38.width_=0;_this38.previouslySelectedItem_=_this38.selectedItem_=_this38.flyout_=null;_this38.boundEvents_=[];_this38.workspace_=a;_this38.toolboxDef_=a.options.languageTree||{contents:[]};_this38.horizontalLayout_=a.options.horizontalLayout;_this38.RTL=a.options.RTL;_this38.contentMap_=Object.create(null);_this38.toolboxPosition=a.options.toolboxPosition;return _this38;}_createClass(Toolbox$$module$build$src$core$toolbox$toolbox,[{key:"onShortcut",value:function onShortcut(a){return!1;}},{key:"init",value:function init(){var a=this.workspace_;var b=a.getParentSvg();this.flyout_=this.createFlyout_();this.HtmlDiv=this.createDom_(this.workspace_);insertAfter$$module$build$src$core$utils$dom(this.flyout_.createDom("svg"),b);this.setVisible(!0);this.flyout_.init(a);this.render(this.toolboxDef_);a=a.getThemeManager();a.subscribe(this.HtmlDiv,"toolboxBackgroundColour","background-color");a.subscribe(this.HtmlDiv,"toolboxForegroundColour","color");this.workspace_.getComponentManager().addComponent({component:this,weight:1,capabilities:[ComponentManager$$module$build$src$core$component_manager.Capability.AUTOHIDEABLE,ComponentManager$$module$build$src$core$component_manager.Capability.DELETE_AREA,ComponentManager$$module$build$src$core$component_manager.Capability.DRAG_TARGET]});}},{key:"createDom_",value:function createDom_(a){a=a.getParentSvg();var b=this.createContainer_();this.contentsDiv_=this.createContentsContainer_();this.contentsDiv_.tabIndex=0;setRole$$module$build$src$core$utils$aria(this.contentsDiv_,Role$$module$build$src$core$utils$aria.TREE);b.appendChild(this.contentsDiv_);a.parentNode.insertBefore(b,a);this.attachEvents_(b,this.contentsDiv_);return b;}},{key:"createContainer_",value:function createContainer_(){var a=document.createElement("div");a.setAttribute("layout",this.isHorizontal()?"h":"v");addClass$$module$build$src$core$utils$dom(a,"blocklyToolboxDiv");addClass$$module$build$src$core$utils$dom(a,"blocklyNonSelectable");a.setAttribute("dir",this.RTL?"RTL":"LTR");return a;}},{key:"createContentsContainer_",value:function createContentsContainer_(){var a=document.createElement("div");addClass$$module$build$src$core$utils$dom(a,"blocklyToolboxContents");this.isHorizontal()&&(a.style.flexDirection="row");return a;}},{key:"attachEvents_",value:function attachEvents_(a,b){a=conditionalBind$$module$build$src$core$browser_events(a,"click",this,this.onClick_,!1,!0);this.boundEvents_.push(a);b=conditionalBind$$module$build$src$core$browser_events(b,"keydown",this,this.onKeyDown_,!1,!0);this.boundEvents_.push(b);}},{key:"onClick_",value:function onClick_(a){if(isRightButton$$module$build$src$core$browser_events(a)||a.target===this.HtmlDiv)getMainWorkspace$$module$build$src$core$common().hideChaff(!1);else{var b=a.target.getAttribute("id");b&&(b=this.getToolboxItemById(b),b.isSelectable()&&(this.setSelectedItem(b),b.onClick(a)));getMainWorkspace$$module$build$src$core$common().hideChaff(!0);}clearTouchIdentifier$$module$build$src$core$touch();}},{key:"onKeyDown_",value:function onKeyDown_(a){var b=!1;switch(a.keyCode){case KeyCodes$$module$build$src$core$utils$keycodes.DOWN:b=this.selectNext_();break;case KeyCodes$$module$build$src$core$utils$keycodes.UP:b=this.selectPrevious_();break;case KeyCodes$$module$build$src$core$utils$keycodes.LEFT:b=this.selectParent_();break;case KeyCodes$$module$build$src$core$utils$keycodes.RIGHT:b=this.selectChild_();break;case KeyCodes$$module$build$src$core$utils$keycodes.ENTER:case KeyCodes$$module$build$src$core$utils$keycodes.SPACE:this.selectedItem_&&this.selectedItem_.isCollapsible()&&(this.selectedItem_.toggleExpanded(),b=!0);break;default:b=!1;}if(!b&&this.selectedItem_){var c=this.selectedItem_;c.onKeyDown&&(b=c.onKeyDown(a));}b&&a.preventDefault();}},{key:"createFlyout_",value:function createFlyout_(){var a=this.workspace_,b=new Options$$module$build$src$core$options({parentWorkspace:a,rtl:a.RTL,oneBasedIndex:a.options.oneBasedIndex,horizontalLayout:a.horizontalLayout,renderer:a.options.renderer,rendererOverrides:a.options.rendererOverrides,move:{scrollbars:!0}});b.toolboxPosition=a.options.toolboxPosition;return new(a.horizontalLayout?getClassFromOptions$$module$build$src$core$registry(Type$$module$build$src$core$registry.FLYOUTS_HORIZONTAL_TOOLBOX,a.options,!0):getClassFromOptions$$module$build$src$core$registry(Type$$module$build$src$core$registry.FLYOUTS_VERTICAL_TOOLBOX,a.options,!0))(b);}},{key:"render",value:function render(a){this.toolboxDef_=a;for(var b=0;b<this.contents_.length;b++){var c=this.contents_[b];c&&c.dispose();}this.contents_=[];this.contentMap_=Object.create(null);this.renderContents_(a.contents);this.position();this.handleToolboxItemResize();}},{key:"renderContents_",value:function renderContents_(a){var b=document.createDocumentFragment();for(var c=0;c<a.length;c++){this.createToolboxItem_(a[c],b);}this.contentsDiv_.appendChild(b);}},{key:"createToolboxItem_",value:function createToolboxItem_(a,b){var c=a.kind;"CATEGORY"===c.toUpperCase()&&isCategoryCollapsible$$module$build$src$core$utils$toolbox(a)&&(c=CollapsibleToolboxCategory$$module$build$src$core$toolbox$collapsible_category.registrationName);if(c=getClass$$module$build$src$core$registry(Type$$module$build$src$core$registry.TOOLBOX_ITEM,c.toLowerCase()))a=new c(a,this),a.init(),this.addToolboxItem_(a),(c=a.getDiv())&&b.appendChild(c),a.getClickTarget()&&a.getClickTarget().setAttribute("id",a.getId());}},{key:"addToolboxItem_",value:function addToolboxItem_(a){this.contents_.push(a);this.contentMap_[a.getId()]=a;if(a.isCollapsible()){a=a.getChildToolboxItems();for(var b=0;b<a.length;b++){this.addToolboxItem_(a[b]);}}}},{key:"getToolboxItems",value:function getToolboxItems(){return this.contents_;}},{key:"addStyle",value:function addStyle(a){a&&this.HtmlDiv&&addClass$$module$build$src$core$utils$dom(this.HtmlDiv,a);}},{key:"removeStyle",value:function removeStyle(a){a&&this.HtmlDiv&&removeClass$$module$build$src$core$utils$dom(this.HtmlDiv,a);}},{key:"getClientRect",value:function getClientRect(){if(!this.HtmlDiv||!this.isVisible_)return null;var a=this.HtmlDiv.getBoundingClientRect();var b=a.top,c=b+a.height,d=a.left;a=d+a.width;return this.toolboxPosition===Position$$module$build$src$core$utils$toolbox.TOP?new Rect$$module$build$src$core$utils$rect(-1E7,c,-1E7,1E7):this.toolboxPosition===Position$$module$build$src$core$utils$toolbox.BOTTOM?new Rect$$module$build$src$core$utils$rect(b,1E7,-1E7,1E7):this.toolboxPosition===Position$$module$build$src$core$utils$toolbox.LEFT?new Rect$$module$build$src$core$utils$rect(-1E7,1E7,-1E7,a):new Rect$$module$build$src$core$utils$rect(-1E7,1E7,d,1E7);}},{key:"wouldDelete",value:function wouldDelete(a,b){a instanceof BlockSvg$$module$build$src$core$block_svg?this.updateWouldDelete_(!a.getParent()&&a.isDeletable()):this.updateWouldDelete_(a.isDeletable());return this.wouldDelete_;}},{key:"onDragEnter",value:function onDragEnter(a){this.updateCursorDeleteStyle_(!0);}},{key:"onDragExit",value:function onDragExit(a){this.updateCursorDeleteStyle_(!1);}},{key:"onDrop",value:function onDrop(a){this.updateCursorDeleteStyle_(!1);}},{key:"updateWouldDelete_",value:function updateWouldDelete_(a){a!==this.wouldDelete_&&(this.updateCursorDeleteStyle_(!1),this.wouldDelete_=a,this.updateCursorDeleteStyle_(!0));}},{key:"updateCursorDeleteStyle_",value:function updateCursorDeleteStyle_(a){var b=this.wouldDelete_?"blocklyToolboxDelete":"blocklyToolboxGrab";a?this.addStyle(b):this.removeStyle(b);}},{key:"getToolboxItemById",value:function getToolboxItemById(a){return this.contentMap_[a]||null;}},{key:"getWidth",value:function getWidth(){return this.width_;}},{key:"getHeight",value:function getHeight(){return this.height_;}},{key:"getFlyout",value:function getFlyout(){return this.flyout_;}},{key:"getWorkspace",value:function getWorkspace(){return this.workspace_;}},{key:"getSelectedItem",value:function getSelectedItem(){return this.selectedItem_;}},{key:"getPreviouslySelectedItem",value:function getPreviouslySelectedItem(){return this.previouslySelectedItem_;}},{key:"isHorizontal",value:function isHorizontal(){return this.horizontalLayout_;}},{key:"position",value:function position(){var a=this.workspace_.getMetrics(),b=this.HtmlDiv;b&&(this.horizontalLayout_?(b.style.left="0",b.style.height="auto",b.style.width="100%",this.height_=b.offsetHeight,this.width_=a.viewWidth,this.toolboxPosition===Position$$module$build$src$core$utils$toolbox.TOP?b.style.top="0":b.style.bottom="0"):(this.toolboxPosition===Position$$module$build$src$core$utils$toolbox.RIGHT?b.style.right="0":b.style.left="0",b.style.height="100%",this.width_=b.offsetWidth,this.height_=a.viewHeight),this.flyout_.position());}},{key:"handleToolboxItemResize",value:function handleToolboxItemResize(){var a=this.workspace_,b=this.HtmlDiv.getBoundingClientRect();a.translate(this.toolboxPosition===Position$$module$build$src$core$utils$toolbox.LEFT?a.scrollX+b.width:a.scrollX,this.toolboxPosition===Position$$module$build$src$core$utils$toolbox.TOP?a.scrollY+b.height:a.scrollY);svgResize$$module$build$src$core$common(a);}},{key:"clearSelection",value:function clearSelection(){this.setSelectedItem(null);}},{key:"refreshTheme",value:function refreshTheme(){for(var a=0;a<this.contents_.length;a++){var b=this.contents_[a];b.refreshTheme&&b.refreshTheme();}}},{key:"refreshSelection",value:function refreshSelection(){this.selectedItem_&&this.selectedItem_.isSelectable()&&this.selectedItem_.getContents().length&&this.flyout_.show(this.selectedItem_.getContents());}},{key:"setVisible",value:function setVisible(a){this.isVisible_!==a&&(this.HtmlDiv.style.display=a?"block":"none",this.isVisible_=a,this.workspace_.recordDragTargets());}},{key:"autoHide",value:function autoHide(a){!a&&this.flyout_&&this.flyout_.autoClose&&this.clearSelection();}},{key:"setSelectedItem",value:function setSelectedItem(a){var b=this.selectedItem_;!a&&!b||a&&!a.isSelectable()||(this.shouldDeselectItem_(b,a)&&null!==b&&this.deselectItem_(b),this.shouldSelectItem_(b,a)&&null!==a&&this.selectItem_(b,a),this.updateFlyout_(b,a),this.fireSelectEvent_(b,a));}},{key:"shouldDeselectItem_",value:function shouldDeselectItem_(a,b){return null!==a&&(!a.isCollapsible()||a!==b);}},{key:"shouldSelectItem_",value:function shouldSelectItem_(a,b){return null!==b&&b!==a;}},{key:"deselectItem_",value:function deselectItem_(a){this.selectedItem_=null;this.previouslySelectedItem_=a;a.setSelected(!1);setState$$module$build$src$core$utils$aria(this.contentsDiv_,State$$module$build$src$core$utils$aria.ACTIVEDESCENDANT,"");}},{key:"selectItem_",value:function selectItem_(a,b){this.selectedItem_=b;this.previouslySelectedItem_=a;b.setSelected(!0);setState$$module$build$src$core$utils$aria(this.contentsDiv_,State$$module$build$src$core$utils$aria.ACTIVEDESCENDANT,b.getId());}},{key:"selectItemByPosition",value:function selectItemByPosition(a){-1<a&&a<this.contents_.length&&(a=this.contents_[a],a.isSelectable()&&this.setSelectedItem(a));}},{key:"updateFlyout_",value:function updateFlyout_(a,b){b&&(a!==b||b.isCollapsible())&&b.getContents().length?(this.flyout_.show(b.getContents()),this.flyout_.scrollToStart()):this.flyout_.hide();}},{key:"fireSelectEvent_",value:function fireSelectEvent_(a,b){var c=a&&a.getName();var d=b&&b.getName();a===b&&(d=null);a=new(get$$module$build$src$core$events$utils(TOOLBOX_ITEM_SELECT$$module$build$src$core$events$utils))(c,d,this.workspace_.id);fire$$module$build$src$core$events$utils(a);}},{key:"selectParent_",value:function selectParent_(){return this.selectedItem_?this.selectedItem_.isCollapsible()&&this.selectedItem_.isExpanded()?(this.selectedItem_.toggleExpanded(),!0):this.selectedItem_.getParent()&&this.selectedItem_.getParent().isSelectable()?(this.setSelectedItem(this.selectedItem_.getParent()),!0):!1:!1;}},{key:"selectChild_",value:function selectChild_(){if(!this.selectedItem_||!this.selectedItem_.isCollapsible())return!1;var a=this.selectedItem_;a.isExpanded()?this.selectNext_():a.toggleExpanded();return!0;}},{key:"selectNext_",value:function selectNext_(){if(!this.selectedItem_)return!1;var a=this.contents_.indexOf(this.selectedItem_)+1;if(-1<a&&a<this.contents_.length){var b=this.contents_[a];for(;b&&!b.isSelectable();){b=this.contents_[++a];}if(b&&b.isSelectable())return this.setSelectedItem(b),!0;}return!1;}},{key:"selectPrevious_",value:function selectPrevious_(){if(!this.selectedItem_)return!1;var a=this.contents_.indexOf(this.selectedItem_)-1;if(-1<a&&a<this.contents_.length){var b=this.contents_[a];for(;b&&!b.isSelectable();){b=this.contents_[--a];}if(b&&b.isSelectable())return this.setSelectedItem(b),!0;}return!1;}},{key:"dispose",value:function dispose(){this.workspace_.getComponentManager().removeComponent("toolbox");this.flyout_.dispose();for(var a=0;a<this.contents_.length;a++){this.contents_[a].dispose();}for(a=0;a<this.boundEvents_.length;a++){unbind$$module$build$src$core$browser_events(this.boundEvents_[a]);}this.boundEvents_=[];this.contents_=[];this.workspace_.getThemeManager().unsubscribe(this.HtmlDiv);removeNode$$module$build$src$core$utils$dom(this.HtmlDiv);}}]);return Toolbox$$module$build$src$core$toolbox$toolbox;}(DeleteArea$$module$build$src$core$delete_area);register$$module$build$src$core$css('\n.blocklyToolboxDelete {\n  cursor: url("<<<PATH>>>/handdelete.cur"), auto;\n}\n\n.blocklyToolboxGrab {\n  cursor: url("<<<PATH>>>/handclosed.cur"), auto;\n  cursor: grabbing;\n  cursor: -webkit-grabbing;\n}\n\n/* Category tree in Toolbox. */\n.blocklyToolboxDiv {\n  background-color: #ddd;\n  overflow-x: visible;\n  overflow-y: auto;\n  padding: 4px 0 4px 0;\n  position: absolute;\n  z-index: 70;  /* so blocks go under toolbox when dragging */\n  -webkit-tap-highlight-color: transparent;  /* issue #1345 */\n}\n\n.blocklyToolboxContents {\n  display: flex;\n  flex-wrap: wrap;\n  flex-direction: column;\n}\n\n.blocklyToolboxContents:focus {\n  outline: none;\n}\n');register$$module$build$src$core$registry(Type$$module$build$src$core$registry.TOOLBOX,DEFAULT$$module$build$src$core$registry,Toolbox$$module$build$src$core$toolbox$toolbox);var module$build$src$core$toolbox$toolbox={};module$build$src$core$toolbox$toolbox.Toolbox=Toolbox$$module$build$src$core$toolbox$toolbox;var defaultBlockStyles$$module$build$src$core$theme$zelos={colour_blocks:{colourPrimary:"#CF63CF",colourSecondary:"#C94FC9",colourTertiary:"#BD42BD"},list_blocks:{colourPrimary:"#9966FF",colourSecondary:"#855CD6",colourTertiary:"#774DCB"},logic_blocks:{colourPrimary:"#4C97FF",colourSecondary:"#4280D7",colourTertiary:"#3373CC"},loop_blocks:{colourPrimary:"#0fBD8C",colourSecondary:"#0DA57A",colourTertiary:"#0B8E69"},math_blocks:{colourPrimary:"#59C059",colourSecondary:"#46B946",colourTertiary:"#389438"},procedure_blocks:{colourPrimary:"#FF6680",colourSecondary:"#FF4D6A",colourTertiary:"#FF3355"},text_blocks:{colourPrimary:"#FFBF00",colourSecondary:"#E6AC00",colourTertiary:"#CC9900"},variable_blocks:{colourPrimary:"#FF8C1A",colourSecondary:"#FF8000",colourTertiary:"#DB6E00"},variable_dynamic_blocks:{colourPrimary:"#FF8C1A",colourSecondary:"#FF8000",colourTertiary:"#DB6E00"},hat_blocks:{colourPrimary:"#4C97FF",colourSecondary:"#4280D7",colourTertiary:"#3373CC",hat:"cap"}},categoryStyles$$module$build$src$core$theme$zelos={colour_category:{colour:"#CF63CF"},list_category:{colour:"#9966FF"},logic_category:{colour:"#4C97FF"},loop_category:{colour:"#0fBD8C"},math_category:{colour:"#59C059"},procedure_category:{colour:"#FF6680"},text_category:{colour:"#FFBF00"},variable_category:{colour:"#FF8C1A"},variable_dynamic_category:{colour:"#FF8C1A"}},Zelos$$module$build$src$core$theme$zelos=new Theme$$module$build$src$core$theme("zelos",defaultBlockStyles$$module$build$src$core$theme$zelos,categoryStyles$$module$build$src$core$theme$zelos),module$build$src$core$theme$zelos={};module$build$src$core$theme$zelos.Zelos=Zelos$$module$build$src$core$theme$zelos;var module$build$src$core$theme$themes={};module$build$src$core$theme$themes.Classic=Classic$$module$build$src$core$theme$classic;module$build$src$core$theme$themes.Zelos=Zelos$$module$build$src$core$theme$zelos;var Click$$module$build$src$core$events$events_click=/*#__PURE__*/function(_UiBase$$module$build5){_inherits(Click$$module$build$src$core$events$events_click,_UiBase$$module$build5);var _super35=_createSuper(Click$$module$build$src$core$events$events_click);function Click$$module$build$src$core$events$events_click(a,b,c){var _this39;_classCallCheck(this,Click$$module$build$src$core$events$events_click);b=a?a.workspace.id:b;null===b&&(b=void 0);_this39=_super35.call(this,b);_this39.type=CLICK$$module$build$src$core$events$utils;_this39.blockId=a?a.id:void 0;_this39.targetType=c;return _this39;}_createClass(Click$$module$build$src$core$events$events_click,[{key:"toJson",value:function toJson(){var a=_get(_getPrototypeOf(Click$$module$build$src$core$events$events_click.prototype),"toJson",this).call(this);if(!this.targetType)throw Error("The click target type is undefined. Either pass a block to the constructor, or call fromJson");a.targetType=this.targetType;a.blockId=this.blockId;return a;}},{key:"fromJson",value:function fromJson(a){_get(_getPrototypeOf(Click$$module$build$src$core$events$events_click.prototype),"fromJson",this).call(this,a);this.targetType=a.targetType;this.blockId=a.blockId;}}]);return Click$$module$build$src$core$events$events_click;}(UiBase$$module$build$src$core$events$events_ui_base),ClickTarget$$module$build$src$core$events$events_click;(function(a){a.BLOCK="block";a.WORKSPACE="workspace";a.ZOOM_CONTROLS="zoom_controls";})(ClickTarget$$module$build$src$core$events$events_click||(ClickTarget$$module$build$src$core$events$events_click={}));register$$module$build$src$core$registry(Type$$module$build$src$core$registry.EVENT,CLICK$$module$build$src$core$events$utils,Click$$module$build$src$core$events$events_click);var module$build$src$core$events$events_click={};module$build$src$core$events$events_click.Click=Click$$module$build$src$core$events$events_click;module$build$src$core$events$events_click.ClickTarget=ClickTarget$$module$build$src$core$events$events_click;var BubbleDragger$$module$build$src$core$bubble_dragger=/*#__PURE__*/function(){function BubbleDragger$$module$build$src$core$bubble_dragger(a,b){_classCallCheck(this,BubbleDragger$$module$build$src$core$bubble_dragger);this.bubble=a;this.workspace=b;this.dragTarget_=null;this.wouldDeleteBubble_=!1;this.startXY_=this.bubble.getRelativeToSurfaceXY();this.dragSurface_=b.getBlockDragSurface();}_createClass(BubbleDragger$$module$build$src$core$bubble_dragger,[{key:"startBubbleDrag",value:function startBubbleDrag(){getGroup$$module$build$src$core$events$utils()||setGroup$$module$build$src$core$events$utils(!0);this.workspace.setResizesEnabled(!1);this.bubble.setAutoLayout(!1);this.dragSurface_&&(this.bubble.moveTo(0,0),this.dragSurface_.translateSurface(this.startXY_.x,this.startXY_.y),this.dragSurface_.setBlocksAndShow(this.bubble.getSvgRoot()));this.bubble.setDragging&&this.bubble.setDragging(!0);}},{key:"dragBubble",value:function dragBubble(a,b){b=this.pixelsToWorkspaceUnits_(b);b=Coordinate$$module$build$src$core$utils$coordinate.sum(this.startXY_,b);this.bubble.moveDuringDrag(this.dragSurface_,b);b=this.dragTarget_;this.dragTarget_=this.workspace.getDragTarget(a);a=this.wouldDeleteBubble_;this.wouldDeleteBubble_=this.shouldDelete_(this.dragTarget_);a!==this.wouldDeleteBubble_&&this.updateCursorDuringBubbleDrag_();this.dragTarget_!==b&&(b&&b.onDragExit(this.bubble),this.dragTarget_&&this.dragTarget_.onDragEnter(this.bubble));this.dragTarget_&&this.dragTarget_.onDragOver(this.bubble);}},{key:"shouldDelete_",value:function shouldDelete_(a){return a&&this.workspace.getComponentManager().hasCapability(a.id,ComponentManager$$module$build$src$core$component_manager.Capability.DELETE_AREA)?a.wouldDelete(this.bubble,!1):!1;}},{key:"updateCursorDuringBubbleDrag_",value:function updateCursorDuringBubbleDrag_(){this.bubble.setDeleteStyle(this.wouldDeleteBubble_);}},{key:"endBubbleDrag",value:function endBubbleDrag(a,b){this.dragBubble(a,b);this.dragTarget_&&this.dragTarget_.shouldPreventMove(this.bubble)?a=this.startXY_:(a=this.pixelsToWorkspaceUnits_(b),a=Coordinate$$module$build$src$core$utils$coordinate.sum(this.startXY_,a));this.bubble.moveTo(a.x,a.y);if(this.dragTarget_)this.dragTarget_.onDrop(this.bubble);this.wouldDeleteBubble_?(this.fireMoveEvent_(),this.bubble.dispose()):(this.dragSurface_&&this.dragSurface_.clearAndHide(this.workspace.getBubbleCanvas()),this.bubble.setDragging&&this.bubble.setDragging(!1),this.fireMoveEvent_());this.workspace.setResizesEnabled(!0);setGroup$$module$build$src$core$events$utils(!1);}},{key:"fireMoveEvent_",value:function fireMoveEvent_(){if(this.bubble instanceof WorkspaceCommentSvg$$module$build$src$core$workspace_comment_svg){var a=new(get$$module$build$src$core$events$utils(COMMENT_MOVE$$module$build$src$core$events$utils))(this.bubble);a.setOldCoordinate(this.startXY_);a.recordNew();fire$$module$build$src$core$events$utils(a);}}},{key:"pixelsToWorkspaceUnits_",value:function pixelsToWorkspaceUnits_(a){a=new Coordinate$$module$build$src$core$utils$coordinate(a.x/this.workspace.scale,a.y/this.workspace.scale);this.workspace.isMutator&&a.scale(1/this.workspace.options.parentWorkspace.scale);return a;}}]);return BubbleDragger$$module$build$src$core$bubble_dragger;}(),module$build$src$core$bubble_dragger={};module$build$src$core$bubble_dragger.BubbleDragger=BubbleDragger$$module$build$src$core$bubble_dragger;var WorkspaceDragger$$module$build$src$core$workspace_dragger=/*#__PURE__*/function(){function WorkspaceDragger$$module$build$src$core$workspace_dragger(a){_classCallCheck(this,WorkspaceDragger$$module$build$src$core$workspace_dragger);this.workspace=a;this.horizontalScrollEnabled_=this.workspace.isMovableHorizontally();this.verticalScrollEnabled_=this.workspace.isMovableVertically();this.startScrollXY_=new Coordinate$$module$build$src$core$utils$coordinate(a.scrollX,a.scrollY);}_createClass(WorkspaceDragger$$module$build$src$core$workspace_dragger,[{key:"dispose",value:function dispose(){this.workspace=null;}},{key:"startDrag",value:function startDrag(){getSelected$$module$build$src$core$common()&&getSelected$$module$build$src$core$common().unselect();this.workspace.setupDragSurface();}},{key:"endDrag",value:function endDrag(a){this.drag(a);this.workspace.resetDragSurface();}},{key:"drag",value:function drag(a){a=Coordinate$$module$build$src$core$utils$coordinate.sum(this.startScrollXY_,a);if(this.horizontalScrollEnabled_&&this.verticalScrollEnabled_)this.workspace.scroll(a.x,a.y);else if(this.horizontalScrollEnabled_)this.workspace.scroll(a.x,this.workspace.scrollY);else if(this.verticalScrollEnabled_)this.workspace.scroll(this.workspace.scrollX,a.y);else throw new TypeError("Invalid state.");}}]);return WorkspaceDragger$$module$build$src$core$workspace_dragger;}(),module$build$src$core$workspace_dragger={};module$build$src$core$workspace_dragger.WorkspaceDragger=WorkspaceDragger$$module$build$src$core$workspace_dragger;var Gesture$$module$build$src$core$gesture=/*#__PURE__*/function(){function Gesture$$module$build$src$core$gesture(a,b){_classCallCheck(this,Gesture$$module$build$src$core$gesture);this.creatorWorkspace=b;this.mouseDownXY_=new Coordinate$$module$build$src$core$utils$coordinate(0,0);this.startWorkspace_=this.targetBlock_=this.startBlock_=this.startField_=this.startBubble_=null;this.hasExceededDragRadius_=!1;this.flyout_=this.workspaceDragger_=this.blockDragger_=this.bubbleDragger_=this.onUpWrapper_=this.onMoveWrapper_=null;this.isEnding_=this.hasStarted_=this.calledUpdateIsDragging_=!1;this.mostRecentEvent_=a;this.currentDragDeltaXY_=new Coordinate$$module$build$src$core$utils$coordinate(0,0);this.healStack_=!DRAG_STACK$$module$build$src$core$internal_constants;}_createClass(Gesture$$module$build$src$core$gesture,[{key:"dispose",value:function dispose(){clearTouchIdentifier$$module$build$src$core$touch();unblock$$module$build$src$core$tooltip();this.creatorWorkspace.clearGesture();this.onMoveWrapper_&&unbind$$module$build$src$core$browser_events(this.onMoveWrapper_);this.onUpWrapper_&&unbind$$module$build$src$core$browser_events(this.onUpWrapper_);this.blockDragger_&&this.blockDragger_.dispose();this.workspaceDragger_&&this.workspaceDragger_.dispose();}},{key:"updateFromEvent_",value:function updateFromEvent_(a){var b=new Coordinate$$module$build$src$core$utils$coordinate(a.clientX,a.clientY);this.updateDragDelta_(b)&&(this.updateIsDragging_(),longStop$$module$build$src$core$touch());this.mostRecentEvent_=a;}},{key:"updateDragDelta_",value:function updateDragDelta_(a){this.currentDragDeltaXY_=Coordinate$$module$build$src$core$utils$coordinate.difference(a,this.mouseDownXY_);return this.hasExceededDragRadius_?!1:this.hasExceededDragRadius_=Coordinate$$module$build$src$core$utils$coordinate.magnitude(this.currentDragDeltaXY_)>(this.flyout_?$.config$$module$build$src$core$config.flyoutDragRadius:$.config$$module$build$src$core$config.dragRadius);}},{key:"updateIsDraggingFromFlyout_",value:function updateIsDraggingFromFlyout_(){var a;if(!this.targetBlock_||null==(a=this.flyout_)||!a.isBlockCreatable(this.targetBlock_))return!1;if(!this.flyout_.targetWorkspace)throw Error("Cannot update dragging from the flyout because the ' +\n          'flyout's target workspace is undefined");return!this.flyout_.isScrollable()||this.flyout_.isDragTowardWorkspace(this.currentDragDeltaXY_)?(this.startWorkspace_=this.flyout_.targetWorkspace,this.startWorkspace_.updateScreenCalculationsIfScrolled(),getGroup$$module$build$src$core$events$utils()||setGroup$$module$build$src$core$events$utils(!0),this.startBlock_=null,this.targetBlock_=this.flyout_.createBlock(this.targetBlock_),this.targetBlock_.select(),!0):!1;}},{key:"updateIsDraggingBubble_",value:function updateIsDraggingBubble_(){if(!this.startBubble_)return!1;this.startDraggingBubble_();return!0;}},{key:"updateIsDraggingBlock_",value:function updateIsDraggingBlock_(){if(!this.targetBlock_)return!1;if(this.flyout_){if(this.updateIsDraggingFromFlyout_())return this.startDraggingBlock_(),!0;}else if(this.targetBlock_.isMovable())return this.startDraggingBlock_(),!0;return!1;}},{key:"updateIsDraggingWorkspace_",value:function updateIsDraggingWorkspace_(){if(!this.startWorkspace_)throw Error("Cannot update dragging the workspace because the start workspace is undefined");if(this.flyout_?this.flyout_.isScrollable():this.startWorkspace_&&this.startWorkspace_.isDraggable())this.workspaceDragger_=new WorkspaceDragger$$module$build$src$core$workspace_dragger(this.startWorkspace_),this.workspaceDragger_.startDrag();}},{key:"updateIsDragging_",value:function updateIsDragging_(){if(this.calledUpdateIsDragging_)throw Error("updateIsDragging_ should only be called once per gesture.");this.calledUpdateIsDragging_=!0;this.updateIsDraggingBubble_()||this.updateIsDraggingBlock_()||this.updateIsDraggingWorkspace_();}},{key:"startDraggingBlock_",value:function startDraggingBlock_(){this.blockDragger_=new(getClassFromOptions$$module$build$src$core$registry(Type$$module$build$src$core$registry.BLOCK_DRAGGER,this.creatorWorkspace.options,!0))(this.targetBlock_,this.startWorkspace_);this.blockDragger_.startDrag(this.currentDragDeltaXY_,this.healStack_);this.blockDragger_.drag(this.mostRecentEvent_,this.currentDragDeltaXY_);}},{key:"startDraggingBubble_",value:function startDraggingBubble_(){if(!this.startBubble_)throw Error("Cannot update dragging the bubble because the start bubble is undefined");if(!this.startWorkspace_)throw Error("Cannot update dragging the bubble because the start workspace is undefined");this.bubbleDragger_=new BubbleDragger$$module$build$src$core$bubble_dragger(this.startBubble_,this.startWorkspace_);this.bubbleDragger_.startBubbleDrag();this.bubbleDragger_.dragBubble(this.mostRecentEvent_,this.currentDragDeltaXY_);}},{key:"doStart",value:function doStart(a){if(isTargetInput$$module$build$src$core$browser_events(a))this.cancel();else{if(!this.startWorkspace_)throw Error("Cannot start the gesture because the start workspace is undefined");this.hasStarted_=!0;disconnectUiStop$$module$build$src$core$block_animations();this.startWorkspace_.updateScreenCalculationsIfScrolled();this.startWorkspace_.isMutator&&this.startWorkspace_.resize();this.startWorkspace_.hideChaff(!!this.flyout_);this.startWorkspace_.markFocused();this.mostRecentEvent_=a;block$$module$build$src$core$tooltip();this.targetBlock_&&this.targetBlock_.select();isRightButton$$module$build$src$core$browser_events(a)?this.handleRightClick(a):("touchstart"!==a.type.toLowerCase()&&"pointerdown"!==a.type.toLowerCase()||"mouse"===a.pointerType||longStart$$module$build$src$core$touch(a,this),this.mouseDownXY_=new Coordinate$$module$build$src$core$utils$coordinate(a.clientX,a.clientY),this.healStack_=a.altKey||a.ctrlKey||a.metaKey,this.bindMouseEvents(a));}}},{key:"bindMouseEvents",value:function bindMouseEvents(a){this.onMoveWrapper_=conditionalBind$$module$build$src$core$browser_events(document,"mousemove",null,this.handleMove.bind(this));this.onUpWrapper_=conditionalBind$$module$build$src$core$browser_events(document,"mouseup",null,this.handleUp.bind(this));a.preventDefault();a.stopPropagation();}},{key:"handleMove",value:function handleMove(a){this.updateFromEvent_(a);this.workspaceDragger_?this.workspaceDragger_.drag(this.currentDragDeltaXY_):this.blockDragger_?this.blockDragger_.drag(this.mostRecentEvent_,this.currentDragDeltaXY_):this.bubbleDragger_&&this.bubbleDragger_.dragBubble(this.mostRecentEvent_,this.currentDragDeltaXY_);a.preventDefault();a.stopPropagation();}},{key:"handleUp",value:function handleUp(a){this.updateFromEvent_(a);longStop$$module$build$src$core$touch();this.isEnding_?console.log("Trying to end a gesture recursively."):(this.isEnding_=!0,this.bubbleDragger_?this.bubbleDragger_.endBubbleDrag(a,this.currentDragDeltaXY_):this.blockDragger_?this.blockDragger_.endDrag(a,this.currentDragDeltaXY_):this.workspaceDragger_?this.workspaceDragger_.endDrag(this.currentDragDeltaXY_):this.isBubbleClick_()?this.doBubbleClick_():this.isFieldClick_()?this.doFieldClick_():this.isBlockClick_()?this.doBlockClick_():this.isWorkspaceClick_()&&this.doWorkspaceClick_(a),a.preventDefault(),a.stopPropagation(),this.dispose());}},{key:"cancel",value:function cancel(){this.isEnding_||(longStop$$module$build$src$core$touch(),this.bubbleDragger_?this.bubbleDragger_.endBubbleDrag(this.mostRecentEvent_,this.currentDragDeltaXY_):this.blockDragger_?this.blockDragger_.endDrag(this.mostRecentEvent_,this.currentDragDeltaXY_):this.workspaceDragger_&&this.workspaceDragger_.endDrag(this.currentDragDeltaXY_),this.dispose());}},{key:"handleRightClick",value:function handleRightClick(a){this.targetBlock_?(this.bringBlockToFront_(),this.targetBlock_.workspace.hideChaff(!!this.flyout_),this.targetBlock_.showContextMenu(a)):this.startBubble_?this.startBubble_.showContextMenu(a):this.startWorkspace_&&!this.flyout_&&(this.startWorkspace_.hideChaff(),this.startWorkspace_.showContextMenu(a));a.preventDefault();a.stopPropagation();this.dispose();}},{key:"handleWsStart",value:function handleWsStart(a,b){if(this.hasStarted_)throw Error("Tried to call gesture.handleWsStart, but the gesture had already been started.");this.setStartWorkspace_(b);this.mostRecentEvent_=a;this.doStart(a);}},{key:"fireWorkspaceClick_",value:function fireWorkspaceClick_(a){fire$$module$build$src$core$events$utils(new(get$$module$build$src$core$events$utils(CLICK$$module$build$src$core$events$utils))(null,a.id,"workspace"));}},{key:"handleFlyoutStart",value:function handleFlyoutStart(a,b){if(this.hasStarted_)throw Error("Tried to call gesture.handleFlyoutStart, but the gesture had already been started.");this.setStartFlyout_(b);this.handleWsStart(a,b.getWorkspace());}},{key:"handleBlockStart",value:function handleBlockStart(a,b){if(this.hasStarted_)throw Error("Tried to call gesture.handleBlockStart, but the gesture had already been started.");this.setStartBlock(b);this.mostRecentEvent_=a;}},{key:"handleBubbleStart",value:function handleBubbleStart(a,b){if(this.hasStarted_)throw Error("Tried to call gesture.handleBubbleStart, but the gesture had already been started.");this.setStartBubble(b);this.mostRecentEvent_=a;}},{key:"doBubbleClick_",value:function doBubbleClick_(){this.startBubble_ instanceof WorkspaceCommentSvg$$module$build$src$core$workspace_comment_svg&&(this.startBubble_.setFocus(),this.startBubble_.select());}},{key:"doFieldClick_",value:function doFieldClick_(){if(!this.startField_)throw Error("Cannot do a field click because the start field is undefined");this.startField_.showEditor(this.mostRecentEvent_);this.bringBlockToFront_();}},{key:"doBlockClick_",value:function doBlockClick_(){if(this.flyout_&&this.flyout_.autoClose){if(!this.targetBlock_)throw Error("Cannot do a block click because the target block is undefined");this.targetBlock_.isEnabled()&&(getGroup$$module$build$src$core$events$utils()||setGroup$$module$build$src$core$events$utils(!0),this.flyout_.createBlock(this.targetBlock_).scheduleSnapAndBump());}else{if(!this.startWorkspace_)throw Error("Cannot do a block click because the start workspace is undefined");var a=new(get$$module$build$src$core$events$utils(CLICK$$module$build$src$core$events$utils))(this.startBlock_,this.startWorkspace_.id,"block");fire$$module$build$src$core$events$utils(a);}this.bringBlockToFront_();setGroup$$module$build$src$core$events$utils(!1);}},{key:"doWorkspaceClick_",value:function doWorkspaceClick_(a){a=this.creatorWorkspace;getSelected$$module$build$src$core$common()&&getSelected$$module$build$src$core$common().unselect();this.fireWorkspaceClick_(this.startWorkspace_||a);}},{key:"bringBlockToFront_",value:function bringBlockToFront_(){this.targetBlock_&&!this.flyout_&&this.targetBlock_.bringToFront();}},{key:"setStartField",value:function setStartField(a){if(this.hasStarted_)throw Error("Tried to call gesture.setStartField, but the gesture had already been started.");this.startField_||(this.startField_=a);}},{key:"setStartBubble",value:function setStartBubble(a){this.startBubble_||(this.startBubble_=a);}},{key:"setStartBlock",value:function setStartBlock(a){this.startBlock_||this.startBubble_||(this.startBlock_=a,a.isInFlyout&&a!==a.getRootBlock()?this.setTargetBlock_(a.getRootBlock()):this.setTargetBlock_(a));}},{key:"setTargetBlock_",value:function setTargetBlock_(a){a.isShadow()?this.setTargetBlock_(a.getParent()):this.targetBlock_=a;}},{key:"setStartWorkspace_",value:function setStartWorkspace_(a){this.startWorkspace_||(this.startWorkspace_=a);}},{key:"setStartFlyout_",value:function setStartFlyout_(a){this.flyout_||(this.flyout_=a);}},{key:"isBubbleClick_",value:function isBubbleClick_(){return!!this.startBubble_&&!this.hasExceededDragRadius_;}},{key:"isBlockClick_",value:function isBlockClick_(){return!!this.startBlock_&&!this.hasExceededDragRadius_&&!this.isFieldClick_();}},{key:"isFieldClick_",value:function isFieldClick_(){return(this.startField_?this.startField_.isClickable():!1)&&!this.hasExceededDragRadius_&&(!this.flyout_||!this.flyout_.autoClose);}},{key:"isWorkspaceClick_",value:function isWorkspaceClick_(){return!this.startBlock_&&!this.startBubble_&&!this.startField_&&!this.hasExceededDragRadius_;}},{key:"isDragging",value:function isDragging(){return!!this.workspaceDragger_||!!this.blockDragger_||!!this.bubbleDragger_;}},{key:"hasStarted",value:function hasStarted(){return this.hasStarted_;}},{key:"getInsertionMarkers",value:function getInsertionMarkers(){return this.blockDragger_?this.blockDragger_.getInsertionMarkers():[];}},{key:"getCurrentDragger",value:function getCurrentDragger(){var a,b;return null!=(b=null!=(a=this.blockDragger_)?a:this.workspaceDragger_)?b:this.bubbleDragger_;}}],[{key:"inProgress",value:function inProgress(){var a=getAllWorkspaces$$module$build$src$core$common();for(var b=0,c;c=a[b];b++){if(c.currentGesture_)return!0;}return!1;}}]);return Gesture$$module$build$src$core$gesture;}(),module$build$src$core$gesture={};module$build$src$core$gesture.Gesture=Gesture$$module$build$src$core$gesture;var _ShortcutRegistry$$module$build$src$core$shortcut_registry=/*#__PURE__*/function(){function ShortcutRegistry$$module$build$src$core$shortcut_registry(){_classCallCheck(this,ShortcutRegistry$$module$build$src$core$shortcut_registry);this.shortcuts=new Map();this.keyMap=new Map();this.reset();}_createClass(ShortcutRegistry$$module$build$src$core$shortcut_registry,[{key:"reset",value:function reset(){this.shortcuts.clear();this.keyMap.clear();}},{key:"register",value:function register(a,b){if(this.shortcuts.get(a.name)&&!b)throw Error("Shortcut named \"".concat(a.name,"\" already exists."));this.shortcuts.set(a.name,a);if((b=a.keyCodes)&&0<b.length)for(var c=0;c<b.length;c++){this.addKeyMapping(b[c],a.name,!!a.allowCollision);}}},{key:"unregister",value:function unregister(a){if(!this.shortcuts.get(a))return console.warn("Keyboard shortcut named \"".concat(a,"\" not found.")),!1;this.removeAllKeyMappings(a);this.shortcuts["delete"](a);return!0;}},{key:"addKeyMapping",value:function addKeyMapping(a,b,c){a=String(a);var d=this.keyMap.get(a);if(d&&!c)throw Error("Shortcut named \"".concat(b,"\" collides with shortcuts \"").concat(d,"\""));d&&c?d.unshift(b):this.keyMap.set(a,[b]);}},{key:"removeKeyMapping",value:function removeKeyMapping(a,b,c){var d=this.keyMap.get(a);if(!d)return c||console.warn("No keyboard shortcut named \"".concat(b,"\" registered with key code \"").concat(a,"\"")),!1;var e=d.indexOf(b);if(-1<e)return d.splice(e,1),0===d.length&&this.keyMap["delete"](a),!0;c||console.warn("No keyboard shortcut named \"".concat(b,"\" registered with key code \"").concat(a,"\""));return!1;}},{key:"removeAllKeyMappings",value:function removeAllKeyMappings(a){var _iterator13=_createForOfIteratorHelper(this.keyMap.keys()),_step13;try{for(_iterator13.s();!(_step13=_iterator13.n()).done;){var b=_step13.value;this.removeKeyMapping(b,a,!0);}}catch(err){_iterator13.e(err);}finally{_iterator13.f();}}},{key:"setKeyMap",value:function setKeyMap(a){this.keyMap.clear();for(var b in a){this.keyMap.set(b,a[b]);}}},{key:"getKeyMap",value:function getKeyMap(){var a=Object.create(null);var _iterator14=_createForOfIteratorHelper(this.keyMap),_step14;try{for(_iterator14.s();!(_step14=_iterator14.n()).done;){var _step14$value=_slicedToArray(_step14.value,2),b=_step14$value[0],c=_step14$value[1];a[b]=c;}}catch(err){_iterator14.e(err);}finally{_iterator14.f();}return a;}},{key:"getRegistry",value:function getRegistry(){var a=Object.create(null);var _iterator15=_createForOfIteratorHelper(this.shortcuts),_step15;try{for(_iterator15.s();!(_step15=_iterator15.n()).done;){var _step15$value=_slicedToArray(_step15.value,2),b=_step15$value[0],c=_step15$value[1];a[b]=c;}}catch(err){_iterator15.e(err);}finally{_iterator15.f();}return deepMerge$$module$build$src$core$utils$object(Object.create(null),a);}},{key:"onKeyDown",value:function onKeyDown(a,b){var c=this.serializeKeyEvent_(b);c=this.getShortcutNamesByKeyCode(c);if(!c)return!1;for(var d=0,e;e=c[d];d++){var f=this.shortcuts.get(e);var g=void 0,h=void 0;if(null==(g=f)||!g.preconditionFn||(null==(h=f)?0:h.preconditionFn(a))){var k=void 0,l=void 0;if((null==(k=f)?0:k.callback)&&(null==(l=f)?0:l.callback(a,b,f)))return!0;}}return!1;}},{key:"getShortcutNamesByKeyCode",value:function getShortcutNamesByKeyCode(a){return this.keyMap.get(a)||[];}},{key:"getKeyCodesByShortcutName",value:function getKeyCodesByShortcutName(a){var b=[];var _iterator16=_createForOfIteratorHelper(this.keyMap),_step16;try{for(_iterator16.s();!(_step16=_iterator16.n()).done;){var _step16$value=_slicedToArray(_step16.value,2),c=_step16$value[0],d=_step16$value[1];-1<d.indexOf(a)&&b.push(c);}}catch(err){_iterator16.e(err);}finally{_iterator16.f();}return b;}},{key:"serializeKeyEvent_",value:function serializeKeyEvent_(a){var b="";for(var c in _ShortcutRegistry$$module$build$src$core$shortcut_registry.modifierKeys){a.getModifierState(c)&&(""!==b&&(b+="+"),b+=c);}""!==b&&a.keyCode?b=b+"+"+a.keyCode:a.keyCode&&(b=a.keyCode.toString());return b;}},{key:"checkModifiers_",value:function checkModifiers_(a){for(var b=0,c;c=a[b];b++){if(!(c in _ShortcutRegistry$$module$build$src$core$shortcut_registry.modifierKeys))throw Error(c+" is not a valid modifier key.");}}},{key:"createSerializedKey",value:function createSerializedKey(a,b){var c="";if(b){this.checkModifiers_(b);for(var d in _ShortcutRegistry$$module$build$src$core$shortcut_registry.modifierKeys){-1<b.indexOf(_ShortcutRegistry$$module$build$src$core$shortcut_registry.modifierKeys[d])&&(""!==c&&(c+="+"),c+=d);}}""!==c&&a?c=c+"+"+a:a&&(c=a.toString());return c;}}]);return ShortcutRegistry$$module$build$src$core$shortcut_registry;}();_ShortcutRegistry$$module$build$src$core$shortcut_registry.registry=new _ShortcutRegistry$$module$build$src$core$shortcut_registry();(function(a){a=a.modifierKeys||(a.modifierKeys={});a[a.Shift=16]="Shift";a[a.Control=17]="Control";a[a.Alt=18]="Alt";a[a.Meta=91]="Meta";})(_ShortcutRegistry$$module$build$src$core$shortcut_registry||(_ShortcutRegistry$$module$build$src$core$shortcut_registry={}));var module$build$src$core$shortcut_registry={};module$build$src$core$shortcut_registry.ShortcutRegistry=_ShortcutRegistry$$module$build$src$core$shortcut_registry;var names$$module$build$src$core$shortcut_items;(function(a){a.ESCAPE="escape";a.DELETE="delete";a.COPY="copy";a.CUT="cut";a.PASTE="paste";a.UNDO="undo";a.REDO="redo";})(names$$module$build$src$core$shortcut_items||(names$$module$build$src$core$shortcut_items={}));registerDefaultShortcuts$$module$build$src$core$shortcut_items();var module$build$src$core$shortcut_items={};module$build$src$core$shortcut_items.names=names$$module$build$src$core$shortcut_items;module$build$src$core$shortcut_items.registerCopy=registerCopy$$module$build$src$core$shortcut_items;module$build$src$core$shortcut_items.registerCut=registerCut$$module$build$src$core$shortcut_items;module$build$src$core$shortcut_items.registerDefaultShortcuts=registerDefaultShortcuts$$module$build$src$core$shortcut_items;module$build$src$core$shortcut_items.registerDelete=registerDelete$$module$build$src$core$shortcut_items;module$build$src$core$shortcut_items.registerEscape=registerEscape$$module$build$src$core$shortcut_items;module$build$src$core$shortcut_items.registerPaste=registerPaste$$module$build$src$core$shortcut_items;module$build$src$core$shortcut_items.registerRedo=registerRedo$$module$build$src$core$shortcut_items;module$build$src$core$shortcut_items.registerUndo=registerUndo$$module$build$src$core$shortcut_items;var ThemeChange$$module$build$src$core$events$events_theme_change=/*#__PURE__*/function(_UiBase$$module$build6){_inherits(ThemeChange$$module$build$src$core$events$events_theme_change,_UiBase$$module$build6);var _super36=_createSuper(ThemeChange$$module$build$src$core$events$events_theme_change);function ThemeChange$$module$build$src$core$events$events_theme_change(a,b){var _this40;_classCallCheck(this,ThemeChange$$module$build$src$core$events$events_theme_change);_this40=_super36.call(this,b);_this40.type=THEME_CHANGE$$module$build$src$core$events$utils;_this40.themeName=a;return _this40;}_createClass(ThemeChange$$module$build$src$core$events$events_theme_change,[{key:"toJson",value:function toJson(){var a=_get(_getPrototypeOf(ThemeChange$$module$build$src$core$events$events_theme_change.prototype),"toJson",this).call(this);if(!this.themeName)throw Error("The theme name is undefined. Either pass a theme name to the constructor, or call fromJson");a.themeName=this.themeName;return a;}},{key:"fromJson",value:function fromJson(a){_get(_getPrototypeOf(ThemeChange$$module$build$src$core$events$events_theme_change.prototype),"fromJson",this).call(this,a);this.themeName=a.themeName;}}]);return ThemeChange$$module$build$src$core$events$events_theme_change;}(UiBase$$module$build$src$core$events$events_ui_base);register$$module$build$src$core$registry(Type$$module$build$src$core$registry.EVENT,THEME_CHANGE$$module$build$src$core$events$utils,ThemeChange$$module$build$src$core$events$events_theme_change);var module$build$src$core$events$events_theme_change={};module$build$src$core$events$events_theme_change.ThemeChange=ThemeChange$$module$build$src$core$events$events_theme_change;var ViewportChange$$module$build$src$core$events$events_viewport=/*#__PURE__*/function(_UiBase$$module$build7){_inherits(ViewportChange$$module$build$src$core$events$events_viewport,_UiBase$$module$build7);var _super37=_createSuper(ViewportChange$$module$build$src$core$events$events_viewport);function ViewportChange$$module$build$src$core$events$events_viewport(a,b,c,d,e){var _this41;_classCallCheck(this,ViewportChange$$module$build$src$core$events$events_viewport);_this41=_super37.call(this,d);_this41.type=VIEWPORT_CHANGE$$module$build$src$core$events$utils;_this41.viewTop=a;_this41.viewLeft=b;_this41.scale=c;_this41.oldScale=e;return _this41;}_createClass(ViewportChange$$module$build$src$core$events$events_viewport,[{key:"toJson",value:function toJson(){var a=_get(_getPrototypeOf(ViewportChange$$module$build$src$core$events$events_viewport.prototype),"toJson",this).call(this);if(void 0===this.viewTop)throw Error("The view top is undefined. Either pass a value to the constructor, or call fromJson");if(void 0===this.viewLeft)throw Error("The view left is undefined. Either pass a value to the constructor, or call fromJson");if(void 0===this.scale)throw Error("The scale is undefined. Either pass a value to the constructor, or call fromJson");if(void 0===this.oldScale)throw Error("The old scale is undefined. Either pass a value to the constructor, or call fromJson");a.viewTop=this.viewTop;a.viewLeft=this.viewLeft;a.scale=this.scale;a.oldScale=this.oldScale;return a;}},{key:"fromJson",value:function fromJson(a){_get(_getPrototypeOf(ViewportChange$$module$build$src$core$events$events_viewport.prototype),"fromJson",this).call(this,a);this.viewTop=a.viewTop;this.viewLeft=a.viewLeft;this.scale=a.scale;this.oldScale=a.oldScale;}}]);return ViewportChange$$module$build$src$core$events$events_viewport;}(UiBase$$module$build$src$core$events$events_ui_base);register$$module$build$src$core$registry(Type$$module$build$src$core$registry.EVENT,VIEWPORT_CHANGE$$module$build$src$core$events$utils,ViewportChange$$module$build$src$core$events$events_viewport);var module$build$src$core$events$events_viewport={};module$build$src$core$events$events_viewport.ViewportChange=ViewportChange$$module$build$src$core$events$events_viewport;var ConnectionDB$$module$build$src$core$connection_db=/*#__PURE__*/function(){function ConnectionDB$$module$build$src$core$connection_db(a){_classCallCheck(this,ConnectionDB$$module$build$src$core$connection_db);this.connectionChecker=a;this.connections_=[];}_createClass(ConnectionDB$$module$build$src$core$connection_db,[{key:"addConnection",value:function addConnection(a,b){b=this.calculateIndexForYPos_(b);this.connections_.splice(b,0,a);}},{key:"findIndexOfConnection_",value:function findIndexOfConnection_(a,b){if(!this.connections_.length)return-1;var c=this.calculateIndexForYPos_(b);if(c>=this.connections_.length)return-1;b=a.y;var d=c;for(;0<=d&&this.connections_[d].y===b;){if(this.connections_[d]===a)return d;d--;}for(d=c;d<this.connections_.length&&this.connections_[d].y===b;){if(this.connections_[d]===a)return d;d++;}return-1;}},{key:"calculateIndexForYPos_",value:function calculateIndexForYPos_(a){if(!this.connections_.length)return 0;var b=0,c=this.connections_.length;for(;b<c;){var d=Math.floor((b+c)/2);if(this.connections_[d].y<a)b=d+1;else if(this.connections_[d].y>a)c=d;else{b=d;break;}}return b;}},{key:"removeConnection",value:function removeConnection(a,b){a=this.findIndexOfConnection_(a,b);if(-1===a)throw Error("Unable to find connection in connectionDB.");this.connections_.splice(a,1);}},{key:"getNeighbours",value:function getNeighbours(a,b){function c(l){var m=e-d[l].x,n=f-d[l].y;Math.sqrt(m*m+n*n)<=b&&k.push(d[l]);return n<b;}var d=this.connections_,e=a.x,f=a.y;a=0;var g=d.length-2,h=g;for(;a<h;){d[h].y<f?a=h:g=h,h=Math.floor((a+g)/2);}var k=[];g=a=h;if(d.length){for(;0<=a&&c(a);){a--;}do{g++;}while(g<d.length&&c(g));}return k;}},{key:"isInYRange_",value:function isInYRange_(a,b,c){return Math.abs(this.connections_[a].y-b)<=c;}},{key:"searchForClosest",value:function searchForClosest(a,b,c){if(!this.connections_.length)return{connection:null,radius:b};var d=a.y,e=a.x;a.x=e+c.x;a.y=d+c.y;var f=this.calculateIndexForYPos_(a.y);c=null;var g=b,h,k=f-1;for(;0<=k&&this.isInYRange_(k,a.y,b);){h=this.connections_[k],this.connectionChecker.canConnect(a,h,!0,g)&&(c=h,g=h.distanceFrom(a)),k--;}for(;f<this.connections_.length&&this.isInYRange_(f,a.y,b);){h=this.connections_[f],this.connectionChecker.canConnect(a,h,!0,g)&&(c=h,g=h.distanceFrom(a)),f++;}a.x=e;a.y=d;return{connection:c,radius:g};}}],[{key:"init",value:function init(a){var b=[];b[ConnectionType$$module$build$src$core$connection_type.INPUT_VALUE]=new ConnectionDB$$module$build$src$core$connection_db(a);b[ConnectionType$$module$build$src$core$connection_type.OUTPUT_VALUE]=new ConnectionDB$$module$build$src$core$connection_db(a);b[ConnectionType$$module$build$src$core$connection_type.NEXT_STATEMENT]=new ConnectionDB$$module$build$src$core$connection_db(a);b[ConnectionType$$module$build$src$core$connection_type.PREVIOUS_STATEMENT]=new ConnectionDB$$module$build$src$core$connection_db(a);return b;}}]);return ConnectionDB$$module$build$src$core$connection_db;}(),module$build$src$core$connection_db={};module$build$src$core$connection_db.ConnectionDB=ConnectionDB$$module$build$src$core$connection_db;var Grid$$module$build$src$core$grid=/*#__PURE__*/function(){function Grid$$module$build$src$core$grid(a,b){_classCallCheck(this,Grid$$module$build$src$core$grid);this.pattern=a;var c;this.spacing=null!=(c=b.spacing)?c:0;var d;this.length=null!=(d=b.length)?d:1;this.line2=(this.line1=a.firstChild)&&this.line1.nextSibling;var e;this.snapToGrid=null!=(e=b.snap)?e:!1;}_createClass(Grid$$module$build$src$core$grid,[{key:"shouldSnap",value:function shouldSnap(){return this.snapToGrid;}},{key:"getSpacing",value:function getSpacing(){return this.spacing;}},{key:"getPatternId",value:function getPatternId(){return this.pattern.id;}},{key:"update",value:function update(a){var b=this.spacing*a||100;this.pattern.setAttribute("width",b.toString());this.pattern.setAttribute("height",b.toString());b=Math.floor(this.spacing/2)+.5;var c=b-this.length/2,d=b+this.length/2;b*=a;c*=a;d*=a;this.setLineAttributes(this.line1,a,c,d,b,b);this.setLineAttributes(this.line2,a,b,b,c,d);}},{key:"setLineAttributes",value:function setLineAttributes(a,b,c,d,e,f){a&&(a.setAttribute("stroke-width",b.toString()),a.setAttribute("x1",c.toString()),a.setAttribute("y1",e.toString()),a.setAttribute("x2",d.toString()),a.setAttribute("y2",f.toString()));}},{key:"moveTo",value:function moveTo(a,b){this.pattern.setAttribute("x",a.toString());this.pattern.setAttribute("y",b.toString());}}],[{key:"createDom",value:function createDom(a,b,c){a=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.PATTERN,{id:"blocklyGridPattern"+a,patternUnits:"userSpaceOnUse"},c);var d,e;if(0<(null!=(d=b.length)?d:1)&&0<(null!=(e=b.spacing)?e:0)){createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.LINE,{stroke:b.colour},a);var f;null!=(f=b.length)&&f&&createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.LINE,{stroke:b.colour},a);}else createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.LINE,{},a);return a;}}]);return Grid$$module$build$src$core$grid;}(),module$build$src$core$grid={};module$build$src$core$grid.Grid=Grid$$module$build$src$core$grid;var Names$$module$build$src$core$names=/*#__PURE__*/function(){function Names$$module$build$src$core$names(a,b){_classCallCheck(this,Names$$module$build$src$core$names);this.db=new Map();this.dbReverse=new Set();this.variableMap_=null;this.variablePrefix_=b||"";this.reservedWords=new Set(a?a.split(","):[]);}_createClass(Names$$module$build$src$core$names,[{key:"reset",value:function reset(){this.db.clear();this.dbReverse.clear();this.variableMap_=null;}},{key:"setVariableMap",value:function setVariableMap(a){this.variableMap_=a;}},{key:"getNameForUserVariable_",value:function getNameForUserVariable_(a){return this.variableMap_?(a=this.variableMap_.getVariableById(a))?a.name:null:(console.warn("Deprecated call to Names.prototype.getName without defining a variable map. To fix, add the following code in your generator's init() function:\nBlockly.YourGeneratorName.nameDB_.setVariableMap(workspace.getVariableMap());"),null);}},{key:"populateVariables",value:function populateVariables(a){a=allUsedVarModels$$module$build$src$core$variables(a);for(var b=0;b<a.length;b++){this.getName(a[b].getId(),$.NameType$$module$build$src$core$names.VARIABLE);}}},{key:"populateProcedures",value:function populateProcedures(a){throw Error("The implementation of populateProcedures should be monkey-patched in by blockly.ts");}},{key:"getName",value:function getName(a,b){var c=a;b===$.NameType$$module$build$src$core$names.VARIABLE&&(a=this.getNameForUserVariable_(a))&&(c=a);a=c.toLowerCase();var d=b===$.NameType$$module$build$src$core$names.VARIABLE||b===$.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE?this.variablePrefix_:"";this.db.has(b)||this.db.set(b,new Map());var e=this.db.get(b);if(e.has(a))return d+e.get(a);b=this.getDistinctName(c,b);e.set(a,b.substr(d.length));return b;}},{key:"getUserNames",value:function getUserNames(a){var b;return(a=null==(b=this.db.get(a))?void 0:b.keys())?Array.from(a):[];}},{key:"getDistinctName",value:function getDistinctName(a,b){a=this.safeName_(a);var c="";for(;this.dbReverse.has(a+c)||this.reservedWords.has(a+c);){c=c?c+1:2;}a+=c;this.dbReverse.add(a);return(b===$.NameType$$module$build$src$core$names.VARIABLE||b===$.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE?this.variablePrefix_:"")+a;}},{key:"safeName_",value:function safeName_(a){a?(a=encodeURI(a.replace(/ /g,"_")).replace(/[^\w]/g,"_"),-1!=="0123456789".indexOf(a[0])&&(a="my_"+a)):a=Msg$$module$build$src$core$msg.UNNAMED_KEY||"unnamed";return a;}}],[{key:"equals",value:function equals(a,b){return a.toLowerCase()===b.toLowerCase();}}]);return Names$$module$build$src$core$names;}();(function(a){a=a.NameType||(a.NameType={});a.DEVELOPER_VARIABLE="DEVELOPER_VARIABLE";a.VARIABLE="VARIABLE";a.PROCEDURE="PROCEDURE";})(Names$$module$build$src$core$names||(Names$$module$build$src$core$names={}));$.NameType$$module$build$src$core$names=Names$$module$build$src$core$names.NameType;Names$$module$build$src$core$names.DEVELOPER_VARIABLE_TYPE=$.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE;$.module$build$src$core$names={};$.module$build$src$core$names.NameType=$.NameType$$module$build$src$core$names;$.module$build$src$core$names.Names=Names$$module$build$src$core$names;var module$build$src$core$interfaces$i_procedure_block={};module$build$src$core$interfaces$i_procedure_block.isProcedureBlock=isProcedureBlock$$module$build$src$core$interfaces$i_procedure_block;var module$build$src$core$procedures$update_procedures={};module$build$src$core$procedures$update_procedures.triggerProceduresUpdate=triggerProceduresUpdate$$module$build$src$core$procedures$update_procedures;var ObservableProcedureMap$$module$build$src$core$procedures$observable_procedure_map=/*#__PURE__*/function(_Map){_inherits(ObservableProcedureMap$$module$build$src$core$procedures$observable_procedure_map,_Map);var _super38=_createSuper(ObservableProcedureMap$$module$build$src$core$procedures$observable_procedure_map);function ObservableProcedureMap$$module$build$src$core$procedures$observable_procedure_map(a){var _this42;_classCallCheck(this,ObservableProcedureMap$$module$build$src$core$procedures$observable_procedure_map);_this42=_super38.call(this);_this42.workspace=a;return _this42;}_createClass(ObservableProcedureMap$$module$build$src$core$procedures$observable_procedure_map,[{key:"set",value:function set(a,b){_get(_getPrototypeOf(ObservableProcedureMap$$module$build$src$core$procedures$observable_procedure_map.prototype),"set",this).call(this,a,b);return this;}},{key:"delete",value:function _delete(a){a=_get(_getPrototypeOf(ObservableProcedureMap$$module$build$src$core$procedures$observable_procedure_map.prototype),"delete",this).call(this,a);triggerProceduresUpdate$$module$build$src$core$procedures$update_procedures(this.workspace);return a;}},{key:"clear",value:function clear(){_get(_getPrototypeOf(ObservableProcedureMap$$module$build$src$core$procedures$observable_procedure_map.prototype),"clear",this).call(this);triggerProceduresUpdate$$module$build$src$core$procedures$update_procedures(this.workspace);}},{key:"add",value:function add(a){return this.set(a.getId(),a);}},{key:"getProcedures",value:function getProcedures(){return _toConsumableArray(this.values());}}]);return ObservableProcedureMap$$module$build$src$core$procedures$observable_procedure_map;}(/*#__PURE__*/_wrapNativeSuper(Map)),module$build$src$core$procedures$observable_procedure_map={};module$build$src$core$procedures$observable_procedure_map.ObservableProcedureMap=ObservableProcedureMap$$module$build$src$core$procedures$observable_procedure_map;var ObservableProcedureModel$$module$build$src$core$procedures$observable_procedure_model=/*#__PURE__*/function(){function ObservableProcedureModel$$module$build$src$core$procedures$observable_procedure_model(a,b,c){_classCallCheck(this,ObservableProcedureModel$$module$build$src$core$procedures$observable_procedure_model);this.workspace=a;this.parameters=[];this.returnTypes=null;this.enabled=!0;this.id=null!=c?c:genUid$$module$build$src$core$utils$idgenerator();this.name=b;}_createClass(ObservableProcedureModel$$module$build$src$core$procedures$observable_procedure_model,[{key:"setName",value:function setName(a){this.name=a;triggerProceduresUpdate$$module$build$src$core$procedures$update_procedures(this.workspace);return this;}},{key:"insertParameter",value:function insertParameter(a,b){this.parameters.splice(b,0,a);triggerProceduresUpdate$$module$build$src$core$procedures$update_procedures(this.workspace);return this;}},{key:"deleteParameter",value:function deleteParameter(a){this.parameters.splice(a,1);triggerProceduresUpdate$$module$build$src$core$procedures$update_procedures(this.workspace);return this;}},{key:"setReturnTypes",value:function setReturnTypes(a){if(a&&a.length)throw Error("The built-in ProcedureModel does not support typing. You need to implement your own custom ProcedureModel.");this.returnTypes=a;triggerProceduresUpdate$$module$build$src$core$procedures$update_procedures(this.workspace);return this;}},{key:"setEnabled",value:function setEnabled(a){this.enabled=a;triggerProceduresUpdate$$module$build$src$core$procedures$update_procedures(this.workspace);return this;}},{key:"getId",value:function getId(){return this.id;}},{key:"getName",value:function getName(){return this.name;}},{key:"getParameter",value:function getParameter(a){return this.parameters[a];}},{key:"getParameters",value:function getParameters(){return _toConsumableArray(this.parameters);}},{key:"getReturnTypes",value:function getReturnTypes(){return this.returnTypes;}},{key:"getEnabled",value:function getEnabled(){return this.enabled;}}]);return ObservableProcedureModel$$module$build$src$core$procedures$observable_procedure_model;}(),module$build$src$core$procedures$observable_procedure_model={};module$build$src$core$procedures$observable_procedure_model.ObservableProcedureModel=ObservableProcedureModel$$module$build$src$core$procedures$observable_procedure_model;var ObservableParameterModel$$module$build$src$core$procedures$observable_parameter_model=/*#__PURE__*/function(){function ObservableParameterModel$$module$build$src$core$procedures$observable_parameter_model(a,b,c){_classCallCheck(this,ObservableParameterModel$$module$build$src$core$procedures$observable_parameter_model);this.workspace=a;this.id=null!=c?c:genUid$$module$build$src$core$utils$idgenerator();var d;this.variable=null!=(d=this.workspace.getVariable(b))?d:a.createVariable(b);}_createClass(ObservableParameterModel$$module$build$src$core$procedures$observable_parameter_model,[{key:"setName",value:function setName(a){if(a==this.variable.name)return this;var b;this.variable=null!=(b=this.workspace.getVariable(a))?b:this.workspace.createVariable(a);triggerProceduresUpdate$$module$build$src$core$procedures$update_procedures(this.workspace);return this;}},{key:"setTypes",value:function setTypes(a){throw Error("The built-in ParameterModel does not support typing. You need to implement your own custom ParameterModel.");}},{key:"getName",value:function getName(){return this.variable.name;}},{key:"getTypes",value:function getTypes(){return[];}},{key:"getId",value:function getId(){return this.id;}},{key:"getVariableModel",value:function getVariableModel(){return this.variable;}}]);return ObservableParameterModel$$module$build$src$core$procedures$observable_parameter_model;}(),module$build$src$core$procedures$observable_parameter_model={};module$build$src$core$procedures$observable_parameter_model.ObservableParameterModel=ObservableParameterModel$$module$build$src$core$procedures$observable_parameter_model;var CATEGORY_NAME$$module$build$src$core$procedures,DEFAULT_ARG$$module$build$src$core$procedures;CATEGORY_NAME$$module$build$src$core$procedures="PROCEDURE";DEFAULT_ARG$$module$build$src$core$procedures="x";$.module$build$src$core$procedures={};$.module$build$src$core$procedures.CATEGORY_NAME=CATEGORY_NAME$$module$build$src$core$procedures;$.module$build$src$core$procedures.DEFAULT_ARG=DEFAULT_ARG$$module$build$src$core$procedures;$.module$build$src$core$procedures.ObservableParameterModel=ObservableParameterModel$$module$build$src$core$procedures$observable_parameter_model;$.module$build$src$core$procedures.ObservableProcedureMap=ObservableProcedureMap$$module$build$src$core$procedures$observable_procedure_map;$.module$build$src$core$procedures.ObservableProcedureModel=ObservableProcedureModel$$module$build$src$core$procedures$observable_procedure_model;$.module$build$src$core$procedures.allProcedures=allProcedures$$module$build$src$core$procedures;$.module$build$src$core$procedures.findLegalName=findLegalName$$module$build$src$core$procedures;$.module$build$src$core$procedures.flyoutCategory=flyoutCategory$$module$build$src$core$procedures;$.module$build$src$core$procedures.getCallers=getCallers$$module$build$src$core$procedures;$.module$build$src$core$procedures.getDefinition=getDefinition$$module$build$src$core$procedures;$.module$build$src$core$procedures.isNameUsed=isNameUsed$$module$build$src$core$procedures;$.module$build$src$core$procedures.mutateCallers=mutateCallers$$module$build$src$core$procedures;$.module$build$src$core$procedures.mutatorOpenListener=mutatorOpenListener$$module$build$src$core$procedures;$.module$build$src$core$procedures.rename=rename$$module$build$src$core$procedures;var TypesContainer$$module$build$src$core$renderers$measurables$types=/*#__PURE__*/function(){function TypesContainer$$module$build$src$core$renderers$measurables$types(){_classCallCheck(this,TypesContainer$$module$build$src$core$renderers$measurables$types);this.NONE=0;this.FIELD=1;this.HAT=2;this.ICON=4;this.SPACER=8;this.BETWEEN_ROW_SPACER=16;this.IN_ROW_SPACER=32;this.EXTERNAL_VALUE_INPUT=64;this.INPUT=128;this.INLINE_INPUT=256;this.STATEMENT_INPUT=512;this.CONNECTION=1024;this.PREVIOUS_CONNECTION=2048;this.NEXT_CONNECTION=4096;this.OUTPUT_CONNECTION=8192;this.CORNER=16384;this.LEFT_SQUARE_CORNER=32768;this.LEFT_ROUND_CORNER=65536;this.RIGHT_SQUARE_CORNER=131072;this.RIGHT_ROUND_CORNER=262144;this.JAGGED_EDGE=524288;this.ROW=1048576;this.TOP_ROW=2097152;this.BOTTOM_ROW=4194304;this.INPUT_ROW=8388608;this.LEFT_CORNER=this.LEFT_SQUARE_CORNER|this.LEFT_ROUND_CORNER;this.RIGHT_CORNER=this.RIGHT_SQUARE_CORNER|this.RIGHT_ROUND_CORNER;this.nextTypeValue_=16777216;}_createClass(TypesContainer$$module$build$src$core$renderers$measurables$types,[{key:"getType",value:function getType(a){Object.prototype.hasOwnProperty.call(this,a)||(this[a]=this.nextTypeValue_,this.nextTypeValue_<<=1);return this[a];}},{key:"isField",value:function isField(a){return a.type&this.FIELD;}},{key:"isHat",value:function isHat(a){return a.type&this.HAT;}},{key:"isIcon",value:function isIcon(a){return a.type&this.ICON;}},{key:"isSpacer",value:function isSpacer(a){return a.type&this.SPACER;}},{key:"isInRowSpacer",value:function isInRowSpacer(a){return a.type&this.IN_ROW_SPACER;}},{key:"isInput",value:function isInput(a){return a.type&this.INPUT;}},{key:"isExternalInput",value:function isExternalInput(a){return a.type&this.EXTERNAL_VALUE_INPUT;}},{key:"isInlineInput",value:function isInlineInput(a){return a.type&this.INLINE_INPUT;}},{key:"isStatementInput",value:function isStatementInput(a){return a.type&this.STATEMENT_INPUT;}},{key:"isPreviousConnection",value:function isPreviousConnection(a){return a.type&this.PREVIOUS_CONNECTION;}},{key:"isNextConnection",value:function isNextConnection(a){return a.type&this.NEXT_CONNECTION;}},{key:"isPreviousOrNextConnection",value:function isPreviousOrNextConnection(a){return a.type&(this.PREVIOUS_CONNECTION|this.NEXT_CONNECTION);}},{key:"isLeftRoundedCorner",value:function isLeftRoundedCorner(a){return a.type&this.LEFT_ROUND_CORNER;}},{key:"isRightRoundedCorner",value:function isRightRoundedCorner(a){return a.type&this.RIGHT_ROUND_CORNER;}},{key:"isLeftSquareCorner",value:function isLeftSquareCorner(a){return a.type&this.LEFT_SQUARE_CORNER;}},{key:"isRightSquareCorner",value:function isRightSquareCorner(a){return a.type&this.RIGHT_SQUARE_CORNER;}},{key:"isCorner",value:function isCorner(a){return a.type&this.CORNER;}},{key:"isJaggedEdge",value:function isJaggedEdge(a){return a.type&this.JAGGED_EDGE;}},{key:"isRow",value:function isRow(a){return a.type&this.ROW;}},{key:"isBetweenRowSpacer",value:function isBetweenRowSpacer(a){return a.type&this.BETWEEN_ROW_SPACER;}},{key:"isTopRow",value:function isTopRow(a){return a.type&this.TOP_ROW;}},{key:"isBottomRow",value:function isBottomRow(a){return a.type&this.BOTTOM_ROW;}},{key:"isTopOrBottomRow",value:function isTopOrBottomRow(a){return a.type&(this.TOP_ROW|this.BOTTOM_ROW);}},{key:"isInputRow",value:function isInputRow(a){return a.type&this.INPUT_ROW;}}]);return TypesContainer$$module$build$src$core$renderers$measurables$types;}(),Types$$module$build$src$core$renderers$measurables$types=new TypesContainer$$module$build$src$core$renderers$measurables$types(),module$build$src$core$renderers$measurables$types={};module$build$src$core$renderers$measurables$types.Types=Types$$module$build$src$core$renderers$measurables$types;var Measurable$$module$build$src$core$renderers$measurables$base=/*#__PURE__*/_createClass(function Measurable$$module$build$src$core$renderers$measurables$base(a){_classCallCheck(this,Measurable$$module$build$src$core$renderers$measurables$base);this.centerline=this.xPos=this.height=this.width=0;this.constants_=a;this.type=Types$$module$build$src$core$renderers$measurables$types.NONE;this.notchOffset=this.constants_.NOTCH_OFFSET_LEFT;}),module$build$src$core$renderers$measurables$base={};module$build$src$core$renderers$measurables$base.Measurable=Measurable$$module$build$src$core$renderers$measurables$base;var Row$$module$build$src$core$renderers$measurables$row=/*#__PURE__*/function(){function Row$$module$build$src$core$renderers$measurables$row(a){_classCallCheck(this,Row$$module$build$src$core$renderers$measurables$row);this.elements=[];this.xPos=this.yPos=this.widthWithConnectedBlocks=this.minWidth=this.minHeight=this.width=this.height=0;this.hasStatement=this.hasExternalInput=!1;this.statementEdge=0;this.hasJaggedEdge=this.hasDummyInput=this.hasInlineInput=!1;this.align=null;this.constants_=a;this.type=Types$$module$build$src$core$renderers$measurables$types.ROW;this.notchOffset=this.constants_.NOTCH_OFFSET_LEFT;}_createClass(Row$$module$build$src$core$renderers$measurables$row,[{key:"getLastInput",value:function getLastInput(){for(var a=this.elements.length-1;0<=a;a--){var b=this.elements[a];if(Types$$module$build$src$core$renderers$measurables$types.isInput(b))return b;}return null;}},{key:"measure",value:function measure(){throw Error("Unexpected attempt to measure a base Row.");}},{key:"startsWithElemSpacer",value:function startsWithElemSpacer(){return!0;}},{key:"endsWithElemSpacer",value:function endsWithElemSpacer(){return!0;}},{key:"getFirstSpacer",value:function getFirstSpacer(){for(var a=0;a<this.elements.length;a++){var b=this.elements[a];if(Types$$module$build$src$core$renderers$measurables$types.isSpacer(b))return b;}return null;}},{key:"getLastSpacer",value:function getLastSpacer(){for(var a=this.elements.length-1;0<=a;a--){var b=this.elements[a];if(Types$$module$build$src$core$renderers$measurables$types.isSpacer(b))return b;}return null;}}]);return Row$$module$build$src$core$renderers$measurables$row;}(),module$build$src$core$renderers$measurables$row={};module$build$src$core$renderers$measurables$row.Row=Row$$module$build$src$core$renderers$measurables$row;var BottomRow$$module$build$src$core$renderers$measurables$bottom_row=/*#__PURE__*/function(_Row$$module$build$sr){_inherits(BottomRow$$module$build$src$core$renderers$measurables$bottom_row,_Row$$module$build$sr);var _super39=_createSuper(BottomRow$$module$build$src$core$renderers$measurables$bottom_row);function BottomRow$$module$build$src$core$renderers$measurables$bottom_row(a){var _this43;_classCallCheck(this,BottomRow$$module$build$src$core$renderers$measurables$bottom_row);_this43=_super39.call(this,a);_this43.hasNextConnection=!1;_this43.connection=null;_this43.baseline=_this43.descenderHeight=0;_this43.type|=Types$$module$build$src$core$renderers$measurables$types.BOTTOM_ROW;return _this43;}_createClass(BottomRow$$module$build$src$core$renderers$measurables$bottom_row,[{key:"hasLeftSquareCorner",value:function hasLeftSquareCorner(a){return!!a.outputConnection||!!a.getNextBlock();}},{key:"hasRightSquareCorner",value:function hasRightSquareCorner(a){return!0;}},{key:"measure",value:function measure(){var a=0,b=0,c=0;for(var d=0;d<this.elements.length;d++){var e=this.elements[d];b+=e.width;Types$$module$build$src$core$renderers$measurables$types.isSpacer(e)||(Types$$module$build$src$core$renderers$measurables$types.isNextConnection(e)?c=Math.max(c,e.height):a=Math.max(a,e.height));}this.width=Math.max(this.minWidth,b);this.height=Math.max(this.minHeight,a)+c;this.descenderHeight=c;this.widthWithConnectedBlocks=this.width;}},{key:"startsWithElemSpacer",value:function startsWithElemSpacer(){return!1;}},{key:"endsWithElemSpacer",value:function endsWithElemSpacer(){return!1;}}]);return BottomRow$$module$build$src$core$renderers$measurables$bottom_row;}(Row$$module$build$src$core$renderers$measurables$row),module$build$src$core$renderers$measurables$bottom_row={};module$build$src$core$renderers$measurables$bottom_row.BottomRow=BottomRow$$module$build$src$core$renderers$measurables$bottom_row;var Connection$$module$build$src$core$renderers$measurables$connection=/*#__PURE__*/function(_Measurable$$module$b){_inherits(Connection$$module$build$src$core$renderers$measurables$connection,_Measurable$$module$b);var _super40=_createSuper(Connection$$module$build$src$core$renderers$measurables$connection);function Connection$$module$build$src$core$renderers$measurables$connection(a,b){var _this44;_classCallCheck(this,Connection$$module$build$src$core$renderers$measurables$connection);_this44=_super40.call(this,a);_this44.connectionModel=b;_this44.shape=_this44.constants_.shapeFor(b);_this44.isDynamicShape="isDynamic"in _this44.shape&&_this44.shape.isDynamic;_this44.type|=Types$$module$build$src$core$renderers$measurables$types.CONNECTION;return _this44;}return _createClass(Connection$$module$build$src$core$renderers$measurables$connection);}(Measurable$$module$build$src$core$renderers$measurables$base),module$build$src$core$renderers$measurables$connection={};module$build$src$core$renderers$measurables$connection.Connection=Connection$$module$build$src$core$renderers$measurables$connection;var InputConnection$$module$build$src$core$renderers$measurables$input_connection=/*#__PURE__*/function(_Connection$$module$b2){_inherits(InputConnection$$module$build$src$core$renderers$measurables$input_connection,_Connection$$module$b2);var _super41=_createSuper(InputConnection$$module$build$src$core$renderers$measurables$input_connection);function InputConnection$$module$build$src$core$renderers$measurables$input_connection(a,b){var _this45;_classCallCheck(this,InputConnection$$module$build$src$core$renderers$measurables$input_connection);_this45=_super41.call(this,a,b.connection);_this45.input=b;_this45.connectionOffsetY=_this45.connectionOffsetX=0;_this45.type|=Types$$module$build$src$core$renderers$measurables$types.INPUT;_this45.align=b.align;(_this45.connectedBlock=b.connection&&b.connection.targetBlock()?b.connection.targetBlock():null)?(a=_this45.connectedBlock.getHeightWidth(),_this45.connectedBlockWidth=a.width,_this45.connectedBlockHeight=a.height):_this45.connectedBlockHeight=_this45.connectedBlockWidth=0;return _this45;}return _createClass(InputConnection$$module$build$src$core$renderers$measurables$input_connection);}(Connection$$module$build$src$core$renderers$measurables$connection),module$build$src$core$renderers$measurables$input_connection={};module$build$src$core$renderers$measurables$input_connection.InputConnection=InputConnection$$module$build$src$core$renderers$measurables$input_connection;var ExternalValueInput$$module$build$src$core$renderers$measurables$external_value_input=/*#__PURE__*/function(_InputConnection$$mod){_inherits(ExternalValueInput$$module$build$src$core$renderers$measurables$external_value_input,_InputConnection$$mod);var _super42=_createSuper(ExternalValueInput$$module$build$src$core$renderers$measurables$external_value_input);function ExternalValueInput$$module$build$src$core$renderers$measurables$external_value_input(a,b){var _this46;_classCallCheck(this,ExternalValueInput$$module$build$src$core$renderers$measurables$external_value_input);_this46=_super42.call(this,a,b);_this46.height=0;_this46.type|=Types$$module$build$src$core$renderers$measurables$types.EXTERNAL_VALUE_INPUT;_this46.height=_this46.connectedBlock?_this46.connectedBlockHeight-_this46.constants_.TAB_OFFSET_FROM_TOP-_this46.constants_.MEDIUM_PADDING:_this46.shape.height;_this46.width=_this46.shape.width+_this46.constants_.EXTERNAL_VALUE_INPUT_PADDING;_this46.connectionOffsetY=_this46.constants_.TAB_OFFSET_FROM_TOP;_this46.connectionHeight=_this46.shape.height;_this46.connectionWidth=_this46.shape.width;return _this46;}return _createClass(ExternalValueInput$$module$build$src$core$renderers$measurables$external_value_input);}(InputConnection$$module$build$src$core$renderers$measurables$input_connection),module$build$src$core$renderers$measurables$external_value_input={};module$build$src$core$renderers$measurables$external_value_input.ExternalValueInput=ExternalValueInput$$module$build$src$core$renderers$measurables$external_value_input;var Field$$module$build$src$core$renderers$measurables$field=/*#__PURE__*/function(_Measurable$$module$b2){_inherits(Field$$module$build$src$core$renderers$measurables$field,_Measurable$$module$b2);var _super43=_createSuper(Field$$module$build$src$core$renderers$measurables$field);function Field$$module$build$src$core$renderers$measurables$field(a,b,c){var _this47;_classCallCheck(this,Field$$module$build$src$core$renderers$measurables$field);_this47=_super43.call(this,a);_this47.field=b;_this47.parentInput=c;_this47.isEditable=b.EDITABLE;_this47.flipRtl=b.getFlipRtl();_this47.type|=Types$$module$build$src$core$renderers$measurables$types.FIELD;a=_this47.field.getSize();_this47.height=a.height;_this47.width=a.width;return _this47;}return _createClass(Field$$module$build$src$core$renderers$measurables$field);}(Measurable$$module$build$src$core$renderers$measurables$base),module$build$src$core$renderers$measurables$field={};module$build$src$core$renderers$measurables$field.Field=Field$$module$build$src$core$renderers$measurables$field;var Hat$$module$build$src$core$renderers$measurables$hat=/*#__PURE__*/function(_Measurable$$module$b3){_inherits(Hat$$module$build$src$core$renderers$measurables$hat,_Measurable$$module$b3);var _super44=_createSuper(Hat$$module$build$src$core$renderers$measurables$hat);function Hat$$module$build$src$core$renderers$measurables$hat(a){var _this48;_classCallCheck(this,Hat$$module$build$src$core$renderers$measurables$hat);_this48=_super44.call(this,a);_this48.type|=Types$$module$build$src$core$renderers$measurables$types.HAT;_this48.height=_this48.constants_.START_HAT.height;_this48.width=_this48.constants_.START_HAT.width;_this48.ascenderHeight=_this48.height;return _this48;}return _createClass(Hat$$module$build$src$core$renderers$measurables$hat);}(Measurable$$module$build$src$core$renderers$measurables$base),module$build$src$core$renderers$measurables$hat={};module$build$src$core$renderers$measurables$hat.Hat=Hat$$module$build$src$core$renderers$measurables$hat;var Icon$$module$build$src$core$renderers$measurables$icon=/*#__PURE__*/function(_Measurable$$module$b4){_inherits(Icon$$module$build$src$core$renderers$measurables$icon,_Measurable$$module$b4);var _super45=_createSuper(Icon$$module$build$src$core$renderers$measurables$icon);function Icon$$module$build$src$core$renderers$measurables$icon(a,b){var _this49;_classCallCheck(this,Icon$$module$build$src$core$renderers$measurables$icon);_this49=_super45.call(this,a);_this49.icon=b;_this49.flipRtl=!1;_this49.isVisible=b.isVisible();_this49.type|=Types$$module$build$src$core$renderers$measurables$types.ICON;a=b.getCorrectedSize();_this49.height=a.height;_this49.width=a.width;return _this49;}return _createClass(Icon$$module$build$src$core$renderers$measurables$icon);}(Measurable$$module$build$src$core$renderers$measurables$base),module$build$src$core$renderers$measurables$icon={};module$build$src$core$renderers$measurables$icon.Icon=Icon$$module$build$src$core$renderers$measurables$icon;var InRowSpacer$$module$build$src$core$renderers$measurables$in_row_spacer=/*#__PURE__*/function(_Measurable$$module$b5){_inherits(InRowSpacer$$module$build$src$core$renderers$measurables$in_row_spacer,_Measurable$$module$b5);var _super46=_createSuper(InRowSpacer$$module$build$src$core$renderers$measurables$in_row_spacer);function InRowSpacer$$module$build$src$core$renderers$measurables$in_row_spacer(a,b){var _this50;_classCallCheck(this,InRowSpacer$$module$build$src$core$renderers$measurables$in_row_spacer);_this50=_super46.call(this,a);_this50.type=_this50.type|Types$$module$build$src$core$renderers$measurables$types.SPACER|Types$$module$build$src$core$renderers$measurables$types.IN_ROW_SPACER;_this50.width=b;_this50.height=_this50.constants_.SPACER_DEFAULT_HEIGHT;return _this50;}return _createClass(InRowSpacer$$module$build$src$core$renderers$measurables$in_row_spacer);}(Measurable$$module$build$src$core$renderers$measurables$base),module$build$src$core$renderers$measurables$in_row_spacer={};module$build$src$core$renderers$measurables$in_row_spacer.InRowSpacer=InRowSpacer$$module$build$src$core$renderers$measurables$in_row_spacer;var InlineInput$$module$build$src$core$renderers$measurables$inline_input=/*#__PURE__*/function(_InputConnection$$mod2){_inherits(InlineInput$$module$build$src$core$renderers$measurables$inline_input,_InputConnection$$mod2);var _super47=_createSuper(InlineInput$$module$build$src$core$renderers$measurables$inline_input);function InlineInput$$module$build$src$core$renderers$measurables$inline_input(a,b){var _this51;_classCallCheck(this,InlineInput$$module$build$src$core$renderers$measurables$inline_input);_this51=_super47.call(this,a,b);_this51.type|=Types$$module$build$src$core$renderers$measurables$types.INLINE_INPUT;_this51.connectedBlock?(_this51.width=_this51.connectedBlockWidth,_this51.height=_this51.connectedBlockHeight):(_this51.height=_this51.constants_.EMPTY_INLINE_INPUT_HEIGHT,_this51.width=_this51.constants_.EMPTY_INLINE_INPUT_PADDING);_this51.connectionHeight=_this51.isDynamicShape?_this51.shape.height(_this51.height):_this51.shape.height;_this51.connectionWidth=_this51.isDynamicShape?_this51.shape.width(_this51.height):_this51.shape.width;_this51.connectedBlock||(_this51.width+=_this51.connectionWidth*(_this51.isDynamicShape?2:1));_this51.connectionOffsetY="connectionOffsetY"in _this51.shape?_this51.shape.connectionOffsetY(_this51.connectionHeight):_this51.constants_.TAB_OFFSET_FROM_TOP;_this51.connectionOffsetX="connectionOffsetX"in _this51.shape?_this51.shape.connectionOffsetX(_this51.connectionWidth):0;return _this51;}return _createClass(InlineInput$$module$build$src$core$renderers$measurables$inline_input);}(InputConnection$$module$build$src$core$renderers$measurables$input_connection),module$build$src$core$renderers$measurables$inline_input={};module$build$src$core$renderers$measurables$inline_input.InlineInput=InlineInput$$module$build$src$core$renderers$measurables$inline_input;var StatementInput$$module$build$src$core$renderers$measurables$statement_input=/*#__PURE__*/function(_InputConnection$$mod3){_inherits(StatementInput$$module$build$src$core$renderers$measurables$statement_input,_InputConnection$$mod3);var _super48=_createSuper(StatementInput$$module$build$src$core$renderers$measurables$statement_input);function StatementInput$$module$build$src$core$renderers$measurables$statement_input(a,b){var _this52;_classCallCheck(this,StatementInput$$module$build$src$core$renderers$measurables$statement_input);_this52=_super48.call(this,a,b);_this52.type|=Types$$module$build$src$core$renderers$measurables$types.STATEMENT_INPUT;_this52.height=_this52.connectedBlock?_this52.connectedBlockHeight+_this52.constants_.STATEMENT_BOTTOM_SPACER:_this52.constants_.EMPTY_STATEMENT_INPUT_HEIGHT;_this52.width=_this52.constants_.STATEMENT_INPUT_NOTCH_OFFSET+_this52.shape.width;return _this52;}return _createClass(StatementInput$$module$build$src$core$renderers$measurables$statement_input);}(InputConnection$$module$build$src$core$renderers$measurables$input_connection),module$build$src$core$renderers$measurables$statement_input={};module$build$src$core$renderers$measurables$statement_input.StatementInput=StatementInput$$module$build$src$core$renderers$measurables$statement_input;var InputRow$$module$build$src$core$renderers$measurables$input_row=/*#__PURE__*/function(_Row$$module$build$sr2){_inherits(InputRow$$module$build$src$core$renderers$measurables$input_row,_Row$$module$build$sr2);var _super49=_createSuper(InputRow$$module$build$src$core$renderers$measurables$input_row);function InputRow$$module$build$src$core$renderers$measurables$input_row(a){var _this53;_classCallCheck(this,InputRow$$module$build$src$core$renderers$measurables$input_row);_this53=_super49.call(this,a);_this53.connectedBlockWidths=0;_this53.type|=Types$$module$build$src$core$renderers$measurables$types.INPUT_ROW;return _this53;}_createClass(InputRow$$module$build$src$core$renderers$measurables$input_row,[{key:"measure",value:function measure(){this.width=this.minWidth;this.height=this.minHeight;var a=0;for(var b=0;b<this.elements.length;b++){var c=this.elements[b];this.width+=c.width;Types$$module$build$src$core$renderers$measurables$types.isInput(c)&&c instanceof InputConnection$$module$build$src$core$renderers$measurables$input_connection&&(Types$$module$build$src$core$renderers$measurables$types.isStatementInput(c)&&c instanceof StatementInput$$module$build$src$core$renderers$measurables$statement_input?a+=c.connectedBlockWidth:Types$$module$build$src$core$renderers$measurables$types.isExternalInput(c)&&c instanceof ExternalValueInput$$module$build$src$core$renderers$measurables$external_value_input&&0!==c.connectedBlockWidth&&(a+=c.connectedBlockWidth-c.connectionWidth));Types$$module$build$src$core$renderers$measurables$types.isSpacer(c)||(this.height=Math.max(this.height,c.height));}this.connectedBlockWidths=a;this.widthWithConnectedBlocks=this.width+a;}},{key:"endsWithElemSpacer",value:function endsWithElemSpacer(){return!this.hasExternalInput&&!this.hasStatement;}}]);return InputRow$$module$build$src$core$renderers$measurables$input_row;}(Row$$module$build$src$core$renderers$measurables$row),module$build$src$core$renderers$measurables$input_row={};module$build$src$core$renderers$measurables$input_row.InputRow=InputRow$$module$build$src$core$renderers$measurables$input_row;var JaggedEdge$$module$build$src$core$renderers$measurables$jagged_edge=/*#__PURE__*/function(_Measurable$$module$b6){_inherits(JaggedEdge$$module$build$src$core$renderers$measurables$jagged_edge,_Measurable$$module$b6);var _super50=_createSuper(JaggedEdge$$module$build$src$core$renderers$measurables$jagged_edge);function JaggedEdge$$module$build$src$core$renderers$measurables$jagged_edge(a){var _this54;_classCallCheck(this,JaggedEdge$$module$build$src$core$renderers$measurables$jagged_edge);_this54=_super50.call(this,a);_this54.type|=Types$$module$build$src$core$renderers$measurables$types.JAGGED_EDGE;_this54.height=_this54.constants_.JAGGED_TEETH.height;_this54.width=_this54.constants_.JAGGED_TEETH.width;return _this54;}return _createClass(JaggedEdge$$module$build$src$core$renderers$measurables$jagged_edge);}(Measurable$$module$build$src$core$renderers$measurables$base),module$build$src$core$renderers$measurables$jagged_edge={};module$build$src$core$renderers$measurables$jagged_edge.JaggedEdge=JaggedEdge$$module$build$src$core$renderers$measurables$jagged_edge;var NextConnection$$module$build$src$core$renderers$measurables$next_connection=/*#__PURE__*/function(_Connection$$module$b3){_inherits(NextConnection$$module$build$src$core$renderers$measurables$next_connection,_Connection$$module$b3);var _super51=_createSuper(NextConnection$$module$build$src$core$renderers$measurables$next_connection);function NextConnection$$module$build$src$core$renderers$measurables$next_connection(a,b){var _this55;_classCallCheck(this,NextConnection$$module$build$src$core$renderers$measurables$next_connection);_this55=_super51.call(this,a,b);_this55.type|=Types$$module$build$src$core$renderers$measurables$types.NEXT_CONNECTION;_this55.height=_this55.shape.height;_this55.width=_this55.shape.width;return _this55;}return _createClass(NextConnection$$module$build$src$core$renderers$measurables$next_connection);}(Connection$$module$build$src$core$renderers$measurables$connection),module$build$src$core$renderers$measurables$next_connection={};module$build$src$core$renderers$measurables$next_connection.NextConnection=NextConnection$$module$build$src$core$renderers$measurables$next_connection;var OutputConnection$$module$build$src$core$renderers$measurables$output_connection=/*#__PURE__*/function(_Connection$$module$b4){_inherits(OutputConnection$$module$build$src$core$renderers$measurables$output_connection,_Connection$$module$b4);var _super52=_createSuper(OutputConnection$$module$build$src$core$renderers$measurables$output_connection);function OutputConnection$$module$build$src$core$renderers$measurables$output_connection(a,b){var _this56;_classCallCheck(this,OutputConnection$$module$build$src$core$renderers$measurables$output_connection);_this56=_super52.call(this,a,b);_this56.connectionOffsetX=0;_this56.type|=Types$$module$build$src$core$renderers$measurables$types.OUTPUT_CONNECTION;_this56.height=_this56.isDynamicShape?0:_this56.shape.height;_this56.startX=_this56.width=_this56.isDynamicShape?0:_this56.shape.width;_this56.connectionOffsetY=_this56.constants_.TAB_OFFSET_FROM_TOP;return _this56;}return _createClass(OutputConnection$$module$build$src$core$renderers$measurables$output_connection);}(Connection$$module$build$src$core$renderers$measurables$connection),module$build$src$core$renderers$measurables$output_connection={};module$build$src$core$renderers$measurables$output_connection.OutputConnection=OutputConnection$$module$build$src$core$renderers$measurables$output_connection;var PreviousConnection$$module$build$src$core$renderers$measurables$previous_connection=/*#__PURE__*/function(_Connection$$module$b5){_inherits(PreviousConnection$$module$build$src$core$renderers$measurables$previous_connection,_Connection$$module$b5);var _super53=_createSuper(PreviousConnection$$module$build$src$core$renderers$measurables$previous_connection);function PreviousConnection$$module$build$src$core$renderers$measurables$previous_connection(a,b){var _this57;_classCallCheck(this,PreviousConnection$$module$build$src$core$renderers$measurables$previous_connection);_this57=_super53.call(this,a,b);_this57.type|=Types$$module$build$src$core$renderers$measurables$types.PREVIOUS_CONNECTION;_this57.height=_this57.shape.height;_this57.width=_this57.shape.width;return _this57;}return _createClass(PreviousConnection$$module$build$src$core$renderers$measurables$previous_connection);}(Connection$$module$build$src$core$renderers$measurables$connection),module$build$src$core$renderers$measurables$previous_connection={};module$build$src$core$renderers$measurables$previous_connection.PreviousConnection=PreviousConnection$$module$build$src$core$renderers$measurables$previous_connection;var RoundCorner$$module$build$src$core$renderers$measurables$round_corner=/*#__PURE__*/function(_Measurable$$module$b7){_inherits(RoundCorner$$module$build$src$core$renderers$measurables$round_corner,_Measurable$$module$b7);var _super54=_createSuper(RoundCorner$$module$build$src$core$renderers$measurables$round_corner);function RoundCorner$$module$build$src$core$renderers$measurables$round_corner(a,b){var _this58;_classCallCheck(this,RoundCorner$$module$build$src$core$renderers$measurables$round_corner);_this58=_super54.call(this,a);_this58.type=(b&&"left"!==b?Types$$module$build$src$core$renderers$measurables$types.RIGHT_ROUND_CORNER:Types$$module$build$src$core$renderers$measurables$types.LEFT_ROUND_CORNER)|Types$$module$build$src$core$renderers$measurables$types.CORNER;_this58.width=_this58.constants_.CORNER_RADIUS;_this58.height=_this58.constants_.CORNER_RADIUS/2;return _this58;}return _createClass(RoundCorner$$module$build$src$core$renderers$measurables$round_corner);}(Measurable$$module$build$src$core$renderers$measurables$base),module$build$src$core$renderers$measurables$round_corner={};module$build$src$core$renderers$measurables$round_corner.RoundCorner=RoundCorner$$module$build$src$core$renderers$measurables$round_corner;var SpacerRow$$module$build$src$core$renderers$measurables$spacer_row=/*#__PURE__*/function(_Row$$module$build$sr3){_inherits(SpacerRow$$module$build$src$core$renderers$measurables$spacer_row,_Row$$module$build$sr3);var _super55=_createSuper(SpacerRow$$module$build$src$core$renderers$measurables$spacer_row);function SpacerRow$$module$build$src$core$renderers$measurables$spacer_row(a,b,c){var _this59;_classCallCheck(this,SpacerRow$$module$build$src$core$renderers$measurables$spacer_row);_this59=_super55.call(this,a);_this59.height=b;_this59.width=c;_this59.precedesStatement=_this59.followsStatement=!1;_this59.widthWithConnectedBlocks=0;_this59.type=_this59.type|Types$$module$build$src$core$renderers$measurables$types.SPACER|Types$$module$build$src$core$renderers$measurables$types.BETWEEN_ROW_SPACER;_this59.elements=[new InRowSpacer$$module$build$src$core$renderers$measurables$in_row_spacer(_this59.constants_,c)];return _this59;}_createClass(SpacerRow$$module$build$src$core$renderers$measurables$spacer_row,[{key:"measure",value:function measure(){}}]);return SpacerRow$$module$build$src$core$renderers$measurables$spacer_row;}(Row$$module$build$src$core$renderers$measurables$row),module$build$src$core$renderers$measurables$spacer_row={};module$build$src$core$renderers$measurables$spacer_row.SpacerRow=SpacerRow$$module$build$src$core$renderers$measurables$spacer_row;var SquareCorner$$module$build$src$core$renderers$measurables$square_corner=/*#__PURE__*/function(_Measurable$$module$b8){_inherits(SquareCorner$$module$build$src$core$renderers$measurables$square_corner,_Measurable$$module$b8);var _super56=_createSuper(SquareCorner$$module$build$src$core$renderers$measurables$square_corner);function SquareCorner$$module$build$src$core$renderers$measurables$square_corner(a,b){var _this60;_classCallCheck(this,SquareCorner$$module$build$src$core$renderers$measurables$square_corner);_this60=_super56.call(this,a);_this60.type=(b&&"left"!==b?Types$$module$build$src$core$renderers$measurables$types.RIGHT_SQUARE_CORNER:Types$$module$build$src$core$renderers$measurables$types.LEFT_SQUARE_CORNER)|Types$$module$build$src$core$renderers$measurables$types.CORNER;_this60.width=_this60.height=_this60.constants_.NO_PADDING;return _this60;}return _createClass(SquareCorner$$module$build$src$core$renderers$measurables$square_corner);}(Measurable$$module$build$src$core$renderers$measurables$base),module$build$src$core$renderers$measurables$square_corner={};module$build$src$core$renderers$measurables$square_corner.SquareCorner=SquareCorner$$module$build$src$core$renderers$measurables$square_corner;var TopRow$$module$build$src$core$renderers$measurables$top_row=/*#__PURE__*/function(_Row$$module$build$sr4){_inherits(TopRow$$module$build$src$core$renderers$measurables$top_row,_Row$$module$build$sr4);var _super57=_createSuper(TopRow$$module$build$src$core$renderers$measurables$top_row);function TopRow$$module$build$src$core$renderers$measurables$top_row(a){var _this61;_classCallCheck(this,TopRow$$module$build$src$core$renderers$measurables$top_row);_this61=_super57.call(this,a);_this61.ascenderHeight=_this61.capline=0;_this61.hasPreviousConnection=!1;_this61.connection=null;_this61.type|=Types$$module$build$src$core$renderers$measurables$types.TOP_ROW;return _this61;}_createClass(TopRow$$module$build$src$core$renderers$measurables$top_row,[{key:"hasLeftSquareCorner",value:function hasLeftSquareCorner(a){var b=(a.hat?"cap"===a.hat:this.constants_.ADD_START_HATS)&&!a.outputConnection&&!a.previousConnection,c=a.getPreviousBlock();return!!a.outputConnection||b||(c?c.getNextBlock()===a:!1);}},{key:"hasRightSquareCorner",value:function hasRightSquareCorner(a){return!0;}},{key:"measure",value:function measure(){var a=0,b=0,c=0;for(var d=0;d<this.elements.length;d++){var e=this.elements[d];b+=e.width;Types$$module$build$src$core$renderers$measurables$types.isSpacer(e)||(Types$$module$build$src$core$renderers$measurables$types.isHat(e)&&e instanceof Hat$$module$build$src$core$renderers$measurables$hat?c=Math.max(c,e.ascenderHeight):a=Math.max(a,e.height));}this.width=Math.max(this.minWidth,b);this.height=Math.max(this.minHeight,a)+c;this.capline=this.ascenderHeight=c;this.widthWithConnectedBlocks=this.width;}},{key:"startsWithElemSpacer",value:function startsWithElemSpacer(){return!1;}},{key:"endsWithElemSpacer",value:function endsWithElemSpacer(){return!1;}}]);return TopRow$$module$build$src$core$renderers$measurables$top_row;}(Row$$module$build$src$core$renderers$measurables$row),module$build$src$core$renderers$measurables$top_row={};module$build$src$core$renderers$measurables$top_row.TopRow=TopRow$$module$build$src$core$renderers$measurables$top_row;var ConstantProvider$$module$build$src$core$renderers$common$constants=/*#__PURE__*/function(){function ConstantProvider$$module$build$src$core$renderers$common$constants(){_classCallCheck(this,ConstantProvider$$module$build$src$core$renderers$common$constants);this.NO_PADDING=0;this.SMALL_PADDING=3;this.MEDIUM_PADDING=5;this.MEDIUM_LARGE_PADDING=8;this.LARGE_PADDING=10;this.TAB_HEIGHT=15;this.TAB_OFFSET_FROM_TOP=5;this.TAB_VERTICAL_OVERLAP=2.5;this.TAB_WIDTH=8;this.NOTCH_WIDTH=15;this.NOTCH_HEIGHT=4;this.MIN_BLOCK_WIDTH=12;this.EMPTY_BLOCK_SPACER_HEIGHT=16;this.CORNER_RADIUS=8;this.NOTCH_OFFSET_LEFT=15;this.STATEMENT_BOTTOM_SPACER=0;this.STATEMENT_INPUT_PADDING_LEFT=20;this.BETWEEN_STATEMENT_PADDING_Y=4;this.ADD_START_HATS=!1;this.START_HAT_HEIGHT=15;this.START_HAT_WIDTH=100;this.SPACER_DEFAULT_HEIGHT=15;this.MIN_BLOCK_HEIGHT=24;this.EMPTY_INLINE_INPUT_PADDING=14.5;this.EXTERNAL_VALUE_INPUT_PADDING=2;this.JAGGED_TEETH_HEIGHT=12;this.JAGGED_TEETH_WIDTH=6;this.FIELD_TEXT_FONTSIZE=11;this.FIELD_TEXT_FONTWEIGHT="normal";this.FIELD_TEXT_FONTFAMILY="sans-serif";this.FIELD_TEXT_BASELINE=this.FIELD_TEXT_HEIGHT=-1;this.FIELD_BORDER_RECT_RADIUS=4;this.FIELD_BORDER_RECT_HEIGHT=16;this.FIELD_BORDER_RECT_X_PADDING=5;this.FIELD_BORDER_RECT_Y_PADDING=3;this.FIELD_BORDER_RECT_COLOUR="#fff";this.FIELD_DROPDOWN_SVG_ARROW=this.FIELD_DROPDOWN_COLOURED_DIV=this.FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW=!1;this.FIELD_DROPDOWN_SVG_ARROW_SIZE=12;this.FIELD_COLOUR_FULL_BLOCK=this.FIELD_TEXTINPUT_BOX_SHADOW=!1;this.FIELD_COLOUR_DEFAULT_WIDTH=26;this.defs_=null;this.embossFilterId="";this.embossFilter_=null;this.disabledPatternId="";this.disabledPattern_=null;this.debugFilterId="";this.cssNode_=this.debugFilter_=null;this.CURSOR_COLOUR="#cc0a0a";this.MARKER_COLOUR="#4286f4";this.CURSOR_WS_WIDTH=100;this.WS_CURSOR_HEIGHT=5;this.CURSOR_STACK_PADDING=10;this.CURSOR_BLOCK_PADDING=2;this.CURSOR_STROKE_WIDTH=4;this.FULL_BLOCK_FIELDS=!1;this.INSERTION_MARKER_COLOUR="#000000";this.INSERTION_MARKER_OPACITY=.2;this.SHAPES={PUZZLE:1,NOTCH:2};this.TALL_INPUT_FIELD_OFFSET_Y=this.MEDIUM_PADDING;this.DUMMY_INPUT_SHADOW_MIN_HEIGHT=this.DUMMY_INPUT_MIN_HEIGHT=this.TAB_HEIGHT;this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT;this.TOP_ROW_MIN_HEIGHT=this.MEDIUM_PADDING;this.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING;this.BOTTOM_ROW_MIN_HEIGHT=this.MEDIUM_PADDING;this.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING;this.EMPTY_INLINE_INPUT_HEIGHT=this.TAB_HEIGHT+11;this.EMPTY_STATEMENT_INPUT_HEIGHT=this.MIN_BLOCK_HEIGHT;this.START_POINT=moveBy$$module$build$src$core$utils$svg_paths(0,0);this.FIELD_TEXT_BASELINE_CENTER=!0;this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT;this.FIELD_DROPDOWN_SVG_ARROW_PADDING=this.FIELD_BORDER_RECT_X_PADDING;this.FIELD_DROPDOWN_SVG_ARROW_DATAURI="data:image/svg+xml;base64,PHN2ZyBpZD0iTGF5ZXJfMSIgZGF0YS1uYW1lPSJMYXllciAxIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMi43MSIgaGVpZ2h0PSI4Ljc5IiB2aWV3Qm94PSIwIDAgMTIuNzEgOC43OSI+PHRpdGxlPmRyb3Bkb3duLWFycm93PC90aXRsZT48ZyBvcGFjaXR5PSIwLjEiPjxwYXRoIGQ9Ik0xMi43MSwyLjQ0QTIuNDEsMi40MSwwLDAsMSwxMiw0LjE2TDguMDgsOC4wOGEyLjQ1LDIuNDUsMCwwLDEtMy40NSwwTDAuNzIsNC4xNkEyLjQyLDIuNDIsMCwwLDEsMCwyLjQ0LDIuNDgsMi40OCwwLDAsMSwuNzEuNzFDMSwwLjQ3LDEuNDMsMCw2LjM2LDBTMTEuNzUsMC40NiwxMiwuNzFBMi40NCwyLjQ0LDAsMCwxLDEyLjcxLDIuNDRaIiBmaWxsPSIjMjMxZjIwIi8+PC9nPjxwYXRoIGQ9Ik02LjM2LDcuNzlhMS40MywxLjQzLDAsMCwxLTEtLjQyTDEuNDIsMy40NWExLjQ0LDEuNDQsMCwwLDEsMC0yYzAuNTYtLjU2LDkuMzEtMC41Niw5Ljg3LDBhMS40NCwxLjQ0LDAsMCwxLDAsMkw3LjM3LDcuMzdBMS40MywxLjQzLDAsMCwxLDYuMzYsNy43OVoiIGZpbGw9IiNmZmYiLz48L3N2Zz4=";this.FIELD_COLOUR_DEFAULT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT;this.FIELD_CHECKBOX_X_OFFSET=this.FIELD_BORDER_RECT_X_PADDING-3;this.randomIdentifier=String(Math.random()).substring(2);}_createClass(ConstantProvider$$module$build$src$core$renderers$common$constants,[{key:"init",value:function init(){this.JAGGED_TEETH=this.makeJaggedTeeth();this.NOTCH=this.makeNotch();this.START_HAT=this.makeStartHat();this.PUZZLE_TAB=this.makePuzzleTab();this.INSIDE_CORNERS=this.makeInsideCorners();this.OUTSIDE_CORNERS=this.makeOutsideCorners();}},{key:"setTheme",value:function setTheme(a){this.blockStyles=Object.create(null);var b=a.blockStyles;for(var c in b){this.blockStyles[c]=this.validatedBlockStyle_(b[c]);}this.setDynamicProperties_(a);}},{key:"setDynamicProperties_",value:function setDynamicProperties_(a){this.setFontConstants_(a);this.setComponentConstants_(a);this.ADD_START_HATS=void 0!==a.startHats?a.startHats:this.ADD_START_HATS;}},{key:"setFontConstants_",value:function setFontConstants_(a){a.fontStyle&&a.fontStyle.family&&(this.FIELD_TEXT_FONTFAMILY=a.fontStyle.family);a.fontStyle&&a.fontStyle.weight&&(this.FIELD_TEXT_FONTWEIGHT=a.fontStyle.weight);a.fontStyle&&a.fontStyle.size&&(this.FIELD_TEXT_FONTSIZE=a.fontStyle.size);a=measureFontMetrics$$module$build$src$core$utils$dom("Hg",this.FIELD_TEXT_FONTSIZE+"pt",this.FIELD_TEXT_FONTWEIGHT,this.FIELD_TEXT_FONTFAMILY);this.FIELD_TEXT_HEIGHT=a.height;this.FIELD_TEXT_BASELINE=a.baseline;}},{key:"setComponentConstants_",value:function setComponentConstants_(a){this.CURSOR_COLOUR=a.getComponentStyle("cursorColour")||this.CURSOR_COLOUR;this.MARKER_COLOUR=a.getComponentStyle("markerColour")||this.MARKER_COLOUR;this.INSERTION_MARKER_COLOUR=a.getComponentStyle("insertionMarkerColour")||this.INSERTION_MARKER_COLOUR;this.INSERTION_MARKER_OPACITY=Number(a.getComponentStyle("insertionMarkerOpacity"))||this.INSERTION_MARKER_OPACITY;}},{key:"getBlockStyleForColour",value:function getBlockStyleForColour(a){var b="auto_"+a;this.blockStyles[b]||(this.blockStyles[b]=this.createBlockStyle_(a));return{style:this.blockStyles[b],name:b};}},{key:"getBlockStyle",value:function getBlockStyle(a){return this.blockStyles[a||""]||(a&&0===a.indexOf("auto_")?this.getBlockStyleForColour(a.substring(5)).style:this.createBlockStyle_("#000000"));}},{key:"createBlockStyle_",value:function createBlockStyle_(a){return this.validatedBlockStyle_({colourPrimary:a});}},{key:"validatedBlockStyle_",value:function validatedBlockStyle_(a){var b={};a&&Object.assign(b,a);a=parseBlockColour$$module$build$src$core$utils$parsing(b.colourPrimary||"#000");b.colourPrimary=a.hex;b.colourSecondary=b.colourSecondary?parseBlockColour$$module$build$src$core$utils$parsing(b.colourSecondary).hex:this.generateSecondaryColour_(b.colourPrimary);b.colourTertiary=b.colourTertiary?parseBlockColour$$module$build$src$core$utils$parsing(b.colourTertiary).hex:this.generateTertiaryColour_(b.colourPrimary);b.hat=b.hat||"";return b;}},{key:"generateSecondaryColour_",value:function generateSecondaryColour_(a){return blend$$module$build$src$core$utils$colour("#fff",a,.6)||a;}},{key:"generateTertiaryColour_",value:function generateTertiaryColour_(a){return blend$$module$build$src$core$utils$colour("#fff",a,.3)||a;}},{key:"dispose",value:function dispose(){this.embossFilter_&&removeNode$$module$build$src$core$utils$dom(this.embossFilter_);this.disabledPattern_&&removeNode$$module$build$src$core$utils$dom(this.disabledPattern_);this.debugFilter_&&removeNode$$module$build$src$core$utils$dom(this.debugFilter_);this.cssNode_=null;}},{key:"makeJaggedTeeth",value:function makeJaggedTeeth(){var a=this.JAGGED_TEETH_HEIGHT,b=this.JAGGED_TEETH_WIDTH,c=line$$module$build$src$core$utils$svg_paths([point$$module$build$src$core$utils$svg_paths(b,a/4),point$$module$build$src$core$utils$svg_paths(2*-b,a/2),point$$module$build$src$core$utils$svg_paths(b,a/4)]);return{height:a,width:b,path:c};}},{key:"makeStartHat",value:function makeStartHat(){var a=this.START_HAT_HEIGHT,b=this.START_HAT_WIDTH,c=curve$$module$build$src$core$utils$svg_paths("c",[point$$module$build$src$core$utils$svg_paths(30,-a),point$$module$build$src$core$utils$svg_paths(70,-a),point$$module$build$src$core$utils$svg_paths(b,0)]);return{height:a,width:b,path:c};}},{key:"makePuzzleTab",value:function makePuzzleTab(){function a(f){f=f?-1:1;var g=-f;var h=c/2;var k=h+2.5,l=h+.5,m=point$$module$build$src$core$utils$svg_paths(-b,f*h);h=point$$module$build$src$core$utils$svg_paths(b,f*h);return curve$$module$build$src$core$utils$svg_paths("c",[point$$module$build$src$core$utils$svg_paths(0,f*k),point$$module$build$src$core$utils$svg_paths(-b,g*l),m])+curve$$module$build$src$core$utils$svg_paths("s",[point$$module$build$src$core$utils$svg_paths(b,2.5*g),h]);}var b=this.TAB_WIDTH,c=this.TAB_HEIGHT,d=a(!0),e=a(!1);return{type:this.SHAPES.PUZZLE,width:b,height:c,pathDown:e,pathUp:d};}},{key:"makeNotch",value:function makeNotch(){function a(g){return line$$module$build$src$core$utils$svg_paths([point$$module$build$src$core$utils$svg_paths(g*d,c),point$$module$build$src$core$utils$svg_paths(3*g,0),point$$module$build$src$core$utils$svg_paths(g*d,-c)]);}var b=this.NOTCH_WIDTH,c=this.NOTCH_HEIGHT,d=(b-3)/2,e=a(1),f=a(-1);return{type:this.SHAPES.NOTCH,width:b,height:c,pathLeft:e,pathRight:f};}},{key:"makeInsideCorners",value:function makeInsideCorners(){var a=this.CORNER_RADIUS,b=arc$$module$build$src$core$utils$svg_paths("a","0 0,0",a,point$$module$build$src$core$utils$svg_paths(-a,a)),c=arc$$module$build$src$core$utils$svg_paths("a","0 0,0",a,point$$module$build$src$core$utils$svg_paths(a,a));return{width:a,height:a,pathTop:b,pathBottom:c};}},{key:"makeOutsideCorners",value:function makeOutsideCorners(){var a=this.CORNER_RADIUS,b=moveBy$$module$build$src$core$utils$svg_paths(0,a)+arc$$module$build$src$core$utils$svg_paths("a","0 0,1",a,point$$module$build$src$core$utils$svg_paths(a,-a)),c=arc$$module$build$src$core$utils$svg_paths("a","0 0,1",a,point$$module$build$src$core$utils$svg_paths(a,a)),d=arc$$module$build$src$core$utils$svg_paths("a","0 0,1",a,point$$module$build$src$core$utils$svg_paths(-a,-a)),e=arc$$module$build$src$core$utils$svg_paths("a","0 0,1",a,point$$module$build$src$core$utils$svg_paths(-a,a));return{topLeft:b,topRight:c,bottomRight:e,bottomLeft:d,rightHeight:a};}},{key:"shapeFor",value:function shapeFor(a){switch(a.type){case ConnectionType$$module$build$src$core$connection_type.INPUT_VALUE:case ConnectionType$$module$build$src$core$connection_type.OUTPUT_VALUE:return this.PUZZLE_TAB;case ConnectionType$$module$build$src$core$connection_type.PREVIOUS_STATEMENT:case ConnectionType$$module$build$src$core$connection_type.NEXT_STATEMENT:return this.NOTCH;default:throw Error("Unknown connection type");}}},{key:"createDom",value:function createDom(a,b,c){this.injectCSS_(b,c);this.defs_=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.DEFS,{},a);a=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.FILTER,{id:"blocklyEmbossFilter"+this.randomIdentifier},this.defs_);createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.FEGAUSSIANBLUR,{"in":"SourceAlpha",stdDeviation:1,result:"blur"},a);b=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.FESPECULARLIGHTING,{"in":"blur",surfaceScale:1,specularConstant:.5,specularExponent:10,"lighting-color":"white",result:"specOut"},a);createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.FEPOINTLIGHT,{x:-5E3,y:-1E4,z:2E4},b);createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.FECOMPOSITE,{"in":"specOut",in2:"SourceAlpha",operator:"in",result:"specOut"},a);createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.FECOMPOSITE,{"in":"SourceGraphic",in2:"specOut",operator:"arithmetic",k1:0,k2:1,k3:1,k4:0},a);this.embossFilterId=a.id;this.embossFilter_=a;a=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.PATTERN,{id:"blocklyDisabledPattern"+this.randomIdentifier,patternUnits:"userSpaceOnUse",width:10,height:10},this.defs_);createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.RECT,{width:10,height:10,fill:"#aaa"},a);createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.PATH,{d:"M 0 0 L 10 10 M 10 0 L 0 10",stroke:"#cc0"},a);this.disabledPatternId=a.id;this.disabledPattern_=a;this.createDebugFilter();}},{key:"createDebugFilter",value:function createDebugFilter(){if(!this.debugFilter_){var a=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.FILTER,{id:"blocklyDebugFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},this.defs_),b=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.FECOMPONENTTRANSFER,{result:"outBlur"},a);createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},b);createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.FEFLOOD,{"flood-color":"#ff0000","flood-opacity":.5,result:"outColor"},a);createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.FECOMPOSITE,{"in":"outColor",in2:"outBlur",operator:"in",result:"outGlow"},a);this.debugFilterId=a.id;this.debugFilter_=a;}}},{key:"injectCSS_",value:function injectCSS_(a,b){b=this.getCSS_(b);a="blockly-renderer-style-"+a;this.cssNode_=document.getElementById(a);var c=b.join("\n");this.cssNode_?this.cssNode_.firstChild.textContent=c:(b=document.createElement("style"),b.id=a,a=document.createTextNode(c),b.appendChild(a),document.head.insertBefore(b,document.head.firstChild),this.cssNode_=b);}},{key:"getCSS_",value:function getCSS_(a){return["".concat(a," .blocklyText, "),"".concat(a," .blocklyFlyoutLabelText {"),"font: ".concat(this.FIELD_TEXT_FONTWEIGHT," ")+"".concat(this.FIELD_TEXT_FONTSIZE,"pt ").concat(this.FIELD_TEXT_FONTFAMILY,";"),"}","".concat(a," .blocklyText {"),"fill: #fff;","}","".concat(a," .blocklyNonEditableText>rect,"),"".concat(a," .blocklyEditableText>rect {"),"fill: ".concat(this.FIELD_BORDER_RECT_COLOUR,";"),"fill-opacity: .6;","stroke: none;","}","".concat(a," .blocklyNonEditableText>text,"),"".concat(a," .blocklyEditableText>text {"),"fill: #000;","}","".concat(a," .blocklyFlyoutLabelText {"),"fill: #000;","}","".concat(a," .blocklyText.blocklyBubbleText {"),"fill: #000;","}","".concat(a," .blocklyEditableText:not(.editing):hover>rect {"),"stroke: #fff;","stroke-width: 2;","}","".concat(a," .blocklyHtmlInput {"),"font-family: ".concat(this.FIELD_TEXT_FONTFAMILY,";"),"font-weight: ".concat(this.FIELD_TEXT_FONTWEIGHT,";"),"}","".concat(a," .blocklySelected>.blocklyPath {"),"stroke: #fc3;","stroke-width: 3px;","}","".concat(a," .blocklyHighlightedConnectionPath {"),"stroke: #fc3;","}","".concat(a," .blocklyReplaceable .blocklyPath {"),"fill-opacity: .5;","}","".concat(a," .blocklyReplaceable .blocklyPathLight,"),"".concat(a," .blocklyReplaceable .blocklyPathDark {"),"display: none;","}","".concat(a," .blocklyInsertionMarker>.blocklyPath {"),"fill-opacity: ".concat(this.INSERTION_MARKER_OPACITY,";"),"stroke: none;","}"];}}]);return ConstantProvider$$module$build$src$core$renderers$common$constants;}(),module$build$src$core$renderers$common$constants={};module$build$src$core$renderers$common$constants.ConstantProvider=ConstantProvider$$module$build$src$core$renderers$common$constants;module$build$src$core$renderers$common$constants.isDynamicShape=isDynamicShape$$module$build$src$core$renderers$common$constants;var useDebugger$$module$build$src$core$renderers$common$debug=!1,module$build$src$core$renderers$common$debug={};module$build$src$core$renderers$common$debug.isDebuggerEnabled=isDebuggerEnabled$$module$build$src$core$renderers$common$debug;module$build$src$core$renderers$common$debug.startDebugger=startDebugger$$module$build$src$core$renderers$common$debug;module$build$src$core$renderers$common$debug.stopDebugger=stopDebugger$$module$build$src$core$renderers$common$debug;var Debug$$module$build$src$core$renderers$common$debugger=/*#__PURE__*/function(){function Debug$$module$build$src$core$renderers$common$debugger(a){_classCallCheck(this,Debug$$module$build$src$core$renderers$common$debugger);this.constants=a;this.debugElements_=[];this.svgRoot_=null;this.randomColour_="";}_createClass(Debug$$module$build$src$core$renderers$common$debugger,[{key:"clearElems",value:function clearElems(){for(var a=0;a<this.debugElements_.length;a++){removeNode$$module$build$src$core$utils$dom(this.debugElements_[a]);}this.debugElements_=[];}},{key:"drawSpacerRow",value:function drawSpacerRow(a,b,c){if(Debug$$module$build$src$core$renderers$common$debugger.config.rowSpacers){var d=Math.abs(a.height),e=0>a.height;e&&(b-=d);this.debugElements_.push(createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.RECT,{"class":"rowSpacerRect blockRenderDebug",x:c?-(a.xPos+a.width):a.xPos,y:b,width:a.width,height:d,stroke:e?"black":"blue",fill:"blue","fill-opacity":"0.5","stroke-width":"1px"},this.svgRoot_));}}},{key:"drawSpacerElem",value:function drawSpacerElem(a,b,c){if(Debug$$module$build$src$core$renderers$common$debugger.config.elemSpacers){b=Math.abs(a.width);var d=0>a.width,e=d?a.xPos-b:a.xPos;c&&(e=-(e+b));this.debugElements_.push(createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.RECT,{"class":"elemSpacerRect blockRenderDebug",x:e,y:a.centerline-a.height/2,width:b,height:a.height,stroke:"pink",fill:d?"black":"pink","fill-opacity":"0.5","stroke-width":"1px"},this.svgRoot_));}}},{key:"drawRenderedElem",value:function drawRenderedElem(a,b){if(Debug$$module$build$src$core$renderers$common$debugger.config.elems){var c=a.xPos;b&&(c=-(c+a.width));b=a.centerline-a.height/2;this.debugElements_.push(createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.RECT,{"class":"rowRenderingRect blockRenderDebug",x:c,y:b,width:a.width,height:a.height,stroke:"black",fill:"none","stroke-width":"1px"},this.svgRoot_));Types$$module$build$src$core$renderers$measurables$types.isField(a)&&a instanceof Field$$module$build$src$core$renderers$measurables$field&&a.field instanceof $.FieldLabel$$module$build$src$core$field_label&&this.debugElements_.push(createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.RECT,{"class":"rowRenderingRect blockRenderDebug",x:c,y:b+this.constants.FIELD_TEXT_BASELINE,width:a.width,height:"0.1px",stroke:"red",fill:"none","stroke-width":"0.5px"},this.svgRoot_));}Types$$module$build$src$core$renderers$measurables$types.isInput(a)&&a instanceof InputConnection$$module$build$src$core$renderers$measurables$input_connection&&Debug$$module$build$src$core$renderers$common$debugger.config.connections&&this.drawConnection(a.connectionModel);}},{key:"drawConnection",value:function drawConnection(a){if(Debug$$module$build$src$core$renderers$common$debugger.config.connections){var b="",c=0,d="";a.type===ConnectionType$$module$build$src$core$connection_type.INPUT_VALUE?(c=4,b="magenta",d="none"):a.type===ConnectionType$$module$build$src$core$connection_type.OUTPUT_VALUE?(c=2,d=b="magenta"):a.type===ConnectionType$$module$build$src$core$connection_type.NEXT_STATEMENT?(c=4,b="goldenrod",d="none"):a.type===ConnectionType$$module$build$src$core$connection_type.PREVIOUS_STATEMENT&&(c=2,d=b="goldenrod");this.debugElements_.push(createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.CIRCLE,{"class":"blockRenderDebug",cx:a.getOffsetInBlock().x,cy:a.getOffsetInBlock().y,r:c,fill:d,stroke:b},this.svgRoot_));}}},{key:"drawRenderedRow",value:function drawRenderedRow(a,b,c){Debug$$module$build$src$core$renderers$common$debugger.config.rows&&(this.debugElements_.push(createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.RECT,{"class":"elemRenderingRect blockRenderDebug",x:c?-(a.xPos+a.width):a.xPos,y:a.yPos,width:a.width,height:a.height,stroke:"red",fill:"none","stroke-width":"1px"},this.svgRoot_)),Types$$module$build$src$core$renderers$measurables$types.isTopOrBottomRow(a)||Debug$$module$build$src$core$renderers$common$debugger.config.connectedBlockBounds&&this.debugElements_.push(createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.RECT,{"class":"connectedBlockWidth blockRenderDebug",x:c?-(a.xPos+a.widthWithConnectedBlocks):a.xPos,y:a.yPos,width:a.widthWithConnectedBlocks,height:a.height,stroke:this.randomColour_,fill:"none","stroke-width":"1px","stroke-dasharray":"3,3"},this.svgRoot_)));}},{key:"drawRowWithElements",value:function drawRowWithElements(a,b,c){for(var d=0;d<a.elements.length;d++){var e=a.elements[d];e?Types$$module$build$src$core$renderers$measurables$types.isSpacer(e)?this.drawSpacerElem(e,a.height,c):this.drawRenderedElem(e,c):console.warn("A row has an undefined or null element.",a,e);}this.drawRenderedRow(a,b,c);}},{key:"drawBoundingBox",value:function drawBoundingBox(a){if(Debug$$module$build$src$core$renderers$common$debugger.config.blockBounds){var b=a.RTL?-a.width:0;this.debugElements_.push(createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.RECT,{"class":"blockBoundingBox blockRenderDebug",x:b,y:0,width:a.width,height:a.height,stroke:"black",fill:"none","stroke-width":"1px","stroke-dasharray":"5,5"},this.svgRoot_));Debug$$module$build$src$core$renderers$common$debugger.config.connectedBlockBounds&&(b=a.RTL?-a.widthWithChildren:0,this.debugElements_.push(createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.RECT,{"class":"blockRenderDebug",x:b,y:0,width:a.widthWithChildren,height:a.height,stroke:"#DF57BC",fill:"none","stroke-width":"1px","stroke-dasharray":"3,3"},this.svgRoot_)));}}},{key:"drawDebug",value:function drawDebug(a,b){this.clearElems();this.svgRoot_=a.getSvgRoot();this.randomColour_="#"+Math.floor(16777215*Math.random()).toString(16);var c=0;for(var d=0;d<b.rows.length;d++){var e=b.rows[d];Types$$module$build$src$core$renderers$measurables$types.isBetweenRowSpacer(e)?this.drawSpacerRow(e,c,b.RTL):this.drawRowWithElements(e,c,b.RTL);c+=e.height;}a.previousConnection&&this.drawConnection(a.previousConnection);a.nextConnection&&this.drawConnection(a.nextConnection);a.outputConnection&&this.drawConnection(a.outputConnection);b.rightSide&&this.drawRenderedElem(b.rightSide,b.RTL);this.drawBoundingBox(b);this.drawRender(a.pathObject.svgPath);}},{key:"drawRender",value:function drawRender(a){Debug$$module$build$src$core$renderers$common$debugger.config.render&&(a.setAttribute("filter","url(#"+this.constants.debugFilterId+")"),setTimeout(function(){a.setAttribute("filter","");},100));}}]);return Debug$$module$build$src$core$renderers$common$debugger;}();Debug$$module$build$src$core$renderers$common$debugger.config={rowSpacers:!0,elemSpacers:!0,rows:!0,elems:!0,connections:!0,blockBounds:!0,connectedBlockBounds:!0,render:!0};var module$build$src$core$renderers$common$debugger={};module$build$src$core$renderers$common$debugger.Debug=Debug$$module$build$src$core$renderers$common$debugger;var Drawer$$module$build$src$core$renderers$common$drawer=/*#__PURE__*/function(){function Drawer$$module$build$src$core$renderers$common$drawer(a,b){_classCallCheck(this,Drawer$$module$build$src$core$renderers$common$drawer);this.inlinePath_=this.outlinePath_="";this.block_=a;this.info_=b;this.topLeft_=a.getRelativeToSurfaceXY();this.constants_=b.getRenderer().getConstants();}_createClass(Drawer$$module$build$src$core$renderers$common$drawer,[{key:"draw",value:function draw(){this.hideHiddenIcons_();this.drawOutline_();this.drawInternals_();this.block_.pathObject.setPath(this.outlinePath_+"\n"+this.inlinePath_);this.info_.RTL&&this.block_.pathObject.flipRTL();if(isDebuggerEnabled$$module$build$src$core$renderers$common$debug()){var a;null==(a=this.block_.renderingDebugger)||a.drawDebug(this.block_,this.info_);}this.recordSizeOnBlock_();}},{key:"recordSizeOnBlock_",value:function recordSizeOnBlock_(){this.block_.height=this.info_.height;this.block_.width=this.info_.widthWithChildren;}},{key:"hideHiddenIcons_",value:function hideHiddenIcons_(){for(var a=0,b;b=this.info_.hiddenIcons[a];a++){var c=void 0;null==(c=b.icon.iconGroup_)||c.setAttribute("display","none");}}},{key:"drawOutline_",value:function drawOutline_(){this.drawTop_();for(var a=1;a<this.info_.rows.length-1;a++){var b=this.info_.rows[a];b.hasJaggedEdge?this.drawJaggedEdge_(b):b.hasStatement?this.drawStatementInput_(b):b.hasExternalInput?this.drawValueInput_(b):this.drawRightSideRow_(b);}this.drawBottom_();this.drawLeft_();}},{key:"drawTop_",value:function drawTop_(){var a=this.info_.topRow,b=a.elements;this.positionPreviousConnection_();this.outlinePath_+=moveBy$$module$build$src$core$utils$svg_paths(a.xPos,this.info_.startY);for(var c=0,d;d=b[c];c++){Types$$module$build$src$core$renderers$measurables$types.isLeftRoundedCorner(d)?this.outlinePath_+=this.constants_.OUTSIDE_CORNERS.topLeft:Types$$module$build$src$core$renderers$measurables$types.isRightRoundedCorner(d)?this.outlinePath_+=this.constants_.OUTSIDE_CORNERS.topRight:Types$$module$build$src$core$renderers$measurables$types.isPreviousConnection(d)&&d instanceof Connection$$module$build$src$core$renderers$measurables$connection?this.outlinePath_+=d.shape.pathLeft:Types$$module$build$src$core$renderers$measurables$types.isHat(d)?this.outlinePath_+=this.constants_.START_HAT.path:Types$$module$build$src$core$renderers$measurables$types.isSpacer(d)&&(this.outlinePath_+=lineOnAxis$$module$build$src$core$utils$svg_paths("h",d.width));}this.outlinePath_+=lineOnAxis$$module$build$src$core$utils$svg_paths("v",a.height);}},{key:"drawJaggedEdge_",value:function drawJaggedEdge_(a){this.outlinePath_+=this.constants_.JAGGED_TEETH.path+lineOnAxis$$module$build$src$core$utils$svg_paths("v",a.height-this.constants_.JAGGED_TEETH.height);}},{key:"drawValueInput_",value:function drawValueInput_(a){var b=a.getLastInput();this.positionExternalValueConnection_(a);var c=isDynamicShape$$module$build$src$core$renderers$common$constants(b.shape)?b.shape.pathDown(b.height):b.shape.pathDown;this.outlinePath_+=lineOnAxis$$module$build$src$core$utils$svg_paths("H",b.xPos+b.width)+c+lineOnAxis$$module$build$src$core$utils$svg_paths("v",a.height-b.connectionHeight);}},{key:"drawStatementInput_",value:function drawStatementInput_(a){var b=a.getLastInput();if(b){var c=b.xPos+b.notchOffset+b.shape.width;b=b.shape.pathRight+lineOnAxis$$module$build$src$core$utils$svg_paths("h",-(b.notchOffset-this.constants_.INSIDE_CORNERS.width))+this.constants_.INSIDE_CORNERS.pathTop;var d=a.height-2*this.constants_.INSIDE_CORNERS.height;this.outlinePath_+=lineOnAxis$$module$build$src$core$utils$svg_paths("H",c)+b+lineOnAxis$$module$build$src$core$utils$svg_paths("v",d)+this.constants_.INSIDE_CORNERS.pathBottom+lineOnAxis$$module$build$src$core$utils$svg_paths("H",a.xPos+a.width);this.positionStatementInputConnection_(a);}}},{key:"drawRightSideRow_",value:function drawRightSideRow_(a){this.outlinePath_+=lineOnAxis$$module$build$src$core$utils$svg_paths("V",a.yPos+a.height);}},{key:"drawBottom_",value:function drawBottom_(){var a=this.info_.bottomRow,b=a.elements;this.positionNextConnection_();var c=0,d="";for(var e=b.length-1,f;f=b[e];e--){Types$$module$build$src$core$renderers$measurables$types.isNextConnection(f)&&f instanceof Connection$$module$build$src$core$renderers$measurables$connection?d+=f.shape.pathRight:Types$$module$build$src$core$renderers$measurables$types.isLeftSquareCorner(f)?d+=lineOnAxis$$module$build$src$core$utils$svg_paths("H",a.xPos):Types$$module$build$src$core$renderers$measurables$types.isLeftRoundedCorner(f)?d+=this.constants_.OUTSIDE_CORNERS.bottomLeft:Types$$module$build$src$core$renderers$measurables$types.isRightRoundedCorner(f)?(d+=this.constants_.OUTSIDE_CORNERS.bottomRight,c=this.constants_.OUTSIDE_CORNERS.rightHeight):Types$$module$build$src$core$renderers$measurables$types.isSpacer(f)&&(d+=lineOnAxis$$module$build$src$core$utils$svg_paths("h",-1*f.width));}this.outlinePath_+=lineOnAxis$$module$build$src$core$utils$svg_paths("V",a.baseline-c);this.outlinePath_+=d;}},{key:"drawLeft_",value:function drawLeft_(){var a=this.info_.outputConnection;this.positionOutputConnection_();if(a){var b=a.connectionOffsetY+a.height;a=isDynamicShape$$module$build$src$core$renderers$common$constants(a.shape)?a.shape.pathUp(a.height):a.shape.pathUp;this.outlinePath_+=lineOnAxis$$module$build$src$core$utils$svg_paths("V",b)+a;}this.outlinePath_+="z";}},{key:"drawInternals_",value:function drawInternals_(){for(var a=0,b;b=this.info_.rows[a];a++){for(var c=0,d;d=b.elements[c];c++){Types$$module$build$src$core$renderers$measurables$types.isInlineInput(d)?this.drawInlineInput_(d):(Types$$module$build$src$core$renderers$measurables$types.isIcon(d)||Types$$module$build$src$core$renderers$measurables$types.isField(d))&&this.layoutField_(d);}}}},{key:"layoutField_",value:function layoutField_(a){var b=Types$$module$build$src$core$renderers$measurables$types.isField(a)?a.field.getSvgRoot():a.icon.iconGroup_,c=a.centerline-a.height/2;var d=a.xPos,e="";this.info_.RTL&&(d=-(d+a.width),a.flipRtl&&(d+=a.width,e="scale(-1 1)"));Types$$module$build$src$core$renderers$measurables$types.isIcon(a)?(b.setAttribute("display","block"),b.setAttribute("transform","translate("+d+","+c+")"),a.icon.computeIconLocation()):b.setAttribute("transform","translate("+d+","+c+")"+e);this.info_.isInsertionMarker&&b.setAttribute("display","none");}},{key:"drawInlineInput_",value:function drawInlineInput_(a){var b=a.width,c=a.height,d=a.connectionOffsetY,e=a.connectionHeight+d;this.inlinePath_+=moveTo$$module$build$src$core$utils$svg_paths(a.xPos+a.connectionWidth,a.centerline-c/2)+lineOnAxis$$module$build$src$core$utils$svg_paths("v",d)+a.shape.pathDown+lineOnAxis$$module$build$src$core$utils$svg_paths("v",c-e)+lineOnAxis$$module$build$src$core$utils$svg_paths("h",b-a.connectionWidth)+lineOnAxis$$module$build$src$core$utils$svg_paths("v",-c)+"z";this.positionInlineInputConnection_(a);}},{key:"positionInlineInputConnection_",value:function positionInlineInputConnection_(a){var b=a.centerline-a.height/2;if(a.connectionModel){var c=a.xPos+a.connectionWidth+a.connectionOffsetX;this.info_.RTL&&(c*=-1);a.connectionModel.setOffsetInBlock(c,b+a.connectionOffsetY);}}},{key:"positionStatementInputConnection_",value:function positionStatementInputConnection_(a){var b=a.getLastInput();if(null==b?0:b.connectionModel){var c=a.xPos+a.statementEdge+b.notchOffset;this.info_.RTL&&(c*=-1);b.connectionModel.setOffsetInBlock(c,a.yPos);}}},{key:"positionExternalValueConnection_",value:function positionExternalValueConnection_(a){var b=a.getLastInput();if(b&&b.connectionModel){var c=a.xPos+a.width;this.info_.RTL&&(c*=-1);b.connectionModel.setOffsetInBlock(c,a.yPos);}}},{key:"positionPreviousConnection_",value:function positionPreviousConnection_(){var a=this.info_.topRow;if(a.connection){var b=a.xPos+a.notchOffset;a.connection.connectionModel.setOffsetInBlock(this.info_.RTL?-b:b,0);}}},{key:"positionNextConnection_",value:function positionNextConnection_(){var a=this.info_.bottomRow;if(a.connection){var b=a.connection,c=b.xPos;b.connectionModel.setOffsetInBlock(this.info_.RTL?-c:c,a.baseline);}}},{key:"positionOutputConnection_",value:function positionOutputConnection_(){if(this.info_.outputConnection){var a=this.info_.startX+this.info_.outputConnection.connectionOffsetX;this.block_.outputConnection.setOffsetInBlock(this.info_.RTL?-a:a,this.info_.outputConnection.connectionOffsetY);}}}]);return Drawer$$module$build$src$core$renderers$common$drawer;}(),module$build$src$core$renderers$common$drawer={};module$build$src$core$renderers$common$drawer.Drawer=Drawer$$module$build$src$core$renderers$common$drawer;var RenderInfo$$module$build$src$core$renderers$common$info=/*#__PURE__*/function(){function RenderInfo$$module$build$src$core$renderers$common$info(a,b){_classCallCheck(this,RenderInfo$$module$build$src$core$renderers$common$info);this.statementEdge=this.width=this.widthWithChildren=this.height=0;this.rows=[];this.inputRows=[];this.hiddenIcons=[];this.startY=this.startX=0;this.renderer_=a;this.block_=b;this.constants_=this.renderer_.getConstants();this.outputConnection=b.outputConnection?new OutputConnection$$module$build$src$core$renderers$measurables$output_connection(this.constants_,b.outputConnection):null;this.isInline=b.getInputsInline()&&!b.isCollapsed();this.isCollapsed=b.isCollapsed();this.isInsertionMarker=b.isInsertionMarker();this.RTL=b.RTL;this.topRow=new TopRow$$module$build$src$core$renderers$measurables$top_row(this.constants_);this.bottomRow=new BottomRow$$module$build$src$core$renderers$measurables$bottom_row(this.constants_);}_createClass(RenderInfo$$module$build$src$core$renderers$common$info,[{key:"getRenderer",value:function getRenderer(){return this.renderer_;}},{key:"measure",value:function measure(){this.createRows_();this.addElemSpacing_();this.addRowSpacing_();this.computeBounds_();this.alignRowElements_();this.finalize_();}},{key:"createRows_",value:function createRows_(){this.populateTopRow_();this.rows.push(this.topRow);var a=new InputRow$$module$build$src$core$renderers$measurables$input_row(this.constants_);this.inputRows.push(a);var b=this.block_.getIcons();for(var c=0,d;d=b[c];c++){var e=new Icon$$module$build$src$core$renderers$measurables$icon(this.constants_,d);this.isCollapsed&&d.collapseHidden?this.hiddenIcons.push(e):a.elements.push(e);}b=void 0;for(var _c5=0,_d6;_d6=this.block_.inputList[_c5];_c5++){if(_d6.isVisible()){this.shouldStartNewRow_(_d6,b)&&(this.rows.push(a),a=new InputRow$$module$build$src$core$renderers$measurables$input_row(this.constants_),this.inputRows.push(a));for(var _e5=0,f;f=_d6.fieldRow[_e5];_e5++){a.elements.push(new Field$$module$build$src$core$renderers$measurables$field(this.constants_,f,_d6));}this.addInput_(_d6,a);b=_d6;}}this.isCollapsed&&(a.hasJaggedEdge=!0,a.elements.push(new JaggedEdge$$module$build$src$core$renderers$measurables$jagged_edge(this.constants_)));(a.elements.length||a.hasDummyInput)&&this.rows.push(a);this.populateBottomRow_();this.rows.push(this.bottomRow);}},{key:"populateTopRow_",value:function populateTopRow_(){var a=!!this.block_.previousConnection;var b=(this.block_.hat?"cap"===this.block_.hat:this.constants_.ADD_START_HATS)&&!this.outputConnection&&!a;var c=this.topRow.hasLeftSquareCorner(this.block_)?SquareCorner$$module$build$src$core$renderers$measurables$square_corner:RoundCorner$$module$build$src$core$renderers$measurables$round_corner;this.topRow.elements.push(new c(this.constants_));b?(a=new Hat$$module$build$src$core$renderers$measurables$hat(this.constants_),this.topRow.elements.push(a),this.topRow.capline=a.ascenderHeight):a&&(this.topRow.hasPreviousConnection=!0,this.topRow.connection=new PreviousConnection$$module$build$src$core$renderers$measurables$previous_connection(this.constants_,this.block_.previousConnection),this.topRow.elements.push(this.topRow.connection));this.block_.inputList.length&&this.block_.inputList[0].type===inputTypes$$module$build$src$core$input_types.STATEMENT&&!this.block_.isCollapsed()?this.topRow.minHeight=this.constants_.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT:this.topRow.minHeight=this.constants_.TOP_ROW_MIN_HEIGHT;c=this.topRow.hasRightSquareCorner(this.block_)?SquareCorner$$module$build$src$core$renderers$measurables$square_corner:RoundCorner$$module$build$src$core$renderers$measurables$round_corner;this.topRow.elements.push(new c(this.constants_,"right"));}},{key:"populateBottomRow_",value:function populateBottomRow_(){this.bottomRow.hasNextConnection=!!this.block_.nextConnection;this.bottomRow.minHeight=this.block_.inputList.length&&this.block_.inputList[this.block_.inputList.length-1].type===inputTypes$$module$build$src$core$input_types.STATEMENT?this.constants_.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT:this.constants_.BOTTOM_ROW_MIN_HEIGHT;this.bottomRow.hasLeftSquareCorner(this.block_)?this.bottomRow.elements.push(new SquareCorner$$module$build$src$core$renderers$measurables$square_corner(this.constants_)):this.bottomRow.elements.push(new RoundCorner$$module$build$src$core$renderers$measurables$round_corner(this.constants_));this.bottomRow.hasNextConnection&&(this.bottomRow.connection=new NextConnection$$module$build$src$core$renderers$measurables$next_connection(this.constants_,this.block_.nextConnection),this.bottomRow.elements.push(this.bottomRow.connection));this.bottomRow.hasRightSquareCorner(this.block_)?this.bottomRow.elements.push(new SquareCorner$$module$build$src$core$renderers$measurables$square_corner(this.constants_,"right")):this.bottomRow.elements.push(new RoundCorner$$module$build$src$core$renderers$measurables$round_corner(this.constants_,"right"));}},{key:"addInput_",value:function addInput_(a,b){this.isInline&&a.type===inputTypes$$module$build$src$core$input_types.VALUE?(b.elements.push(new InlineInput$$module$build$src$core$renderers$measurables$inline_input(this.constants_,a)),b.hasInlineInput=!0):a.type===inputTypes$$module$build$src$core$input_types.STATEMENT?(b.elements.push(new StatementInput$$module$build$src$core$renderers$measurables$statement_input(this.constants_,a)),b.hasStatement=!0):a.type===inputTypes$$module$build$src$core$input_types.VALUE?(b.elements.push(new ExternalValueInput$$module$build$src$core$renderers$measurables$external_value_input(this.constants_,a)),b.hasExternalInput=!0):a.type===inputTypes$$module$build$src$core$input_types.DUMMY&&(b.minHeight=Math.max(b.minHeight,a.getSourceBlock()&&a.getSourceBlock().isShadow()?this.constants_.DUMMY_INPUT_SHADOW_MIN_HEIGHT:this.constants_.DUMMY_INPUT_MIN_HEIGHT),b.hasDummyInput=!0);null===b.align&&(b.align=a.align);}},{key:"shouldStartNewRow_",value:function shouldStartNewRow_(a,b){return b?a.type===inputTypes$$module$build$src$core$input_types.STATEMENT||b.type===inputTypes$$module$build$src$core$input_types.STATEMENT?!0:a.type===inputTypes$$module$build$src$core$input_types.VALUE||a.type===inputTypes$$module$build$src$core$input_types.DUMMY?!this.isInline:!1:!1;}},{key:"addElemSpacing_",value:function addElemSpacing_(){for(var a=0,b;b=this.rows[a];a++){var c=b.elements;b.elements=[];b.startsWithElemSpacer()&&b.elements.push(new InRowSpacer$$module$build$src$core$renderers$measurables$in_row_spacer(this.constants_,this.getInRowSpacing_(null,c[0])));if(c.length){for(var d=0;d<c.length-1;d++){b.elements.push(c[d]);var e=this.getInRowSpacing_(c[d],c[d+1]);b.elements.push(new InRowSpacer$$module$build$src$core$renderers$measurables$in_row_spacer(this.constants_,e));}b.elements.push(c[c.length-1]);b.endsWithElemSpacer()&&b.elements.push(new InRowSpacer$$module$build$src$core$renderers$measurables$in_row_spacer(this.constants_,this.getInRowSpacing_(c[c.length-1],null)));}}}},{key:"getInRowSpacing_",value:function getInRowSpacing_(a,b){if(!a&&b&&Types$$module$build$src$core$renderers$measurables$types.isStatementInput(b))return this.constants_.STATEMENT_INPUT_PADDING_LEFT;if(a&&Types$$module$build$src$core$renderers$measurables$types.isInput(a)&&!b){if(Types$$module$build$src$core$renderers$measurables$types.isExternalInput(a))return this.constants_.NO_PADDING;if(Types$$module$build$src$core$renderers$measurables$types.isInlineInput(a))return this.constants_.LARGE_PADDING;if(Types$$module$build$src$core$renderers$measurables$types.isStatementInput(a))return this.constants_.NO_PADDING;}return a&&Types$$module$build$src$core$renderers$measurables$types.isLeftSquareCorner(a)&&b&&(Types$$module$build$src$core$renderers$measurables$types.isPreviousConnection(b)||Types$$module$build$src$core$renderers$measurables$types.isNextConnection(b))?b.notchOffset:a&&Types$$module$build$src$core$renderers$measurables$types.isLeftRoundedCorner(a)&&b&&(Types$$module$build$src$core$renderers$measurables$types.isPreviousConnection(b)||Types$$module$build$src$core$renderers$measurables$types.isNextConnection(b))?b.notchOffset-this.constants_.CORNER_RADIUS:this.constants_.MEDIUM_PADDING;}},{key:"computeBounds_",value:function computeBounds_(){var a=0,b=0,c=0;for(var e=0,f;f=this.rows[e];e++){f.measure();b=Math.max(b,f.width);if(f.hasStatement){var d=f.getLastInput();var g=void 0,h=void 0;d=f.width-(null!=(h=null==(g=d)?void 0:g.width)?h:0);a=Math.max(a,d);}c=Math.max(c,f.widthWithConnectedBlocks);}this.statementEdge=a;this.width=b;for(var _e6=0,_f4;_f4=this.rows[_e6];_e6++){_f4.hasStatement&&(_f4.statementEdge=this.statementEdge);}this.widthWithChildren=Math.max(b,c);this.outputConnection&&(this.startX=this.outputConnection.width,this.width+=this.outputConnection.width,this.widthWithChildren+=this.outputConnection.width);}},{key:"alignRowElements_",value:function alignRowElements_(){for(var b=0,c;c=this.rows[b];b++){if(c.hasStatement)this.alignStatementRow_(c);else{var a=c.width;a=this.getDesiredRowWidth_(c)-a;0<a&&this.addAlignmentPadding_(c,a);Types$$module$build$src$core$renderers$measurables$types.isTopOrBottomRow(c)&&(c.widthWithConnectedBlocks=c.width);}}}},{key:"getDesiredRowWidth_",value:function getDesiredRowWidth_(a){return this.width-this.startX;}},{key:"addAlignmentPadding_",value:function addAlignmentPadding_(a,b){var c=a.getFirstSpacer(),d=a.getLastSpacer();if(a.hasExternalInput||a.hasStatement)a.widthWithConnectedBlocks+=b;if(a.align===$.Align$$module$build$src$core$input.LEFT&&d)d.width+=b;else if(a.align===$.Align$$module$build$src$core$input.CENTRE&&c&&d)c.width+=b/2,d.width+=b/2;else if(a.align===$.Align$$module$build$src$core$input.RIGHT&&c)c.width+=b;else if(d)d.width+=b;else return;a.width+=b;}},{key:"alignStatementRow_",value:function alignStatementRow_(a){var b=a.getLastInput();if(b){var c=a.width-b.width,d=this.statementEdge;c=d-c;0<c&&this.addAlignmentPadding_(a,c);c=a.width;d=this.getDesiredRowWidth_(a);b.width+=d-c;b.height=Math.max(b.height,a.height);a.width+=d-c;a.widthWithConnectedBlocks=Math.max(a.width,this.statementEdge+a.connectedBlockWidths);}}},{key:"addRowSpacing_",value:function addRowSpacing_(){var a=this.rows;this.rows=[];for(var b=0;b<a.length;b++){this.rows.push(a[b]),b!==a.length-1&&this.rows.push(this.makeSpacerRow_(a[b],a[b+1]));}}},{key:"makeSpacerRow_",value:function makeSpacerRow_(a,b){var c=this.getSpacerRowHeight_(a,b);var d=this.getSpacerRowWidth_(a,b);c=new SpacerRow$$module$build$src$core$renderers$measurables$spacer_row(this.constants_,c,d);a.hasStatement&&(c.followsStatement=!0);b.hasStatement&&(c.precedesStatement=!0);return c;}},{key:"getSpacerRowWidth_",value:function getSpacerRowWidth_(a,b){return this.width-this.startX;}},{key:"getSpacerRowHeight_",value:function getSpacerRowHeight_(a,b){return this.constants_.MEDIUM_PADDING;}},{key:"getElemCenterline_",value:function getElemCenterline_(a,b){return Types$$module$build$src$core$renderers$measurables$types.isSpacer(b)?a.yPos+b.height/2:Types$$module$build$src$core$renderers$measurables$types.isBottomRow(a)?(a=a.yPos+a.height-a.descenderHeight,Types$$module$build$src$core$renderers$measurables$types.isNextConnection(b)?a+b.height/2:a-b.height/2):Types$$module$build$src$core$renderers$measurables$types.isTopRow(a)?Types$$module$build$src$core$renderers$measurables$types.isHat(b)?a.capline-b.height/2:a.capline+b.height/2:a.yPos+a.height/2;}},{key:"recordElemPositions_",value:function recordElemPositions_(a){var b=a.xPos;for(var c=0,d;d=a.elements[c];c++){Types$$module$build$src$core$renderers$measurables$types.isSpacer(d)&&(d.height=a.height),d.xPos=b,d.centerline=this.getElemCenterline_(a,d),b+=d.width;}}},{key:"finalize_",value:function finalize_(){var a=0,b=0;for(var c=0,d;d=this.rows[c];c++){d.yPos=b,d.xPos=this.startX,b+=d.height,a=Math.max(a,d.widthWithConnectedBlocks),this.recordElemPositions_(d);}if(this.outputConnection&&this.block_.nextConnection){var _c6=this.block_.nextConnection.targetBlock();_c6&&(a=Math.max(a,_c6.getHeightWidth().width));}this.widthWithChildren=a+this.startX;this.height=b;this.startY=this.topRow.capline;this.bottomRow.baseline=b-this.bottomRow.descenderHeight;}}]);return RenderInfo$$module$build$src$core$renderers$common$info;}(),module$build$src$core$renderers$common$info={};module$build$src$core$renderers$common$info.RenderInfo=RenderInfo$$module$build$src$core$renderers$common$info;var MarkerMove$$module$build$src$core$events$events_marker_move=/*#__PURE__*/function(_UiBase$$module$build8){_inherits(MarkerMove$$module$build$src$core$events$events_marker_move,_UiBase$$module$build8);var _super58=_createSuper(MarkerMove$$module$build$src$core$events$events_marker_move);function MarkerMove$$module$build$src$core$events$events_marker_move(a,b,c,d){var _this62;_classCallCheck(this,MarkerMove$$module$build$src$core$events$events_marker_move);var e=a?a.workspace.id:void 0;d&&d.getType()===_ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.WORKSPACE&&(e=d.getLocation().id);_this62=_super58.call(this,e);_this62.type=MARKER_MOVE$$module$build$src$core$events$utils;_this62.blockId=null==a?void 0:a.id;_this62.oldNode=c||void 0;_this62.newNode=d;_this62.isCursor=b;return _this62;}_createClass(MarkerMove$$module$build$src$core$events$events_marker_move,[{key:"toJson",value:function toJson(){var a=_get(_getPrototypeOf(MarkerMove$$module$build$src$core$events$events_marker_move.prototype),"toJson",this).call(this);if(void 0===this.isCursor)throw Error("Whether this is a cursor event or not is undefined. Either pass a value to the constructor, or call fromJson");if(!this.newNode)throw Error("The new node is undefined. Either pass a node to the constructor, or call fromJson");a.isCursor=this.isCursor;a.blockId=this.blockId;a.oldNode=this.oldNode;a.newNode=this.newNode;return a;}},{key:"fromJson",value:function fromJson(a){_get(_getPrototypeOf(MarkerMove$$module$build$src$core$events$events_marker_move.prototype),"fromJson",this).call(this,a);this.isCursor=a.isCursor;this.blockId=a.blockId;this.oldNode=a.oldNode;this.newNode=a.newNode;}}]);return MarkerMove$$module$build$src$core$events$events_marker_move;}(UiBase$$module$build$src$core$events$events_ui_base);register$$module$build$src$core$registry(Type$$module$build$src$core$registry.EVENT,MARKER_MOVE$$module$build$src$core$events$utils,MarkerMove$$module$build$src$core$events$events_marker_move);var module$build$src$core$events$events_marker_move={};module$build$src$core$events$events_marker_move.MarkerMove=MarkerMove$$module$build$src$core$events$events_marker_move;var CURSOR_CLASS$$module$build$src$core$renderers$common$marker_svg="blocklyCursor",MARKER_CLASS$$module$build$src$core$renderers$common$marker_svg="blocklyMarker",HEIGHT_MULTIPLIER$$module$build$src$core$renderers$common$marker_svg=.75,MarkerSvg$$module$build$src$core$renderers$common$marker_svg=/*#__PURE__*/function(){function MarkerSvg$$module$build$src$core$renderers$common$marker_svg(a,b,c){_classCallCheck(this,MarkerSvg$$module$build$src$core$renderers$common$marker_svg);this.workspace=a;this.marker=c;this.markerSvgRect_=this.markerSvgLine_=this.markerInput_=this.markerBlock_=this.svgGroup_=this.markerSvg_=this.currentMarkerSvg=this.parent_=null;this.constants_=b;a=this.isCursor()?this.constants_.CURSOR_COLOUR:this.constants_.MARKER_COLOUR;this.colour_=c.colour||a;}_createClass(MarkerSvg$$module$build$src$core$renderers$common$marker_svg,[{key:"getSvgRoot",value:function getSvgRoot(){return this.svgGroup_;}},{key:"getMarker",value:function getMarker(){return this.marker;}},{key:"isCursor",value:function isCursor(){return"cursor"===this.marker.type;}},{key:"createDom",value:function createDom(){var a=this.isCursor()?CURSOR_CLASS$$module$build$src$core$renderers$common$marker_svg:MARKER_CLASS$$module$build$src$core$renderers$common$marker_svg;this.svgGroup_=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.G,{"class":a});this.createDomInternal_();return this.svgGroup_;}},{key:"setParent_",value:function setParent_(a){this.isCursor()?(this.parent_&&this.parent_.setCursorSvg(null),a.setCursorSvg(this.getSvgRoot())):(this.parent_&&this.parent_.setMarkerSvg(null),a.setMarkerSvg(this.getSvgRoot()));this.parent_=a;}},{key:"draw",value:function draw(a,b){if(b){this.constants_=this.workspace.getRenderer().getConstants();var c=this.isCursor()?this.constants_.CURSOR_COLOUR:this.constants_.MARKER_COLOUR;this.colour_=this.marker.colour||c;this.applyColour_(b);this.showAtLocation_(b);this.fireMarkerEvent_(a,b);a=this.currentMarkerSvg.childNodes[0];void 0!==a&&a.beginElement&&a.beginElement();}else this.hide();}},{key:"showAtLocation_",value:function showAtLocation_(a){var b=a.getLocation().type;a.getType()===_ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.BLOCK?this.showWithBlock_(a):a.getType()===_ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.OUTPUT?this.showWithOutput_(a):b===ConnectionType$$module$build$src$core$connection_type.INPUT_VALUE?this.showWithInput_(a):b===ConnectionType$$module$build$src$core$connection_type.NEXT_STATEMENT?this.showWithNext_(a):a.getType()===_ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.PREVIOUS?this.showWithPrevious_(a):a.getType()===_ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.FIELD?this.showWithField_(a):a.getType()===_ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.WORKSPACE?this.showWithCoordinates_(a):a.getType()===_ASTNode$$module$build$src$core$keyboard_nav$ast_node.types.STACK&&this.showWithStack_(a);}},{key:"showWithBlockPrevOutput_",value:function showWithBlockPrevOutput_(a){a=a.getSourceBlock();var b=a.width;var c=a.height,d=c*HEIGHT_MULTIPLIER$$module$build$src$core$renderers$common$marker_svg;var e=this.constants_.CURSOR_BLOCK_PADDING;a.previousConnection?(c=this.constants_.shapeFor(a.previousConnection),this.positionPrevious_(b,e,d,c)):a.outputConnection?(d=this.constants_.shapeFor(a.outputConnection),this.positionOutput_(b,c,d)):this.positionBlock_(b,e,d);this.setParent_(a);this.showCurrent_();}},{key:"showWithBlock_",value:function showWithBlock_(a){this.showWithBlockPrevOutput_(a);}},{key:"showWithPrevious_",value:function showWithPrevious_(a){this.showWithBlockPrevOutput_(a);}},{key:"showWithOutput_",value:function showWithOutput_(a){this.showWithBlockPrevOutput_(a);}},{key:"showWithCoordinates_",value:function showWithCoordinates_(a){var b=a.getWsCoordinate();a=b.x;b=b.y;this.workspace.RTL&&(a-=this.constants_.CURSOR_WS_WIDTH);this.positionLine_(a,b,this.constants_.CURSOR_WS_WIDTH);this.setParent_(this.workspace);this.showCurrent_();}},{key:"showWithField_",value:function showWithField_(a){a=a.getLocation();var b=a.getSize().width,c=a.getSize().height;this.positionRect_(0,0,b,c);this.setParent_(a);this.showCurrent_();}},{key:"showWithInput_",value:function showWithInput_(a){a=a.getLocation();var b=a.getSourceBlock();this.positionInput_(a);this.setParent_(b);this.showCurrent_();}},{key:"showWithNext_",value:function showWithNext_(a){var b=a.getLocation();a=b.getSourceBlock();var c=0;b=b.getOffsetInBlock().y;var d=a.getHeightWidth().width;this.workspace.RTL&&(c=-d);this.positionLine_(c,b,d);this.setParent_(a);this.showCurrent_();}},{key:"showWithStack_",value:function showWithStack_(a){a=a.getLocation();var b=a.getHeightWidth();var c=b.width+this.constants_.CURSOR_STACK_PADDING;b=b.height+this.constants_.CURSOR_STACK_PADDING;var d=-this.constants_.CURSOR_STACK_PADDING/2,e=-this.constants_.CURSOR_STACK_PADDING/2;var f=d;this.workspace.RTL&&(f=-(c+d));this.positionRect_(f,e,c,b);this.setParent_(a);this.showCurrent_();}},{key:"showCurrent_",value:function showCurrent_(){this.hide();this.currentMarkerSvg&&(this.currentMarkerSvg.style.display="");}},{key:"positionBlock_",value:function positionBlock_(a,b,c){a=moveBy$$module$build$src$core$utils$svg_paths(-b,c)+lineOnAxis$$module$build$src$core$utils$svg_paths("V",-b)+lineOnAxis$$module$build$src$core$utils$svg_paths("H",a+2*b)+lineOnAxis$$module$build$src$core$utils$svg_paths("V",c);if(!this.markerBlock_)throw Error("createDom should be called before positioning the marker");this.markerBlock_.setAttribute("d",a);this.workspace.RTL&&this.flipRtl_(this.markerBlock_);this.currentMarkerSvg=this.markerBlock_;}},{key:"positionInput_",value:function positionInput_(a){var b=a.getOffsetInBlock().x,c=a.getOffsetInBlock().y;a=moveTo$$module$build$src$core$utils$svg_paths(0,0)+this.constants_.shapeFor(a).pathDown;this.markerInput_.setAttribute("d",a);this.markerInput_.setAttribute("transform","translate("+b+","+c+")"+(this.workspace.RTL?" scale(-1 1)":""));this.currentMarkerSvg=this.markerInput_;}},{key:"positionLine_",value:function positionLine_(a,b,c){if(!this.markerSvgLine_)throw Error("createDom should be called before positioning the line");this.markerSvgLine_.setAttribute("x","".concat(a));this.markerSvgLine_.setAttribute("y","".concat(b));this.markerSvgLine_.setAttribute("width","".concat(c));this.currentMarkerSvg=this.markerSvgLine_;}},{key:"positionOutput_",value:function positionOutput_(a,b,c){if(!this.markerBlock_)throw Error("createDom should be called before positioning the output");a=moveBy$$module$build$src$core$utils$svg_paths(a,0)+lineOnAxis$$module$build$src$core$utils$svg_paths("h",-(a-c.width))+lineOnAxis$$module$build$src$core$utils$svg_paths("v",this.constants_.TAB_OFFSET_FROM_TOP)+c.pathDown+lineOnAxis$$module$build$src$core$utils$svg_paths("V",b)+lineOnAxis$$module$build$src$core$utils$svg_paths("H",a);this.markerBlock_.setAttribute("d",a);this.workspace.RTL&&this.flipRtl_(this.markerBlock_);this.currentMarkerSvg=this.markerBlock_;}},{key:"positionPrevious_",value:function positionPrevious_(a,b,c,d){if(!this.markerBlock_)throw Error("createDom should be called before positioning the previous connection marker");a=moveBy$$module$build$src$core$utils$svg_paths(-b,c)+lineOnAxis$$module$build$src$core$utils$svg_paths("V",-b)+lineOnAxis$$module$build$src$core$utils$svg_paths("H",this.constants_.NOTCH_OFFSET_LEFT)+d.pathLeft+lineOnAxis$$module$build$src$core$utils$svg_paths("H",a+2*b)+lineOnAxis$$module$build$src$core$utils$svg_paths("V",c);this.markerBlock_.setAttribute("d",a);this.workspace.RTL&&this.flipRtl_(this.markerBlock_);this.currentMarkerSvg=this.markerBlock_;}},{key:"positionRect_",value:function positionRect_(a,b,c,d){if(!this.markerSvgRect_)throw Error("createDom should be called before positioning the rect");this.markerSvgRect_.setAttribute("x","".concat(a));this.markerSvgRect_.setAttribute("y","".concat(b));this.markerSvgRect_.setAttribute("width","".concat(c));this.markerSvgRect_.setAttribute("height","".concat(d));this.currentMarkerSvg=this.markerSvgRect_;}},{key:"flipRtl_",value:function flipRtl_(a){a.setAttribute("transform","scale(-1 1)");}},{key:"hide",value:function hide(){if(!(this.markerSvgLine_&&this.markerSvgRect_&&this.markerInput_&&this.markerBlock_))throw Error("createDom should be called before hiding the marker");this.markerSvgLine_.style.display="none";this.markerSvgRect_.style.display="none";this.markerInput_.style.display="none";this.markerBlock_.style.display="none";}},{key:"fireMarkerEvent_",value:function fireMarkerEvent_(a,b){var c=b.getSourceBlock();a=new(get$$module$build$src$core$events$utils(MARKER_MOVE$$module$build$src$core$events$utils))(c,this.isCursor(),a,b);fire$$module$build$src$core$events$utils(a);}},{key:"getBlinkProperties_",value:function getBlinkProperties_(){return{attributeType:"XML",attributeName:"fill",dur:"1s",values:this.colour_+";transparent;transparent;",repeatCount:"indefinite"};}},{key:"createDomInternal_",value:function createDomInternal_(){this.markerSvg_=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.G,{width:this.constants_.CURSOR_WS_WIDTH,height:this.constants_.WS_CURSOR_HEIGHT},this.svgGroup_);this.markerSvgLine_=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.RECT,{width:this.constants_.CURSOR_WS_WIDTH,height:this.constants_.WS_CURSOR_HEIGHT,style:"display: none"},this.markerSvg_);this.markerSvgRect_=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.RECT,{"class":"blocklyVerticalMarker",rx:10,ry:10,style:"display: none"},this.markerSvg_);this.markerInput_=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.PATH,{transform:"",style:"display: none"},this.markerSvg_);this.markerBlock_=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.PATH,{transform:"",style:"display: none",fill:"none","stroke-width":this.constants_.CURSOR_STROKE_WIDTH},this.markerSvg_);if(this.isCursor()){var a=this.getBlinkProperties_();createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.ANIMATE,a,this.markerSvgLine_);createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.ANIMATE,a,this.markerInput_);createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.ANIMATE,Object.assign({},a,{attributeName:"stroke"}),this.markerBlock_);}return this.markerSvg_;}},{key:"applyColour_",value:function applyColour_(a){if(!(this.markerSvgLine_&&this.markerSvgRect_&&this.markerInput_&&this.markerBlock_))throw Error("createDom should be called before applying color to the markerj");this.markerSvgLine_.setAttribute("fill",this.colour_);this.markerSvgRect_.setAttribute("stroke",this.colour_);this.markerInput_.setAttribute("fill",this.colour_);this.markerBlock_.setAttribute("stroke",this.colour_);this.isCursor()&&(a=this.colour_+";transparent;transparent;",this.markerSvgLine_.firstElementChild.setAttribute("values",a),this.markerInput_.firstElementChild.setAttribute("values",a),this.markerBlock_.firstElementChild.setAttribute("values",a));}},{key:"dispose",value:function dispose(){this.svgGroup_&&removeNode$$module$build$src$core$utils$dom(this.svgGroup_);}}]);return MarkerSvg$$module$build$src$core$renderers$common$marker_svg;}(),module$build$src$core$renderers$common$marker_svg={};module$build$src$core$renderers$common$marker_svg.MarkerSvg=MarkerSvg$$module$build$src$core$renderers$common$marker_svg;var PathObject$$module$build$src$core$renderers$common$path_object=/*#__PURE__*/function(){function PathObject$$module$build$src$core$renderers$common$path_object(a,b,c){_classCallCheck(this,PathObject$$module$build$src$core$renderers$common$path_object);this.markerSvg=this.cursorSvg=null;this.constants=c;this.style=b;this.svgRoot=a;this.svgPath=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.PATH,{"class":"blocklyPath"},this.svgRoot);}_createClass(PathObject$$module$build$src$core$renderers$common$path_object,[{key:"setPath",value:function setPath(a){this.svgPath.setAttribute("d",a);}},{key:"flipRTL",value:function flipRTL(){this.svgPath.setAttribute("transform","scale(-1 1)");}},{key:"setCursorSvg",value:function setCursorSvg(a){a?(this.svgRoot.appendChild(a),this.cursorSvg=a):this.cursorSvg=null;}},{key:"setMarkerSvg",value:function setMarkerSvg(a){a?(this.cursorSvg?this.svgRoot.insertBefore(a,this.cursorSvg):this.svgRoot.appendChild(a),this.markerSvg=a):this.markerSvg=null;}},{key:"applyColour",value:function applyColour(a){this.svgPath.setAttribute("stroke",this.style.colourTertiary);this.svgPath.setAttribute("fill",this.style.colourPrimary);this.updateShadow_(a.isShadow());this.updateDisabled_(!a.isEnabled()||a.getInheritedDisabled());}},{key:"setStyle",value:function setStyle(a){this.style=a;}},{key:"setClass_",value:function setClass_(a,b){a&&(b?addClass$$module$build$src$core$utils$dom(this.svgRoot,a):removeClass$$module$build$src$core$utils$dom(this.svgRoot,a));}},{key:"updateHighlighted",value:function updateHighlighted(a){a?this.svgPath.setAttribute("filter","url(#"+this.constants.embossFilterId+")"):this.svgPath.setAttribute("filter","none");}},{key:"updateShadow_",value:function updateShadow_(a){a&&(this.svgPath.setAttribute("stroke","none"),this.svgPath.setAttribute("fill",this.style.colourSecondary));}},{key:"updateDisabled_",value:function updateDisabled_(a){this.setClass_("blocklyDisabled",a);a&&this.svgPath.setAttribute("fill","url(#"+this.constants.disabledPatternId+")");}},{key:"updateSelected",value:function updateSelected(a){this.setClass_("blocklySelected",a);}},{key:"updateDraggingDelete",value:function updateDraggingDelete(a){this.setClass_("blocklyDraggingDelete",a);}},{key:"updateInsertionMarker",value:function updateInsertionMarker(a){this.setClass_("blocklyInsertionMarker",a);}},{key:"updateMovable",value:function updateMovable(a){this.setClass_("blocklyDraggable",a);}},{key:"updateReplacementFade",value:function updateReplacementFade(a){this.setClass_("blocklyReplaceable",a);}},{key:"updateShapeForInputHighlight",value:function updateShapeForInputHighlight(a,b){}}]);return PathObject$$module$build$src$core$renderers$common$path_object;}(),module$build$src$core$renderers$common$path_object={};module$build$src$core$renderers$common$path_object.PathObject=PathObject$$module$build$src$core$renderers$common$path_object;var DUPLICATE_BLOCK_ERROR$$module$build$src$core$insertion_marker_manager="The insertion marker manager tried to create a marker but the result is missing %1. If you are using a mutator, make sure your domToMutation method is properly defined.",_InsertionMarkerManager$$module$build$src$core$insertion_marker_manager=/*#__PURE__*/function(){function InsertionMarkerManager$$module$build$src$core$insertion_marker_manager(a){_classCallCheck(this,InsertionMarkerManager$$module$build$src$core$insertion_marker_manager);this.localConnection_=this.closestConnection_=this.lastMarker_=this.lastOnStack_=null;this.wouldDeleteBlock_=!1;this.fadedBlock_=this.highlightedBlock_=this.markerConnection_=null;setSelected$$module$build$src$core$common(a);this.topBlock_=a;this.workspace_=a.workspace;this.firstMarker_=this.createMarkerBlock_(this.topBlock_);this.availableConnections_=this.initAvailableConnections_();}_createClass(InsertionMarkerManager$$module$build$src$core$insertion_marker_manager,[{key:"dispose",value:function dispose(){this.availableConnections_.length=0;disable$$module$build$src$core$events$utils();try{this.firstMarker_&&this.firstMarker_.dispose(),this.lastMarker_&&this.lastMarker_.dispose();}finally{enable$$module$build$src$core$events$utils();}}},{key:"updateAvailableConnections",value:function updateAvailableConnections(){this.availableConnections_=this.initAvailableConnections_();}},{key:"wouldDeleteBlock",value:function wouldDeleteBlock(){return this.wouldDeleteBlock_;}},{key:"wouldConnectBlock",value:function wouldConnectBlock(){return!!this.closestConnection_;}},{key:"applyConnections",value:function applyConnections(){if(this.closestConnection_){if(!this.localConnection_)throw Error("Cannot apply connections because there is no local connection");disable$$module$build$src$core$events$utils();this.hidePreview_();enable$$module$build$src$core$events$utils();this.localConnection_.connect(this.closestConnection_);if(this.topBlock_.rendered){var a=this.localConnection_.isSuperior()?this.closestConnection_:this.localConnection_;connectionUiEffect$$module$build$src$core$block_animations(a.getSourceBlock());this.topBlock_.getRootBlock().bringToFront();}}}},{key:"update",value:function update(a,b){var c=this.getCandidate_(a);if((this.wouldDeleteBlock_=this.shouldDelete_(c,b))||this.shouldUpdatePreviews_(c,a))disable$$module$build$src$core$events$utils(),this.maybeHidePreview_(c),this.maybeShowPreview_(c),enable$$module$build$src$core$events$utils();}},{key:"createMarkerBlock_",value:function createMarkerBlock_(a){var b=a.type;disable$$module$build$src$core$events$utils();var c;try{c=this.workspace_.newBlock(b);c.setInsertionMarker(!0);if(a.saveExtraState){var d=a.saveExtraState();d&&c.loadExtraState&&c.loadExtraState(d);}else if(a.mutationToDom){var e=a.mutationToDom();e&&c.domToMutation&&c.domToMutation(e);}for(b=0;b<a.inputList.length;b++){var _e7=a.inputList[b];if(_e7.name===COLLAPSED_INPUT_NAME$$module$build$src$core$constants)continue;var f=c.inputList[b];if(!f)throw Error(DUPLICATE_BLOCK_ERROR$$module$build$src$core$insertion_marker_manager.replace("%1","an input"));for(d=0;d<_e7.fieldRow.length;d++){var g=_e7.fieldRow[d],h=f.fieldRow[d];if(!h)throw Error(DUPLICATE_BLOCK_ERROR$$module$build$src$core$insertion_marker_manager.replace("%1","a field"));h.setValue(g.getValue());}}c.setCollapsed(a.isCollapsed());c.setInputsInline(a.getInputsInline());c.initSvg();c.getSvgRoot().setAttribute("visibility","hidden");}finally{enable$$module$build$src$core$events$utils();}return c;}},{key:"initAvailableConnections_",value:function initAvailableConnections_(){var a=this.topBlock_.getConnections_(!1),b=this.topBlock_.lastConnectionInStack(!0);if(b&&b!==this.topBlock_.nextConnection){a.push(b);this.lastOnStack_=b;if(this.lastMarker_){disable$$module$build$src$core$events$utils();try{this.lastMarker_.dispose();}finally{enable$$module$build$src$core$events$utils();}}this.lastMarker_=this.createMarkerBlock_(b.getSourceBlock());}return a;}},{key:"shouldUpdatePreviews_",value:function shouldUpdatePreviews_(a,b){var c=a.local;var d=a.closest;a=a.radius;if(c&&d){if(this.localConnection_&&this.closestConnection_){if(this.closestConnection_===d&&this.localConnection_===c)return!1;c=this.localConnection_.x+b.x-this.closestConnection_.x;b=this.localConnection_.y+b.y-this.closestConnection_.y;b=Math.sqrt(c*c+b*b);return!(d&&a>b-$.config$$module$build$src$core$config.currentConnectionPreference);}if(this.localConnection_||this.closestConnection_)console.error("Only one of localConnection_ and closestConnection_ was set.");else return!0;}else return!(!this.localConnection_||!this.closestConnection_);console.error("Returning true from shouldUpdatePreviews, but it's not clear why.");return!0;}},{key:"getCandidate_",value:function getCandidate_(a){var b=this.getStartRadius_(),c=null,d=null;this.markerConnection_&&this.markerConnection_.isConnected()||this.updateAvailableConnections();for(var e=0;e<this.availableConnections_.length;e++){var f=this.availableConnections_[e],g=f.closest(b,a);g.connection&&(c=g.connection,d=f,b=g.radius);}return{closest:c,local:d,radius:b};}},{key:"getStartRadius_",value:function getStartRadius_(){return this.closestConnection_&&this.localConnection_?$.config$$module$build$src$core$config.connectingSnapRadius:$.config$$module$build$src$core$config.snapRadius;}},{key:"shouldDelete_",value:function shouldDelete_(a,b){return b&&this.workspace_.getComponentManager().hasCapability(b.id,ComponentManager$$module$build$src$core$component_manager.Capability.DELETE_AREA)?b.wouldDelete(this.topBlock_,a&&!!a.closest):!1;}},{key:"maybeShowPreview_",value:function maybeShowPreview_(a){if(!this.wouldDeleteBlock_){var b=a.closest;a=a.local;b&&(b===this.closestConnection_||b.getSourceBlock().isInsertionMarker()?console.log("Trying to connect to an insertion marker"):(this.closestConnection_=b,this.localConnection_=a,this.showPreview_()));}}},{key:"showPreview_",value:function showPreview_(){if(!this.closestConnection_)throw Error("Cannot show the preview because there is no closest connection");if(!this.localConnection_)throw Error("Cannot show the preview because there is no local connection");var a=this.closestConnection_,b=this.workspace_.getRenderer();switch(b.getConnectionPreviewMethod(a,this.localConnection_,this.topBlock_)){case _InsertionMarkerManager$$module$build$src$core$insertion_marker_manager.PREVIEW_TYPE.INPUT_OUTLINE:this.showInsertionInputOutline_();break;case _InsertionMarkerManager$$module$build$src$core$insertion_marker_manager.PREVIEW_TYPE.INSERTION_MARKER:this.showInsertionMarker_();break;case _InsertionMarkerManager$$module$build$src$core$insertion_marker_manager.PREVIEW_TYPE.REPLACEMENT_FADE:this.showReplacementFade_();}a&&b.shouldHighlightConnection(a)&&a.highlight();}},{key:"maybeHidePreview_",value:function maybeHidePreview_(a){if(a.closest){var b=this.closestConnection_!==a.closest;a=this.localConnection_!==a.local;this.closestConnection_&&this.localConnection_&&(b||a||this.wouldDeleteBlock_)&&this.hidePreview_();}else this.hidePreview_();this.localConnection_=this.closestConnection_=this.markerConnection_=null;}},{key:"hidePreview_",value:function hidePreview_(){this.closestConnection_&&this.closestConnection_.targetBlock()&&this.workspace_.getRenderer().shouldHighlightConnection(this.closestConnection_)&&this.closestConnection_.unhighlight();this.fadedBlock_?this.hideReplacementFade_():this.highlightedBlock_?this.hideInsertionInputOutline_():this.markerConnection_&&this.hideInsertionMarker_();}},{key:"showInsertionMarker_",value:function showInsertionMarker_(){if(!this.localConnection_)throw Error("Cannot show the insertion marker because there is no local connection");if(!this.closestConnection_)throw Error("Cannot show the insertion marker because there is no closest connection");var a=this.localConnection_,b=this.closestConnection_,c=this.lastOnStack_&&a===this.lastOnStack_;var d=c?this.lastMarker_:this.firstMarker_;if(!d)throw Error("Cannot show the insertion marker because there is no insertion marker block");var e;try{e=d.getMatchingConnection(a.getSourceBlock(),a);}catch(f){this.firstMarker_=this.createMarkerBlock_(this.topBlock_);d=c?this.lastMarker_:this.firstMarker_;if(!d)throw Error("Cannot show the insertion marker because there is no insertion marker block");e=d.getMatchingConnection(a.getSourceBlock(),a);}if(!e)throw Error("Cannot show the insertion marker because there is no associated connection");if(e===this.markerConnection_)throw Error("Made it to showInsertionMarker_ even though the marker isn't changing");d.render();d.rendered=!0;d.getSvgRoot().setAttribute("visibility","visible");e&&b&&d.positionNearConnection(e,b);b&&e.connect(b);this.markerConnection_=e;}},{key:"hideInsertionMarker_",value:function hideInsertionMarker_(){if(this.markerConnection_){var a=this.markerConnection_,b=a.getSourceBlock(),c=b.nextConnection,d=b.previousConnection,e=b.outputConnection;e=a.type===ConnectionType$$module$build$src$core$connection_type.INPUT_VALUE&&!(e&&e.targetConnection);!(a!==c||d&&d.targetConnection)||e?a.targetBlock().unplug(!1):a.type===ConnectionType$$module$build$src$core$connection_type.NEXT_STATEMENT&&a!==c?((c=a.targetConnection)&&c.getSourceBlock().unplug(!1),d=d?d.targetConnection:null,b.unplug(!0),d&&c&&d.connect(c)):b.unplug(!0);if(a.targetConnection)throw Error("markerConnection_ still connected at the end of disconnectInsertionMarker");this.markerConnection_=null;(a=b.getSvgRoot())&&a.setAttribute("visibility","hidden");}else console.log("No insertion marker connection to disconnect");}},{key:"showInsertionInputOutline_",value:function showInsertionInputOutline_(){if(!this.closestConnection_)throw Error("Cannot show the insertion marker outline because there is no closest connection");var a=this.closestConnection_;this.highlightedBlock_=a.getSourceBlock();this.highlightedBlock_.highlightShapeForInput(a,!0);}},{key:"hideInsertionInputOutline_",value:function hideInsertionInputOutline_(){if(!this.highlightedBlock_)throw Error("Cannot hide the insertion marker outline because there is no highlighted block");if(!this.closestConnection_)throw Error("Cannot hide the insertion marker outline because there is no closest connection");this.highlightedBlock_.highlightShapeForInput(this.closestConnection_,!1);this.highlightedBlock_=null;}},{key:"showReplacementFade_",value:function showReplacementFade_(){if(!this.closestConnection_)throw Error("Cannot show the replacement fade because there is no closest connection");this.fadedBlock_=this.closestConnection_.targetBlock();if(!this.fadedBlock_)throw Error("Cannot show the replacement fade because the closest connection does not have a target block");this.fadedBlock_.fadeForReplacement(!0);}},{key:"hideReplacementFade_",value:function hideReplacementFade_(){if(!this.fadedBlock_)throw Error("Cannot hide the replacement because there is no faded block");this.fadedBlock_.fadeForReplacement(!1);this.fadedBlock_=null;}},{key:"getInsertionMarkers",value:function getInsertionMarkers(){var a=[];this.firstMarker_&&a.push(this.firstMarker_);this.lastMarker_&&a.push(this.lastMarker_);return a;}}]);return InsertionMarkerManager$$module$build$src$core$insertion_marker_manager;}();(function(a){a=a.PREVIEW_TYPE||(a.PREVIEW_TYPE={});a[a.INSERTION_MARKER=0]="INSERTION_MARKER";a[a.INPUT_OUTLINE=1]="INPUT_OUTLINE";a[a.REPLACEMENT_FADE=2]="REPLACEMENT_FADE";})(_InsertionMarkerManager$$module$build$src$core$insertion_marker_manager||(_InsertionMarkerManager$$module$build$src$core$insertion_marker_manager={}));var PreviewType$$module$build$src$core$insertion_marker_manager=_InsertionMarkerManager$$module$build$src$core$insertion_marker_manager.PREVIEW_TYPE,module$build$src$core$insertion_marker_manager={};module$build$src$core$insertion_marker_manager.InsertionMarkerManager=_InsertionMarkerManager$$module$build$src$core$insertion_marker_manager;module$build$src$core$insertion_marker_manager.PreviewType=PreviewType$$module$build$src$core$insertion_marker_manager;var Renderer$$module$build$src$core$renderers$common$renderer=/*#__PURE__*/function(){function Renderer$$module$build$src$core$renderers$common$renderer(a){_classCallCheck(this,Renderer$$module$build$src$core$renderers$common$renderer);this.overrides=null;this.name=a;}_createClass(Renderer$$module$build$src$core$renderers$common$renderer,[{key:"getClassName",value:function getClassName(){return this.name+"-renderer";}},{key:"init",value:function init(a,b){this.constants_=this.makeConstants_();b&&(this.overrides=b,Object.assign(this.constants_,b));this.constants_.setTheme(a);this.constants_.init();}},{key:"createDom",value:function createDom(a,b){this.constants_.createDom(a,this.name+"-"+b.name,"."+this.getClassName()+"."+b.getClassName());}},{key:"refreshDom",value:function refreshDom(a,b){var c=this.getConstants();c.dispose();this.constants_=this.makeConstants_();this.overrides&&Object.assign(this.constants_,this.overrides);this.constants_.randomIdentifier=c.randomIdentifier;this.constants_.setTheme(b);this.constants_.init();this.createDom(a,b);}},{key:"dispose",value:function dispose(){this.constants_&&this.constants_.dispose();}},{key:"makeConstants_",value:function makeConstants_(){return new ConstantProvider$$module$build$src$core$renderers$common$constants();}},{key:"makeRenderInfo_",value:function makeRenderInfo_(a){return new RenderInfo$$module$build$src$core$renderers$common$info(this,a);}},{key:"makeDrawer_",value:function makeDrawer_(a,b){return new Drawer$$module$build$src$core$renderers$common$drawer(a,b);}},{key:"makeDebugger_",value:function makeDebugger_(){return new Debug$$module$build$src$core$renderers$common$debugger(this.getConstants());}},{key:"makeMarkerDrawer",value:function makeMarkerDrawer(a,b){return new MarkerSvg$$module$build$src$core$renderers$common$marker_svg(a,this.getConstants(),b);}},{key:"makePathObject",value:function makePathObject(a,b){return new PathObject$$module$build$src$core$renderers$common$path_object(a,b,this.constants_);}},{key:"getConstants",value:function getConstants(){return this.constants_;}},{key:"shouldHighlightConnection",value:function shouldHighlightConnection(a){return!0;}},{key:"orphanCanConnectAtEnd",value:function orphanCanConnectAtEnd(a,b,c){return!!Connection$$module$build$src$core$connection.getConnectionForOrphanedConnection(a,c===ConnectionType$$module$build$src$core$connection_type.OUTPUT_VALUE?b.outputConnection:b.previousConnection);}},{key:"getConnectionPreviewMethod",value:function getConnectionPreviewMethod(a,b,c){return b.type===ConnectionType$$module$build$src$core$connection_type.OUTPUT_VALUE||b.type===ConnectionType$$module$build$src$core$connection_type.PREVIOUS_STATEMENT?!a.isConnected()||this.orphanCanConnectAtEnd(c,a.targetBlock(),b.type)?_InsertionMarkerManager$$module$build$src$core$insertion_marker_manager.PREVIEW_TYPE.INSERTION_MARKER:_InsertionMarkerManager$$module$build$src$core$insertion_marker_manager.PREVIEW_TYPE.REPLACEMENT_FADE:_InsertionMarkerManager$$module$build$src$core$insertion_marker_manager.PREVIEW_TYPE.INSERTION_MARKER;}},{key:"render",value:function render(a){isDebuggerEnabled$$module$build$src$core$renderers$common$debug()&&!a.renderingDebugger&&(a.renderingDebugger=this.makeDebugger_());var b=this.makeRenderInfo_(a);b.measure();this.makeDrawer_(a,b).draw();}}]);return Renderer$$module$build$src$core$renderers$common$renderer;}(),module$build$src$core$renderers$common$renderer={};module$build$src$core$renderers$common$renderer.Renderer=Renderer$$module$build$src$core$renderers$common$renderer;var module$build$src$core$renderers$common$block_rendering={};module$build$src$core$renderers$common$block_rendering.BottomRow=BottomRow$$module$build$src$core$renderers$measurables$bottom_row;module$build$src$core$renderers$common$block_rendering.Connection=Connection$$module$build$src$core$renderers$measurables$connection;module$build$src$core$renderers$common$block_rendering.ConstantProvider=ConstantProvider$$module$build$src$core$renderers$common$constants;module$build$src$core$renderers$common$block_rendering.Debug=Debug$$module$build$src$core$renderers$common$debugger;module$build$src$core$renderers$common$block_rendering.Drawer=Drawer$$module$build$src$core$renderers$common$drawer;module$build$src$core$renderers$common$block_rendering.ExternalValueInput=ExternalValueInput$$module$build$src$core$renderers$measurables$external_value_input;module$build$src$core$renderers$common$block_rendering.Field=Field$$module$build$src$core$renderers$measurables$field;module$build$src$core$renderers$common$block_rendering.Hat=Hat$$module$build$src$core$renderers$measurables$hat;module$build$src$core$renderers$common$block_rendering.Icon=Icon$$module$build$src$core$renderers$measurables$icon;module$build$src$core$renderers$common$block_rendering.InRowSpacer=InRowSpacer$$module$build$src$core$renderers$measurables$in_row_spacer;module$build$src$core$renderers$common$block_rendering.InlineInput=InlineInput$$module$build$src$core$renderers$measurables$inline_input;module$build$src$core$renderers$common$block_rendering.InputConnection=InputConnection$$module$build$src$core$renderers$measurables$input_connection;module$build$src$core$renderers$common$block_rendering.InputRow=InputRow$$module$build$src$core$renderers$measurables$input_row;module$build$src$core$renderers$common$block_rendering.JaggedEdge=JaggedEdge$$module$build$src$core$renderers$measurables$jagged_edge;module$build$src$core$renderers$common$block_rendering.MarkerSvg=MarkerSvg$$module$build$src$core$renderers$common$marker_svg;module$build$src$core$renderers$common$block_rendering.Measurable=Measurable$$module$build$src$core$renderers$measurables$base;module$build$src$core$renderers$common$block_rendering.NextConnection=NextConnection$$module$build$src$core$renderers$measurables$next_connection;module$build$src$core$renderers$common$block_rendering.OutputConnection=OutputConnection$$module$build$src$core$renderers$measurables$output_connection;module$build$src$core$renderers$common$block_rendering.PathObject=PathObject$$module$build$src$core$renderers$common$path_object;module$build$src$core$renderers$common$block_rendering.PreviousConnection=PreviousConnection$$module$build$src$core$renderers$measurables$previous_connection;module$build$src$core$renderers$common$block_rendering.RenderInfo=RenderInfo$$module$build$src$core$renderers$common$info;module$build$src$core$renderers$common$block_rendering.Renderer=Renderer$$module$build$src$core$renderers$common$renderer;module$build$src$core$renderers$common$block_rendering.RoundCorner=RoundCorner$$module$build$src$core$renderers$measurables$round_corner;module$build$src$core$renderers$common$block_rendering.Row=Row$$module$build$src$core$renderers$measurables$row;module$build$src$core$renderers$common$block_rendering.SpacerRow=SpacerRow$$module$build$src$core$renderers$measurables$spacer_row;module$build$src$core$renderers$common$block_rendering.SquareCorner=SquareCorner$$module$build$src$core$renderers$measurables$square_corner;module$build$src$core$renderers$common$block_rendering.StatementInput=StatementInput$$module$build$src$core$renderers$measurables$statement_input;module$build$src$core$renderers$common$block_rendering.TopRow=TopRow$$module$build$src$core$renderers$measurables$top_row;module$build$src$core$renderers$common$block_rendering.Types=Types$$module$build$src$core$renderers$measurables$types;module$build$src$core$renderers$common$block_rendering.init=init$$module$build$src$core$renderers$common$block_rendering;module$build$src$core$renderers$common$block_rendering.register=register$$module$build$src$core$renderers$common$block_rendering;module$build$src$core$renderers$common$block_rendering.stopDebugger=stopDebugger$$module$build$src$core$renderers$common$block_rendering;module$build$src$core$renderers$common$block_rendering.unregister=unregister$$module$build$src$core$renderers$common$block_rendering;var ThemeManager$$module$build$src$core$theme_manager=/*#__PURE__*/function(){function ThemeManager$$module$build$src$core$theme_manager(a,b){_classCallCheck(this,ThemeManager$$module$build$src$core$theme_manager);this.workspace=a;this.theme=b;this.subscribedWorkspaces_=[];this.componentDB=new Map();}_createClass(ThemeManager$$module$build$src$core$theme_manager,[{key:"getTheme",value:function getTheme(){return this.theme;}},{key:"setTheme",value:function setTheme(a){var b=this.theme;this.theme=a;if(a=this.workspace.getInjectionDiv())b&&(b=b.getClassName())&&removeClass$$module$build$src$core$utils$dom(a,b),(b=this.theme.getClassName())&&addClass$$module$build$src$core$utils$dom(a,b);for(var c=0,d;d=this.subscribedWorkspaces_[c];c++){d.refreshTheme();}var _iterator17=_createForOfIteratorHelper(this.componentDB),_step17;try{for(_iterator17.s();!(_step17=_iterator17.n()).done;){var _step17$value=_slicedToArray(_step17.value,2),_c7=_step17$value[0],_d7=_step17$value[1];var _iterator19=_createForOfIteratorHelper(_d7),_step19;try{for(_iterator19.s();!(_step19=_iterator19.n()).done;){var e=_step19.value;a=e.element;b=e.propertyName;var f=this.theme&&this.theme.getComponentStyle(_c7);a.style[b]=f||"";}}catch(err){_iterator19.e(err);}finally{_iterator19.f();}}}catch(err){_iterator17.e(err);}finally{_iterator17.f();}var _iterator18=_createForOfIteratorHelper(this.subscribedWorkspaces_),_step18;try{for(_iterator18.s();!(_step18=_iterator18.n()).done;){var _c8=_step18.value;_c8.hideChaff();}}catch(err){_iterator18.e(err);}finally{_iterator18.f();}}},{key:"subscribeWorkspace",value:function subscribeWorkspace(a){this.subscribedWorkspaces_.push(a);}},{key:"unsubscribeWorkspace",value:function unsubscribeWorkspace(a){if(!removeElem$$module$build$src$core$utils$array(this.subscribedWorkspaces_,a))throw Error("Cannot unsubscribe a workspace that hasn't been subscribed.");}},{key:"subscribe",value:function subscribe(a,b,c){this.componentDB.has(b)||this.componentDB.set(b,[]);this.componentDB.get(b).push({element:a,propertyName:c});b=this.theme&&this.theme.getComponentStyle(b);a.style[c]=b||"";}},{key:"unsubscribe",value:function unsubscribe(a){if(a){var _iterator20=_createForOfIteratorHelper(this.componentDB),_step20;try{for(_iterator20.s();!(_step20=_iterator20.n()).done;){var _step20$value=_slicedToArray(_step20.value,2),b=_step20$value[0],c=_step20$value[1];for(var d=c.length-1;0<=d;d--){c[d].element===a&&c.splice(d,1);}c.length||this.componentDB["delete"](b);}}catch(err){_iterator20.e(err);}finally{_iterator20.f();}}}},{key:"dispose",value:function dispose(){this.subscribedWorkspaces_=this.theme=this.owner_=null;this.componentDB.clear();}}]);return ThemeManager$$module$build$src$core$theme_manager;}(),module$build$src$core$theme_manager={};module$build$src$core$theme_manager.ThemeManager=ThemeManager$$module$build$src$core$theme_manager;var ZOOM_IN_MULTIPLIER$$module$build$src$core$touch_gesture=5,ZOOM_OUT_MULTIPLIER$$module$build$src$core$touch_gesture=6,TouchGesture$$module$build$src$core$touch_gesture=/*#__PURE__*/function(_Gesture$$module$buil){_inherits(TouchGesture$$module$build$src$core$touch_gesture,_Gesture$$module$buil);var _super59=_createSuper(TouchGesture$$module$build$src$core$touch_gesture);function TouchGesture$$module$build$src$core$touch_gesture(){var _this63;_classCallCheck(this,TouchGesture$$module$build$src$core$touch_gesture);_this63=_super59.apply(this,arguments);_this63.isMultiTouch_=!1;_this63.cachedPoints=new Map();_this63.startDistance_=_this63.previousScale_=0;_this63.onUpWrapper_=_this63.onMoveWrapper_=_this63.isPinchZoomEnabled_=_this63.onStartWrapper_=null;return _this63;}_createClass(TouchGesture$$module$build$src$core$touch_gesture,[{key:"doStart",value:function doStart(a){if(!this.startWorkspace_)throw Error("Cannot start the touch event becauase the start workspace is undefined");this.isPinchZoomEnabled_=this.startWorkspace_.options.zoomOptions&&this.startWorkspace_.options.zoomOptions.pinch;_get(_getPrototypeOf(TouchGesture$$module$build$src$core$touch_gesture.prototype),"doStart",this).call(this,a);!this.isEnding_&&isTouchEvent$$module$build$src$core$touch(a)&&this.handleTouchStart(a);}},{key:"bindMouseEvents",value:function bindMouseEvents(a){this.onStartWrapper_=conditionalBind$$module$build$src$core$browser_events(document,"mousedown",null,this.handleStart.bind(this),!0);this.onMoveWrapper_=conditionalBind$$module$build$src$core$browser_events(document,"mousemove",null,this.handleMove.bind(this),!0);this.onUpWrapper_=conditionalBind$$module$build$src$core$browser_events(document,"mouseup",null,this.handleUp.bind(this),!0);a.preventDefault();a.stopPropagation();}},{key:"handleStart",value:function handleStart(a){!this.isDragging()&&isTouchEvent$$module$build$src$core$touch(a)&&(this.handleTouchStart(a),this.isMultiTouch()&&longStop$$module$build$src$core$touch());}},{key:"handleMove",value:function handleMove(a){this.isDragging()?shouldHandleEvent$$module$build$src$core$touch(a)&&_get(_getPrototypeOf(TouchGesture$$module$build$src$core$touch_gesture.prototype),"handleMove",this).call(this,a):this.isMultiTouch()?(isTouchEvent$$module$build$src$core$touch(a)&&this.handleTouchMove(a),longStop$$module$build$src$core$touch()):_get(_getPrototypeOf(TouchGesture$$module$build$src$core$touch_gesture.prototype),"handleMove",this).call(this,a);}},{key:"handleUp",value:function handleUp(a){isTouchEvent$$module$build$src$core$touch(a)&&!this.isDragging()&&this.handleTouchEnd(a);!this.isMultiTouch()||this.isDragging()?shouldHandleEvent$$module$build$src$core$touch(a)&&_get(_getPrototypeOf(TouchGesture$$module$build$src$core$touch_gesture.prototype),"handleUp",this).call(this,a):(a.preventDefault(),a.stopPropagation(),this.dispose());}},{key:"isMultiTouch",value:function isMultiTouch(){return this.isMultiTouch_;}},{key:"dispose",value:function dispose(){_get(_getPrototypeOf(TouchGesture$$module$build$src$core$touch_gesture.prototype),"dispose",this).call(this);this.onStartWrapper_&&unbind$$module$build$src$core$browser_events(this.onStartWrapper_);}},{key:"handleTouchStart",value:function handleTouchStart(a){var b=getTouchIdentifierFromEvent$$module$build$src$core$touch(a);this.cachedPoints.set(b,this.getTouchPoint(a));var c=Array.from(this.cachedPoints.keys());2===c.length&&(b=this.cachedPoints.get(c[0]),c=this.cachedPoints.get(c[1]),this.startDistance_=Coordinate$$module$build$src$core$utils$coordinate.distance(b,c),this.isMultiTouch_=!0,a.preventDefault());}},{key:"handleTouchMove",value:function handleTouchMove(a){var b=getTouchIdentifierFromEvent$$module$build$src$core$touch(a);this.cachedPoints.set(b,this.getTouchPoint(a));this.isPinchZoomEnabled_&&2===this.cachedPoints.size?this.handlePinch_(a):_get(_getPrototypeOf(TouchGesture$$module$build$src$core$touch_gesture.prototype),"handleMove",this).call(this,a);}},{key:"handlePinch_",value:function handlePinch_(a){var b=Array.from(this.cachedPoints.keys()),c=this.cachedPoints.get(b[0]);b=this.cachedPoints.get(b[1]);c=Coordinate$$module$build$src$core$utils$coordinate.distance(c,b)/this.startDistance_;if(0<this.previousScale_&&Infinity>this.previousScale_){b=c-this.previousScale_;b=0<b?b*ZOOM_IN_MULTIPLIER$$module$build$src$core$touch_gesture:b*ZOOM_OUT_MULTIPLIER$$module$build$src$core$touch_gesture;if(!this.startWorkspace_)throw Error("Cannot handle a pinch because the start workspace is undefined");var d=this.startWorkspace_,e=mouseToSvg$$module$build$src$core$browser_events(a,d.getParentSvg(),d.getInverseScreenCTM());d.zoom(e.x,e.y,b);}this.previousScale_=c;a.preventDefault();}},{key:"handleTouchEnd",value:function handleTouchEnd(a){a=getTouchIdentifierFromEvent$$module$build$src$core$touch(a);this.cachedPoints.has(a)&&this.cachedPoints["delete"](a);2>this.cachedPoints.size&&(this.cachedPoints.clear(),this.previousScale_=0);}},{key:"getTouchPoint",value:function getTouchPoint(a){return this.startWorkspace_?new Coordinate$$module$build$src$core$utils$coordinate(a.changedTouches?a.changedTouches[0].pageX:a.pageX,a.changedTouches?a.changedTouches[0].pageY:a.pageY):null;}}]);return TouchGesture$$module$build$src$core$touch_gesture;}(Gesture$$module$build$src$core$gesture),module$build$src$core$touch_gesture={};module$build$src$core$touch_gesture.TouchGesture=TouchGesture$$module$build$src$core$touch_gesture;var CATEGORY_NAME$$module$build$src$core$variables_dynamic="VARIABLE_DYNAMIC",onCreateVariableButtonClick_String$$module$build$src$core$variables_dynamic=stringButtonClickHandler$$module$build$src$core$variables_dynamic,onCreateVariableButtonClick_Number$$module$build$src$core$variables_dynamic=numberButtonClickHandler$$module$build$src$core$variables_dynamic,onCreateVariableButtonClick_Colour$$module$build$src$core$variables_dynamic=colourButtonClickHandler$$module$build$src$core$variables_dynamic,module$build$src$core$variables_dynamic={};module$build$src$core$variables_dynamic.CATEGORY_NAME=CATEGORY_NAME$$module$build$src$core$variables_dynamic;module$build$src$core$variables_dynamic.flyoutCategory=flyoutCategory$$module$build$src$core$variables_dynamic;module$build$src$core$variables_dynamic.flyoutCategoryBlocks=flyoutCategoryBlocks$$module$build$src$core$variables_dynamic;module$build$src$core$variables_dynamic.onCreateVariableButtonClick_Colour=colourButtonClickHandler$$module$build$src$core$variables_dynamic;module$build$src$core$variables_dynamic.onCreateVariableButtonClick_Number=numberButtonClickHandler$$module$build$src$core$variables_dynamic;module$build$src$core$variables_dynamic.onCreateVariableButtonClick_String=stringButtonClickHandler$$module$build$src$core$variables_dynamic;var ConnectionChecker$$module$build$src$core$connection_checker=/*#__PURE__*/function(){function ConnectionChecker$$module$build$src$core$connection_checker(){_classCallCheck(this,ConnectionChecker$$module$build$src$core$connection_checker);}_createClass(ConnectionChecker$$module$build$src$core$connection_checker,[{key:"canConnect",value:function canConnect(a,b,c,d){return this.canConnectWithReason(a,b,c,d)===Connection$$module$build$src$core$connection.CAN_CONNECT;}},{key:"canConnectWithReason",value:function canConnectWithReason(a,b,c,d){var e=this.doSafetyChecks(a,b);return e!==Connection$$module$build$src$core$connection.CAN_CONNECT?e:this.doTypeChecks(a,b)?c&&!this.doDragChecks(a,b,d||0)?Connection$$module$build$src$core$connection.REASON_DRAG_CHECKS_FAILED:Connection$$module$build$src$core$connection.CAN_CONNECT:Connection$$module$build$src$core$connection.REASON_CHECKS_FAILED;}},{key:"getErrorMessage",value:function getErrorMessage(a,b,c){switch(a){case Connection$$module$build$src$core$connection.REASON_SELF_CONNECTION:return"Attempted to connect a block to itself.";case Connection$$module$build$src$core$connection.REASON_DIFFERENT_WORKSPACES:return"Blocks not on same workspace.";case Connection$$module$build$src$core$connection.REASON_WRONG_TYPE:return"Attempt to connect incompatible types.";case Connection$$module$build$src$core$connection.REASON_TARGET_NULL:return"Target connection is null.";case Connection$$module$build$src$core$connection.REASON_CHECKS_FAILED:return"Connection checks failed. "+(b+" expected "+b.getCheck()+", found "+c.getCheck());case Connection$$module$build$src$core$connection.REASON_SHADOW_PARENT:return"Connecting non-shadow to shadow block.";case Connection$$module$build$src$core$connection.REASON_DRAG_CHECKS_FAILED:return"Drag checks failed.";case Connection$$module$build$src$core$connection.REASON_PREVIOUS_AND_OUTPUT:return"Block would have an output and a previous connection.";default:return"Unknown connection failure: this should never happen!";}}},{key:"doSafetyChecks",value:function doSafetyChecks(a,b){if(!a||!b)return Connection$$module$build$src$core$connection.REASON_TARGET_NULL;var c,d,e;a.isSuperior()?(c=a.getSourceBlock(),d=b.getSourceBlock(),e=b):(d=a.getSourceBlock(),c=b.getSourceBlock(),e=a,a=b);return c===d?Connection$$module$build$src$core$connection.REASON_SELF_CONNECTION:e.type!==OPPOSITE_TYPE$$module$build$src$core$internal_constants[a.type]?Connection$$module$build$src$core$connection.REASON_WRONG_TYPE:c.workspace!==d.workspace?Connection$$module$build$src$core$connection.REASON_DIFFERENT_WORKSPACES:c.isShadow()&&!d.isShadow()?Connection$$module$build$src$core$connection.REASON_SHADOW_PARENT:e.type===ConnectionType$$module$build$src$core$connection_type.OUTPUT_VALUE&&d.previousConnection&&d.previousConnection.isConnected()||e.type===ConnectionType$$module$build$src$core$connection_type.PREVIOUS_STATEMENT&&d.outputConnection&&d.outputConnection.isConnected()?Connection$$module$build$src$core$connection.REASON_PREVIOUS_AND_OUTPUT:Connection$$module$build$src$core$connection.CAN_CONNECT;}},{key:"doTypeChecks",value:function doTypeChecks(a,b){a=a.getCheck();b=b.getCheck();if(!a||!b)return!0;for(var c=0;c<a.length;c++){if(-1!==b.indexOf(a[c]))return!0;}return!1;}},{key:"doDragChecks",value:function doDragChecks(a,b,c){if(a.distanceFrom(b)>c||b.getSourceBlock().isInsertionMarker())return!1;switch(b.type){case ConnectionType$$module$build$src$core$connection_type.PREVIOUS_STATEMENT:return this.canConnectToPrevious_(a,b);case ConnectionType$$module$build$src$core$connection_type.OUTPUT_VALUE:if(b.isConnected()&&!b.targetBlock().isInsertionMarker()||a.isConnected())return!1;break;case ConnectionType$$module$build$src$core$connection_type.INPUT_VALUE:if(b.isConnected()&&!b.targetBlock().isMovable()&&!b.targetBlock().isShadow())return!1;break;case ConnectionType$$module$build$src$core$connection_type.NEXT_STATEMENT:if(b.isConnected()&&!a.getSourceBlock().nextConnection&&!b.targetBlock().isShadow()&&b.targetBlock().nextConnection)return!1;break;default:return!1;}return-1!==draggingConnections$$module$build$src$core$common.indexOf(b)?!1:!0;}},{key:"canConnectToPrevious_",value:function canConnectToPrevious_(a,b){if(a.targetConnection||-1!==draggingConnections$$module$build$src$core$common.indexOf(b))return!1;if(!b.targetConnection)return!0;a=b.targetBlock();return a.isInsertionMarker()?!a.getPreviousBlock():!1;}}]);return ConnectionChecker$$module$build$src$core$connection_checker;}();register$$module$build$src$core$registry(Type$$module$build$src$core$registry.CONNECTION_CHECKER,DEFAULT$$module$build$src$core$registry,ConnectionChecker$$module$build$src$core$connection_checker);var module$build$src$core$connection_checker={};module$build$src$core$connection_checker.ConnectionChecker=ConnectionChecker$$module$build$src$core$connection_checker;var VarDelete$$module$build$src$core$events$events_var_delete=/*#__PURE__*/function(_VarBase$$module$buil2){_inherits(VarDelete$$module$build$src$core$events$events_var_delete,_VarBase$$module$buil2);var _super60=_createSuper(VarDelete$$module$build$src$core$events$events_var_delete);function VarDelete$$module$build$src$core$events$events_var_delete(a){var _this64;_classCallCheck(this,VarDelete$$module$build$src$core$events$events_var_delete);_this64=_super60.call(this,a);_this64.type=VAR_DELETE$$module$build$src$core$events$utils;a&&(_this64.varType=a.type,_this64.varName=a.name);return _this64;}_createClass(VarDelete$$module$build$src$core$events$events_var_delete,[{key:"toJson",value:function toJson(){var a=_get(_getPrototypeOf(VarDelete$$module$build$src$core$events$events_var_delete.prototype),"toJson",this).call(this);if(!this.varType)throw Error("The var type is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");a.varType=this.varType;a.varName=this.varName;return a;}},{key:"fromJson",value:function fromJson(a){_get(_getPrototypeOf(VarDelete$$module$build$src$core$events$events_var_delete.prototype),"fromJson",this).call(this,a);this.varType=a.varType;this.varName=a.varName;}},{key:"run",value:function run(a){var b=this.getEventWorkspace_();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");a?b.deleteVariableById(this.varId):b.createVariable(this.varName,this.varType,this.varId);}}]);return VarDelete$$module$build$src$core$events$events_var_delete;}(VarBase$$module$build$src$core$events$events_var_base);register$$module$build$src$core$registry(Type$$module$build$src$core$registry.EVENT,VAR_DELETE$$module$build$src$core$events$utils,VarDelete$$module$build$src$core$events$events_var_delete);var module$build$src$core$events$events_var_delete={};module$build$src$core$events$events_var_delete.VarDelete=VarDelete$$module$build$src$core$events$events_var_delete;var VarRename$$module$build$src$core$events$events_var_rename=/*#__PURE__*/function(_VarBase$$module$buil3){_inherits(VarRename$$module$build$src$core$events$events_var_rename,_VarBase$$module$buil3);var _super61=_createSuper(VarRename$$module$build$src$core$events$events_var_rename);function VarRename$$module$build$src$core$events$events_var_rename(a,b){var _this65;_classCallCheck(this,VarRename$$module$build$src$core$events$events_var_rename);_this65=_super61.call(this,a);_this65.type=VAR_RENAME$$module$build$src$core$events$utils;a&&(_this65.oldName=a.name,_this65.newName="undefined"===typeof b?"":b);return _this65;}_createClass(VarRename$$module$build$src$core$events$events_var_rename,[{key:"toJson",value:function toJson(){var a=_get(_getPrototypeOf(VarRename$$module$build$src$core$events$events_var_rename.prototype),"toJson",this).call(this);if(!this.oldName)throw Error("The old var name is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.newName)throw Error("The new var name is undefined. Either pass a value to the constructor, or call fromJson");a.oldName=this.oldName;a.newName=this.newName;return a;}},{key:"fromJson",value:function fromJson(a){_get(_getPrototypeOf(VarRename$$module$build$src$core$events$events_var_rename.prototype),"fromJson",this).call(this,a);this.oldName=a.oldName;this.newName=a.newName;}},{key:"run",value:function run(a){var b=this.getEventWorkspace_();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.oldName)throw Error("The old var name is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.newName)throw Error("The new var name is undefined. Either pass a value to the constructor, or call fromJson");a?b.renameVariableById(this.varId,this.newName):b.renameVariableById(this.varId,this.oldName);}}]);return VarRename$$module$build$src$core$events$events_var_rename;}(VarBase$$module$build$src$core$events$events_var_base);register$$module$build$src$core$registry(Type$$module$build$src$core$registry.EVENT,VAR_RENAME$$module$build$src$core$events$utils,VarRename$$module$build$src$core$events$events_var_rename);var module$build$src$core$events$events_var_rename={};module$build$src$core$events$events_var_rename.VarRename=VarRename$$module$build$src$core$events$events_var_rename;var VariableMap$$module$build$src$core$variable_map=/*#__PURE__*/function(){function VariableMap$$module$build$src$core$variable_map(a){_classCallCheck(this,VariableMap$$module$build$src$core$variable_map);this.workspace=a;this.variableMap=new Map();}_createClass(VariableMap$$module$build$src$core$variable_map,[{key:"clear",value:function clear(){this.variableMap.clear();}},{key:"renameVariable",value:function renameVariable(a,b){var c=this.getVariable(b,a.type),d=this.workspace.getAllBlocks(!1);setGroup$$module$build$src$core$events$utils(!0);try{c&&c.getId()!==a.getId()?this.renameVariableWithConflict_(a,b,c,d):this.renameVariableAndUses_(a,b,d);}finally{setGroup$$module$build$src$core$events$utils(!1);}}},{key:"renameVariableById",value:function renameVariableById(a,b){var c=this.getVariableById(a);if(!c)throw Error("Tried to rename a variable that didn't exist. ID: "+a);this.renameVariable(c,b);}},{key:"renameVariableAndUses_",value:function renameVariableAndUses_(a,b,c){fire$$module$build$src$core$events$utils(new(get$$module$build$src$core$events$utils(VAR_RENAME$$module$build$src$core$events$utils))(a,b));a.name=b;for(b=0;b<c.length;b++){c[b].updateVarName(a);}}},{key:"renameVariableWithConflict_",value:function renameVariableWithConflict_(a,b,c,d){var e=a.type;b!==c.name&&this.renameVariableAndUses_(c,b,d);for(b=0;b<d.length;b++){d[b].renameVarById(a.getId(),c.getId());}fire$$module$build$src$core$events$utils(new(get$$module$build$src$core$events$utils(VAR_DELETE$$module$build$src$core$events$utils))(a));removeElem$$module$build$src$core$utils$array(this.variableMap.get(e),a);}},{key:"createVariable",value:function createVariable(a,b,c){var d=this.getVariable(a,b);if(d){if(c&&d.getId()!==c)throw Error('Variable "'+a+'" is already in use and its id is "'+d.getId()+'" which conflicts with the passed in id, "'+c+'".');return d;}if(c&&this.getVariableById(c))throw Error('Variable id, "'+c+'", is already in use.');d=c||genUid$$module$build$src$core$utils$idgenerator();b=b||"";d=new VariableModel$$module$build$src$core$variable_model(this.workspace,a,b,d);a=this.variableMap.get(b)||[];a.push(d);this.variableMap["delete"](b);this.variableMap.set(b,a);return d;}},{key:"deleteVariable",value:function deleteVariable(a){var b=a.getId(),c=this.variableMap.get(a.type);if(c)for(var d=0;d<c.length;d++){if(c[d].getId()===b){c.splice(d,1);fire$$module$build$src$core$events$utils(new(get$$module$build$src$core$events$utils(VAR_DELETE$$module$build$src$core$events$utils))(a));break;}}}},{key:"deleteVariableById",value:function deleteVariableById(a){var _this66=this;var b=this.getVariableById(a);if(b){var c=b.name;var d=this.getVariableUsesById(a);for(var e=0,f;f=d[e];e++){if("procedures_defnoreturn"===f.type||"procedures_defreturn"===f.type){a=String(f.getFieldValue("NAME"));c=Msg$$module$build$src$core$msg.CANNOT_DELETE_VARIABLE_PROCEDURE.replace("%1",c).replace("%2",a);alert$$module$build$src$core$dialog(c);return;}}1<d.length?(c=Msg$$module$build$src$core$msg.DELETE_VARIABLE_CONFIRMATION.replace("%1",String(d.length)).replace("%2",c),confirm$$module$build$src$core$dialog(c,function(e){e&&b&&_this66.deleteVariableInternal(b,d);})):this.deleteVariableInternal(b,d);}else console.warn("Can't delete non-existent variable: "+a);}},{key:"deleteVariableInternal",value:function deleteVariableInternal(a,b){var c=getGroup$$module$build$src$core$events$utils();c||setGroup$$module$build$src$core$events$utils(!0);try{for(var d=0;d<b.length;d++){b[d].dispose(!0);}this.deleteVariable(a);}finally{c||setGroup$$module$build$src$core$events$utils(!1);}}},{key:"getVariable",value:function getVariable(a,b){if(b=this.variableMap.get(b||""))for(var c=0,d;d=b[c];c++){if(Names$$module$build$src$core$names.equals(d.name,a))return d;}return null;}},{key:"getVariableById",value:function getVariableById(a){var _iterator21=_createForOfIteratorHelper(this.variableMap),_step21;try{for(_iterator21.s();!(_step21=_iterator21.n()).done;){var _step21$value=_slicedToArray(_step21.value,2),b=_step21$value[1];var _iterator22=_createForOfIteratorHelper(b),_step22;try{for(_iterator22.s();!(_step22=_iterator22.n()).done;){var c=_step22.value;if(c.getId()===a)return c;}}catch(err){_iterator22.e(err);}finally{_iterator22.f();}}}catch(err){_iterator21.e(err);}finally{_iterator21.f();}return null;}},{key:"getVariablesOfType",value:function getVariablesOfType(a){return(a=this.variableMap.get(a||""))?a.slice():[];}},{key:"getVariableTypes",value:function getVariableTypes(a){var b=new Set(this.variableMap.keys());if(a&&a.getPotentialVariableMap()){var _iterator23=_createForOfIteratorHelper(a.getPotentialVariableMap().variableMap.keys()),_step23;try{for(_iterator23.s();!(_step23=_iterator23.n()).done;){var c=_step23.value;b.add(c);}}catch(err){_iterator23.e(err);}finally{_iterator23.f();}}b.has("")||b.add("");return Array.from(b.values());}},{key:"getAllVariables",value:function getAllVariables(){var a=[];var _iterator24=_createForOfIteratorHelper(this.variableMap.values()),_step24;try{for(_iterator24.s();!(_step24=_iterator24.n()).done;){var b=_step24.value;a=a.concat(b);}}catch(err){_iterator24.e(err);}finally{_iterator24.f();}return a;}},{key:"getAllVariableNames",value:function getAllVariableNames(){return Array.from(this.variableMap.values()).flat().map(function(a){return a.name;});}},{key:"getVariableUsesById",value:function getVariableUsesById(a){var b=[],c=this.workspace.getAllBlocks(!1);for(var d=0;d<c.length;d++){var e=c[d].getVarModels();if(e)for(var f=0;f<e.length;f++){e[f].getId()===a&&b.push(c[d]);}}return b;}}]);return VariableMap$$module$build$src$core$variable_map;}(),module$build$src$core$variable_map={};module$build$src$core$variable_map.VariableMap=VariableMap$$module$build$src$core$variable_map;var Workspace$$module$build$src$core$workspace=/*#__PURE__*/function(){function Workspace$$module$build$src$core$workspace(a){_classCallCheck(this,Workspace$$module$build$src$core$workspace);this.isClearing=this.internalIsMutator=this.internalIsFlyout=this.rendered=!1;this.MAX_UNDO=1024;this.connectionDBList=[];this.topBlocks=[];this.topComments=[];this.commentDB=new Map();this.listeners=[];this.undoStack_=[];this.redoStack_=[];this.blockDB=new Map();this.typedBlocksDB=new Map();this.procedureMap=new ObservableProcedureMap$$module$build$src$core$procedures$observable_procedure_map(this);this.potentialVariableMap=null;this.id=genUid$$module$build$src$core$utils$idgenerator();registerWorkspace$$module$build$src$core$common(this);this.options=a||new Options$$module$build$src$core$options({});this.RTL=!!this.options.RTL;this.horizontalLayout=!!this.options.horizontalLayout;this.toolboxPosition=this.options.toolboxPosition;this.connectionChecker=new(getClassFromOptions$$module$build$src$core$registry(Type$$module$build$src$core$registry.CONNECTION_CHECKER,this.options,!0))(this);this.variableMap=new VariableMap$$module$build$src$core$variable_map(this);}_createClass(Workspace$$module$build$src$core$workspace,[{key:"isFlyout",get:function get(){return this.internalIsFlyout;}},{key:"isMutator",get:function get(){return this.internalIsMutator;}},{key:"dispose",value:function dispose(){this.listeners.length=0;this.clear();unregisterWorkpace$$module$build$src$core$common(this);}},{key:"sortObjects_",value:function sortObjects_(a,b){a=a.getRelativeToSurfaceXY();b=b.getRelativeToSurfaceXY();return a.y+Workspace$$module$build$src$core$workspace.prototype.sortObjects_.offset*a.x-(b.y+Workspace$$module$build$src$core$workspace.prototype.sortObjects_.offset*b.x);}},{key:"addTopBlock",value:function addTopBlock(a){this.topBlocks.push(a);}},{key:"removeTopBlock",value:function removeTopBlock(a){if(!removeElem$$module$build$src$core$utils$array(this.topBlocks,a))throw Error("Block not present in workspace's list of top-most blocks.");}},{key:"getTopBlocks",value:function getTopBlocks(a){var b=[].concat(this.topBlocks);a&&1<b.length&&(this.sortObjects_.offset=Math.sin(toRadians$$module$build$src$core$utils$math(Workspace$$module$build$src$core$workspace.SCAN_ANGLE)),this.RTL&&(this.sortObjects_.offset*=-1),b.sort(this.sortObjects_));return b;}},{key:"addTypedBlock",value:function addTypedBlock(a){this.typedBlocksDB.has(a.type)||this.typedBlocksDB.set(a.type,[]);this.typedBlocksDB.get(a.type).push(a);}},{key:"removeTypedBlock",value:function removeTypedBlock(a){removeElem$$module$build$src$core$utils$array(this.typedBlocksDB.get(a.type),a);this.typedBlocksDB.get(a.type).length||this.typedBlocksDB["delete"](a.type);}},{key:"getBlocksByType",value:function getBlocksByType(a,b){if(!this.typedBlocksDB.has(a))return[];a=this.typedBlocksDB.get(a).slice(0);b&&a&&1<a.length&&(this.sortObjects_.offset=Math.sin(toRadians$$module$build$src$core$utils$math(Workspace$$module$build$src$core$workspace.SCAN_ANGLE)),this.RTL&&(this.sortObjects_.offset*=-1),a.sort(this.sortObjects_));return a.filter(function(c){return!c.isInsertionMarker();});}},{key:"addTopComment",value:function addTopComment(a){this.topComments.push(a);this.commentDB.has(a.id)&&console.warn('Overriding an existing comment on this workspace, with id "'+a.id+'"');this.commentDB.set(a.id,a);}},{key:"removeTopComment",value:function removeTopComment(a){if(!removeElem$$module$build$src$core$utils$array(this.topComments,a))throw Error("Comment not present in workspace's list of top-most comments.");this.commentDB["delete"](a.id);}},{key:"getTopComments",value:function getTopComments(a){var b=[].concat(this.topComments);a&&1<b.length&&(this.sortObjects_.offset=Math.sin(toRadians$$module$build$src$core$utils$math(Workspace$$module$build$src$core$workspace.SCAN_ANGLE)),this.RTL&&(this.sortObjects_.offset*=-1),b.sort(this.sortObjects_));return b;}},{key:"getAllBlocks",value:function getAllBlocks(a){if(a){var b=this.getTopBlocks(!0);a=[];for(var c=0;c<b.length;c++){var _a2;(_a2=a).push.apply(_a2,_toConsumableArray(b[c].getDescendants(!0)));}}else for(a=this.getTopBlocks(!1),b=0;b<a.length;b++){var _a3;(_a3=a).push.apply(_a3,_toConsumableArray(a[b].getChildren(!1)));}return a.filter(function(c){return!c.isInsertionMarker();});}},{key:"clear",value:function clear(){this.isClearing=!0;try{var a=getGroup$$module$build$src$core$events$utils();for(a||setGroup$$module$build$src$core$events$utils(!0);this.topBlocks.length;){this.topBlocks[0].dispose(!1);}for(;this.topComments.length;){this.topComments[this.topComments.length-1].dispose();}a||setGroup$$module$build$src$core$events$utils(!1);this.variableMap.clear();this.potentialVariableMap&&this.potentialVariableMap.clear();}finally{this.isClearing=!1;}}},{key:"renameVariableById",value:function renameVariableById(a,b){this.variableMap.renameVariableById(a,b);}},{key:"createVariable",value:function createVariable(a,b,c){return this.variableMap.createVariable(a,b,c);}},{key:"getVariableUsesById",value:function getVariableUsesById(a){return this.variableMap.getVariableUsesById(a);}},{key:"deleteVariableById",value:function deleteVariableById(a){this.variableMap.deleteVariableById(a);}},{key:"getVariable",value:function getVariable(a,b){return this.variableMap.getVariable(a,b);}},{key:"getVariableById",value:function getVariableById(a){return this.variableMap.getVariableById(a);}},{key:"getVariablesOfType",value:function getVariablesOfType(a){return this.variableMap.getVariablesOfType(a);}},{key:"getVariableTypes",value:function getVariableTypes(){return this.variableMap.getVariableTypes(this);}},{key:"getAllVariables",value:function getAllVariables(){return this.variableMap.getAllVariables();}},{key:"getAllVariableNames",value:function getAllVariableNames(){return this.variableMap.getAllVariableNames();}},{key:"getWidth",value:function getWidth(){return 0;}},{key:"newBlock",value:function newBlock(a,b){throw Error("The implementation of newBlock should be monkey-patched in by blockly.ts");}},{key:"remainingCapacity",value:function remainingCapacity(){return isNaN(this.options.maxBlocks)?Infinity:this.options.maxBlocks-this.getAllBlocks(!1).length;}},{key:"remainingCapacityOfType",value:function remainingCapacityOfType(a){return this.options.maxInstances?(void 0!==this.options.maxInstances[a]?this.options.maxInstances[a]:Infinity)-this.getBlocksByType(a,!1).length:Infinity;}},{key:"isCapacityAvailable",value:function isCapacityAvailable(a){if(!this.hasBlockLimits())return!0;var b=0;for(var c in a){if(a[c]>this.remainingCapacityOfType(c))return!1;b+=a[c];}return b>this.remainingCapacity()?!1:!0;}},{key:"hasBlockLimits",value:function hasBlockLimits(){return Infinity!==this.options.maxBlocks||!!this.options.maxInstances;}},{key:"getUndoStack",value:function getUndoStack(){return this.undoStack_;}},{key:"getRedoStack",value:function getRedoStack(){return this.redoStack_;}},{key:"undo",value:function undo(a){var b=a?this.redoStack_:this.undoStack_,c=a?this.undoStack_:this.redoStack_;var d=b.pop();if(d){for(var e=[d];b.length&&d.group&&d.group===b[b.length-1].group;){e.push(b.pop());}for(b=0;b<e.length;b++){c.push(e[b]);}e=filter$$module$build$src$core$events$utils(e,a);setRecordUndo$$module$build$src$core$events$utils(!1);try{for(c=0;c<e.length;c++){e[c].run(a);}}finally{setRecordUndo$$module$build$src$core$events$utils(!0);}}}},{key:"clearUndo",value:function clearUndo(){this.undoStack_.length=0;this.redoStack_.length=0;clearPendingUndo$$module$build$src$core$events$utils();}},{key:"addChangeListener",value:function addChangeListener(a){this.listeners.push(a);return a;}},{key:"removeChangeListener",value:function removeChangeListener(a){removeElem$$module$build$src$core$utils$array(this.listeners,a);}},{key:"fireChangeListener",value:function fireChangeListener(a){if(a.recordUndo)for(this.undoStack_.push(a),this.redoStack_.length=0;this.undoStack_.length>this.MAX_UNDO&&0<=this.MAX_UNDO;){this.undoStack_.shift();}for(var b=0;b<this.listeners.length;b++){(0,this.listeners[b])(a);}}},{key:"getBlockById",value:function getBlockById(a){return this.blockDB.get(a)||null;}},{key:"setBlockById",value:function setBlockById(a,b){this.blockDB.set(a,b);}},{key:"removeBlockById",value:function removeBlockById(a){this.blockDB["delete"](a);}},{key:"getCommentById",value:function getCommentById(a){var b;return null!=(b=this.commentDB.get(a))?b:null;}},{key:"allInputsFilled",value:function allInputsFilled(a){var b=this.getTopBlocks(!1);for(var c=0;c<b.length;c++){if(!b[c].allInputsFilled(a))return!1;}return!0;}},{key:"getPotentialVariableMap",value:function getPotentialVariableMap(){return this.potentialVariableMap;}},{key:"createPotentialVariableMap",value:function createPotentialVariableMap(){this.potentialVariableMap=new VariableMap$$module$build$src$core$variable_map(this);}},{key:"getVariableMap",value:function getVariableMap(){return this.variableMap;}},{key:"setVariableMap",value:function setVariableMap(a){this.variableMap=a;}},{key:"getProcedureMap",value:function getProcedureMap(){return this.procedureMap;}}],[{key:"getById",value:function getById(a){return getWorkspaceById$$module$build$src$core$common(a);}},{key:"getAll",value:function getAll(){return getAllWorkspaces$$module$build$src$core$common();}}]);return Workspace$$module$build$src$core$workspace;}();Workspace$$module$build$src$core$workspace.SCAN_ANGLE=3;var module$build$src$core$workspace={};module$build$src$core$workspace.Workspace=Workspace$$module$build$src$core$workspace;var SOUND_LIMIT$$module$build$src$core$workspace_audio=100,WorkspaceAudio$$module$build$src$core$workspace_audio=/*#__PURE__*/function(){function WorkspaceAudio$$module$build$src$core$workspace_audio(a){_classCallCheck(this,WorkspaceAudio$$module$build$src$core$workspace_audio);this.parentWorkspace=a;this.sounds=new Map();this.lastSound_=null;}_createClass(WorkspaceAudio$$module$build$src$core$workspace_audio,[{key:"dispose",value:function dispose(){this.sounds.clear();}},{key:"load",value:function load(a,b){if(a.length){try{var c=new globalThis.Audio();}catch(e){return;}for(var e=0;e<a.length;e++){var f=a[e],g=f.match(/\.(\w+)$/);if(g&&c.canPlayType("audio/"+g[1])){var d=new globalThis.Audio(f);break;}}d&&this.sounds.set(b,d);}}},{key:"preload",value:function preload(){var _iterator25=_createForOfIteratorHelper(this.sounds.values()),_step25;try{for(_iterator25.s();!(_step25=_iterator25.n()).done;){var a=_step25.value;a.volume=.01;var b=a.play();void 0!==b?b.then(a.pause)["catch"](function(){}):a.pause();if(IPAD$$module$build$src$core$utils$useragent||IPHONE$$module$build$src$core$utils$useragent)break;}}catch(err){_iterator25.e(err);}finally{_iterator25.f();}}},{key:"play",value:function play(a,b){var c=this.sounds.get(a);c?(a=new Date(),null!==this.lastSound_&&a.getTime()-this.lastSound_.getTime()<SOUND_LIMIT$$module$build$src$core$workspace_audio||(this.lastSound_=a,c=IPAD$$module$build$src$core$utils$useragent||ANDROID$$module$build$src$core$utils$useragent?c:c.cloneNode(),c.volume=void 0===b?1:b,c.play())):this.parentWorkspace&&this.parentWorkspace.getAudioManager().play(a,b);}}]);return WorkspaceAudio$$module$build$src$core$workspace_audio;}(),module$build$src$core$workspace_audio={};module$build$src$core$workspace_audio.WorkspaceAudio=WorkspaceAudio$$module$build$src$core$workspace_audio;var ZoomControls$$module$build$src$core$zoom_controls=/*#__PURE__*/function(){function ZoomControls$$module$build$src$core$zoom_controls(a){_classCallCheck(this,ZoomControls$$module$build$src$core$zoom_controls);this.workspace=a;this.id="zoomControls";this.zoomResetGroup=this.zoomOutGroup=this.zoomInGroup=this.onZoomOutWrapper=this.onZoomInWrapper=this.onZoomResetWrapper=null;this.HEIGHT=this.WIDTH=32;this.SMALL_SPACING=2;this.LARGE_SPACING=11;this.MARGIN_HORIZONTAL=this.MARGIN_VERTICAL=20;this.svgGroup=null;this.top=this.left=0;this.initialized=!1;}_createClass(ZoomControls$$module$build$src$core$zoom_controls,[{key:"createDom",value:function createDom(){this.svgGroup=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.G,{});var a=String(Math.random()).substring(2);this.createZoomOutSvg(a);this.createZoomInSvg(a);this.workspace.isMovable()&&this.createZoomResetSvg(a);return this.svgGroup;}},{key:"init",value:function init(){this.workspace.getComponentManager().addComponent({component:this,weight:2,capabilities:[ComponentManager$$module$build$src$core$component_manager.Capability.POSITIONABLE]});this.initialized=!0;}},{key:"dispose",value:function dispose(){this.workspace.getComponentManager().removeComponent("zoomControls");this.svgGroup&&removeNode$$module$build$src$core$utils$dom(this.svgGroup);this.onZoomResetWrapper&&unbind$$module$build$src$core$browser_events(this.onZoomResetWrapper);this.onZoomInWrapper&&unbind$$module$build$src$core$browser_events(this.onZoomInWrapper);this.onZoomOutWrapper&&unbind$$module$build$src$core$browser_events(this.onZoomOutWrapper);}},{key:"getBoundingRectangle",value:function getBoundingRectangle(){var a=this.SMALL_SPACING+2*this.HEIGHT;this.zoomResetGroup&&(a+=this.LARGE_SPACING+this.HEIGHT);return new Rect$$module$build$src$core$utils$rect(this.top,this.top+a,this.left,this.left+this.WIDTH);}},{key:"position",value:function position(a,b){if(this.initialized){var c=getCornerOppositeToolbox$$module$build$src$core$positionable_helpers(this.workspace,a),d=this.SMALL_SPACING+2*this.HEIGHT;this.zoomResetGroup&&(d+=this.LARGE_SPACING+this.HEIGHT);a=getStartPositionRect$$module$build$src$core$positionable_helpers(c,new Size$$module$build$src$core$utils$size(this.WIDTH,d),this.MARGIN_HORIZONTAL,this.MARGIN_VERTICAL,a,this.workspace);c=c.vertical;b=bumpPositionRect$$module$build$src$core$positionable_helpers(a,this.MARGIN_VERTICAL,c===verticalPosition$$module$build$src$core$positionable_helpers.TOP?bumpDirection$$module$build$src$core$positionable_helpers.DOWN:bumpDirection$$module$build$src$core$positionable_helpers.UP,b);if(c===verticalPosition$$module$build$src$core$positionable_helpers.TOP){var e=this.SMALL_SPACING+this.HEIGHT,f;null==(f=this.zoomInGroup)||f.setAttribute("transform","translate(0, "+e+")");this.zoomResetGroup&&this.zoomResetGroup.setAttribute("transform","translate(0, "+(e+this.LARGE_SPACING+this.HEIGHT)+")");}else{f=this.zoomResetGroup?this.LARGE_SPACING+this.HEIGHT:0;var h;null==(h=this.zoomInGroup)||h.setAttribute("transform","translate(0, "+f+")");f=f+this.SMALL_SPACING+this.HEIGHT;null==(e=this.zoomOutGroup)||e.setAttribute("transform","translate(0, "+f+")");}this.top=b.top;this.left=b.left;var g;null==(g=this.svgGroup)||g.setAttribute("transform","translate("+this.left+","+this.top+")");}}},{key:"createZoomOutSvg",value:function createZoomOutSvg(a){this.zoomOutGroup=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.G,{"class":"blocklyZoom"},this.svgGroup);var b=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.CLIPPATH,{id:"blocklyZoomoutClipPath"+a},this.zoomOutGroup);createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.RECT,{width:32,height:32},b);createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.IMAGE,{width:SPRITE$$module$build$src$core$sprites.width,height:SPRITE$$module$build$src$core$sprites.height,x:-64,y:-92,"clip-path":"url(#blocklyZoomoutClipPath"+a+")"},this.zoomOutGroup).setAttributeNS(XLINK_NS$$module$build$src$core$utils$dom,"xlink:href",this.workspace.options.pathToMedia+SPRITE$$module$build$src$core$sprites.url);this.onZoomOutWrapper=conditionalBind$$module$build$src$core$browser_events(this.zoomOutGroup,"mousedown",null,this.zoom.bind(this,-1));}},{key:"createZoomInSvg",value:function createZoomInSvg(a){this.zoomInGroup=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.G,{"class":"blocklyZoom"},this.svgGroup);var b=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.CLIPPATH,{id:"blocklyZoominClipPath"+a},this.zoomInGroup);createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.RECT,{width:32,height:32},b);createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.IMAGE,{width:SPRITE$$module$build$src$core$sprites.width,height:SPRITE$$module$build$src$core$sprites.height,x:-32,y:-92,"clip-path":"url(#blocklyZoominClipPath"+a+")"},this.zoomInGroup).setAttributeNS(XLINK_NS$$module$build$src$core$utils$dom,"xlink:href",this.workspace.options.pathToMedia+SPRITE$$module$build$src$core$sprites.url);this.onZoomInWrapper=conditionalBind$$module$build$src$core$browser_events(this.zoomInGroup,"mousedown",null,this.zoom.bind(this,1));}},{key:"zoom",value:function zoom(a,b){this.workspace.markFocused();this.workspace.zoomCenter(a);this.fireZoomEvent();clearTouchIdentifier$$module$build$src$core$touch();b.stopPropagation();b.preventDefault();}},{key:"createZoomResetSvg",value:function createZoomResetSvg(a){this.zoomResetGroup=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.G,{"class":"blocklyZoom"},this.svgGroup);var b=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.CLIPPATH,{id:"blocklyZoomresetClipPath"+a},this.zoomResetGroup);createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.RECT,{width:32,height:32},b);createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.IMAGE,{width:SPRITE$$module$build$src$core$sprites.width,height:SPRITE$$module$build$src$core$sprites.height,y:-92,"clip-path":"url(#blocklyZoomresetClipPath"+a+")"},this.zoomResetGroup).setAttributeNS(XLINK_NS$$module$build$src$core$utils$dom,"xlink:href",this.workspace.options.pathToMedia+SPRITE$$module$build$src$core$sprites.url);this.onZoomResetWrapper=conditionalBind$$module$build$src$core$browser_events(this.zoomResetGroup,"mousedown",null,this.resetZoom.bind(this));}},{key:"resetZoom",value:function resetZoom(a){this.workspace.markFocused();var b=Math.log(this.workspace.options.zoomOptions.startScale/this.workspace.scale)/Math.log(this.workspace.options.zoomOptions.scaleSpeed);this.workspace.beginCanvasTransition();this.workspace.zoomCenter(b);this.workspace.scrollCenter();setTimeout(this.workspace.endCanvasTransition.bind(this.workspace),500);this.fireZoomEvent();clearTouchIdentifier$$module$build$src$core$touch();a.stopPropagation();a.preventDefault();}},{key:"fireZoomEvent",value:function fireZoomEvent(){var a=new(get$$module$build$src$core$events$utils(CLICK$$module$build$src$core$events$utils))(null,this.workspace.id,"zoom_controls");fire$$module$build$src$core$events$utils(a);}}]);return ZoomControls$$module$build$src$core$zoom_controls;}();register$$module$build$src$core$css("\n.blocklyZoom>image, .blocklyZoom>svg>image {\n  opacity: .4;\n}\n\n.blocklyZoom>image:hover, .blocklyZoom>svg>image:hover {\n  opacity: .6;\n}\n\n.blocklyZoom>image:active, .blocklyZoom>svg>image:active {\n  opacity: .8;\n}\n");var module$build$src$core$zoom_controls={};module$build$src$core$zoom_controls.ZoomControls=ZoomControls$$module$build$src$core$zoom_controls;var ZOOM_TO_FIT_MARGIN$$module$build$src$core$workspace_svg=20,WorkspaceSvg$$module$build$src$core$workspace_svg=/*#__PURE__*/function(_Workspace$$module$bu){_inherits(WorkspaceSvg$$module$build$src$core$workspace_svg,_Workspace$$module$bu);var _super62=_createSuper(WorkspaceSvg$$module$build$src$core$workspace_svg);function WorkspaceSvg$$module$build$src$core$workspace_svg(a,b,c){var _this67;_classCallCheck(this,WorkspaceSvg$$module$build$src$core$workspace_svg);_this67=_super62.call(this,a);_this67.resizeHandlerWrapper=null;_this67.resizesEnabled=_this67.isVisible_=_this67.rendered=!0;_this67.startScrollY=_this67.startScrollX=_this67.scrollY=_this67.scrollX=0;_this67.dragDeltaXY=null;_this67.oldScale=_this67.scale=1;_this67.oldLeft=_this67.oldTop=0;_this67.workspaceDragSurface=_this67.blockDragSurface=_this67.currentGesture_=_this67.toolbox_=_this67.flyout=_this67.scrollbar=_this67.trashcan=null;_this67.isDragSurfaceActive=!1;_this67.inverseScreenCTM=_this67.targetWorkspace=_this67.configureContextMenu=_this67.lastRecordedPageScroll=_this67.injectionDiv=null;_this67.inverseScreenCTMDirty=!0;_this67.highlightedBlocks=[];_this67.toolboxCategoryCallbacks=new Map();_this67.flyoutButtonCallbacks=new Map();_this67.cachedParentSvg=null;_this67.keyboardAccessibilityMode=!1;_this67.topBoundedElements=[];_this67.dragTargetAreas=[];_this67.zoomControls_=null;_this67.metricsManager=new(getClassFromOptions$$module$build$src$core$registry(Type$$module$build$src$core$registry.METRICS_MANAGER,a,!0))(_assertThisInitialized(_this67));_this67.getMetrics=a.getMetrics||_this67.metricsManager.getMetrics.bind(_this67.metricsManager);_this67.setMetrics=a.setMetrics||WorkspaceSvg$$module$build$src$core$workspace_svg.setTopLevelWorkspaceMetrics_;_this67.componentManager=new ComponentManager$$module$build$src$core$component_manager();_this67.connectionDBList=ConnectionDB$$module$build$src$core$connection_db.init(_this67.connectionChecker);b&&(_this67.blockDragSurface=b);c&&(_this67.workspaceDragSurface=c);_this67.useWorkspaceDragSurface=!!_this67.workspaceDragSurface;_this67.audioManager=new WorkspaceAudio$$module$build$src$core$workspace_audio(a.parentWorkspace);_this67.grid=_this67.options.gridPattern?new Grid$$module$build$src$core$grid(_this67.options.gridPattern,a.gridOptions):null;_this67.markerManager=new MarkerManager$$module$build$src$core$marker_manager(_assertThisInitialized(_this67));$.module$build$src$core$variables&&flyoutCategory$$module$build$src$core$variables&&_this67.registerToolboxCategoryCallback(CATEGORY_NAME$$module$build$src$core$variables,flyoutCategory$$module$build$src$core$variables);module$build$src$core$variables_dynamic&&flyoutCategory$$module$build$src$core$variables_dynamic&&_this67.registerToolboxCategoryCallback(CATEGORY_NAME$$module$build$src$core$variables_dynamic,flyoutCategory$$module$build$src$core$variables_dynamic);$.module$build$src$core$procedures&&flyoutCategory$$module$build$src$core$procedures&&(_this67.registerToolboxCategoryCallback(CATEGORY_NAME$$module$build$src$core$procedures,flyoutCategory$$module$build$src$core$procedures),_this67.addChangeListener(mutatorOpenListener$$module$build$src$core$procedures));_this67.themeManager_=_this67.options.parentWorkspace?_this67.options.parentWorkspace.getThemeManager():new ThemeManager$$module$build$src$core$theme_manager(_assertThisInitialized(_this67),_this67.options.theme||Classic$$module$build$src$core$theme$classic);_this67.themeManager_.subscribeWorkspace(_assertThisInitialized(_this67));var d;_this67.renderer=init$$module$build$src$core$renderers$common$block_rendering(_this67.options.renderer||"geras",_this67.getTheme(),null!=(d=_this67.options.rendererOverrides)?d:void 0);_this67.cachedParentSvgSize=new Size$$module$build$src$core$utils$size(0,0);return _this67;}_createClass(WorkspaceSvg$$module$build$src$core$workspace_svg,[{key:"getMarkerManager",value:function getMarkerManager(){return this.markerManager;}},{key:"getMetricsManager",value:function getMetricsManager(){return this.metricsManager;}},{key:"setMetricsManager",value:function setMetricsManager(a){this.metricsManager=a;this.getMetrics=this.metricsManager.getMetrics.bind(this.metricsManager);}},{key:"getComponentManager",value:function getComponentManager(){return this.componentManager;}},{key:"setCursorSvg",value:function setCursorSvg(a){this.markerManager.setCursorSvg(a);}},{key:"setMarkerSvg",value:function setMarkerSvg(a){this.markerManager.setMarkerSvg(a);}},{key:"getMarker",value:function getMarker(a){return this.markerManager?this.markerManager.getMarker(a):null;}},{key:"getCursor",value:function getCursor(){return this.markerManager?this.markerManager.getCursor():null;}},{key:"getRenderer",value:function getRenderer(){return this.renderer;}},{key:"getThemeManager",value:function getThemeManager(){return this.themeManager_;}},{key:"getTheme",value:function getTheme(){return this.themeManager_.getTheme();}},{key:"setTheme",value:function setTheme(a){a||(a=Classic$$module$build$src$core$theme$classic);this.themeManager_.setTheme(a);}},{key:"refreshTheme",value:function refreshTheme(){this.svgGroup_&&this.renderer.refreshDom(this.svgGroup_,this.getTheme());this.updateBlockStyles_(this.getAllBlocks(!1).filter(function(b){return!!b.getStyleName();}));this.refreshToolboxSelection();this.toolbox_&&this.toolbox_.refreshTheme();this.isVisible()&&this.setVisible(!0);var a=new(get$$module$build$src$core$events$utils(THEME_CHANGE$$module$build$src$core$events$utils))(this.getTheme().name,this.id);fire$$module$build$src$core$events$utils(a);}},{key:"updateBlockStyles_",value:function updateBlockStyles_(a){for(var b=0,c;c=a[b];b++){var d=c.getStyleName();if(d){var e=c;e.setStyle(d);e.mutator&&e.mutator.updateBlockStyle();}}}},{key:"getInverseScreenCTM",value:function getInverseScreenCTM(){if(this.inverseScreenCTMDirty){var a=this.getParentSvg().getScreenCTM();a&&(this.inverseScreenCTM=a.inverse(),this.inverseScreenCTMDirty=!1);}return this.inverseScreenCTM;}},{key:"updateInverseScreenCTM",value:function updateInverseScreenCTM(){this.inverseScreenCTMDirty=!0;}},{key:"isVisible",value:function isVisible(){return this.isVisible_;}},{key:"getSvgXY",value:function getSvgXY(a){var b=0,c=0,d=1;if(containsNode$$module$build$src$core$utils$dom(this.getCanvas(),a)||containsNode$$module$build$src$core$utils$dom(this.getBubbleCanvas(),a))d=this.scale;do{var e=getRelativeXY$$module$build$src$core$utils$svg_math(a);if(a===this.getCanvas()||a===this.getBubbleCanvas())d=1;b+=e.x*d;c+=e.y*d;a=a.parentNode;}while(a&&a!==this.getParentSvg());return new Coordinate$$module$build$src$core$utils$coordinate(b,c);}},{key:"getCachedParentSvgSize",value:function getCachedParentSvgSize(){var a=this.cachedParentSvgSize;return new Size$$module$build$src$core$utils$size(a.width,a.height);}},{key:"getOriginOffsetInPixels",value:function getOriginOffsetInPixels(){return getInjectionDivXY$$module$build$src$core$utils$svg_math(this.getCanvas());}},{key:"getInjectionDiv",value:function getInjectionDiv(){if(!this.injectionDiv){var a=this.svgGroup_;for(;a;){if(-1!==(" "+(a.getAttribute("class")||"")+" ").indexOf(" injectionDiv ")){this.injectionDiv=a;break;}a=a.parentNode;}}return this.injectionDiv;}},{key:"getBlockCanvas",value:function getBlockCanvas(){return this.svgBlockCanvas_;}},{key:"setResizeHandlerWrapper",value:function setResizeHandlerWrapper(a){this.resizeHandlerWrapper=a;}},{key:"createDom",value:function createDom(a){this.svgGroup_=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.G,{"class":"blocklyWorkspace"});a&&(this.svgBackground_=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.RECT,{height:"100%",width:"100%","class":a},this.svgGroup_),"blocklyMainBackground"===a&&this.grid?this.svgBackground_.style.fill="url(#"+this.grid.getPatternId()+")":this.themeManager_.subscribe(this.svgBackground_,"workspaceBackgroundColour","fill"));this.svgBlockCanvas_=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.G,{"class":"blocklyBlockCanvas"},this.svgGroup_);this.svgBubbleCanvas_=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.G,{"class":"blocklyBubbleCanvas"},this.svgGroup_);this.isFlyout||(conditionalBind$$module$build$src$core$browser_events(this.svgGroup_,"mousedown",this,this.onMouseDown_,!1,!0),document.body.addEventListener("wheel",function(){}),conditionalBind$$module$build$src$core$browser_events(this.svgGroup_,"wheel",this,this.onMouseWheel_));this.options.hasCategories&&(this.toolbox_=new(getClassFromOptions$$module$build$src$core$registry(Type$$module$build$src$core$registry.TOOLBOX,this.options,!0))(this));this.grid&&this.grid.update(this.scale);this.recordDragTargets();(a=getClassFromOptions$$module$build$src$core$registry(Type$$module$build$src$core$registry.CURSOR,this.options))&&this.markerManager.setCursor(new a());this.renderer.createDom(this.svgGroup_,this.getTheme());return this.svgGroup_;}},{key:"dispose",value:function dispose(){this.rendered=!1;this.currentGesture_&&this.currentGesture_.cancel();this.svgGroup_&&removeNode$$module$build$src$core$utils$dom(this.svgGroup_);this.toolbox_&&(this.toolbox_.dispose(),this.toolbox_=null);this.flyout&&(this.flyout.dispose(),this.flyout=null);this.trashcan&&(this.trashcan.dispose(),this.trashcan=null);this.scrollbar&&(this.scrollbar.dispose(),this.scrollbar=null);this.zoomControls_&&this.zoomControls_.dispose();this.audioManager&&this.audioManager.dispose();this.grid&&(this.grid=null);this.renderer.dispose();this.markerManager&&this.markerManager.dispose();_get(_getPrototypeOf(WorkspaceSvg$$module$build$src$core$workspace_svg.prototype),"dispose",this).call(this);this.themeManager_&&(this.themeManager_.unsubscribeWorkspace(this),this.themeManager_.unsubscribe(this.svgBackground_),this.options.parentWorkspace||this.themeManager_.dispose());this.connectionDBList.length=0;this.toolboxCategoryCallbacks.clear();this.flyoutButtonCallbacks.clear();if(!this.options.parentWorkspace){var a=this.getParentSvg();a&&a.parentNode&&removeNode$$module$build$src$core$utils$dom(a.parentNode);}this.resizeHandlerWrapper&&(unbind$$module$build$src$core$browser_events(this.resizeHandlerWrapper),this.resizeHandlerWrapper=null);}},{key:"addTrashcan",value:function addTrashcan(){this.trashcan=WorkspaceSvg$$module$build$src$core$workspace_svg.newTrashcan(this);var a=this.trashcan.createDom();this.svgGroup_.insertBefore(a,this.svgBlockCanvas_);}},{key:"addZoomControls",value:function addZoomControls(){this.zoomControls_=new ZoomControls$$module$build$src$core$zoom_controls(this);var a=this.zoomControls_.createDom();this.svgGroup_.appendChild(a);}},{key:"addFlyout",value:function addFlyout(a){var b=new Options$$module$build$src$core$options({parentWorkspace:this,rtl:this.RTL,oneBasedIndex:this.options.oneBasedIndex,horizontalLayout:this.horizontalLayout,renderer:this.options.renderer,rendererOverrides:this.options.rendererOverrides,move:{scrollbars:!0}});b.toolboxPosition=this.options.toolboxPosition;this.flyout=this.horizontalLayout?new(getClassFromOptions$$module$build$src$core$registry(Type$$module$build$src$core$registry.FLYOUTS_HORIZONTAL_TOOLBOX,this.options,!0))(b):new(getClassFromOptions$$module$build$src$core$registry(Type$$module$build$src$core$registry.FLYOUTS_VERTICAL_TOOLBOX,this.options,!0))(b);this.flyout.autoClose=!1;this.flyout.getWorkspace().setVisible(!0);return this.flyout.createDom(a);}},{key:"getFlyout",value:function getFlyout(a){return this.flyout||a?this.flyout:this.toolbox_?this.toolbox_.getFlyout():null;}},{key:"getToolbox",value:function getToolbox(){return this.toolbox_;}},{key:"updateScreenCalculations_",value:function updateScreenCalculations_(){this.updateInverseScreenCTM();this.recordDragTargets();}},{key:"resizeContents",value:function resizeContents(){this.resizesEnabled&&this.rendered&&(this.scrollbar&&this.scrollbar.resize(),this.updateInverseScreenCTM());}},{key:"resize",value:function resize(){this.toolbox_&&this.toolbox_.position();this.flyout&&this.flyout.position();var a=this.componentManager.getComponents(ComponentManager$$module$build$src$core$component_manager.Capability.POSITIONABLE,!0),b=this.getMetricsManager().getUiMetrics(),c=[];for(var d=0,e;e=a[d];d++){e.position(b,c);var f=e.getBoundingRectangle();f&&c.push(f);}this.scrollbar&&this.scrollbar.resize();this.updateScreenCalculations_();}},{key:"updateScreenCalculationsIfScrolled",value:function updateScreenCalculationsIfScrolled(){var a=getDocumentScroll$$module$build$src$core$utils$svg_math();Coordinate$$module$build$src$core$utils$coordinate.equals(this.lastRecordedPageScroll,a)||(this.lastRecordedPageScroll=a,this.updateScreenCalculations_());}},{key:"getCanvas",value:function getCanvas(){return this.svgBlockCanvas_;}},{key:"setCachedParentSvgSize",value:function setCachedParentSvgSize(a,b){var c=this.getParentSvg();null!=a&&(this.cachedParentSvgSize.width=a,c.setAttribute("data-cached-width",a.toString()));null!=b&&(this.cachedParentSvgSize.height=b,c.setAttribute("data-cached-height",b.toString()));}},{key:"getBubbleCanvas",value:function getBubbleCanvas(){return this.svgBubbleCanvas_;}},{key:"getParentSvg",value:function getParentSvg(){if(!this.cachedParentSvg){var a=this.svgGroup_;for(;a;){if("svg"===a.tagName){this.cachedParentSvg=a;break;}a=a.parentNode;}}return this.cachedParentSvg;}},{key:"maybeFireViewportChangeEvent",value:function maybeFireViewportChangeEvent(){if(isEnabled$$module$build$src$core$events$utils()){var a=this.scale,b=-this.scrollY,c=-this.scrollX;if(!(a===this.oldScale&&1>Math.abs(b-this.oldTop)&&1>Math.abs(c-this.oldLeft))){var d=new(get$$module$build$src$core$events$utils(VIEWPORT_CHANGE$$module$build$src$core$events$utils))(b,c,a,this.id,this.oldScale);this.oldScale=a;this.oldTop=b;this.oldLeft=c;fire$$module$build$src$core$events$utils(d);}}}},{key:"translate",value:function translate(a,b){if(this.useWorkspaceDragSurface&&this.isDragSurfaceActive){var c;null==(c=this.workspaceDragSurface)||c.translateSurface(a,b);}else c="translate("+a+","+b+") scale("+this.scale+")",this.svgBlockCanvas_.setAttribute("transform",c),this.svgBubbleCanvas_.setAttribute("transform",c);this.blockDragSurface&&this.blockDragSurface.translateAndScaleGroup(a,b,this.scale);this.grid&&this.grid.moveTo(a,b);this.maybeFireViewportChangeEvent();}},{key:"resetDragSurface",value:function resetDragSurface(){if(this.useWorkspaceDragSurface){this.isDragSurfaceActive=!1;var a=this.workspaceDragSurface.getSurfaceTranslation();this.workspaceDragSurface.clearAndHide(this.svgGroup_);a="translate("+a.x+","+a.y+") scale("+this.scale+")";this.svgBlockCanvas_.setAttribute("transform",a);this.svgBubbleCanvas_.setAttribute("transform",a);}}},{key:"setupDragSurface",value:function setupDragSurface(){if(this.useWorkspaceDragSurface&&!this.isDragSurfaceActive){this.isDragSurfaceActive=!0;var a=this.svgBlockCanvas_.previousSibling,b,c=parseInt(null!=(b=this.getParentSvg().getAttribute("width"))?b:"0"),d;b=parseInt(null!=(d=this.getParentSvg().getAttribute("height"))?d:"0");d=getRelativeXY$$module$build$src$core$utils$svg_math(this.getCanvas());this.workspaceDragSurface.setContentsAndShow(this.getCanvas(),this.getBubbleCanvas(),a,c,b,this.scale);this.workspaceDragSurface.translateSurface(d.x,d.y);}}},{key:"getBlockDragSurface",value:function getBlockDragSurface(){return this.blockDragSurface;}},{key:"getWidth",value:function getWidth(){var a=this.getMetrics();return a?a.viewWidth/this.scale:0;}},{key:"setVisible",value:function setVisible(a){this.isVisible_=a;if(this.svgGroup_)if(this.scrollbar&&this.scrollbar.setContainerVisible(a),this.getFlyout()&&this.getFlyout().setContainerVisible(a),this.getParentSvg().style.display=a?"block":"none",this.toolbox_&&this.toolbox_.setVisible(a),a){a=this.getAllBlocks(!1);for(var b=a.length-1;0<=b;b--){a[b].markDirty();}this.render();this.toolbox_&&this.toolbox_.position();}else this.hideChaff(!0);}},{key:"render",value:function render(){var a=this.getAllBlocks(!1);for(var b=a.length-1;0<=b;b--){a[b].render(!1);}if(this.currentGesture_)for(a=this.currentGesture_.getInsertionMarkers(),b=0;b<a.length;b++){a[b].render(!1);}this.markerManager.updateMarkers();}},{key:"highlightBlock",value:function highlightBlock(a,b){if(void 0===b){for(var c=0,d;d=this.highlightedBlocks[c];c++){d.setHighlighted(!1);}this.highlightedBlocks.length=0;}if(a=a?this.getBlockById(a):null)(b=void 0===b||b)?-1===this.highlightedBlocks.indexOf(a)&&this.highlightedBlocks.push(a):removeElem$$module$build$src$core$utils$array(this.highlightedBlocks,a),a.setHighlighted(b);}},{key:"paste",value:function paste(a){if(!this.rendered||!a.type&&!a.tagName)return null;this.currentGesture_&&this.currentGesture_.cancel();var b=getGroup$$module$build$src$core$events$utils();b||setGroup$$module$build$src$core$events$utils(!0);a=a.type?this.pasteBlock_(null,a):"comment"===a.tagName.toLowerCase()?this.pasteWorkspaceComment_(a):this.pasteBlock_(a,null);setGroup$$module$build$src$core$events$utils(b);return a;}},{key:"pasteBlock_",value:function pasteBlock_(a,b){disable$$module$build$src$core$events$utils();var c;try{var d=0,e=0;if(a){c=domToBlock$$module$build$src$core$xml(a,this);var f;d=parseInt(null!=(f=a.getAttribute("x"))?f:"0");this.RTL&&(d=-d);var g;e=parseInt(null!=(g=a.getAttribute("y"))?g:"0");}else b&&(c=append$$module$build$src$core$serialization$blocks(b,this),d=b.x||10,this.RTL&&(d=this.getWidth()-d),e=b.y||10);if(!isNaN(d)&&!isNaN(e)){var _f5;do{_f5=!1;var _g4=this.getAllBlocks(!1);for(var h=0,k;k=_g4[h];h++){var l=k.getRelativeToSurfaceXY();if(1>=Math.abs(d-l.x)&&1>=Math.abs(e-l.y)){_f5=!0;break;}}if(!_f5){var _h2=c.getConnections_(!1);for(var _k=0,_l;_l=_h2[_k];_k++){if(_l.closest($.config$$module$build$src$core$config.snapRadius,new Coordinate$$module$build$src$core$utils$coordinate(d,e)).connection){_f5=!0;break;}}}_f5&&(d=this.RTL?d-$.config$$module$build$src$core$config.snapRadius:d+$.config$$module$build$src$core$config.snapRadius,e+=2*$.config$$module$build$src$core$config.snapRadius);}while(_f5);c.moveTo(new Coordinate$$module$build$src$core$utils$coordinate(d,e));}}finally{enable$$module$build$src$core$events$utils();}isEnabled$$module$build$src$core$events$utils()&&!c.isShadow()&&fire$$module$build$src$core$events$utils(new(get$$module$build$src$core$events$utils(CREATE$$module$build$src$core$events$utils))(c));c.select();return c;}},{key:"pasteWorkspaceComment_",value:function pasteWorkspaceComment_(a){disable$$module$build$src$core$events$utils();var b;try{b=WorkspaceCommentSvg$$module$build$src$core$workspace_comment_svg.fromXmlRendered(a,this);var c,d=parseInt(null!=(c=a.getAttribute("x"))?c:"0"),e,f=parseInt(null!=(e=a.getAttribute("y"))?e:"0");isNaN(d)||isNaN(f)||(this.RTL&&(d=-d),b.moveBy(d+50,f+50));}finally{enable$$module$build$src$core$events$utils();}isEnabled$$module$build$src$core$events$utils()&&WorkspaceComment$$module$build$src$core$workspace_comment.fireCreateEvent(b);b.select();return b;}},{key:"refreshToolboxSelection",value:function refreshToolboxSelection(){var a=this.isFlyout?this.targetWorkspace:this;a&&!a.currentGesture_&&a.toolbox_&&a.toolbox_.getFlyout()&&a.toolbox_.refreshSelection();}},{key:"renameVariableById",value:function renameVariableById(a,b){_get(_getPrototypeOf(WorkspaceSvg$$module$build$src$core$workspace_svg.prototype),"renameVariableById",this).call(this,a,b);this.refreshToolboxSelection();}},{key:"deleteVariableById",value:function deleteVariableById(a){_get(_getPrototypeOf(WorkspaceSvg$$module$build$src$core$workspace_svg.prototype),"deleteVariableById",this).call(this,a);this.refreshToolboxSelection();}},{key:"createVariable",value:function createVariable(a,b,c){a=_get(_getPrototypeOf(WorkspaceSvg$$module$build$src$core$workspace_svg.prototype),"createVariable",this).call(this,a,b,c);this.refreshToolboxSelection();return a;}},{key:"recordDragTargets",value:function recordDragTargets(){var a=this.componentManager.getComponents(ComponentManager$$module$build$src$core$component_manager.Capability.DRAG_TARGET,!0);this.dragTargetAreas=[];for(var b=0,c;c=a[b];b++){var d=c.getClientRect();d&&this.dragTargetAreas.push({component:c,clientRect:d});}}},{key:"newBlock",value:function newBlock(a,b){throw Error("The implementation of newBlock should be monkey-patched in by blockly.ts");}},{key:"getDragTarget",value:function getDragTarget(a){for(var b=0,c;c=this.dragTargetAreas[b];b++){if(c.clientRect.contains(a.clientX,a.clientY))return c.component;}return null;}},{key:"onMouseDown_",value:function onMouseDown_(a){var b=this.getGesture(a);b&&b.handleWsStart(a,this);}},{key:"startDrag",value:function startDrag(a,b){a=mouseToSvg$$module$build$src$core$browser_events(a,this.getParentSvg(),this.getInverseScreenCTM());a.x/=this.scale;a.y/=this.scale;this.dragDeltaXY=Coordinate$$module$build$src$core$utils$coordinate.difference(b,a);}},{key:"moveDrag",value:function moveDrag(a){a=mouseToSvg$$module$build$src$core$browser_events(a,this.getParentSvg(),this.getInverseScreenCTM());a.x/=this.scale;a.y/=this.scale;return Coordinate$$module$build$src$core$utils$coordinate.sum(this.dragDeltaXY,a);}},{key:"isDragging",value:function isDragging(){return null!==this.currentGesture_&&this.currentGesture_.isDragging();}},{key:"isDraggable",value:function isDraggable(){return this.options.moveOptions&&this.options.moveOptions.drag;}},{key:"isMovable",value:function isMovable(){return this.options.moveOptions&&!!this.options.moveOptions.scrollbars||this.options.moveOptions&&this.options.moveOptions.wheel||this.options.moveOptions&&this.options.moveOptions.drag||this.options.zoomOptions&&this.options.zoomOptions.wheel||this.options.zoomOptions&&this.options.zoomOptions.pinch;}},{key:"isMovableHorizontally",value:function isMovableHorizontally(){var a=!!this.scrollbar;return this.isMovable()&&(!a||a&&this.scrollbar.canScrollHorizontally());}},{key:"isMovableVertically",value:function isMovableVertically(){var a=!!this.scrollbar;return this.isMovable()&&(!a||a&&this.scrollbar.canScrollVertically());}},{key:"onMouseWheel_",value:function onMouseWheel_(a){if(Gesture$$module$build$src$core$gesture.inProgress())a.preventDefault(),a.stopPropagation();else{var b=this.options.zoomOptions&&this.options.zoomOptions.wheel,c=this.options.moveOptions&&this.options.moveOptions.wheel;if(b||c){var d=getScrollDeltaPixels$$module$build$src$core$browser_events(a);if(MAC$$module$build$src$core$utils$useragent)var e=a.metaKey;b&&(a.ctrlKey||e||!c)?(d=-d.y/50,b=mouseToSvg$$module$build$src$core$browser_events(a,this.getParentSvg(),this.getInverseScreenCTM()),this.zoom(b.x,b.y,d)):(b=this.scrollX-d.x,c=this.scrollY-d.y,a.shiftKey&&!d.x&&(b=this.scrollX-d.y,c=this.scrollY),this.scroll(b,c));a.preventDefault();}}}},{key:"getBlocksBoundingBox",value:function getBlocksBoundingBox(){var a=this.getTopBoundedElements();if(!a.length)return new Rect$$module$build$src$core$utils$rect(0,0,0,0);var b=a[0].getBoundingRectangle();for(var d=1;d<a.length;d++){var c=a[d];c.isInsertionMarker&&c.isInsertionMarker()||(c=c.getBoundingRectangle(),c.top<b.top&&(b.top=c.top),c.bottom>b.bottom&&(b.bottom=c.bottom),c.left<b.left&&(b.left=c.left),c.right>b.right&&(b.right=c.right));}return b;}},{key:"cleanUp",value:function cleanUp(){this.setResizesEnabled(!1);setGroup$$module$build$src$core$events$utils(!0);var a=this.getTopBlocks(!0);var b=0;for(var c=0,d;d=a[c];c++){if(!d.isMovable())continue;var e=d.getRelativeToSurfaceXY();d.moveBy(-e.x,b-e.y);d.snapToGrid();b=d.getRelativeToSurfaceXY().y+d.getHeightWidth().height+this.renderer.getConstants().MIN_BLOCK_HEIGHT;}setGroup$$module$build$src$core$events$utils(!1);this.setResizesEnabled(!0);}},{key:"showContextMenu",value:function showContextMenu(a){if(!this.options.readOnly&&!this.isFlyout){var b=ContextMenuRegistry$$module$build$src$core$contextmenu_registry.registry.getContextMenuOptions(ContextMenuRegistry$$module$build$src$core$contextmenu_registry.ScopeType.WORKSPACE,{workspace:this});this.configureContextMenu&&this.configureContextMenu(b,a);show$$module$build$src$core$contextmenu(a,b,this.RTL);}}},{key:"updateToolbox",value:function updateToolbox(a){if(a=convertToolboxDefToJson$$module$build$src$core$utils$toolbox(a)){if(!this.options.languageTree)throw Error("Existing toolbox is null.  Can't create new toolbox.");if(hasCategories$$module$build$src$core$utils$toolbox(a)){if(!this.toolbox_)throw Error("Existing toolbox has no categories.  Can't change mode.");this.options.languageTree=a;this.toolbox_.render(a);}else{if(!this.flyout)throw Error("Existing toolbox has categories.  Can't change mode.");this.options.languageTree=a;this.flyout.show(a);}}else if(this.options.languageTree)throw Error("Can't nullify an existing toolbox.");}},{key:"markFocused",value:function markFocused(){this.options.parentWorkspace?this.options.parentWorkspace.markFocused():(setMainWorkspace$$module$build$src$core$common(this),this.setBrowserFocus());}},{key:"setBrowserFocus",value:function setBrowserFocus(){document.activeElement&&document.activeElement instanceof HTMLElement&&document.activeElement.blur();try{this.getParentSvg().focus({preventScroll:!0});}catch(a){try{this.getParentSvg().parentElement.setActive();}catch(b){this.getParentSvg().parentElement.focus({preventScroll:!0});}}}},{key:"zoom",value:function zoom(a,b,c){c=Math.pow(this.options.zoomOptions.scaleSpeed,c);var d=this.scale*c;if(this.scale!==d){d>this.options.zoomOptions.maxScale?c=this.options.zoomOptions.maxScale/this.scale:d<this.options.zoomOptions.minScale&&(c=this.options.zoomOptions.minScale/this.scale);var e=this.getCanvas().getCTM(),f=this.getParentSvg().createSVGPoint();f.x=a;f.y=b;f=f.matrixTransform(e.inverse());a=f.x;b=f.y;e=e.translate(a*(1-c),b*(1-c)).scale(c);this.scrollX=e.e;this.scrollY=e.f;this.setScale(d);}}},{key:"zoomCenter",value:function zoomCenter(a){var b=this.getMetrics();var c;this.flyout?(c=b.svgWidth?b.svgWidth/2:0,b=b.svgHeight?b.svgHeight/2:0):(c=b.viewWidth/2+b.absoluteLeft,b=b.viewHeight/2+b.absoluteTop);this.zoom(c,b,a);}},{key:"zoomToFit",value:function zoomToFit(){if(this.isMovable()){var a=this.getMetrics(),b=a.viewWidth;a=a.viewHeight;var c=this.getBlocksBoundingBox(),d=2*ZOOM_TO_FIT_MARGIN$$module$build$src$core$workspace_svg,e=c.right-c.left+d;c=c.bottom-c.top+d;if(e){this.flyout&&(this.horizontalLayout?(a+=this.flyout.getHeight(),c+=this.flyout.getHeight()/this.scale):(b+=this.flyout.getWidth(),e+=this.flyout.getWidth()/this.scale));b/=e;a/=c;disable$$module$build$src$core$events$utils();try{this.setScale(Math.min(b,a)),this.scrollCenter();}finally{enable$$module$build$src$core$events$utils();}this.maybeFireViewportChangeEvent();}}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.");}},{key:"beginCanvasTransition",value:function beginCanvasTransition(){addClass$$module$build$src$core$utils$dom(this.svgBlockCanvas_,"blocklyCanvasTransitioning");addClass$$module$build$src$core$utils$dom(this.svgBubbleCanvas_,"blocklyCanvasTransitioning");}},{key:"endCanvasTransition",value:function endCanvasTransition(){removeClass$$module$build$src$core$utils$dom(this.svgBlockCanvas_,"blocklyCanvasTransitioning");removeClass$$module$build$src$core$utils$dom(this.svgBubbleCanvas_,"blocklyCanvasTransitioning");}},{key:"scrollCenter",value:function scrollCenter(){if(this.isMovable()){var a=this.getMetrics(),b=(a.scrollWidth-a.viewWidth)/2,c=(a.scrollHeight-a.viewHeight)/2;b=-b-a.scrollLeft;c=-c-a.scrollTop;this.scroll(b,c);}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.");}},{key:"centerOnBlock",value:function centerOnBlock(a){if(this.isMovable()){if(a=a?this.getBlockById(a):null){var b=a.getRelativeToSurfaceXY(),c=a.getHeightWidth(),d=this.scale;a=(b.x+(this.RTL?-1:1)*c.width/2)*d;b=(b.y+c.height/2)*d;c=this.getMetrics();this.scroll(-(a-c.viewWidth/2),-(b-c.viewHeight/2));}}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.");}},{key:"setScale",value:function setScale(a){this.options.zoomOptions.maxScale&&a>this.options.zoomOptions.maxScale?a=this.options.zoomOptions.maxScale:this.options.zoomOptions.minScale&&a<this.options.zoomOptions.minScale&&(a=this.options.zoomOptions.minScale);this.scale=a;this.hideChaff(!1);(a=this.getFlyout(!1))&&a.isVisible()&&(a.reflow(),this.recordDragTargets());this.grid&&this.grid.update(this.scale);a=this.getMetrics();this.scrollX-=a.absoluteLeft;this.scrollY-=a.absoluteTop;a.viewLeft+=a.absoluteLeft;a.viewTop+=a.absoluteTop;this.scroll(this.scrollX,this.scrollY);this.scrollbar&&(this.flyout?this.scrollbar.resizeView(a):this.scrollbar.resizeContent(a));}},{key:"getScale",value:function getScale(){return this.options.parentWorkspace?this.options.parentWorkspace.getScale():this.scale;}},{key:"scroll",value:function scroll(a,b){this.hideChaff(!0);var c=this.getMetrics();a=Math.min(a,-c.scrollLeft);b=Math.min(b,-c.scrollTop);var d=c.scrollTop+Math.max(0,c.scrollHeight-c.viewHeight);a=Math.max(a,-(c.scrollLeft+Math.max(0,c.scrollWidth-c.viewWidth)));b=Math.max(b,-d);this.scrollX=a;this.scrollY=b;this.scrollbar&&this.scrollbar.set(-(a+c.scrollLeft),-(b+c.scrollTop),!1);a+=c.absoluteLeft;b+=c.absoluteTop;this.translate(a,b);}},{key:"getBlockById",value:function getBlockById(a){return _get(_getPrototypeOf(WorkspaceSvg$$module$build$src$core$workspace_svg.prototype),"getBlockById",this).call(this,a);}},{key:"getAllBlocks",value:function getAllBlocks(a){return _get(_getPrototypeOf(WorkspaceSvg$$module$build$src$core$workspace_svg.prototype),"getAllBlocks",this).call(this,a);}},{key:"getTopBlocks",value:function getTopBlocks(a){return _get(_getPrototypeOf(WorkspaceSvg$$module$build$src$core$workspace_svg.prototype),"getTopBlocks",this).call(this,a);}},{key:"addTopBlock",value:function addTopBlock(a){this.addTopBoundedElement(a);_get(_getPrototypeOf(WorkspaceSvg$$module$build$src$core$workspace_svg.prototype),"addTopBlock",this).call(this,a);}},{key:"removeTopBlock",value:function removeTopBlock(a){this.removeTopBoundedElement(a);_get(_getPrototypeOf(WorkspaceSvg$$module$build$src$core$workspace_svg.prototype),"removeTopBlock",this).call(this,a);}},{key:"addTopComment",value:function addTopComment(a){this.addTopBoundedElement(a);_get(_getPrototypeOf(WorkspaceSvg$$module$build$src$core$workspace_svg.prototype),"addTopComment",this).call(this,a);}},{key:"removeTopComment",value:function removeTopComment(a){this.removeTopBoundedElement(a);_get(_getPrototypeOf(WorkspaceSvg$$module$build$src$core$workspace_svg.prototype),"removeTopComment",this).call(this,a);}},{key:"addTopBoundedElement",value:function addTopBoundedElement(a){this.topBoundedElements.push(a);}},{key:"removeTopBoundedElement",value:function removeTopBoundedElement(a){removeElem$$module$build$src$core$utils$array(this.topBoundedElements,a);}},{key:"getTopBoundedElements",value:function getTopBoundedElements(){return[].concat(this.topBoundedElements);}},{key:"setResizesEnabled",value:function setResizesEnabled(a){var b=!this.resizesEnabled&&a;this.resizesEnabled=a;b&&this.resizeContents();}},{key:"clear",value:function clear(){this.setResizesEnabled(!1);_get(_getPrototypeOf(WorkspaceSvg$$module$build$src$core$workspace_svg.prototype),"clear",this).call(this);this.topBoundedElements=[];this.setResizesEnabled(!0);}},{key:"registerButtonCallback",value:function registerButtonCallback(a,b){if("function"!==typeof b)throw TypeError("Button callbacks must be functions.");this.flyoutButtonCallbacks.set(a,b);}},{key:"getButtonCallback",value:function getButtonCallback(a){var b;return null!=(b=this.flyoutButtonCallbacks.get(a))?b:null;}},{key:"removeButtonCallback",value:function removeButtonCallback(a){this.flyoutButtonCallbacks["delete"](a);}},{key:"registerToolboxCategoryCallback",value:function registerToolboxCategoryCallback(a,b){if("function"!==typeof b)throw TypeError("Toolbox category callbacks must be functions.");this.toolboxCategoryCallbacks.set(a,b);}},{key:"getToolboxCategoryCallback",value:function getToolboxCategoryCallback(a){return this.toolboxCategoryCallbacks.get(a)||null;}},{key:"removeToolboxCategoryCallback",value:function removeToolboxCategoryCallback(a){this.toolboxCategoryCallbacks["delete"](a);}},{key:"getGesture",value:function getGesture(a){var b="mousedown"===a.type||"touchstart"===a.type||"pointerdown"===a.type,c=this.currentGesture_;return c?b&&c.hasStarted()?(console.warn("Tried to start the same gesture twice."),c.cancel(),null):c:b?this.currentGesture_=new TouchGesture$$module$build$src$core$touch_gesture(a,this):null;}},{key:"clearGesture",value:function clearGesture(){this.currentGesture_=null;}},{key:"cancelCurrentGesture",value:function cancelCurrentGesture(){this.currentGesture_&&this.currentGesture_.cancel();}},{key:"getAudioManager",value:function getAudioManager(){return this.audioManager;}},{key:"getGrid",value:function getGrid(){return this.grid;}},{key:"hideChaff",value:function hideChaff(a){hide$$module$build$src$core$tooltip();hide$$module$build$src$core$widgetdiv();hideWithoutAnimation$$module$build$src$core$dropdowndiv();var b=!!a;this.getComponentManager().getComponents(ComponentManager$$module$build$src$core$component_manager.Capability.AUTOHIDEABLE,!0).forEach(function(c){return c.autoHide(b);});}}],[{key:"newTrashcan",value:function newTrashcan(a){throw Error("The implementation of newTrashcan should be monkey-patched in by blockly.ts");}},{key:"setTopLevelWorkspaceMetrics_",value:function setTopLevelWorkspaceMetrics_(a){var b=this.getMetrics();"number"===typeof a.x&&(this.scrollX=-(b.scrollLeft+(b.scrollWidth-b.viewWidth)*a.x));"number"===typeof a.y&&(this.scrollY=-(b.scrollTop+(b.scrollHeight-b.viewHeight)*a.y));this.translate(this.scrollX+b.absoluteLeft,this.scrollY+b.absoluteTop);}}]);return WorkspaceSvg$$module$build$src$core$workspace_svg;}(Workspace$$module$build$src$core$workspace),module$build$src$core$workspace_svg={};module$build$src$core$workspace_svg.WorkspaceSvg=WorkspaceSvg$$module$build$src$core$workspace_svg;module$build$src$core$workspace_svg.resizeSvgContents=resizeSvgContents$$module$build$src$core$workspace_svg;var module$build$src$core$serialization$workspaces={};module$build$src$core$serialization$workspaces.load=load$$module$build$src$core$serialization$workspaces;module$build$src$core$serialization$workspaces.save=save$$module$build$src$core$serialization$workspaces;var VariableSerializer$$module$build$src$core$serialization$variables=/*#__PURE__*/function(){function VariableSerializer$$module$build$src$core$serialization$variables(){_classCallCheck(this,VariableSerializer$$module$build$src$core$serialization$variables);this.priority=VARIABLES$$module$build$src$core$serialization$priorities;}_createClass(VariableSerializer$$module$build$src$core$serialization$variables,[{key:"save",value:function save(a){var b=[];var _iterator26=_createForOfIteratorHelper(a.getAllVariables()),_step26;try{for(_iterator26.s();!(_step26=_iterator26.n()).done;){var c=_step26.value;a={name:c.name,id:c.getId()},c.type&&(a.type=c.type),b.push(a);}}catch(err){_iterator26.e(err);}finally{_iterator26.f();}return b.length?b:null;}},{key:"load",value:function load(a,b){var _iterator27=_createForOfIteratorHelper(a),_step27;try{for(_iterator27.s();!(_step27=_iterator27.n()).done;){var c=_step27.value;b.createVariable(c.name,c.type,c.id);}}catch(err){_iterator27.e(err);}finally{_iterator27.f();}}},{key:"clear",value:function clear(a){a.getVariableMap().clear();}}]);return VariableSerializer$$module$build$src$core$serialization$variables;}();register$$module$build$src$core$serialization$registry("variables",new VariableSerializer$$module$build$src$core$serialization$variables());var module$build$src$core$serialization$variables={};module$build$src$core$serialization$variables.VariableSerializer=VariableSerializer$$module$build$src$core$serialization$variables;var ProcedureSerializer$$module$build$src$core$serialization$procedures=/*#__PURE__*/function(){function ProcedureSerializer$$module$build$src$core$serialization$procedures(a,b){_classCallCheck(this,ProcedureSerializer$$module$build$src$core$serialization$procedures);this.procedureModelClass=a;this.parameterModelClass=b;this.priority=PROCEDURES$$module$build$src$core$serialization$priorities;}_createClass(ProcedureSerializer$$module$build$src$core$serialization$procedures,[{key:"save",value:function save(a){return a.getProcedureMap().getProcedures().map(function(b){return saveProcedure$$module$build$src$core$serialization$procedures(b);});}},{key:"load",value:function load(a,b){var c=b.getProcedureMap();var _iterator28=_createForOfIteratorHelper(a),_step28;try{for(_iterator28.s();!(_step28=_iterator28.n()).done;){var d=_step28.value;c.add(loadProcedure$$module$build$src$core$serialization$procedures(this.procedureModelClass,this.parameterModelClass,d,b));}}catch(err){_iterator28.e(err);}finally{_iterator28.f();}}},{key:"clear",value:function clear(a){a.getProcedureMap().clear();}}]);return ProcedureSerializer$$module$build$src$core$serialization$procedures;}(),observableProcedureSerializer$$module$build$src$core$serialization$procedures=new ProcedureSerializer$$module$build$src$core$serialization$procedures(ObservableProcedureModel$$module$build$src$core$procedures$observable_procedure_model,ObservableParameterModel$$module$build$src$core$procedures$observable_parameter_model),module$build$src$core$serialization$procedures={};module$build$src$core$serialization$procedures.ProcedureSerializer=ProcedureSerializer$$module$build$src$core$serialization$procedures;module$build$src$core$serialization$procedures.observableProcedureSerializer=observableProcedureSerializer$$module$build$src$core$serialization$procedures;var module$build$src$core$serialization={blocks:module$build$src$core$serialization$blocks,exceptions:module$build$src$core$serialization$exceptions,priorities:module$build$src$core$serialization$priorities,procedures:module$build$src$core$serialization$procedures,registry:module$build$src$core$serialization$registry,variables:module$build$src$core$serialization$variables,workspaces:module$build$src$core$serialization$workspaces};var ConstantProvider$$module$build$src$core$renderers$zelos$constants=/*#__PURE__*/function(_ConstantProvider$$mo){_inherits(ConstantProvider$$module$build$src$core$renderers$zelos$constants,_ConstantProvider$$mo);var _super63=_createSuper(ConstantProvider$$module$build$src$core$renderers$zelos$constants);function ConstantProvider$$module$build$src$core$renderers$zelos$constants(){var _this68;_classCallCheck(this,ConstantProvider$$module$build$src$core$renderers$zelos$constants);_this68=_super63.call(this);_this68.GRID_UNIT=4;_this68.CURSOR_COLOUR="#ffa200";_this68.CURSOR_RADIUS=5;_this68.JAGGED_TEETH_WIDTH=_this68.JAGGED_TEETH_HEIGHT=0;_this68.START_HAT_HEIGHT=22;_this68.START_HAT_WIDTH=96;_this68.SHAPES={HEXAGONAL:1,ROUND:2,SQUARE:3,PUZZLE:4,NOTCH:5};_this68.SHAPE_IN_SHAPE_PADDING={1:{0:5*_this68.GRID_UNIT,1:2*_this68.GRID_UNIT,2:5*_this68.GRID_UNIT,3:5*_this68.GRID_UNIT},2:{0:3*_this68.GRID_UNIT,1:3*_this68.GRID_UNIT,2:1*_this68.GRID_UNIT,3:2*_this68.GRID_UNIT},3:{0:2*_this68.GRID_UNIT,1:2*_this68.GRID_UNIT,2:2*_this68.GRID_UNIT,3:2*_this68.GRID_UNIT}};_this68.FULL_BLOCK_FIELDS=!0;_this68.FIELD_TEXT_FONTWEIGHT="bold";_this68.FIELD_TEXT_FONTFAMILY='"Helvetica Neue", "Segoe UI", Helvetica, sans-serif';_this68.FIELD_COLOUR_FULL_BLOCK=_this68.FIELD_TEXTINPUT_BOX_SHADOW=_this68.FIELD_DROPDOWN_SVG_ARROW=_this68.FIELD_DROPDOWN_COLOURED_DIV=_this68.FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW=!0;_this68.SELECTED_GLOW_COLOUR="#fff200";_this68.SELECTED_GLOW_SIZE=.5;_this68.REPLACEMENT_GLOW_COLOUR="#fff200";_this68.REPLACEMENT_GLOW_SIZE=2;_this68.selectedGlowFilterId="";_this68.selectedGlowFilter_=null;_this68.replacementGlowFilterId="";_this68.SQUARED=_this68.ROUNDED=_this68.HEXAGONAL=_this68.replacementGlowFilter_=null;_this68.SMALL_PADDING=_this68.GRID_UNIT;_this68.MEDIUM_PADDING=2*_this68.GRID_UNIT;_this68.MEDIUM_LARGE_PADDING=3*_this68.GRID_UNIT;_this68.LARGE_PADDING=4*_this68.GRID_UNIT;_this68.CORNER_RADIUS=1*_this68.GRID_UNIT;_this68.NOTCH_WIDTH=9*_this68.GRID_UNIT;_this68.NOTCH_HEIGHT=2*_this68.GRID_UNIT;_this68.STATEMENT_INPUT_NOTCH_OFFSET=_this68.NOTCH_OFFSET_LEFT=3*_this68.GRID_UNIT;_this68.MIN_BLOCK_WIDTH=2*_this68.GRID_UNIT;_this68.MIN_BLOCK_HEIGHT=12*_this68.GRID_UNIT;_this68.EMPTY_STATEMENT_INPUT_HEIGHT=6*_this68.GRID_UNIT;_this68.TOP_ROW_MIN_HEIGHT=_this68.CORNER_RADIUS;_this68.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT=_this68.LARGE_PADDING;_this68.BOTTOM_ROW_MIN_HEIGHT=_this68.CORNER_RADIUS;_this68.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT=6*_this68.GRID_UNIT;_this68.STATEMENT_BOTTOM_SPACER=-_this68.NOTCH_HEIGHT;_this68.STATEMENT_INPUT_SPACER_MIN_WIDTH=40*_this68.GRID_UNIT;_this68.STATEMENT_INPUT_PADDING_LEFT=4*_this68.GRID_UNIT;_this68.EMPTY_INLINE_INPUT_PADDING=4*_this68.GRID_UNIT;_this68.EMPTY_INLINE_INPUT_HEIGHT=8*_this68.GRID_UNIT;_this68.DUMMY_INPUT_MIN_HEIGHT=8*_this68.GRID_UNIT;_this68.DUMMY_INPUT_SHADOW_MIN_HEIGHT=6*_this68.GRID_UNIT;_this68.CURSOR_WS_WIDTH=20*_this68.GRID_UNIT;_this68.FIELD_TEXT_FONTSIZE=3*_this68.GRID_UNIT;_this68.FIELD_BORDER_RECT_RADIUS=_this68.CORNER_RADIUS;_this68.FIELD_BORDER_RECT_X_PADDING=2*_this68.GRID_UNIT;_this68.FIELD_BORDER_RECT_Y_PADDING=1.625*_this68.GRID_UNIT;_this68.FIELD_BORDER_RECT_HEIGHT=8*_this68.GRID_UNIT;_this68.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=8*_this68.GRID_UNIT;_this68.FIELD_DROPDOWN_SVG_ARROW_PADDING=_this68.FIELD_BORDER_RECT_X_PADDING;_this68.FIELD_COLOUR_DEFAULT_WIDTH=2*_this68.GRID_UNIT;_this68.FIELD_COLOUR_DEFAULT_HEIGHT=4*_this68.GRID_UNIT;_this68.FIELD_CHECKBOX_X_OFFSET=1*_this68.GRID_UNIT;_this68.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH=12*_this68.GRID_UNIT;return _this68;}_createClass(ConstantProvider$$module$build$src$core$renderers$zelos$constants,[{key:"setFontConstants_",value:function setFontConstants_(a){_get(_getPrototypeOf(ConstantProvider$$module$build$src$core$renderers$zelos$constants.prototype),"setFontConstants_",this).call(this,a);this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT=this.FIELD_TEXT_HEIGHT+2*this.FIELD_BORDER_RECT_Y_PADDING;}},{key:"init",value:function init(){_get(_getPrototypeOf(ConstantProvider$$module$build$src$core$renderers$zelos$constants.prototype),"init",this).call(this);this.HEXAGONAL=this.makeHexagonal();this.ROUNDED=this.makeRounded();this.SQUARED=this.makeSquared();this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT+this.INSIDE_CORNERS.rightWidth;}},{key:"setDynamicProperties_",value:function setDynamicProperties_(a){_get(_getPrototypeOf(ConstantProvider$$module$build$src$core$renderers$zelos$constants.prototype),"setDynamicProperties_",this).call(this,a);this.SELECTED_GLOW_COLOUR=a.getComponentStyle("selectedGlowColour")||this.SELECTED_GLOW_COLOUR;var b=Number(a.getComponentStyle("selectedGlowSize"));this.SELECTED_GLOW_SIZE=b&&!isNaN(b)?b:this.SELECTED_GLOW_SIZE;this.REPLACEMENT_GLOW_COLOUR=a.getComponentStyle("replacementGlowColour")||this.REPLACEMENT_GLOW_COLOUR;this.REPLACEMENT_GLOW_SIZE=(a=Number(a.getComponentStyle("replacementGlowSize")))&&!isNaN(a)?a:this.REPLACEMENT_GLOW_SIZE;}},{key:"dispose",value:function dispose(){_get(_getPrototypeOf(ConstantProvider$$module$build$src$core$renderers$zelos$constants.prototype),"dispose",this).call(this);this.selectedGlowFilter_&&removeNode$$module$build$src$core$utils$dom(this.selectedGlowFilter_);this.replacementGlowFilter_&&removeNode$$module$build$src$core$utils$dom(this.replacementGlowFilter_);}},{key:"makeStartHat",value:function makeStartHat(){var a=this.START_HAT_HEIGHT,b=this.START_HAT_WIDTH,c=curve$$module$build$src$core$utils$svg_paths("c",[point$$module$build$src$core$utils$svg_paths(25,-a),point$$module$build$src$core$utils$svg_paths(71,-a),point$$module$build$src$core$utils$svg_paths(b,0)]);return{height:a,width:b,path:c};}},{key:"makeHexagonal",value:function makeHexagonal(){function a(c,d,e){var f=c/2;f=f>b?b:f;e=e?-1:1;c=(d?-1:1)*c/2;return lineTo$$module$build$src$core$utils$svg_paths(-e*f,c)+lineTo$$module$build$src$core$utils$svg_paths(e*f,c);}var b=this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH;return{type:this.SHAPES.HEXAGONAL,isDynamic:!0,width:function width(c){c/=2;return c>b?b:c;},height:function height(c){return c;},connectionOffsetY:function connectionOffsetY(c){return c/2;},connectionOffsetX:function connectionOffsetX(c){return-c;},pathDown:function pathDown(c){return a(c,!1,!1);},pathUp:function pathUp(c){return a(c,!0,!1);},pathRightDown:function pathRightDown(c){return a(c,!1,!0);},pathRightUp:function pathRightUp(c){return a(c,!1,!0);}};}},{key:"makeRounded",value:function makeRounded(){function a(d,e,f){var g=d>c?d-c:0;d=(d>c?c:d)/2;return arc$$module$build$src$core$utils$svg_paths("a","0 0,1",d,point$$module$build$src$core$utils$svg_paths((e?-1:1)*d,(e?-1:1)*d))+lineOnAxis$$module$build$src$core$utils$svg_paths("v",(f?1:-1)*g)+arc$$module$build$src$core$utils$svg_paths("a","0 0,1",d,point$$module$build$src$core$utils$svg_paths((e?1:-1)*d,(e?-1:1)*d));}var b=this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH,c=2*b;return{type:this.SHAPES.ROUND,isDynamic:!0,width:function width(d){d/=2;return d>b?b:d;},height:function height(d){return d;},connectionOffsetY:function connectionOffsetY(d){return d/2;},connectionOffsetX:function connectionOffsetX(d){return-d;},pathDown:function pathDown(d){return a(d,!1,!1);},pathUp:function pathUp(d){return a(d,!0,!1);},pathRightDown:function pathRightDown(d){return a(d,!1,!0);},pathRightUp:function pathRightUp(d){return a(d,!1,!0);}};}},{key:"makeSquared",value:function makeSquared(){function a(c,d,e){c-=2*b;return arc$$module$build$src$core$utils$svg_paths("a","0 0,1",b,point$$module$build$src$core$utils$svg_paths((d?-1:1)*b,(d?-1:1)*b))+lineOnAxis$$module$build$src$core$utils$svg_paths("v",(e?1:-1)*c)+arc$$module$build$src$core$utils$svg_paths("a","0 0,1",b,point$$module$build$src$core$utils$svg_paths((d?1:-1)*b,(d?-1:1)*b));}var b=this.CORNER_RADIUS;return{type:this.SHAPES.SQUARE,isDynamic:!0,width:function width(c){return b;},height:function height(c){return c;},connectionOffsetY:function connectionOffsetY(c){return c/2;},connectionOffsetX:function connectionOffsetX(c){return-c;},pathDown:function pathDown(c){return a(c,!1,!1);},pathUp:function pathUp(c){return a(c,!0,!1);},pathRightDown:function pathRightDown(c){return a(c,!1,!0);},pathRightUp:function pathRightUp(c){return a(c,!1,!0);}};}},{key:"shapeFor",value:function shapeFor(a){var b=a.getCheck();!b&&a.targetConnection&&(b=a.targetConnection.getCheck());switch(a.type){case ConnectionType$$module$build$src$core$connection_type.INPUT_VALUE:case ConnectionType$$module$build$src$core$connection_type.OUTPUT_VALUE:a=a.getSourceBlock().getOutputShape();if(null!==a)switch(a){case this.SHAPES.HEXAGONAL:return this.HEXAGONAL;case this.SHAPES.ROUND:return this.ROUNDED;case this.SHAPES.SQUARE:return this.SQUARED;}if(b&&-1!==b.indexOf("Boolean"))return this.HEXAGONAL;if(b&&-1!==b.indexOf("Number"))return this.ROUNDED;b&&b.indexOf("String");return this.ROUNDED;case ConnectionType$$module$build$src$core$connection_type.PREVIOUS_STATEMENT:case ConnectionType$$module$build$src$core$connection_type.NEXT_STATEMENT:return this.NOTCH;default:throw Error("Unknown type");}}},{key:"makeNotch",value:function makeNotch(){function a(l){return curve$$module$build$src$core$utils$svg_paths("c",[point$$module$build$src$core$utils$svg_paths(l*e/2,0),point$$module$build$src$core$utils$svg_paths(l*e*3/4,g/2),point$$module$build$src$core$utils$svg_paths(l*e,g)])+line$$module$build$src$core$utils$svg_paths([point$$module$build$src$core$utils$svg_paths(l*e,f)])+curve$$module$build$src$core$utils$svg_paths("c",[point$$module$build$src$core$utils$svg_paths(l*e/4,g/2),point$$module$build$src$core$utils$svg_paths(l*e/2,g),point$$module$build$src$core$utils$svg_paths(l*e,g)])+lineOnAxis$$module$build$src$core$utils$svg_paths("h",l*d)+curve$$module$build$src$core$utils$svg_paths("c",[point$$module$build$src$core$utils$svg_paths(l*e/2,0),point$$module$build$src$core$utils$svg_paths(l*e*3/4,-(g/2)),point$$module$build$src$core$utils$svg_paths(l*e,-g)])+line$$module$build$src$core$utils$svg_paths([point$$module$build$src$core$utils$svg_paths(l*e,-f)])+curve$$module$build$src$core$utils$svg_paths("c",[point$$module$build$src$core$utils$svg_paths(l*e/4,-(g/2)),point$$module$build$src$core$utils$svg_paths(l*e/2,-g),point$$module$build$src$core$utils$svg_paths(l*e,-g)]);}var b=this.NOTCH_WIDTH,c=this.NOTCH_HEIGHT,d=b/3,e=d/3,f=c/2,g=f/2,h=a(1),k=a(-1);return{type:this.SHAPES.NOTCH,width:b,height:c,pathLeft:h,pathRight:k};}},{key:"makeInsideCorners",value:function makeInsideCorners(){var a=this.CORNER_RADIUS,b=arc$$module$build$src$core$utils$svg_paths("a","0 0,0",a,point$$module$build$src$core$utils$svg_paths(-a,a)),c=arc$$module$build$src$core$utils$svg_paths("a","0 0,1",a,point$$module$build$src$core$utils$svg_paths(-a,a)),d=arc$$module$build$src$core$utils$svg_paths("a","0 0,0",a,point$$module$build$src$core$utils$svg_paths(a,a)),e=arc$$module$build$src$core$utils$svg_paths("a","0 0,1",a,point$$module$build$src$core$utils$svg_paths(a,a));return{width:a,height:a,pathTop:b,pathBottom:d,rightWidth:a,rightHeight:a,pathTopRight:c,pathBottomRight:e};}},{key:"generateSecondaryColour_",value:function generateSecondaryColour_(a){return blend$$module$build$src$core$utils$colour("#000",a,.15)||a;}},{key:"generateTertiaryColour_",value:function generateTertiaryColour_(a){return blend$$module$build$src$core$utils$colour("#000",a,.25)||a;}},{key:"createDom",value:function createDom(a,b,c){_get(_getPrototypeOf(ConstantProvider$$module$build$src$core$renderers$zelos$constants.prototype),"createDom",this).call(this,a,b,c);a=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.DEFS,{},a);b=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.FILTER,{id:"blocklySelectedGlowFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},a);createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.FEGAUSSIANBLUR,{"in":"SourceGraphic",stdDeviation:this.SELECTED_GLOW_SIZE},b);c=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.FECOMPONENTTRANSFER,{result:"outBlur"},b);createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},c);createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.FEFLOOD,{"flood-color":this.SELECTED_GLOW_COLOUR,"flood-opacity":1,result:"outColor"},b);createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.FECOMPOSITE,{"in":"outColor",in2:"outBlur",operator:"in",result:"outGlow"},b);this.selectedGlowFilterId=b.id;this.selectedGlowFilter_=b;a=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.FILTER,{id:"blocklyReplacementGlowFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},a);createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.FEGAUSSIANBLUR,{"in":"SourceGraphic",stdDeviation:this.REPLACEMENT_GLOW_SIZE},a);b=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.FECOMPONENTTRANSFER,{result:"outBlur"},a);createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},b);createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.FEFLOOD,{"flood-color":this.REPLACEMENT_GLOW_COLOUR,"flood-opacity":1,result:"outColor"},a);createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.FECOMPOSITE,{"in":"outColor",in2:"outBlur",operator:"in",result:"outGlow"},a);createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.FECOMPOSITE,{"in":"SourceGraphic",in2:"outGlow",operator:"over"},a);this.replacementGlowFilterId=a.id;this.replacementGlowFilter_=a;}},{key:"getCSS_",value:function getCSS_(a){return["".concat(a," .blocklyText,"),"".concat(a," .blocklyFlyoutLabelText {"),"font: ".concat(this.FIELD_TEXT_FONTWEIGHT," ").concat(this.FIELD_TEXT_FONTSIZE)+"pt ".concat(this.FIELD_TEXT_FONTFAMILY,";"),"}","".concat(a," .blocklyText {"),"fill: #fff;","}","".concat(a," .blocklyNonEditableText>rect:not(.blocklyDropdownRect),"),"".concat(a," .blocklyEditableText>rect:not(.blocklyDropdownRect) {"),"fill: ".concat(this.FIELD_BORDER_RECT_COLOUR,";"),"}","".concat(a," .blocklyNonEditableText>text,"),"".concat(a," .blocklyEditableText>text,"),"".concat(a," .blocklyNonEditableText>g>text,"),"".concat(a," .blocklyEditableText>g>text {"),"fill: #575E75;","}","".concat(a," .blocklyFlyoutLabelText {"),"fill: #575E75;","}","".concat(a," .blocklyText.blocklyBubbleText {"),"fill: #575E75;","}","".concat(a," .blocklyDraggable:not(.blocklyDisabled)")," .blocklyEditableText:not(.editing):hover>rect,","".concat(a," .blocklyDraggable:not(.blocklyDisabled)")," .blocklyEditableText:not(.editing):hover>.blocklyPath {","stroke: #fff;","stroke-width: 2;","}","".concat(a," .blocklyHtmlInput {"),"font-family: ".concat(this.FIELD_TEXT_FONTFAMILY,";"),"font-weight: ".concat(this.FIELD_TEXT_FONTWEIGHT,";"),"color: #575E75;","}","".concat(a," .blocklyDropdownText {"),"fill: #fff !important;","}","".concat(a,".blocklyWidgetDiv .goog-menuitem,"),"".concat(a,".blocklyDropDownDiv .goog-menuitem {"),"font-family: ".concat(this.FIELD_TEXT_FONTFAMILY,";"),"}","".concat(a,".blocklyDropDownDiv .goog-menuitem-content {"),"color: #fff;","}","".concat(a," .blocklyHighlightedConnectionPath {"),"stroke: ".concat(this.SELECTED_GLOW_COLOUR,";"),"}","".concat(a," .blocklyDisabled > .blocklyOutlinePath {"),"fill: url(#blocklyDisabledPattern".concat(this.randomIdentifier,")"),"}","".concat(a," .blocklyInsertionMarker>.blocklyPath {"),"fill-opacity: ".concat(this.INSERTION_MARKER_OPACITY,";"),"stroke: none;","}"];}}]);return ConstantProvider$$module$build$src$core$renderers$zelos$constants;}(ConstantProvider$$module$build$src$core$renderers$common$constants),module$build$src$core$renderers$zelos$constants={};module$build$src$core$renderers$zelos$constants.ConstantProvider=ConstantProvider$$module$build$src$core$renderers$zelos$constants;var Drawer$$module$build$src$core$renderers$zelos$drawer=/*#__PURE__*/function(_Drawer$$module$build){_inherits(Drawer$$module$build$src$core$renderers$zelos$drawer,_Drawer$$module$build);var _super64=_createSuper(Drawer$$module$build$src$core$renderers$zelos$drawer);function Drawer$$module$build$src$core$renderers$zelos$drawer(a,b){_classCallCheck(this,Drawer$$module$build$src$core$renderers$zelos$drawer);return _super64.call(this,a,b);}_createClass(Drawer$$module$build$src$core$renderers$zelos$drawer,[{key:"draw",value:function draw(){var a=this.block_.pathObject;a.beginDrawing();this.hideHiddenIcons_();this.drawOutline_();this.drawInternals_();a.setPath(this.outlinePath_+"\n"+this.inlinePath_);this.info_.RTL&&a.flipRTL();if(isDebuggerEnabled$$module$build$src$core$renderers$common$debug()){var b,c;null==(b=this.block_)||null==(c=b.renderingDebugger)||c.drawDebug(this.block_,this.info_);}this.recordSizeOnBlock_();this.info_.outputConnection&&(a.outputShapeType=this.info_.outputConnection.shape.type);a.endDrawing();}},{key:"drawOutline_",value:function drawOutline_(){this.info_.outputConnection&&this.info_.outputConnection.isDynamicShape&&!this.info_.hasStatementInput&&!this.info_.bottomRow.hasNextConnection?(this.drawFlatTop_(),this.drawRightDynamicConnection_(),this.drawFlatBottom_(),this.drawLeftDynamicConnection_()):_get(_getPrototypeOf(Drawer$$module$build$src$core$renderers$zelos$drawer.prototype),"drawOutline_",this).call(this);}},{key:"drawLeft_",value:function drawLeft_(){this.info_.outputConnection&&this.info_.outputConnection.isDynamicShape?this.drawLeftDynamicConnection_():_get(_getPrototypeOf(Drawer$$module$build$src$core$renderers$zelos$drawer.prototype),"drawLeft_",this).call(this);}},{key:"drawRightSideRow_",value:function drawRightSideRow_(a){if(!(0>=a.height))if(Types$$module$build$src$core$renderers$measurables$types.isSpacer(a)&&(a.precedesStatement||a.followsStatement)){var b=this.constants_.INSIDE_CORNERS.rightHeight;b=a.height-(a.precedesStatement?b:0);this.outlinePath_+=(a.followsStatement?this.constants_.INSIDE_CORNERS.pathBottomRight:"")+(0<b?lineOnAxis$$module$build$src$core$utils$svg_paths("V",a.yPos+b):"")+(a.precedesStatement?this.constants_.INSIDE_CORNERS.pathTopRight:"");}else this.outlinePath_+=lineOnAxis$$module$build$src$core$utils$svg_paths("V",a.yPos+a.height);}},{key:"drawRightDynamicConnection_",value:function drawRightDynamicConnection_(){if(!this.info_.outputConnection)throw Error("Cannot draw the output connection of a block that doesn't have one");this.outlinePath_+=this.info_.outputConnection.shape.pathRightDown(this.info_.outputConnection.height);}},{key:"drawLeftDynamicConnection_",value:function drawLeftDynamicConnection_(){if(!this.info_.outputConnection)throw Error("Cannot draw the output connection of a block that doesn't have one");this.positionOutputConnection_();this.outlinePath_+=this.info_.outputConnection.shape.pathUp(this.info_.outputConnection.height);this.outlinePath_+="z";}},{key:"drawFlatTop_",value:function drawFlatTop_(){var a=this.info_.topRow;this.positionPreviousConnection_();this.outlinePath_+=moveBy$$module$build$src$core$utils$svg_paths(a.xPos,this.info_.startY);this.outlinePath_+=lineOnAxis$$module$build$src$core$utils$svg_paths("h",a.width);}},{key:"drawFlatBottom_",value:function drawFlatBottom_(){var a=this.info_.bottomRow;this.positionNextConnection_();this.outlinePath_+=lineOnAxis$$module$build$src$core$utils$svg_paths("V",a.baseline);this.outlinePath_+=lineOnAxis$$module$build$src$core$utils$svg_paths("h",-a.width);}},{key:"drawInlineInput_",value:function drawInlineInput_(a){this.positionInlineInputConnection_(a);var b=a.input.name;if(!a.connectedBlock&&!this.info_.isInsertionMarker){var c=a.width-2*a.connectionWidth;a=moveTo$$module$build$src$core$utils$svg_paths(a.xPos+a.connectionWidth,a.centerline-a.height/2)+lineOnAxis$$module$build$src$core$utils$svg_paths("h",c)+a.shape.pathRightDown(a.height)+lineOnAxis$$module$build$src$core$utils$svg_paths("h",-c)+a.shape.pathUp(a.height)+"z";this.block_.pathObject.setOutlinePath(b,a);}}},{key:"drawStatementInput_",value:function drawStatementInput_(a){var b=a.getLastInput();var c=b.xPos+b.notchOffset+b.shape.width,d=b.shape.pathRight+lineOnAxis$$module$build$src$core$utils$svg_paths("h",-(b.notchOffset-this.constants_.INSIDE_CORNERS.width))+this.constants_.INSIDE_CORNERS.pathTop,e=a.height-2*this.constants_.INSIDE_CORNERS.height;b=this.constants_.INSIDE_CORNERS.pathBottom+lineOnAxis$$module$build$src$core$utils$svg_paths("h",b.notchOffset-this.constants_.INSIDE_CORNERS.width)+(b.connectedBottomNextConnection?"":b.shape.pathLeft);this.outlinePath_+=lineOnAxis$$module$build$src$core$utils$svg_paths("H",c)+d+lineOnAxis$$module$build$src$core$utils$svg_paths("v",e)+b+lineOnAxis$$module$build$src$core$utils$svg_paths("H",a.xPos+a.width);this.positionStatementInputConnection_(a);}}]);return Drawer$$module$build$src$core$renderers$zelos$drawer;}(Drawer$$module$build$src$core$renderers$common$drawer),module$build$src$core$renderers$zelos$drawer={};module$build$src$core$renderers$zelos$drawer.Drawer=Drawer$$module$build$src$core$renderers$zelos$drawer;$.FieldImage$$module$build$src$core$field_image=/*#__PURE__*/function(_Field$$module$build$3){_inherits(_class3,_Field$$module$build$3);var _super65=_createSuper(_class3);function _class3(a,b,c,d,e,f,g){var _this69;_classCallCheck(this,_class3);_this69=_super65.call(this,Field$$module$build$src$core$field.SKIP_SETUP);_this69.imageElement_=_this69.clickHandler_=null;_this69.flipRtl_=_this69.isDirty_=_this69.EDITABLE=!1;_this69.altText_="";c=Number(replaceMessageReferences$$module$build$src$core$utils$parsing(c));b=Number(replaceMessageReferences$$module$build$src$core$utils$parsing(b));if(isNaN(c)||isNaN(b))throw Error("Height and width values of an image field must cast to numbers.");if(0>=c||0>=b)throw Error("Height and width values of an image field must be greater than 0.");_this69.size_=new Size$$module$build$src$core$utils$size(b,c+$.FieldImage$$module$build$src$core$field_image.Y_PADDING);_this69.imageHeight_=c;"function"===typeof e&&(_this69.clickHandler_=e);a!==Field$$module$build$src$core$field.SKIP_SETUP&&(g?_this69.configure_(g):(_this69.flipRtl_=!!f,_this69.altText_=replaceMessageReferences$$module$build$src$core$utils$parsing(d)||""),_this69.setValue(replaceMessageReferences$$module$build$src$core$utils$parsing(a)));return _this69;}_createClass(_class3,[{key:"configure_",value:function configure_(a){_get(_getPrototypeOf(_class3.prototype),"configure_",this).call(this,a);a.flipRtl&&(this.flipRtl_=a.flipRtl);a.alt&&(this.altText_=replaceMessageReferences$$module$build$src$core$utils$parsing(a.alt));}},{key:"initView",value:function initView(){this.imageElement_=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.IMAGE,{height:this.imageHeight_+"px",width:this.size_.width+"px",alt:this.altText_},this.fieldGroup_);this.imageElement_.setAttributeNS(XLINK_NS$$module$build$src$core$utils$dom,"xlink:href",this.value_);this.clickHandler_&&(this.imageElement_.style.cursor="pointer");}},{key:"updateSize_",value:function updateSize_(){}},{key:"doClassValidation_",value:function doClassValidation_(a){return"string"!==typeof a?null:a;}},{key:"doValueUpdate_",value:function doValueUpdate_(a){this.value_=a;this.imageElement_&&this.imageElement_.setAttributeNS(XLINK_NS$$module$build$src$core$utils$dom,"xlink:href",String(this.value_));}},{key:"getFlipRtl",value:function getFlipRtl(){return this.flipRtl_;}},{key:"setAlt",value:function setAlt(a){a!==this.altText_&&(this.altText_=a||"",this.imageElement_&&this.imageElement_.setAttribute("alt",this.altText_));}},{key:"showEditor_",value:function showEditor_(){this.clickHandler_&&this.clickHandler_(this);}},{key:"setOnClickHandler",value:function setOnClickHandler(a){this.clickHandler_=a;}},{key:"getText_",value:function getText_(){return this.altText_;}}],[{key:"fromJson",value:function fromJson(a){if(!a.src||!a.width||!a.height)throw Error("src, width, and height values for an image field arerequired. The width and height must be non-zero.");return new this(a.src,a.width,a.height,void 0,void 0,void 0,a);}}]);return _class3;}(Field$$module$build$src$core$field);$.FieldImage$$module$build$src$core$field_image.Y_PADDING=1;register$$module$build$src$core$field_registry("field_image",$.FieldImage$$module$build$src$core$field_image);$.FieldImage$$module$build$src$core$field_image.prototype.DEFAULT_VALUE="";var module$build$src$core$field_image={};module$build$src$core$field_image.FieldImage=$.FieldImage$$module$build$src$core$field_image;$.FieldTextInput$$module$build$src$core$field_textinput=/*#__PURE__*/function(_Field$$module$build$4){_inherits(_class4,_Field$$module$build$4);var _super66=_createSuper(_class4);function _class4(a,b,c){var _this70;_classCallCheck(this,_class4);_this70=_super66.call(this,Field$$module$build$src$core$field.SKIP_SETUP);_this70.spellcheck_=!0;_this70.htmlInput_=null;_this70.isTextValid_=_this70.isBeingEdited_=!1;_this70.onKeyInputWrapper_=_this70.onKeyDownWrapper_=null;_this70.fullBlockClickTarget_=!1;_this70.workspace_=null;_this70.SERIALIZABLE=!0;_this70.CURSOR="text";a!==Field$$module$build$src$core$field.SKIP_SETUP&&(c&&_this70.configure_(c),_this70.setValue(a),b&&_this70.setValidator(b));return _this70;}_createClass(_class4,[{key:"configure_",value:function configure_(a){_get(_getPrototypeOf(_class4.prototype),"configure_",this).call(this,a);void 0!==a.spellcheck&&(this.spellcheck_=a.spellcheck);}},{key:"initView",value:function initView(){var a=this.getSourceBlock();if(!a)throw new UnattachedFieldError$$module$build$src$core$field();if(this.getConstants().FULL_BLOCK_FIELDS){var b=0,c=0;for(var d=0,e;e=a.inputList[d];d++){for(var f=0;e.fieldRow[f];f++){b++;}e.connection&&c++;}this.fullBlockClickTarget_=1>=b&&a.outputConnection&&!c;}else this.fullBlockClickTarget_=!1;this.fullBlockClickTarget_?this.clickTarget_=this.sourceBlock_.getSvgRoot():this.createBorderRect_();this.createTextElement_();}},{key:"doClassValidation_",value:function doClassValidation_(a){return null===a||void 0===a?null:String(a);}},{key:"doValueInvalid_",value:function doValueInvalid_(a){this.isBeingEdited_&&(this.isTextValid_=!1,a=this.value_,this.value_=this.htmlInput_.getAttribute("data-untyped-default-value"),this.sourceBlock_&&isEnabled$$module$build$src$core$events$utils()&&fire$$module$build$src$core$events$utils(new(get$$module$build$src$core$events$utils(CHANGE$$module$build$src$core$events$utils))(this.sourceBlock_,"field",this.name||null,a,this.value_)));}},{key:"doValueUpdate_",value:function doValueUpdate_(a){this.isTextValid_=!0;this.value_=a;this.isBeingEdited_||(this.isDirty_=!0);}},{key:"applyColour",value:function applyColour(){if(this.sourceBlock_&&this.getConstants().FULL_BLOCK_FIELDS){var a=this.sourceBlock_;this.borderRect_?this.borderRect_.setAttribute("stroke",a.style.colourTertiary):a.pathObject.svgPath.setAttribute("fill",this.getConstants().FIELD_BORDER_RECT_COLOUR);}}},{key:"render_",value:function render_(){_get(_getPrototypeOf(_class4.prototype),"render_",this).call(this);if(this.isBeingEdited_){this.resizeEditor_();var a=this.htmlInput_;this.isTextValid_?(removeClass$$module$build$src$core$utils$dom(a,"blocklyInvalidInput"),setState$$module$build$src$core$utils$aria(a,State$$module$build$src$core$utils$aria.INVALID,!1)):(addClass$$module$build$src$core$utils$dom(a,"blocklyInvalidInput"),setState$$module$build$src$core$utils$aria(a,State$$module$build$src$core$utils$aria.INVALID,!0));}}},{key:"setSpellcheck",value:function setSpellcheck(a){a!==this.spellcheck_&&(this.spellcheck_=a,this.htmlInput_&&this.htmlInput_.setAttribute("spellcheck",this.spellcheck_));}},{key:"showEditor_",value:function showEditor_(a,b){this.workspace_=this.sourceBlock_.workspace;a=b||!1;!a&&(MOBILE$$module$build$src$core$utils$useragent||ANDROID$$module$build$src$core$utils$useragent||IPAD$$module$build$src$core$utils$useragent)?this.showPromptEditor_():this.showInlineEditor_(a);}},{key:"showPromptEditor_",value:function showPromptEditor_(){var _this71=this;prompt$$module$build$src$core$dialog(Msg$$module$build$src$core$msg.CHANGE_VALUE_TITLE,this.getText(),function(a){null!==a&&_this71.setValue(_this71.getValueFromEditorText_(a));});}},{key:"showInlineEditor_",value:function showInlineEditor_(a){var b=this.getSourceBlock();if(!b)throw new UnattachedFieldError$$module$build$src$core$field();show$$module$build$src$core$widgetdiv(this,b.RTL,this.widgetDispose_.bind(this));this.htmlInput_=this.widgetCreate_();this.isBeingEdited_=!0;a||(this.htmlInput_.focus({preventScroll:!0}),this.htmlInput_.select());}},{key:"widgetCreate_",value:function widgetCreate_(){var a=this.getSourceBlock();if(!a)throw new UnattachedFieldError$$module$build$src$core$field();setGroup$$module$build$src$core$events$utils(!0);var b=getDiv$$module$build$src$core$widgetdiv();var c=this.getClickTarget_();if(!c)throw Error("A click target has not been set.");addClass$$module$build$src$core$utils$dom(c,"editing");c=document.createElement("input");c.className="blocklyHtmlInput";c.setAttribute("spellcheck",this.spellcheck_);var d=this.workspace_.getScale();var e=this.getConstants().FIELD_TEXT_FONTSIZE*d+"pt";b.style.fontSize=e;c.style.fontSize=e;e=$.FieldTextInput$$module$build$src$core$field_textinput.BORDERRADIUS*d+"px";this.fullBlockClickTarget_&&(e=this.getScaledBBox(),e=(e.bottom-e.top)/2+"px",a=a.getParent()?a.getParent().style.colourTertiary:this.sourceBlock_.style.colourTertiary,c.style.border=1*d+"px solid "+a,b.style.borderRadius=e,b.style.transition="box-shadow 0.25s ease 0s",this.getConstants().FIELD_TEXTINPUT_BOX_SHADOW&&(b.style.boxShadow="rgba(255, 255, 255, 0.3) 0 0 0 "+4*d+"px"));c.style.borderRadius=e;b.appendChild(c);c.value=c.defaultValue=this.getEditorText_(this.value_);c.setAttribute("data-untyped-default-value",this.value_);c.setAttribute("data-old-value","");this.resizeEditor_();this.bindInputEvents_(c);return c;}},{key:"widgetDispose_",value:function widgetDispose_(){this.isBeingEdited_=!1;this.isTextValid_=!0;this.forceRerender();this.onFinishEditing_(this.value_);setGroup$$module$build$src$core$events$utils(!1);this.unbindInputEvents_();var a=getDiv$$module$build$src$core$widgetdiv().style;a.width="auto";a.height="auto";a.fontSize="";a.transition="";a.boxShadow="";this.htmlInput_=null;a=this.getClickTarget_();if(!a)throw Error("A click target has not been set.");removeClass$$module$build$src$core$utils$dom(a,"editing");}},{key:"onFinishEditing_",value:function onFinishEditing_(a){}},{key:"bindInputEvents_",value:function bindInputEvents_(a){this.onKeyDownWrapper_=conditionalBind$$module$build$src$core$browser_events(a,"keydown",this,this.onHtmlInputKeyDown_);this.onKeyInputWrapper_=conditionalBind$$module$build$src$core$browser_events(a,"input",this,this.onHtmlInputChange_);}},{key:"unbindInputEvents_",value:function unbindInputEvents_(){this.onKeyDownWrapper_&&(unbind$$module$build$src$core$browser_events(this.onKeyDownWrapper_),this.onKeyDownWrapper_=null);this.onKeyInputWrapper_&&(unbind$$module$build$src$core$browser_events(this.onKeyInputWrapper_),this.onKeyInputWrapper_=null);}},{key:"onHtmlInputKeyDown_",value:function onHtmlInputKeyDown_(a){a.keyCode===KeyCodes$$module$build$src$core$utils$keycodes.ENTER?(hide$$module$build$src$core$widgetdiv(),hideWithoutAnimation$$module$build$src$core$dropdowndiv()):a.keyCode===KeyCodes$$module$build$src$core$utils$keycodes.ESC?(this.setValue(this.htmlInput_.getAttribute("data-untyped-default-value")),hide$$module$build$src$core$widgetdiv(),hideWithoutAnimation$$module$build$src$core$dropdowndiv()):a.keyCode===KeyCodes$$module$build$src$core$utils$keycodes.TAB&&(hide$$module$build$src$core$widgetdiv(),hideWithoutAnimation$$module$build$src$core$dropdowndiv(),this.sourceBlock_.tab(this,!a.shiftKey),a.preventDefault());}},{key:"onHtmlInputChange_",value:function onHtmlInputChange_(a){a=this.htmlInput_.value;a!==this.htmlInput_.getAttribute("data-old-value")&&(this.htmlInput_.setAttribute("data-old-value",a),a=this.getValueFromEditorText_(a),this.setValue(a),this.forceRerender(),this.resizeEditor_());}},{key:"setEditorValue_",value:function setEditorValue_(a){this.isDirty_=!0;this.isBeingEdited_&&(this.htmlInput_.value=this.getEditorText_(a));this.setValue(a);}},{key:"resizeEditor_",value:function resizeEditor_(){var a=this.getSourceBlock();if(!a)throw new UnattachedFieldError$$module$build$src$core$field();var b=getDiv$$module$build$src$core$widgetdiv(),c=this.getScaledBBox();b.style.width=c.right-c.left+"px";b.style.height=c.bottom-c.top+"px";a=new Coordinate$$module$build$src$core$utils$coordinate(a.RTL?c.right-b.offsetWidth:c.left,c.top);b.style.left=a.x+"px";b.style.top=a.y+"px";}},{key:"isTabNavigable",value:function isTabNavigable(){return!0;}},{key:"getText_",value:function getText_(){return this.isBeingEdited_&&this.htmlInput_?this.htmlInput_.value:null;}},{key:"getEditorText_",value:function getEditorText_(a){return String(a);}},{key:"getValueFromEditorText_",value:function getValueFromEditorText_(a){return a;}}],[{key:"fromJson",value:function fromJson(a){return new this(replaceMessageReferences$$module$build$src$core$utils$parsing(a.text),void 0,a);}}]);return _class4;}(Field$$module$build$src$core$field);$.FieldTextInput$$module$build$src$core$field_textinput.BORDERRADIUS=4;register$$module$build$src$core$field_registry("field_input",$.FieldTextInput$$module$build$src$core$field_textinput);$.FieldTextInput$$module$build$src$core$field_textinput.prototype.DEFAULT_VALUE="";var module$build$src$core$field_textinput={};module$build$src$core$field_textinput.FieldTextInput=$.FieldTextInput$$module$build$src$core$field_textinput;var BottomRow$$module$build$src$core$renderers$zelos$measurables$bottom_row=/*#__PURE__*/function(_BottomRow$$module$bu){_inherits(BottomRow$$module$build$src$core$renderers$zelos$measurables$bottom_row,_BottomRow$$module$bu);var _super67=_createSuper(BottomRow$$module$build$src$core$renderers$zelos$measurables$bottom_row);function BottomRow$$module$build$src$core$renderers$zelos$measurables$bottom_row(a){_classCallCheck(this,BottomRow$$module$build$src$core$renderers$zelos$measurables$bottom_row);return _super67.call(this,a);}_createClass(BottomRow$$module$build$src$core$renderers$zelos$measurables$bottom_row,[{key:"endsWithElemSpacer",value:function endsWithElemSpacer(){return!1;}},{key:"hasLeftSquareCorner",value:function hasLeftSquareCorner(a){return!!a.outputConnection;}},{key:"hasRightSquareCorner",value:function hasRightSquareCorner(a){return!!a.outputConnection&&!a.statementInputCount&&!a.nextConnection;}}]);return BottomRow$$module$build$src$core$renderers$zelos$measurables$bottom_row;}(BottomRow$$module$build$src$core$renderers$measurables$bottom_row),module$build$src$core$renderers$zelos$measurables$bottom_row={};module$build$src$core$renderers$zelos$measurables$bottom_row.BottomRow=BottomRow$$module$build$src$core$renderers$zelos$measurables$bottom_row;var StatementInput$$module$build$src$core$renderers$zelos$measurables$inputs=/*#__PURE__*/function(_StatementInput$$modu){_inherits(StatementInput$$module$build$src$core$renderers$zelos$measurables$inputs,_StatementInput$$modu);var _super68=_createSuper(StatementInput$$module$build$src$core$renderers$zelos$measurables$inputs);function StatementInput$$module$build$src$core$renderers$zelos$measurables$inputs(a,b){var _this72;_classCallCheck(this,StatementInput$$module$build$src$core$renderers$zelos$measurables$inputs);_this72=_super68.call(this,a,b);_this72.connectedBottomNextConnection=!1;if(_this72.connectedBlock){for(a=_this72.connectedBlock;b=a.getNextBlock();){a=b;}a.nextConnection||(_this72.height=_this72.connectedBlockHeight,_this72.connectedBottomNextConnection=!0);}return _this72;}return _createClass(StatementInput$$module$build$src$core$renderers$zelos$measurables$inputs);}(StatementInput$$module$build$src$core$renderers$measurables$statement_input),module$build$src$core$renderers$zelos$measurables$inputs={};module$build$src$core$renderers$zelos$measurables$inputs.StatementInput=StatementInput$$module$build$src$core$renderers$zelos$measurables$inputs;var RightConnectionShape$$module$build$src$core$renderers$zelos$measurables$row_elements=/*#__PURE__*/function(_Measurable$$module$b9){_inherits(RightConnectionShape$$module$build$src$core$renderers$zelos$measurables$row_elements,_Measurable$$module$b9);var _super69=_createSuper(RightConnectionShape$$module$build$src$core$renderers$zelos$measurables$row_elements);function RightConnectionShape$$module$build$src$core$renderers$zelos$measurables$row_elements(a){var _this73;_classCallCheck(this,RightConnectionShape$$module$build$src$core$renderers$zelos$measurables$row_elements);_this73=_super69.call(this,a);_this73.width=_this73.height=0;_this73.type|=Types$$module$build$src$core$renderers$measurables$types.getType("RIGHT_CONNECTION");return _this73;}return _createClass(RightConnectionShape$$module$build$src$core$renderers$zelos$measurables$row_elements);}(Measurable$$module$build$src$core$renderers$measurables$base),module$build$src$core$renderers$zelos$measurables$row_elements={};module$build$src$core$renderers$zelos$measurables$row_elements.RightConnectionShape=RightConnectionShape$$module$build$src$core$renderers$zelos$measurables$row_elements;var TopRow$$module$build$src$core$renderers$zelos$measurables$top_row=/*#__PURE__*/function(_TopRow$$module$build){_inherits(TopRow$$module$build$src$core$renderers$zelos$measurables$top_row,_TopRow$$module$build);var _super70=_createSuper(TopRow$$module$build$src$core$renderers$zelos$measurables$top_row);function TopRow$$module$build$src$core$renderers$zelos$measurables$top_row(a){_classCallCheck(this,TopRow$$module$build$src$core$renderers$zelos$measurables$top_row);return _super70.call(this,a);}_createClass(TopRow$$module$build$src$core$renderers$zelos$measurables$top_row,[{key:"endsWithElemSpacer",value:function endsWithElemSpacer(){return!1;}},{key:"hasLeftSquareCorner",value:function hasLeftSquareCorner(a){var b=(a.hat?"cap"===a.hat:this.constants_.ADD_START_HATS)&&!a.outputConnection&&!a.previousConnection;return!!a.outputConnection||b;}},{key:"hasRightSquareCorner",value:function hasRightSquareCorner(a){return!!a.outputConnection&&!a.statementInputCount&&!a.nextConnection;}}]);return TopRow$$module$build$src$core$renderers$zelos$measurables$top_row;}(TopRow$$module$build$src$core$renderers$measurables$top_row),module$build$src$core$renderers$zelos$measurables$top_row={};module$build$src$core$renderers$zelos$measurables$top_row.TopRow=TopRow$$module$build$src$core$renderers$zelos$measurables$top_row;var RenderInfo$$module$build$src$core$renderers$zelos$info=/*#__PURE__*/function(_RenderInfo$$module$b){_inherits(RenderInfo$$module$build$src$core$renderers$zelos$info,_RenderInfo$$module$b);var _super71=_createSuper(RenderInfo$$module$build$src$core$renderers$zelos$info);function RenderInfo$$module$build$src$core$renderers$zelos$info(a,b){var _this74;_classCallCheck(this,RenderInfo$$module$build$src$core$renderers$zelos$info);_this74=_super71.call(this,a,b);_this74.isInline=!0;_this74.renderer_=a;_this74.constants_=_this74.renderer_.getConstants();_this74.topRow=new TopRow$$module$build$src$core$renderers$zelos$measurables$top_row(_this74.constants_);_this74.bottomRow=new BottomRow$$module$build$src$core$renderers$zelos$measurables$bottom_row(_this74.constants_);_this74.isMultiRow=!b.getInputsInline()||b.isCollapsed();_this74.hasStatementInput=0<b.statementInputCount;_this74.rightSide=_this74.outputConnection?new RightConnectionShape$$module$build$src$core$renderers$zelos$measurables$row_elements(_this74.constants_):null;_this74.rightAlignedDummyInputs_=new WeakMap();return _this74;}_createClass(RenderInfo$$module$build$src$core$renderers$zelos$info,[{key:"getRenderer",value:function getRenderer(){return this.renderer_;}},{key:"measure",value:function measure(){this.createRows_();this.addElemSpacing_();this.addRowSpacing_();this.adjustXPosition_();this.computeBounds_();this.alignRowElements_();this.finalize_();}},{key:"shouldStartNewRow_",value:function shouldStartNewRow_(a,b){return b?a.type===inputTypes$$module$build$src$core$input_types.STATEMENT||b.type===inputTypes$$module$build$src$core$input_types.STATEMENT?!0:a.type===inputTypes$$module$build$src$core$input_types.VALUE||a.type===inputTypes$$module$build$src$core$input_types.DUMMY?!this.isInline||this.isMultiRow:!1:!1;}},{key:"getDesiredRowWidth_",value:function getDesiredRowWidth_(a){return a.hasStatement?this.width-this.startX-(this.constants_.INSIDE_CORNERS.rightWidth||0):_get(_getPrototypeOf(RenderInfo$$module$build$src$core$renderers$zelos$info.prototype),"getDesiredRowWidth_",this).call(this,a);}},{key:"getInRowSpacing_",value:function getInRowSpacing_(a,b){return a&&b||!this.outputConnection||!this.outputConnection.isDynamicShape||this.hasStatementInput||this.bottomRow.hasNextConnection?!a&&b&&Types$$module$build$src$core$renderers$measurables$types.isStatementInput(b)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:a&&Types$$module$build$src$core$renderers$measurables$types.isLeftRoundedCorner(a)&&b&&(Types$$module$build$src$core$renderers$measurables$types.isPreviousConnection(b)||Types$$module$build$src$core$renderers$measurables$types.isNextConnection(b))?b.notchOffset-this.constants_.CORNER_RADIUS:a&&Types$$module$build$src$core$renderers$measurables$types.isLeftSquareCorner(a)&&b&&Types$$module$build$src$core$renderers$measurables$types.isHat(b)?this.constants_.NO_PADDING:this.constants_.MEDIUM_PADDING:this.constants_.NO_PADDING;}},{key:"getSpacerRowHeight_",value:function getSpacerRowHeight_(a,b){if(Types$$module$build$src$core$renderers$measurables$types.isTopRow(a)&&Types$$module$build$src$core$renderers$measurables$types.isBottomRow(b))return this.constants_.EMPTY_BLOCK_SPACER_HEIGHT;var c=Types$$module$build$src$core$renderers$measurables$types.isInputRow(a)&&a.hasStatement,d=Types$$module$build$src$core$renderers$measurables$types.isInputRow(b)&&b.hasStatement;return d||c?(a=Math.max(this.constants_.NOTCH_HEIGHT,this.constants_.INSIDE_CORNERS.rightHeight||0),d&&c?Math.max(a,this.constants_.DUMMY_INPUT_MIN_HEIGHT):a):Types$$module$build$src$core$renderers$measurables$types.isTopRow(a)?a.hasPreviousConnection||this.outputConnection&&!this.hasStatementInput?this.constants_.NO_PADDING:Math.abs(this.constants_.NOTCH_HEIGHT-this.constants_.CORNER_RADIUS):Types$$module$build$src$core$renderers$measurables$types.isBottomRow(b)?this.outputConnection?!b.hasNextConnection&&this.hasStatementInput?Math.abs(this.constants_.NOTCH_HEIGHT-this.constants_.CORNER_RADIUS):this.constants_.NO_PADDING:Math.max(this.topRow.minHeight,Math.max(this.constants_.NOTCH_HEIGHT,this.constants_.CORNER_RADIUS))-this.constants_.CORNER_RADIUS:this.constants_.MEDIUM_PADDING;}},{key:"getSpacerRowWidth_",value:function getSpacerRowWidth_(a,b){var c=this.width-this.startX;return Types$$module$build$src$core$renderers$measurables$types.isInputRow(a)&&a.hasStatement||Types$$module$build$src$core$renderers$measurables$types.isInputRow(b)&&b.hasStatement?Math.max(c,this.constants_.STATEMENT_INPUT_SPACER_MIN_WIDTH):c;}},{key:"getElemCenterline_",value:function getElemCenterline_(a,b){if(a.hasStatement&&!Types$$module$build$src$core$renderers$measurables$types.isSpacer(b)&&!Types$$module$build$src$core$renderers$measurables$types.isStatementInput(b))return a.yPos+this.constants_.EMPTY_STATEMENT_INPUT_HEIGHT/2;if(Types$$module$build$src$core$renderers$measurables$types.isInlineInput(b)&&b instanceof InputConnection$$module$build$src$core$renderers$measurables$input_connection){var c=b.connectedBlock;if(c&&c.outputConnection&&c.nextConnection)return a.yPos+c.height/2;}return _get(_getPrototypeOf(RenderInfo$$module$build$src$core$renderers$zelos$info.prototype),"getElemCenterline_",this).call(this,a,b);}},{key:"addInput_",value:function addInput_(a,b){if(a.type===inputTypes$$module$build$src$core$input_types.DUMMY&&b.hasDummyInput&&b.align===$.Align$$module$build$src$core$input.LEFT&&a.align===$.Align$$module$build$src$core$input.RIGHT)this.rightAlignedDummyInputs_.set(b,a);else if(a.type===inputTypes$$module$build$src$core$input_types.STATEMENT){b.elements.push(new StatementInput$$module$build$src$core$renderers$zelos$measurables$inputs(this.constants_,a));b.hasStatement=!0;null===b.align&&(b.align=a.align);return;}_get(_getPrototypeOf(RenderInfo$$module$build$src$core$renderers$zelos$info.prototype),"addInput_",this).call(this,a,b);}},{key:"addAlignmentPadding_",value:function addAlignmentPadding_(a,b){if(this.rightAlignedDummyInputs_.get(a)){var c;for(var d=0;d<a.elements.length;d++){var e=a.elements[d];Types$$module$build$src$core$renderers$measurables$types.isSpacer(e)&&(c=e);if(Types$$module$build$src$core$renderers$measurables$types.isField(e)&&e instanceof Field$$module$build$src$core$renderers$measurables$field&&e.parentInput===this.rightAlignedDummyInputs_.get(a))break;}if(c){c.width+=b;a.width+=b;return;}}_get(_getPrototypeOf(RenderInfo$$module$build$src$core$renderers$zelos$info.prototype),"addAlignmentPadding_",this).call(this,a,b);}},{key:"adjustXPosition_",value:function adjustXPosition_(){var a=this.constants_.NOTCH_OFFSET_LEFT+this.constants_.NOTCH_WIDTH;var b=a;for(var e=2;e<this.rows.length-1;e+=2){var c=this.rows[e-1];var f=this.rows[e];var d=this.rows[e+1];c=2===e?!!this.topRow.hasPreviousConnection:!!c.followsStatement;d=e+2>=this.rows.length-1?!!this.bottomRow.hasNextConnection:!!d.precedesStatement;if(Types$$module$build$src$core$renderers$measurables$types.isInputRow(f)&&f.hasStatement){f.measure();var g=void 0,h=void 0;b=f.width-(null!=(h=null==(g=f.getLastInput())?void 0:g.width)?h:0)+a;}else if(c&&(2===e||d)&&Types$$module$build$src$core$renderers$measurables$types.isInputRow(f)&&!f.hasStatement){d=f.xPos;c=null;for(var _g5=0;_g5<f.elements.length;_g5++){var _h3=f.elements[_g5];Types$$module$build$src$core$renderers$measurables$types.isSpacer(_h3)&&(c=_h3);c&&(Types$$module$build$src$core$renderers$measurables$types.isField(_h3)||Types$$module$build$src$core$renderers$measurables$types.isInput(_h3))&&d<b&&!(Types$$module$build$src$core$renderers$measurables$types.isField(_h3)&&_h3 instanceof Field$$module$build$src$core$renderers$measurables$field&&(_h3.field instanceof $.FieldLabel$$module$build$src$core$field_label||_h3.field instanceof $.FieldImage$$module$build$src$core$field_image))&&(c.width+=b-d);d+=_h3.width;}}}}},{key:"finalizeOutputConnection_",value:function finalizeOutputConnection_(){if(this.outputConnection&&this.outputConnection.isDynamicShape){var a=this.outputConnection.shape;if("isDynamic"in a&&a.isDynamic){var b=0;for(var c=0;c<this.rows.length;c++){var d=this.rows[c];d.yPos=b;b+=d.height;}this.height=b;c=this.bottomRow.hasNextConnection?this.height-this.bottomRow.descenderHeight:this.height;b=a.height(c);c=a.width(c);this.outputConnection.height=b;this.outputConnection.width=c;this.outputConnection.startX=c;this.outputConnection.connectionOffsetY=a.connectionOffsetY(b);this.outputConnection.connectionOffsetX=a.connectionOffsetX(c);a=0;this.hasStatementInput||this.bottomRow.hasNextConnection||(a=c,this.rightSide.height=b,this.rightSide.width=a,this.rightSide.centerline=b/2,this.rightSide.xPos=this.width+a);this.startX=c;this.width+=c+a;this.widthWithChildren+=c+a;}}}},{key:"finalizeHorizontalAlignment_",value:function finalizeHorizontalAlignment_(){if(this.outputConnection&&!this.hasStatementInput&&!this.bottomRow.hasNextConnection){var a=0;for(var b=0;b<this.rows.length;b++){var c=this.rows[b];if(!Types$$module$build$src$core$renderers$measurables$types.isInputRow(c))continue;a=c.elements[c.elements.length-2];var d=this.getNegativeSpacing_(c.elements[1]),e=this.getNegativeSpacing_(a);a=d+e;var f=this.constants_.MIN_BLOCK_WIDTH+2*this.outputConnection.width;this.width-a<f&&(a=this.width-f,d=a/2,e=a/2);c.elements.unshift(new InRowSpacer$$module$build$src$core$renderers$measurables$in_row_spacer(this.constants_,-d));c.elements.push(new InRowSpacer$$module$build$src$core$renderers$measurables$in_row_spacer(this.constants_,-e));}if(a)for(this.width-=a,this.widthWithChildren-=a,this.rightSide.xPos-=a,b=0;b<this.rows.length;b++){c=this.rows[b],Types$$module$build$src$core$renderers$measurables$types.isTopOrBottomRow(c)&&(c.elements[1].width-=a),c.width-=a,c.widthWithConnectedBlocks-=a;}}}},{key:"getNegativeSpacing_",value:function getNegativeSpacing_(a){if(!a||!this.outputConnection)return 0;var b=this.outputConnection.width;var c=this.outputConnection.shape.type;var d=this.constants_;if(this.isMultiRow&&1<this.inputRows.length)switch(c){case d.SHAPES.ROUND:return c=this.constants_.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH,c=this.height/2>c?c:this.height/2,b-c*(1-Math.sin(Math.acos((c-this.constants_.SMALL_PADDING)/c)));default:return 0;}if(Types$$module$build$src$core$renderers$measurables$types.isInlineInput(a)&&a instanceof InputConnection$$module$build$src$core$renderers$measurables$input_connection){var e=a.connectedBlock;a=e?e.pathObject.outputShapeType:a.shape.type;return null==a||e&&e.outputConnection&&(e.statementInputCount||e.nextConnection)||c===d.SHAPES.HEXAGONAL&&c!==a?0:b-this.constants_.SHAPE_IN_SHAPE_PADDING[c][a];}return Types$$module$build$src$core$renderers$measurables$types.isField(a)&&a instanceof Field$$module$build$src$core$renderers$measurables$field?c===d.SHAPES.ROUND&&a.field instanceof $.FieldTextInput$$module$build$src$core$field_textinput?b-2.75*d.GRID_UNIT:b-this.constants_.SHAPE_IN_SHAPE_PADDING[c][0]:Types$$module$build$src$core$renderers$measurables$types.isIcon(a)?this.constants_.SMALL_PADDING:0;}},{key:"finalizeVerticalAlignment_",value:function finalizeVerticalAlignment_(){if(!this.outputConnection)for(var d=2;d<this.rows.length-1;d+=2){var e=this.rows[d-1],f=this.rows[d],g=this.rows[d+1];var a=2===d,b=d+2>=this.rows.length-1?!!this.bottomRow.hasNextConnection:!!g.precedesStatement;if(a?this.topRow.hasPreviousConnection:e.followsStatement){var c=f.elements[1];c=3===f.elements.length&&c instanceof Field$$module$build$src$core$renderers$measurables$field&&(c.field instanceof $.FieldLabel$$module$build$src$core$field_label||c.field instanceof $.FieldImage$$module$build$src$core$field_image);if(!a&&c)e.height-=this.constants_.SMALL_PADDING,g.height-=this.constants_.SMALL_PADDING,f.height-=this.constants_.MEDIUM_PADDING;else if(!a&&!b)e.height+=this.constants_.SMALL_PADDING;else if(b){a=!1;for(b=0;b<f.elements.length;b++){if(c=f.elements[b],c instanceof InputConnection$$module$build$src$core$renderers$measurables$input_connection&&Types$$module$build$src$core$renderers$measurables$types.isInlineInput(c)&&c.connectedBlock&&!c.connectedBlock.isShadow()&&40<=c.connectedBlock.getHeightWidth().height){a=!0;break;}}a&&(e.height-=this.constants_.SMALL_PADDING,g.height-=this.constants_.SMALL_PADDING);}}}}},{key:"finalize_",value:function finalize_(){this.finalizeOutputConnection_();this.finalizeHorizontalAlignment_();this.finalizeVerticalAlignment_();_get(_getPrototypeOf(RenderInfo$$module$build$src$core$renderers$zelos$info.prototype),"finalize_",this).call(this);this.rightSide&&(this.widthWithChildren+=this.rightSide.width);}}]);return RenderInfo$$module$build$src$core$renderers$zelos$info;}(RenderInfo$$module$build$src$core$renderers$common$info),module$build$src$core$renderers$zelos$info={};module$build$src$core$renderers$zelos$info.RenderInfo=RenderInfo$$module$build$src$core$renderers$zelos$info;var MarkerSvg$$module$build$src$core$renderers$zelos$marker_svg=/*#__PURE__*/function(_MarkerSvg$$module$bu){_inherits(MarkerSvg$$module$build$src$core$renderers$zelos$marker_svg,_MarkerSvg$$module$bu);var _super72=_createSuper(MarkerSvg$$module$build$src$core$renderers$zelos$marker_svg);function MarkerSvg$$module$build$src$core$renderers$zelos$marker_svg(a,b,c){var _this75;_classCallCheck(this,MarkerSvg$$module$build$src$core$renderers$zelos$marker_svg);_this75=_super72.call(this,a,b,c);_this75.markerCircle_=null;return _this75;}_createClass(MarkerSvg$$module$build$src$core$renderers$zelos$marker_svg,[{key:"showWithInputOutput_",value:function showWithInputOutput_(a){var b=a.getSourceBlock();a=a.getLocation().getOffsetInBlock();this.positionCircle_(a.x,a.y);this.setParent_(b);this.showCurrent_();}},{key:"showWithOutput_",value:function showWithOutput_(a){this.showWithInputOutput_(a);}},{key:"showWithInput_",value:function showWithInput_(a){this.showWithInputOutput_(a);}},{key:"showWithBlock_",value:function showWithBlock_(a){a=a.getLocation();var b=a.getHeightWidth();this.positionRect_(0,0,b.width,b.height);this.setParent_(a);this.showCurrent_();}},{key:"positionCircle_",value:function positionCircle_(a,b){var c;null==(c=this.markerCircle_)||c.setAttribute("cx",a.toString());var d;null==(d=this.markerCircle_)||d.setAttribute("cy",b.toString());this.currentMarkerSvg=this.markerCircle_;}},{key:"hide",value:function hide(){_get(_getPrototypeOf(MarkerSvg$$module$build$src$core$renderers$zelos$marker_svg.prototype),"hide",this).call(this);this.markerCircle_&&(this.markerCircle_.style.display="none");}},{key:"createDomInternal_",value:function createDomInternal_(){_get(_getPrototypeOf(MarkerSvg$$module$build$src$core$renderers$zelos$marker_svg.prototype),"createDomInternal_",this).call(this);this.markerCircle_=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.CIRCLE,{r:this.constants_.CURSOR_RADIUS,style:"display: none","stroke-width":this.constants_.CURSOR_STROKE_WIDTH},this.markerSvg_);if(this.isCursor()){var a=this.getBlinkProperties_();createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.ANIMATE,a,this.markerCircle_);}return this.markerSvg_;}},{key:"applyColour_",value:function applyColour_(a){_get(_getPrototypeOf(MarkerSvg$$module$build$src$core$renderers$zelos$marker_svg.prototype),"applyColour_",this).call(this,a);var b;null==(b=this.markerCircle_)||b.setAttribute("fill",this.colour_);var c;null==(c=this.markerCircle_)||c.setAttribute("stroke",this.colour_);if(this.isCursor()){a=this.colour_+";transparent;transparent;";var d;null==(d=this.markerCircle_)||d.firstElementChild.setAttribute("values",a);}}}]);return MarkerSvg$$module$build$src$core$renderers$zelos$marker_svg;}(MarkerSvg$$module$build$src$core$renderers$common$marker_svg),module$build$src$core$renderers$zelos$marker_svg={};module$build$src$core$renderers$zelos$marker_svg.MarkerSvg=MarkerSvg$$module$build$src$core$renderers$zelos$marker_svg;var PathObject$$module$build$src$core$renderers$zelos$path_object=/*#__PURE__*/function(_PathObject$$module$b){_inherits(PathObject$$module$build$src$core$renderers$zelos$path_object,_PathObject$$module$b);var _super73=_createSuper(PathObject$$module$build$src$core$renderers$zelos$path_object);function PathObject$$module$build$src$core$renderers$zelos$path_object(a,b,c){var _this76;_classCallCheck(this,PathObject$$module$build$src$core$renderers$zelos$path_object);_this76=_super73.call(this,a,b,c);_this76.svgPathSelected_=null;_this76.outlines=new Map();_this76.remainingOutlines=new Set();_this76.outputShapeType=null;_this76.constants=c;return _this76;}_createClass(PathObject$$module$build$src$core$renderers$zelos$path_object,[{key:"setPath",value:function setPath(a){_get(_getPrototypeOf(PathObject$$module$build$src$core$renderers$zelos$path_object.prototype),"setPath",this).call(this,a);this.svgPathSelected_&&this.svgPathSelected_.setAttribute("d",a);}},{key:"applyColour",value:function applyColour(a){_get(_getPrototypeOf(PathObject$$module$build$src$core$renderers$zelos$path_object.prototype),"applyColour",this).call(this,a);var b=a.getParent();a.isShadow()&&b&&this.svgPath.setAttribute("stroke",b.style.colourTertiary);var _iterator29=_createForOfIteratorHelper(this.outlines.values()),_step29;try{for(_iterator29.s();!(_step29=_iterator29.n()).done;){var c=_step29.value;c.setAttribute("fill",this.style.colourTertiary);}}catch(err){_iterator29.e(err);}finally{_iterator29.f();}}},{key:"flipRTL",value:function flipRTL(){_get(_getPrototypeOf(PathObject$$module$build$src$core$renderers$zelos$path_object.prototype),"flipRTL",this).call(this);var _iterator30=_createForOfIteratorHelper(this.outlines.values()),_step30;try{for(_iterator30.s();!(_step30=_iterator30.n()).done;){var a=_step30.value;a.setAttribute("transform","scale(-1 1)");}}catch(err){_iterator30.e(err);}finally{_iterator30.f();}}},{key:"updateSelected",value:function updateSelected(a){this.setClass_("blocklySelected",a);a?this.svgPathSelected_||(this.svgPathSelected_=this.svgPath.cloneNode(!0),this.svgPathSelected_.setAttribute("fill","none"),this.svgPathSelected_.setAttribute("filter","url(#"+this.constants.selectedGlowFilterId+")"),this.svgRoot.appendChild(this.svgPathSelected_)):this.svgPathSelected_&&(this.svgRoot.removeChild(this.svgPathSelected_),this.svgPathSelected_=null);}},{key:"updateReplacementFade",value:function updateReplacementFade(a){this.setClass_("blocklyReplaceable",a);a?this.svgPath.setAttribute("filter","url(#"+this.constants.replacementGlowFilterId+")"):this.svgPath.removeAttribute("filter");}},{key:"updateShapeForInputHighlight",value:function updateShapeForInputHighlight(a,b){a=a.getParentInput().name;(a=this.getOutlinePath_(a))&&(b?a.setAttribute("filter","url(#"+this.constants.replacementGlowFilterId+")"):a.removeAttribute("filter"));}},{key:"beginDrawing",value:function beginDrawing(){this.remainingOutlines.clear();var _iterator31=_createForOfIteratorHelper(this.outlines.keys()),_step31;try{for(_iterator31.s();!(_step31=_iterator31.n()).done;){var a=_step31.value;this.remainingOutlines.add(a);}}catch(err){_iterator31.e(err);}finally{_iterator31.f();}}},{key:"endDrawing",value:function endDrawing(){if(this.remainingOutlines.size){var _iterator32=_createForOfIteratorHelper(this.remainingOutlines),_step32;try{for(_iterator32.s();!(_step32=_iterator32.n()).done;){var a=_step32.value;this.removeOutlinePath_(a);}}catch(err){_iterator32.e(err);}finally{_iterator32.f();}}this.remainingOutlines.clear();}},{key:"setOutlinePath",value:function setOutlinePath(a,b){a=this.getOutlinePath_(a);a.setAttribute("d",b);a.setAttribute("fill",this.style.colourTertiary);}},{key:"getOutlinePath_",value:function getOutlinePath_(a){this.outlines.has(a)||this.outlines.set(a,createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.PATH,{"class":"blocklyOutlinePath",d:""},this.svgRoot));this.remainingOutlines["delete"](a);return this.outlines.get(a);}},{key:"removeOutlinePath_",value:function removeOutlinePath_(a){var b,c;null==(b=this.outlines.get(a))||null==(c=b.parentNode)||c.removeChild(this.outlines.get(a));this.outlines["delete"](a);}}]);return PathObject$$module$build$src$core$renderers$zelos$path_object;}(PathObject$$module$build$src$core$renderers$common$path_object),module$build$src$core$renderers$zelos$path_object={};module$build$src$core$renderers$zelos$path_object.PathObject=PathObject$$module$build$src$core$renderers$zelos$path_object;var Renderer$$module$build$src$core$renderers$zelos$renderer=/*#__PURE__*/function(_Renderer$$module$bui){_inherits(Renderer$$module$build$src$core$renderers$zelos$renderer,_Renderer$$module$bui);var _super74=_createSuper(Renderer$$module$build$src$core$renderers$zelos$renderer);function Renderer$$module$build$src$core$renderers$zelos$renderer(a){_classCallCheck(this,Renderer$$module$build$src$core$renderers$zelos$renderer);return _super74.call(this,a);}_createClass(Renderer$$module$build$src$core$renderers$zelos$renderer,[{key:"makeConstants_",value:function makeConstants_(){return new ConstantProvider$$module$build$src$core$renderers$zelos$constants();}},{key:"makeRenderInfo_",value:function makeRenderInfo_(a){return new RenderInfo$$module$build$src$core$renderers$zelos$info(this,a);}},{key:"makeDrawer_",value:function makeDrawer_(a,b){return new Drawer$$module$build$src$core$renderers$zelos$drawer(a,b);}},{key:"makeMarkerDrawer",value:function makeMarkerDrawer(a,b){return new MarkerSvg$$module$build$src$core$renderers$zelos$marker_svg(a,this.getConstants(),b);}},{key:"makePathObject",value:function makePathObject(a,b){return new PathObject$$module$build$src$core$renderers$zelos$path_object(a,b,this.getConstants());}},{key:"getConstants",value:function getConstants(){return this.constants_;}},{key:"shouldHighlightConnection",value:function shouldHighlightConnection(a){return a.type!==ConnectionType$$module$build$src$core$connection_type.INPUT_VALUE&&a.type!==ConnectionType$$module$build$src$core$connection_type.OUTPUT_VALUE;}},{key:"getConnectionPreviewMethod",value:function getConnectionPreviewMethod(a,b,c){return b.type===ConnectionType$$module$build$src$core$connection_type.OUTPUT_VALUE?a.isConnected()?_InsertionMarkerManager$$module$build$src$core$insertion_marker_manager.PREVIEW_TYPE.REPLACEMENT_FADE:_InsertionMarkerManager$$module$build$src$core$insertion_marker_manager.PREVIEW_TYPE.INPUT_OUTLINE:_get(_getPrototypeOf(Renderer$$module$build$src$core$renderers$zelos$renderer.prototype),"getConnectionPreviewMethod",this).call(this,a,b,c);}}]);return Renderer$$module$build$src$core$renderers$zelos$renderer;}(Renderer$$module$build$src$core$renderers$common$renderer);register$$module$build$src$core$renderers$common$block_rendering("zelos",Renderer$$module$build$src$core$renderers$zelos$renderer);var module$build$src$core$renderers$zelos$renderer={};module$build$src$core$renderers$zelos$renderer.Renderer=Renderer$$module$build$src$core$renderers$zelos$renderer;var module$build$src$core$renderers$zelos$zelos={};module$build$src$core$renderers$zelos$zelos.BottomRow=BottomRow$$module$build$src$core$renderers$zelos$measurables$bottom_row;module$build$src$core$renderers$zelos$zelos.ConstantProvider=ConstantProvider$$module$build$src$core$renderers$zelos$constants;module$build$src$core$renderers$zelos$zelos.Drawer=Drawer$$module$build$src$core$renderers$zelos$drawer;module$build$src$core$renderers$zelos$zelos.MarkerSvg=MarkerSvg$$module$build$src$core$renderers$zelos$marker_svg;module$build$src$core$renderers$zelos$zelos.PathObject=PathObject$$module$build$src$core$renderers$zelos$path_object;module$build$src$core$renderers$zelos$zelos.RenderInfo=RenderInfo$$module$build$src$core$renderers$zelos$info;module$build$src$core$renderers$zelos$zelos.Renderer=Renderer$$module$build$src$core$renderers$zelos$renderer;module$build$src$core$renderers$zelos$zelos.RightConnectionShape=RightConnectionShape$$module$build$src$core$renderers$zelos$measurables$row_elements;module$build$src$core$renderers$zelos$zelos.StatementInput=StatementInput$$module$build$src$core$renderers$zelos$measurables$inputs;module$build$src$core$renderers$zelos$zelos.TopRow=TopRow$$module$build$src$core$renderers$zelos$measurables$top_row;var RenderInfo$$module$build$src$core$renderers$thrasos$info=/*#__PURE__*/function(_RenderInfo$$module$b2){_inherits(RenderInfo$$module$build$src$core$renderers$thrasos$info,_RenderInfo$$module$b2);var _super75=_createSuper(RenderInfo$$module$build$src$core$renderers$thrasos$info);function RenderInfo$$module$build$src$core$renderers$thrasos$info(a,b){_classCallCheck(this,RenderInfo$$module$build$src$core$renderers$thrasos$info);return _super75.call(this,a,b);}_createClass(RenderInfo$$module$build$src$core$renderers$thrasos$info,[{key:"getRenderer",value:function getRenderer(){return this.renderer_;}},{key:"addElemSpacing_",value:function addElemSpacing_(){var a=!1;for(var b=0;b<this.rows.length;b++){if(this.rows[b].hasExternalInput){a=!0;break;}}for(b=0;b<this.rows.length;b++){var d=this.rows[b];var c=d.elements;d.elements=[];d.startsWithElemSpacer()&&d.elements.push(new InRowSpacer$$module$build$src$core$renderers$measurables$in_row_spacer(this.constants_,this.getInRowSpacing_(null,c[0])));if(c.length){for(var e=0;e<c.length-1;e++){d.elements.push(c[e]);var f=this.getInRowSpacing_(c[e],c[e+1]);d.elements.push(new InRowSpacer$$module$build$src$core$renderers$measurables$in_row_spacer(this.constants_,f));}d.elements.push(c[c.length-1]);d.endsWithElemSpacer()&&(c=this.getInRowSpacing_(c[c.length-1],null),a&&d.hasDummyInput&&(c+=this.constants_.TAB_WIDTH),d.elements.push(new InRowSpacer$$module$build$src$core$renderers$measurables$in_row_spacer(this.constants_,c)));}}}},{key:"getInRowSpacing_",value:function getInRowSpacing_(a,b){if(!a)return b&&Types$$module$build$src$core$renderers$measurables$types.isField(b)&&b.isEditable?this.constants_.MEDIUM_PADDING:b&&Types$$module$build$src$core$renderers$measurables$types.isInlineInput(b)?this.constants_.MEDIUM_LARGE_PADDING:b&&Types$$module$build$src$core$renderers$measurables$types.isStatementInput(b)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:this.constants_.LARGE_PADDING;if(!Types$$module$build$src$core$renderers$measurables$types.isInput(a)&&!b)return Types$$module$build$src$core$renderers$measurables$types.isField(a)&&a.isEditable?this.constants_.MEDIUM_PADDING:Types$$module$build$src$core$renderers$measurables$types.isIcon(a)?2*this.constants_.LARGE_PADDING+1:Types$$module$build$src$core$renderers$measurables$types.isHat(a)?this.constants_.NO_PADDING:Types$$module$build$src$core$renderers$measurables$types.isPreviousOrNextConnection(a)?this.constants_.LARGE_PADDING:Types$$module$build$src$core$renderers$measurables$types.isLeftRoundedCorner(a)?this.constants_.MIN_BLOCK_WIDTH:Types$$module$build$src$core$renderers$measurables$types.isJaggedEdge(a)?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING;if(Types$$module$build$src$core$renderers$measurables$types.isInput(a)&&!b){if(Types$$module$build$src$core$renderers$measurables$types.isExternalInput(a))return this.constants_.NO_PADDING;if(Types$$module$build$src$core$renderers$measurables$types.isInlineInput(a))return this.constants_.LARGE_PADDING;if(Types$$module$build$src$core$renderers$measurables$types.isStatementInput(a))return this.constants_.NO_PADDING;}if(!Types$$module$build$src$core$renderers$measurables$types.isInput(a)&&b&&Types$$module$build$src$core$renderers$measurables$types.isInput(b)){if(Types$$module$build$src$core$renderers$measurables$types.isField(a)&&a.isEditable){if(Types$$module$build$src$core$renderers$measurables$types.isInlineInput(b)||Types$$module$build$src$core$renderers$measurables$types.isExternalInput(b))return this.constants_.SMALL_PADDING;}else{if(Types$$module$build$src$core$renderers$measurables$types.isInlineInput(b)||Types$$module$build$src$core$renderers$measurables$types.isExternalInput(b))return this.constants_.MEDIUM_LARGE_PADDING;if(Types$$module$build$src$core$renderers$measurables$types.isStatementInput(b))return this.constants_.LARGE_PADDING;}return this.constants_.LARGE_PADDING-1;}if(Types$$module$build$src$core$renderers$measurables$types.isIcon(a)&&b&&!Types$$module$build$src$core$renderers$measurables$types.isInput(b))return this.constants_.LARGE_PADDING;if(Types$$module$build$src$core$renderers$measurables$types.isInlineInput(a)&&b&&Types$$module$build$src$core$renderers$measurables$types.isField(b))return b.isEditable?this.constants_.MEDIUM_PADDING:this.constants_.LARGE_PADDING;if(Types$$module$build$src$core$renderers$measurables$types.isLeftSquareCorner(a)&&b){if(Types$$module$build$src$core$renderers$measurables$types.isHat(b))return this.constants_.NO_PADDING;if(Types$$module$build$src$core$renderers$measurables$types.isPreviousConnection(b)||Types$$module$build$src$core$renderers$measurables$types.isNextConnection(b))return b.notchOffset;}return Types$$module$build$src$core$renderers$measurables$types.isLeftRoundedCorner(a)&&b?b.notchOffset-this.constants_.CORNER_RADIUS:Types$$module$build$src$core$renderers$measurables$types.isField(a)&&b&&Types$$module$build$src$core$renderers$measurables$types.isField(b)&&a.isEditable===b.isEditable||b&&Types$$module$build$src$core$renderers$measurables$types.isJaggedEdge(b)?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING;}},{key:"getSpacerRowHeight_",value:function getSpacerRowHeight_(a,b){return Types$$module$build$src$core$renderers$measurables$types.isTopRow(a)&&Types$$module$build$src$core$renderers$measurables$types.isBottomRow(b)?this.constants_.EMPTY_BLOCK_SPACER_HEIGHT:Types$$module$build$src$core$renderers$measurables$types.isTopRow(a)||Types$$module$build$src$core$renderers$measurables$types.isBottomRow(b)?this.constants_.NO_PADDING:a.hasExternalInput&&b.hasExternalInput?this.constants_.LARGE_PADDING:!a.hasStatement&&b.hasStatement?this.constants_.BETWEEN_STATEMENT_PADDING_Y:a.hasStatement&&b.hasStatement||a.hasDummyInput||b.hasDummyInput?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING;}},{key:"getElemCenterline_",value:function getElemCenterline_(a,b){if(Types$$module$build$src$core$renderers$measurables$types.isSpacer(b))return a.yPos+b.height/2;if(Types$$module$build$src$core$renderers$measurables$types.isBottomRow(a))return a=a.yPos+a.height-a.descenderHeight,Types$$module$build$src$core$renderers$measurables$types.isNextConnection(b)?a+b.height/2:a-b.height/2;if(Types$$module$build$src$core$renderers$measurables$types.isTopRow(a))return Types$$module$build$src$core$renderers$measurables$types.isHat(b)?a.capline-b.height/2:a.capline+b.height/2;var c=a.yPos;return c=Types$$module$build$src$core$renderers$measurables$types.isField(b)&&a.hasStatement?c+(this.constants_.TALL_INPUT_FIELD_OFFSET_Y+b.height/2):c+a.height/2;}},{key:"finalize_",value:function finalize_(){var a=0,b=0;for(var c=0;c<this.rows.length;c++){var e=this.rows[c];e.yPos=b;e.xPos=this.startX;b+=e.height;a=Math.max(a,e.widthWithConnectedBlocks);var d=b-this.topRow.ascenderHeight;e===this.bottomRow&&d<this.constants_.MIN_BLOCK_HEIGHT&&(d=this.constants_.MIN_BLOCK_HEIGHT-d,this.bottomRow.height+=d,b+=d);this.recordElemPositions_(e);}this.outputConnection&&this.block_.nextConnection&&this.block_.nextConnection.isConnected()&&(c=this.block_.nextConnection.targetBlock())&&(a=Math.max(a,c.getHeightWidth().width));this.bottomRow.baseline=b-this.bottomRow.descenderHeight;this.widthWithChildren=a+this.startX;this.height=b;this.startY=this.topRow.capline;}}]);return RenderInfo$$module$build$src$core$renderers$thrasos$info;}(RenderInfo$$module$build$src$core$renderers$common$info),module$build$src$core$renderers$thrasos$info={};module$build$src$core$renderers$thrasos$info.RenderInfo=RenderInfo$$module$build$src$core$renderers$thrasos$info;var Renderer$$module$build$src$core$renderers$thrasos$renderer=/*#__PURE__*/function(_Renderer$$module$bui2){_inherits(Renderer$$module$build$src$core$renderers$thrasos$renderer,_Renderer$$module$bui2);var _super76=_createSuper(Renderer$$module$build$src$core$renderers$thrasos$renderer);function Renderer$$module$build$src$core$renderers$thrasos$renderer(a){_classCallCheck(this,Renderer$$module$build$src$core$renderers$thrasos$renderer);return _super76.call(this,a);}_createClass(Renderer$$module$build$src$core$renderers$thrasos$renderer,[{key:"makeRenderInfo_",value:function makeRenderInfo_(a){return new RenderInfo$$module$build$src$core$renderers$thrasos$info(this,a);}}]);return Renderer$$module$build$src$core$renderers$thrasos$renderer;}(Renderer$$module$build$src$core$renderers$common$renderer);register$$module$build$src$core$renderers$common$block_rendering("thrasos",Renderer$$module$build$src$core$renderers$thrasos$renderer);var module$build$src$core$renderers$thrasos$renderer={};module$build$src$core$renderers$thrasos$renderer.Renderer=Renderer$$module$build$src$core$renderers$thrasos$renderer;var module$build$src$core$renderers$thrasos$thrasos={};module$build$src$core$renderers$thrasos$thrasos.RenderInfo=RenderInfo$$module$build$src$core$renderers$thrasos$info;module$build$src$core$renderers$thrasos$thrasos.Renderer=Renderer$$module$build$src$core$renderers$thrasos$renderer;var ConstantProvider$$module$build$src$core$renderers$minimalist$constants=/*#__PURE__*/function(_ConstantProvider$$mo2){_inherits(ConstantProvider$$module$build$src$core$renderers$minimalist$constants,_ConstantProvider$$mo2);var _super77=_createSuper(ConstantProvider$$module$build$src$core$renderers$minimalist$constants);function ConstantProvider$$module$build$src$core$renderers$minimalist$constants(){_classCallCheck(this,ConstantProvider$$module$build$src$core$renderers$minimalist$constants);return _super77.call(this);}return _createClass(ConstantProvider$$module$build$src$core$renderers$minimalist$constants);}(ConstantProvider$$module$build$src$core$renderers$common$constants),module$build$src$core$renderers$minimalist$constants={};module$build$src$core$renderers$minimalist$constants.ConstantProvider=ConstantProvider$$module$build$src$core$renderers$minimalist$constants;var Drawer$$module$build$src$core$renderers$minimalist$drawer=/*#__PURE__*/function(_Drawer$$module$build2){_inherits(Drawer$$module$build$src$core$renderers$minimalist$drawer,_Drawer$$module$build2);var _super78=_createSuper(Drawer$$module$build$src$core$renderers$minimalist$drawer);function Drawer$$module$build$src$core$renderers$minimalist$drawer(a,b){_classCallCheck(this,Drawer$$module$build$src$core$renderers$minimalist$drawer);return _super78.call(this,a,b);}return _createClass(Drawer$$module$build$src$core$renderers$minimalist$drawer);}(Drawer$$module$build$src$core$renderers$common$drawer),module$build$src$core$renderers$minimalist$drawer={};module$build$src$core$renderers$minimalist$drawer.Drawer=Drawer$$module$build$src$core$renderers$minimalist$drawer;var RenderInfo$$module$build$src$core$renderers$minimalist$info=/*#__PURE__*/function(_RenderInfo$$module$b3){_inherits(RenderInfo$$module$build$src$core$renderers$minimalist$info,_RenderInfo$$module$b3);var _super79=_createSuper(RenderInfo$$module$build$src$core$renderers$minimalist$info);function RenderInfo$$module$build$src$core$renderers$minimalist$info(a,b){_classCallCheck(this,RenderInfo$$module$build$src$core$renderers$minimalist$info);return _super79.call(this,a,b);}_createClass(RenderInfo$$module$build$src$core$renderers$minimalist$info,[{key:"getRenderer",value:function getRenderer(){return this.renderer_;}}]);return RenderInfo$$module$build$src$core$renderers$minimalist$info;}(RenderInfo$$module$build$src$core$renderers$common$info),module$build$src$core$renderers$minimalist$info={};module$build$src$core$renderers$minimalist$info.RenderInfo=RenderInfo$$module$build$src$core$renderers$minimalist$info;var Renderer$$module$build$src$core$renderers$minimalist$renderer=/*#__PURE__*/function(_Renderer$$module$bui3){_inherits(Renderer$$module$build$src$core$renderers$minimalist$renderer,_Renderer$$module$bui3);var _super80=_createSuper(Renderer$$module$build$src$core$renderers$minimalist$renderer);function Renderer$$module$build$src$core$renderers$minimalist$renderer(a){_classCallCheck(this,Renderer$$module$build$src$core$renderers$minimalist$renderer);return _super80.call(this,a);}_createClass(Renderer$$module$build$src$core$renderers$minimalist$renderer,[{key:"makeConstants_",value:function makeConstants_(){return new ConstantProvider$$module$build$src$core$renderers$minimalist$constants();}},{key:"makeRenderInfo_",value:function makeRenderInfo_(a){return new RenderInfo$$module$build$src$core$renderers$minimalist$info(this,a);}},{key:"makeDrawer_",value:function makeDrawer_(a,b){return new Drawer$$module$build$src$core$renderers$minimalist$drawer(a,b);}}]);return Renderer$$module$build$src$core$renderers$minimalist$renderer;}(Renderer$$module$build$src$core$renderers$common$renderer);register$$module$build$src$core$renderers$common$block_rendering("minimalist",Renderer$$module$build$src$core$renderers$minimalist$renderer);var module$build$src$core$renderers$minimalist$renderer={};module$build$src$core$renderers$minimalist$renderer.Renderer=Renderer$$module$build$src$core$renderers$minimalist$renderer;var module$build$src$core$renderers$minimalist$minimalist={};module$build$src$core$renderers$minimalist$minimalist.ConstantProvider=ConstantProvider$$module$build$src$core$renderers$minimalist$constants;module$build$src$core$renderers$minimalist$minimalist.Drawer=Drawer$$module$build$src$core$renderers$minimalist$drawer;module$build$src$core$renderers$minimalist$minimalist.RenderInfo=RenderInfo$$module$build$src$core$renderers$minimalist$info;module$build$src$core$renderers$minimalist$minimalist.Renderer=Renderer$$module$build$src$core$renderers$minimalist$renderer;var ConstantProvider$$module$build$src$core$renderers$geras$constants=/*#__PURE__*/function(_ConstantProvider$$mo3){_inherits(ConstantProvider$$module$build$src$core$renderers$geras$constants,_ConstantProvider$$mo3);var _super81=_createSuper(ConstantProvider$$module$build$src$core$renderers$geras$constants);function ConstantProvider$$module$build$src$core$renderers$geras$constants(){var _this77;_classCallCheck(this,ConstantProvider$$module$build$src$core$renderers$geras$constants);_this77=_super81.call(this);_this77.FIELD_TEXT_BASELINE_CENTER=!1;_this77.DARK_PATH_OFFSET=1;_this77.MAX_BOTTOM_WIDTH=30;_this77.STATEMENT_BOTTOM_SPACER=-_this77.NOTCH_HEIGHT/2;return _this77;}_createClass(ConstantProvider$$module$build$src$core$renderers$geras$constants,[{key:"getCSS_",value:function getCSS_(a){return _get(_getPrototypeOf(ConstantProvider$$module$build$src$core$renderers$geras$constants.prototype),"getCSS_",this).call(this,a).concat(["".concat(a," .blocklyInsertionMarker>.blocklyPathLight,"),"".concat(a," .blocklyInsertionMarker>.blocklyPathDark {"),"fill-opacity: ".concat(this.INSERTION_MARKER_OPACITY,";"),"stroke: none;","}"]);}}]);return ConstantProvider$$module$build$src$core$renderers$geras$constants;}(ConstantProvider$$module$build$src$core$renderers$common$constants),module$build$src$core$renderers$geras$constants={};module$build$src$core$renderers$geras$constants.ConstantProvider=ConstantProvider$$module$build$src$core$renderers$geras$constants;var Highlighter$$module$build$src$core$renderers$geras$highlighter=/*#__PURE__*/function(){function Highlighter$$module$build$src$core$renderers$geras$highlighter(a){_classCallCheck(this,Highlighter$$module$build$src$core$renderers$geras$highlighter);this.inlineSteps_=this.steps_="";this.info_=a;this.RTL_=this.info_.RTL;a=a.getRenderer();this.constants_=a.getConstants();this.highlightConstants_=a.getHighlightConstants();this.highlightOffset_=this.highlightConstants_.OFFSET;this.outsideCornerPaths_=this.highlightConstants_.OUTSIDE_CORNER;this.insideCornerPaths_=this.highlightConstants_.INSIDE_CORNER;this.puzzleTabPaths_=this.highlightConstants_.PUZZLE_TAB;this.notchPaths_=this.highlightConstants_.NOTCH;this.startPaths_=this.highlightConstants_.START_HAT;this.jaggedTeethPaths_=this.highlightConstants_.JAGGED_TEETH;}_createClass(Highlighter$$module$build$src$core$renderers$geras$highlighter,[{key:"getPath",value:function getPath(){return this.steps_+"\n"+this.inlineSteps_;}},{key:"drawTopCorner",value:function drawTopCorner(a){this.steps_+=moveBy$$module$build$src$core$utils$svg_paths(a.xPos,this.info_.startY);for(var b=0,c;c=a.elements[b];b++){Types$$module$build$src$core$renderers$measurables$types.isLeftSquareCorner(c)?this.steps_+=this.highlightConstants_.START_POINT:Types$$module$build$src$core$renderers$measurables$types.isLeftRoundedCorner(c)?this.steps_+=this.outsideCornerPaths_.topLeft(this.RTL_):Types$$module$build$src$core$renderers$measurables$types.isPreviousConnection(c)?this.steps_+=this.notchPaths_.pathLeft:Types$$module$build$src$core$renderers$measurables$types.isHat(c)?this.steps_+=this.startPaths_.path(this.RTL_):Types$$module$build$src$core$renderers$measurables$types.isSpacer(c)&&0!==c.width&&(this.steps_+=lineOnAxis$$module$build$src$core$utils$svg_paths("H",c.xPos+c.width-this.highlightOffset_));}this.steps_+=lineOnAxis$$module$build$src$core$utils$svg_paths("H",a.xPos+a.width-this.highlightOffset_);}},{key:"drawJaggedEdge_",value:function drawJaggedEdge_(a){this.info_.RTL&&(this.steps_+=this.jaggedTeethPaths_.pathLeft+lineOnAxis$$module$build$src$core$utils$svg_paths("v",a.height-this.jaggedTeethPaths_.height-this.highlightOffset_));}},{key:"drawValueInput",value:function drawValueInput(a){var b=a.getLastInput();if(this.RTL_){var c=a.height-b.connectionHeight;this.steps_+=moveTo$$module$build$src$core$utils$svg_paths(b.xPos+b.width-this.highlightOffset_,a.yPos)+this.puzzleTabPaths_.pathDown(this.RTL_)+lineOnAxis$$module$build$src$core$utils$svg_paths("v",c);}else this.steps_+=moveTo$$module$build$src$core$utils$svg_paths(b.xPos+b.width,a.yPos)+this.puzzleTabPaths_.pathDown(this.RTL_);}},{key:"drawStatementInput",value:function drawStatementInput(a){var b=a.getLastInput();if(b)if(this.RTL_){var c=a.height-2*this.insideCornerPaths_.height;this.steps_+=moveTo$$module$build$src$core$utils$svg_paths(b.xPos,a.yPos)+this.insideCornerPaths_.pathTop(this.RTL_)+lineOnAxis$$module$build$src$core$utils$svg_paths("v",c)+this.insideCornerPaths_.pathBottom(this.RTL_)+lineTo$$module$build$src$core$utils$svg_paths(a.width-b.xPos-this.insideCornerPaths_.width,0);}else this.steps_+=moveTo$$module$build$src$core$utils$svg_paths(b.xPos,a.yPos+a.height)+this.insideCornerPaths_.pathBottom(this.RTL_)+lineTo$$module$build$src$core$utils$svg_paths(a.width-b.xPos-this.insideCornerPaths_.width,0);}},{key:"drawRightSideRow",value:function drawRightSideRow(a){var b=a.xPos+a.width-this.highlightOffset_;a instanceof SpacerRow$$module$build$src$core$renderers$measurables$spacer_row&&a.followsStatement&&(this.steps_+=lineOnAxis$$module$build$src$core$utils$svg_paths("H",b));this.RTL_&&(this.steps_+=lineOnAxis$$module$build$src$core$utils$svg_paths("H",b),a.height>this.highlightOffset_&&(this.steps_+=lineOnAxis$$module$build$src$core$utils$svg_paths("V",a.yPos+a.height-this.highlightOffset_)));}},{key:"drawBottomRow",value:function drawBottomRow(a){if(this.RTL_)this.steps_+=lineOnAxis$$module$build$src$core$utils$svg_paths("V",a.baseline-this.highlightOffset_);else{var b=this.info_.bottomRow.elements[0];Types$$module$build$src$core$renderers$measurables$types.isLeftSquareCorner(b)?this.steps_+=moveTo$$module$build$src$core$utils$svg_paths(a.xPos+this.highlightOffset_,a.baseline-this.highlightOffset_):Types$$module$build$src$core$renderers$measurables$types.isLeftRoundedCorner(b)&&(this.steps_+=moveTo$$module$build$src$core$utils$svg_paths(a.xPos,a.baseline),this.steps_+=this.outsideCornerPaths_.bottomLeft());}}},{key:"drawLeft",value:function drawLeft(){var a=this.info_.outputConnection;a&&(a=a.connectionOffsetY+a.height,this.RTL_?this.steps_+=moveTo$$module$build$src$core$utils$svg_paths(this.info_.startX,a):(this.steps_+=moveTo$$module$build$src$core$utils$svg_paths(this.info_.startX+this.highlightOffset_,this.info_.bottomRow.baseline-this.highlightOffset_),this.steps_+=lineOnAxis$$module$build$src$core$utils$svg_paths("V",a)),this.steps_+=this.puzzleTabPaths_.pathUp(this.RTL_));this.RTL_||(a=this.info_.topRow,Types$$module$build$src$core$renderers$measurables$types.isLeftRoundedCorner(a.elements[0])?this.steps_+=lineOnAxis$$module$build$src$core$utils$svg_paths("V",this.outsideCornerPaths_.height):this.steps_+=lineOnAxis$$module$build$src$core$utils$svg_paths("V",a.capline+this.highlightOffset_));}},{key:"drawInlineInput",value:function drawInlineInput(a){var b=this.highlightOffset_,c=a.xPos+a.connectionWidth;var d=a.centerline-a.height/2;var e=a.width-a.connectionWidth,f=d+b;this.RTL_?(d=a.connectionOffsetY-b,a=a.height-(a.connectionOffsetY+a.connectionHeight)+b,this.inlineSteps_+=moveTo$$module$build$src$core$utils$svg_paths(c-b,f)+lineOnAxis$$module$build$src$core$utils$svg_paths("v",d)+this.puzzleTabPaths_.pathDown(this.RTL_)+lineOnAxis$$module$build$src$core$utils$svg_paths("v",a)+lineOnAxis$$module$build$src$core$utils$svg_paths("h",e)):this.inlineSteps_+=moveTo$$module$build$src$core$utils$svg_paths(a.xPos+a.width+b,f)+lineOnAxis$$module$build$src$core$utils$svg_paths("v",a.height)+lineOnAxis$$module$build$src$core$utils$svg_paths("h",-e)+moveTo$$module$build$src$core$utils$svg_paths(c,d+a.connectionOffsetY)+this.puzzleTabPaths_.pathDown(this.RTL_);}}]);return Highlighter$$module$build$src$core$renderers$geras$highlighter;}(),module$build$src$core$renderers$geras$highlighter={};module$build$src$core$renderers$geras$highlighter.Highlighter=Highlighter$$module$build$src$core$renderers$geras$highlighter;var Drawer$$module$build$src$core$renderers$geras$drawer=/*#__PURE__*/function(_Drawer$$module$build3){_inherits(Drawer$$module$build$src$core$renderers$geras$drawer,_Drawer$$module$build3);var _super82=_createSuper(Drawer$$module$build$src$core$renderers$geras$drawer);function Drawer$$module$build$src$core$renderers$geras$drawer(a,b){var _this78;_classCallCheck(this,Drawer$$module$build$src$core$renderers$geras$drawer);_this78=_super82.call(this,a,b);_this78.highlighter_=new Highlighter$$module$build$src$core$renderers$geras$highlighter(b);return _this78;}_createClass(Drawer$$module$build$src$core$renderers$geras$drawer,[{key:"draw",value:function draw(){this.hideHiddenIcons_();this.drawOutline_();this.drawInternals_();var a=this.block_.pathObject;a.setPath(this.outlinePath_+"\n"+this.inlinePath_);a.setHighlightPath(this.highlighter_.getPath());this.info_.RTL&&a.flipRTL();if(isDebuggerEnabled$$module$build$src$core$renderers$common$debug()){var b,c;null==(b=this.block_)||null==(c=b.renderingDebugger)||c.drawDebug(this.block_,this.info_);}this.recordSizeOnBlock_();}},{key:"drawTop_",value:function drawTop_(){this.highlighter_.drawTopCorner(this.info_.topRow);this.highlighter_.drawRightSideRow(this.info_.topRow);_get(_getPrototypeOf(Drawer$$module$build$src$core$renderers$geras$drawer.prototype),"drawTop_",this).call(this);}},{key:"drawJaggedEdge_",value:function drawJaggedEdge_(a){this.highlighter_.drawJaggedEdge_(a);_get(_getPrototypeOf(Drawer$$module$build$src$core$renderers$geras$drawer.prototype),"drawJaggedEdge_",this).call(this,a);}},{key:"drawValueInput_",value:function drawValueInput_(a){this.highlighter_.drawValueInput(a);_get(_getPrototypeOf(Drawer$$module$build$src$core$renderers$geras$drawer.prototype),"drawValueInput_",this).call(this,a);}},{key:"drawStatementInput_",value:function drawStatementInput_(a){this.highlighter_.drawStatementInput(a);_get(_getPrototypeOf(Drawer$$module$build$src$core$renderers$geras$drawer.prototype),"drawStatementInput_",this).call(this,a);}},{key:"drawRightSideRow_",value:function drawRightSideRow_(a){this.highlighter_.drawRightSideRow(a);this.outlinePath_+=lineOnAxis$$module$build$src$core$utils$svg_paths("H",a.xPos+a.width)+lineOnAxis$$module$build$src$core$utils$svg_paths("V",a.yPos+a.height);}},{key:"drawBottom_",value:function drawBottom_(){this.highlighter_.drawBottomRow(this.info_.bottomRow);_get(_getPrototypeOf(Drawer$$module$build$src$core$renderers$geras$drawer.prototype),"drawBottom_",this).call(this);}},{key:"drawLeft_",value:function drawLeft_(){this.highlighter_.drawLeft();_get(_getPrototypeOf(Drawer$$module$build$src$core$renderers$geras$drawer.prototype),"drawLeft_",this).call(this);}},{key:"drawInlineInput_",value:function drawInlineInput_(a){this.highlighter_.drawInlineInput(a);_get(_getPrototypeOf(Drawer$$module$build$src$core$renderers$geras$drawer.prototype),"drawInlineInput_",this).call(this,a);}},{key:"positionInlineInputConnection_",value:function positionInlineInputConnection_(a){var b=a.centerline-a.height/2;if(a.connectionModel){var c=a.xPos+a.connectionWidth+this.constants_.DARK_PATH_OFFSET;this.info_.RTL&&(c*=-1);a.connectionModel.setOffsetInBlock(c,b+a.connectionOffsetY+this.constants_.DARK_PATH_OFFSET);}}},{key:"positionStatementInputConnection_",value:function positionStatementInputConnection_(a){var b=a.getLastInput();if(null==b?0:b.connectionModel){var c=a.xPos+a.statementEdge+b.notchOffset;c=this.info_.RTL?-1*c:c+this.constants_.DARK_PATH_OFFSET;b.connectionModel.setOffsetInBlock(c,a.yPos+this.constants_.DARK_PATH_OFFSET);}}},{key:"positionExternalValueConnection_",value:function positionExternalValueConnection_(a){var b=a.getLastInput();if(b&&b.connectionModel){var c=a.xPos+a.width+this.constants_.DARK_PATH_OFFSET;this.info_.RTL&&(c*=-1);b.connectionModel.setOffsetInBlock(c,a.yPos);}}},{key:"positionNextConnection_",value:function positionNextConnection_(){var a=this.info_.bottomRow;if(a.connection){var b=a.connection,c=b.xPos;b.connectionModel.setOffsetInBlock((this.info_.RTL?-c:c)+this.constants_.DARK_PATH_OFFSET/2,a.baseline+this.constants_.DARK_PATH_OFFSET);}}}]);return Drawer$$module$build$src$core$renderers$geras$drawer;}(Drawer$$module$build$src$core$renderers$common$drawer),module$build$src$core$renderers$geras$drawer={};module$build$src$core$renderers$geras$drawer.Drawer=Drawer$$module$build$src$core$renderers$geras$drawer;var HighlightConstantProvider$$module$build$src$core$renderers$geras$highlight_constants=/*#__PURE__*/function(){function HighlightConstantProvider$$module$build$src$core$renderers$geras$highlight_constants(a){_classCallCheck(this,HighlightConstantProvider$$module$build$src$core$renderers$geras$highlight_constants);this.OFFSET=.5;this.constantProvider=a;this.START_POINT=moveBy$$module$build$src$core$utils$svg_paths(this.OFFSET,this.OFFSET);}_createClass(HighlightConstantProvider$$module$build$src$core$renderers$geras$highlight_constants,[{key:"init",value:function init(){this.INSIDE_CORNER=this.makeInsideCorner();this.OUTSIDE_CORNER=this.makeOutsideCorner();this.PUZZLE_TAB=this.makePuzzleTab();this.NOTCH=this.makeNotch();this.JAGGED_TEETH=this.makeJaggedTeeth();this.START_HAT=this.makeStartHat();}},{key:"makeInsideCorner",value:function makeInsideCorner(){var a=this.constantProvider.CORNER_RADIUS,b=this.OFFSET,c=(1-Math.SQRT1_2)*(a+b)-b,d=moveBy$$module$build$src$core$utils$svg_paths(c,c)+arc$$module$build$src$core$utils$svg_paths("a","0 0,0",a,point$$module$build$src$core$utils$svg_paths(-c-b,a-c)),e=arc$$module$build$src$core$utils$svg_paths("a","0 0,0",a+b,point$$module$build$src$core$utils$svg_paths(a+b,a+b)),f=moveBy$$module$build$src$core$utils$svg_paths(c,-c)+arc$$module$build$src$core$utils$svg_paths("a","0 0,0",a+b,point$$module$build$src$core$utils$svg_paths(a-c,c+b));return{width:a+b,height:a,pathTop:function pathTop(g){return g?d:"";},pathBottom:function pathBottom(g){return g?e:f;}};}},{key:"makeOutsideCorner",value:function makeOutsideCorner(){var a=this.constantProvider.CORNER_RADIUS,b=this.OFFSET,c=(1-Math.SQRT1_2)*(a-b)+b,d=moveBy$$module$build$src$core$utils$svg_paths(c,c)+arc$$module$build$src$core$utils$svg_paths("a","0 0,1",a-b,point$$module$build$src$core$utils$svg_paths(a-c,-c+b)),e=moveBy$$module$build$src$core$utils$svg_paths(b,a)+arc$$module$build$src$core$utils$svg_paths("a","0 0,1",a-b,point$$module$build$src$core$utils$svg_paths(a,-a+b)),f=-c,g=moveBy$$module$build$src$core$utils$svg_paths(c,f)+arc$$module$build$src$core$utils$svg_paths("a","0 0,1",a-b,point$$module$build$src$core$utils$svg_paths(-c+b,-f-a));return{height:a,topLeft:function topLeft(h){return h?d:e;},bottomLeft:function bottomLeft(){return g;}};}},{key:"makePuzzleTab",value:function makePuzzleTab(){var a=this.constantProvider.TAB_WIDTH,b=this.constantProvider.TAB_HEIGHT,c=moveBy$$module$build$src$core$utils$svg_paths(-2,-b+3.4)+lineTo$$module$build$src$core$utils$svg_paths(-.45*a,-2.1),d=lineOnAxis$$module$build$src$core$utils$svg_paths("v",2.5)+moveBy$$module$build$src$core$utils$svg_paths(.97*-a,2.5)+curve$$module$build$src$core$utils$svg_paths("q",[point$$module$build$src$core$utils$svg_paths(.05*-a,10),point$$module$build$src$core$utils$svg_paths(.3*a,9.5)])+moveBy$$module$build$src$core$utils$svg_paths(.67*a,-1.9)+lineOnAxis$$module$build$src$core$utils$svg_paths("v",2.5),e=lineOnAxis$$module$build$src$core$utils$svg_paths("v",-1.5)+moveBy$$module$build$src$core$utils$svg_paths(-.92*a,-.5)+curve$$module$build$src$core$utils$svg_paths("q",[point$$module$build$src$core$utils$svg_paths(-.19*a,-5.5),point$$module$build$src$core$utils$svg_paths(0,-11)])+moveBy$$module$build$src$core$utils$svg_paths(.92*a,1),f=moveBy$$module$build$src$core$utils$svg_paths(-5,b-.7)+lineTo$$module$build$src$core$utils$svg_paths(.46*a,-2.1);return{width:a,height:b,pathUp:function pathUp(g){return g?c:e;},pathDown:function pathDown(g){return g?d:f;}};}},{key:"makeNotch",value:function makeNotch(){return{pathLeft:lineOnAxis$$module$build$src$core$utils$svg_paths("h",this.OFFSET)+this.constantProvider.NOTCH.pathLeft};}},{key:"makeJaggedTeeth",value:function makeJaggedTeeth(){return{pathLeft:lineTo$$module$build$src$core$utils$svg_paths(5.1,2.6)+moveBy$$module$build$src$core$utils$svg_paths(-10.2,6.8)+lineTo$$module$build$src$core$utils$svg_paths(5.1,2.6),height:12,width:10.2};}},{key:"makeStartHat",value:function makeStartHat(){var a=this.constantProvider.START_HAT.height,b=moveBy$$module$build$src$core$utils$svg_paths(25,-8.7)+curve$$module$build$src$core$utils$svg_paths("c",[point$$module$build$src$core$utils$svg_paths(29.7,-6.2),point$$module$build$src$core$utils$svg_paths(57.2,-.5),point$$module$build$src$core$utils$svg_paths(75,8.7)]),c=curve$$module$build$src$core$utils$svg_paths("c",[point$$module$build$src$core$utils$svg_paths(17.8,-9.2),point$$module$build$src$core$utils$svg_paths(45.3,-14.9),point$$module$build$src$core$utils$svg_paths(75,-8.7)])+moveTo$$module$build$src$core$utils$svg_paths(100.5,a+.5);return{path:function path(d){return d?b:c;}};}}]);return HighlightConstantProvider$$module$build$src$core$renderers$geras$highlight_constants;}(),module$build$src$core$renderers$geras$highlight_constants={};module$build$src$core$renderers$geras$highlight_constants.HighlightConstantProvider=HighlightConstantProvider$$module$build$src$core$renderers$geras$highlight_constants;var InlineInput$$module$build$src$core$renderers$geras$measurables$inline_input=/*#__PURE__*/function(_InlineInput$$module$){_inherits(InlineInput$$module$build$src$core$renderers$geras$measurables$inline_input,_InlineInput$$module$);var _super83=_createSuper(InlineInput$$module$build$src$core$renderers$geras$measurables$inline_input);function InlineInput$$module$build$src$core$renderers$geras$measurables$inline_input(a,b){var _this79;_classCallCheck(this,InlineInput$$module$build$src$core$renderers$geras$measurables$inline_input);_this79=_super83.call(this,a,b);_this79.constants_=a;_this79.connectedBlock&&(_this79.width+=_this79.constants_.DARK_PATH_OFFSET,_this79.height+=_this79.constants_.DARK_PATH_OFFSET);return _this79;}return _createClass(InlineInput$$module$build$src$core$renderers$geras$measurables$inline_input);}(InlineInput$$module$build$src$core$renderers$measurables$inline_input),module$build$src$core$renderers$geras$measurables$inline_input={};module$build$src$core$renderers$geras$measurables$inline_input.InlineInput=InlineInput$$module$build$src$core$renderers$geras$measurables$inline_input;var StatementInput$$module$build$src$core$renderers$geras$measurables$statement_input=/*#__PURE__*/function(_StatementInput$$modu2){_inherits(StatementInput$$module$build$src$core$renderers$geras$measurables$statement_input,_StatementInput$$modu2);var _super84=_createSuper(StatementInput$$module$build$src$core$renderers$geras$measurables$statement_input);function StatementInput$$module$build$src$core$renderers$geras$measurables$statement_input(a,b){var _this80;_classCallCheck(this,StatementInput$$module$build$src$core$renderers$geras$measurables$statement_input);_this80=_super84.call(this,a,b);_this80.constants_=a;_this80.connectedBlock&&(_this80.height+=_this80.constants_.DARK_PATH_OFFSET);return _this80;}return _createClass(StatementInput$$module$build$src$core$renderers$geras$measurables$statement_input);}(StatementInput$$module$build$src$core$renderers$measurables$statement_input),module$build$src$core$renderers$geras$measurables$statement_input={};module$build$src$core$renderers$geras$measurables$statement_input.StatementInput=StatementInput$$module$build$src$core$renderers$geras$measurables$statement_input;var RenderInfo$$module$build$src$core$renderers$geras$info=/*#__PURE__*/function(_RenderInfo$$module$b4){_inherits(RenderInfo$$module$build$src$core$renderers$geras$info,_RenderInfo$$module$b4);var _super85=_createSuper(RenderInfo$$module$build$src$core$renderers$geras$info);function RenderInfo$$module$build$src$core$renderers$geras$info(a,b){var _this81;_classCallCheck(this,RenderInfo$$module$build$src$core$renderers$geras$info);_this81=_super85.call(this,a,b);_this81.renderer_=a;return _this81;}_createClass(RenderInfo$$module$build$src$core$renderers$geras$info,[{key:"getRenderer",value:function getRenderer(){return this.renderer_;}},{key:"populateBottomRow_",value:function populateBottomRow_(){_get(_getPrototypeOf(RenderInfo$$module$build$src$core$renderers$geras$info.prototype),"populateBottomRow_",this).call(this);this.block_.inputList.length&&this.block_.inputList[this.block_.inputList.length-1].type===inputTypes$$module$build$src$core$input_types.STATEMENT||(this.bottomRow.minHeight=this.constants_.MEDIUM_PADDING-this.constants_.DARK_PATH_OFFSET);}},{key:"addInput_",value:function addInput_(a,b){this.isInline&&a.type===inputTypes$$module$build$src$core$input_types.VALUE?(b.elements.push(new InlineInput$$module$build$src$core$renderers$geras$measurables$inline_input(this.constants_,a)),b.hasInlineInput=!0):a.type===inputTypes$$module$build$src$core$input_types.STATEMENT?(b.elements.push(new StatementInput$$module$build$src$core$renderers$geras$measurables$statement_input(this.constants_,a)),b.hasStatement=!0):a.type===inputTypes$$module$build$src$core$input_types.VALUE?(b.elements.push(new ExternalValueInput$$module$build$src$core$renderers$measurables$external_value_input(this.constants_,a)),b.hasExternalInput=!0):a.type===inputTypes$$module$build$src$core$input_types.DUMMY&&(b.minHeight=Math.max(b.minHeight,this.constants_.DUMMY_INPUT_MIN_HEIGHT),b.hasDummyInput=!0);this.isInline||null!==b.align||(b.align=a.align);}},{key:"addElemSpacing_",value:function addElemSpacing_(){var a=!1;for(var c=0,d;d=this.rows[c];c++){d.hasExternalInput&&(a=!0);}for(var _c9=0,_d8;_d8=this.rows[_c9];_c9++){var b=_d8.elements;_d8.elements=[];_d8.startsWithElemSpacer()&&_d8.elements.push(new InRowSpacer$$module$build$src$core$renderers$measurables$in_row_spacer(this.constants_,this.getInRowSpacing_(null,b[0])));if(b.length){for(var e=0;e<b.length-1;e++){_d8.elements.push(b[e]);var f=this.getInRowSpacing_(b[e],b[e+1]);_d8.elements.push(new InRowSpacer$$module$build$src$core$renderers$measurables$in_row_spacer(this.constants_,f));}_d8.elements.push(b[b.length-1]);_d8.endsWithElemSpacer()&&(b=this.getInRowSpacing_(b[b.length-1],null),a&&_d8.hasDummyInput&&(b+=this.constants_.TAB_WIDTH),_d8.elements.push(new InRowSpacer$$module$build$src$core$renderers$measurables$in_row_spacer(this.constants_,b)));}}}},{key:"getInRowSpacing_",value:function getInRowSpacing_(a,b){if(!a)return b&&Types$$module$build$src$core$renderers$measurables$types.isField(b)&&b.isEditable?this.constants_.MEDIUM_PADDING:b&&Types$$module$build$src$core$renderers$measurables$types.isInlineInput(b)?this.constants_.MEDIUM_LARGE_PADDING:b&&Types$$module$build$src$core$renderers$measurables$types.isStatementInput(b)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:this.constants_.LARGE_PADDING;if(!Types$$module$build$src$core$renderers$measurables$types.isInput(a)&&(!b||Types$$module$build$src$core$renderers$measurables$types.isStatementInput(b)))return Types$$module$build$src$core$renderers$measurables$types.isField(a)&&a.isEditable?this.constants_.MEDIUM_PADDING:Types$$module$build$src$core$renderers$measurables$types.isIcon(a)?2*this.constants_.LARGE_PADDING+1:Types$$module$build$src$core$renderers$measurables$types.isHat(a)?this.constants_.NO_PADDING:Types$$module$build$src$core$renderers$measurables$types.isPreviousOrNextConnection(a)?this.constants_.LARGE_PADDING:Types$$module$build$src$core$renderers$measurables$types.isLeftRoundedCorner(a)?this.constants_.MIN_BLOCK_WIDTH:Types$$module$build$src$core$renderers$measurables$types.isJaggedEdge(a)?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING;if(Types$$module$build$src$core$renderers$measurables$types.isInput(a)&&!b){if(Types$$module$build$src$core$renderers$measurables$types.isExternalInput(a))return this.constants_.NO_PADDING;if(Types$$module$build$src$core$renderers$measurables$types.isInlineInput(a))return this.constants_.LARGE_PADDING;if(Types$$module$build$src$core$renderers$measurables$types.isStatementInput(a))return this.constants_.NO_PADDING;}if(!Types$$module$build$src$core$renderers$measurables$types.isInput(a)&&b&&Types$$module$build$src$core$renderers$measurables$types.isInput(b)){if(Types$$module$build$src$core$renderers$measurables$types.isField(a)&&a.isEditable){if(Types$$module$build$src$core$renderers$measurables$types.isInlineInput(b)||Types$$module$build$src$core$renderers$measurables$types.isExternalInput(b))return this.constants_.SMALL_PADDING;}else{if(Types$$module$build$src$core$renderers$measurables$types.isInlineInput(b)||Types$$module$build$src$core$renderers$measurables$types.isExternalInput(b))return this.constants_.MEDIUM_LARGE_PADDING;if(Types$$module$build$src$core$renderers$measurables$types.isStatementInput(b))return this.constants_.LARGE_PADDING;}return this.constants_.LARGE_PADDING-1;}if(Types$$module$build$src$core$renderers$measurables$types.isIcon(a)&&b&&!Types$$module$build$src$core$renderers$measurables$types.isInput(b))return this.constants_.LARGE_PADDING;if(Types$$module$build$src$core$renderers$measurables$types.isInlineInput(a)&&b&&Types$$module$build$src$core$renderers$measurables$types.isField(b))return b.isEditable?this.constants_.MEDIUM_PADDING:this.constants_.LARGE_PADDING;if(Types$$module$build$src$core$renderers$measurables$types.isLeftSquareCorner(a)&&b){if(Types$$module$build$src$core$renderers$measurables$types.isHat(b))return this.constants_.NO_PADDING;if(Types$$module$build$src$core$renderers$measurables$types.isPreviousConnection(b))return b.notchOffset;if(Types$$module$build$src$core$renderers$measurables$types.isNextConnection(b))return b.notchOffset+(this.RTL?1:-1)*this.constants_.DARK_PATH_OFFSET/2;}if(Types$$module$build$src$core$renderers$measurables$types.isLeftRoundedCorner(a)&&b){if(Types$$module$build$src$core$renderers$measurables$types.isPreviousConnection(b))return b.notchOffset-this.constants_.CORNER_RADIUS;if(Types$$module$build$src$core$renderers$measurables$types.isNextConnection(b))return b.notchOffset-this.constants_.CORNER_RADIUS+(this.RTL?1:-1)*this.constants_.DARK_PATH_OFFSET/2;}return Types$$module$build$src$core$renderers$measurables$types.isField(a)&&b&&Types$$module$build$src$core$renderers$measurables$types.isField(b)&&a.isEditable===b.isEditable||b&&Types$$module$build$src$core$renderers$measurables$types.isJaggedEdge(b)?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING;}},{key:"getSpacerRowHeight_",value:function getSpacerRowHeight_(a,b){return Types$$module$build$src$core$renderers$measurables$types.isTopRow(a)&&Types$$module$build$src$core$renderers$measurables$types.isBottomRow(b)?this.constants_.EMPTY_BLOCK_SPACER_HEIGHT:Types$$module$build$src$core$renderers$measurables$types.isTopRow(a)||Types$$module$build$src$core$renderers$measurables$types.isBottomRow(b)?this.constants_.NO_PADDING:a.hasExternalInput&&b.hasExternalInput?this.constants_.LARGE_PADDING:!a.hasStatement&&b.hasStatement?this.constants_.BETWEEN_STATEMENT_PADDING_Y:a.hasStatement&&b.hasStatement||!a.hasStatement&&b.hasDummyInput||a.hasDummyInput?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING;}},{key:"getElemCenterline_",value:function getElemCenterline_(a,b){if(Types$$module$build$src$core$renderers$measurables$types.isSpacer(b))return a.yPos+b.height/2;if(Types$$module$build$src$core$renderers$measurables$types.isBottomRow(a))return a=a.yPos+a.height-a.descenderHeight,Types$$module$build$src$core$renderers$measurables$types.isNextConnection(b)?a+b.height/2:a-b.height/2;if(Types$$module$build$src$core$renderers$measurables$types.isTopRow(a))return Types$$module$build$src$core$renderers$measurables$types.isHat(b)?a.capline-b.height/2:a.capline+b.height/2;var c=a.yPos;Types$$module$build$src$core$renderers$measurables$types.isField(b)||Types$$module$build$src$core$renderers$measurables$types.isIcon(b)?(c+=b.height/2,(a.hasInlineInput||a.hasStatement)&&b.height+this.constants_.TALL_INPUT_FIELD_OFFSET_Y<=a.height&&(c+=this.constants_.TALL_INPUT_FIELD_OFFSET_Y)):c=Types$$module$build$src$core$renderers$measurables$types.isInlineInput(b)?c+b.height/2:c+a.height/2;return c;}},{key:"alignRowElements_",value:function alignRowElements_(){if(this.isInline){var a=0,b=new WeakMap(),c=null;for(var d=this.rows.length-1,e;e=this.rows[d];d--){b.set(e,a),Types$$module$build$src$core$renderers$measurables$types.isInputRow(e)&&(e.hasStatement&&this.alignStatementRow_(e),c&&c.hasStatement&&e.width<c.width?b.set(e,c.width):a=e.width,c=e);}a=0;for(var _d9=0,_e8;_e8=this.rows[_d9];_d9++){_e8.hasStatement?a=this.getDesiredRowWidth_(_e8):Types$$module$build$src$core$renderers$measurables$types.isSpacer(_e8)?_e8.width=Math.max(a,b.get(_e8)):(c=_e8.width,a=Math.max(a,b.get(_e8))-c,0<a&&this.addAlignmentPadding_(_e8,a),a=_e8.width);}}else _get(_getPrototypeOf(RenderInfo$$module$build$src$core$renderers$geras$info.prototype),"alignRowElements_",this).call(this);}},{key:"getDesiredRowWidth_",value:function getDesiredRowWidth_(a){return this.isInline&&a.hasStatement?this.statementEdge+this.constants_.MAX_BOTTOM_WIDTH+this.startX:_get(_getPrototypeOf(RenderInfo$$module$build$src$core$renderers$geras$info.prototype),"getDesiredRowWidth_",this).call(this,a);}},{key:"finalize_",value:function finalize_(){var a=0,b=0;for(var d=0,e;e=this.rows[d];d++){e.yPos=b;e.xPos=this.startX;b+=e.height;a=Math.max(a,e.widthWithConnectedBlocks);var c=b-this.topRow.ascenderHeight;e===this.bottomRow&&c<this.constants_.MIN_BLOCK_HEIGHT&&(c=this.constants_.MIN_BLOCK_HEIGHT-c,this.bottomRow.height+=c,b+=c);this.recordElemPositions_(e);}this.outputConnection&&this.block_.nextConnection&&this.block_.nextConnection.isConnected()&&(c=this.block_.nextConnection.targetBlock())&&(a=Math.max(a,c.getHeightWidth().width-this.constants_.DARK_PATH_OFFSET));this.bottomRow.baseline=b-this.bottomRow.descenderHeight;this.widthWithChildren=a+this.startX+this.constants_.DARK_PATH_OFFSET;this.width+=this.constants_.DARK_PATH_OFFSET;this.height=b+this.constants_.DARK_PATH_OFFSET;this.startY=this.topRow.capline;}}]);return RenderInfo$$module$build$src$core$renderers$geras$info;}(RenderInfo$$module$build$src$core$renderers$common$info),module$build$src$core$renderers$geras$info={};module$build$src$core$renderers$geras$info.RenderInfo=RenderInfo$$module$build$src$core$renderers$geras$info;var PathObject$$module$build$src$core$renderers$geras$path_object=/*#__PURE__*/function(_PathObject$$module$b2){_inherits(PathObject$$module$build$src$core$renderers$geras$path_object,_PathObject$$module$b2);var _super86=_createSuper(PathObject$$module$build$src$core$renderers$geras$path_object);function PathObject$$module$build$src$core$renderers$geras$path_object(a,b,c){var _this82;_classCallCheck(this,PathObject$$module$build$src$core$renderers$geras$path_object);_this82=_super86.call(this,a,b,c);_this82.constants=c;_this82.colourDark="#000000";_this82.svgPathDark=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.PATH,{"class":"blocklyPathDark",transform:"translate(1,1)"});_this82.svgRoot.insertBefore(_this82.svgPathDark,_this82.svgPath);_this82.svgPathLight=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.PATH,{"class":"blocklyPathLight"},_this82.svgRoot);return _this82;}_createClass(PathObject$$module$build$src$core$renderers$geras$path_object,[{key:"setPath",value:function setPath(a){this.svgPath.setAttribute("d",a);this.svgPathDark.setAttribute("d",a);}},{key:"setHighlightPath",value:function setHighlightPath(a){this.svgPathLight.setAttribute("d",a);}},{key:"flipRTL",value:function flipRTL(){this.svgPath.setAttribute("transform","scale(-1 1)");this.svgPathLight.setAttribute("transform","scale(-1 1)");this.svgPathDark.setAttribute("transform","translate(1,1) scale(-1 1)");}},{key:"applyColour",value:function applyColour(a){this.svgPathLight.style.display="";this.svgPathDark.style.display="";if(!this.style.colourTertiary)throw Error("The renderer did not properly initialize the tertiary colour of the block style");this.svgPathLight.setAttribute("stroke",this.style.colourTertiary);this.svgPathDark.setAttribute("fill",this.colourDark);_get(_getPrototypeOf(PathObject$$module$build$src$core$renderers$geras$path_object.prototype),"applyColour",this).call(this,a);this.svgPath.setAttribute("stroke","none");}},{key:"setStyle",value:function setStyle(a){this.style=a;this.colourDark=blend$$module$build$src$core$utils$colour("#000",this.style.colourPrimary,.2)||this.colourDark;}},{key:"updateHighlighted",value:function updateHighlighted(a){a?(this.svgPath.setAttribute("filter","url(#"+this.constants.embossFilterId+")"),this.svgPathLight.style.display="none"):(this.svgPath.setAttribute("filter","none"),this.svgPathLight.style.display="inline");}},{key:"updateShadow_",value:function updateShadow_(a){if(a){this.svgPathLight.style.display="none";if(!this.style.colourSecondary)throw Error("The renderer did not properly initialize the secondary colour of the block style block style");this.svgPathDark.setAttribute("fill",this.style.colourSecondary);this.svgPath.setAttribute("stroke","none");this.svgPath.setAttribute("fill",this.style.colourSecondary);}}},{key:"updateDisabled_",value:function updateDisabled_(a){_get(_getPrototypeOf(PathObject$$module$build$src$core$renderers$geras$path_object.prototype),"updateDisabled_",this).call(this,a);a&&this.svgPath.setAttribute("stroke","none");}}]);return PathObject$$module$build$src$core$renderers$geras$path_object;}(PathObject$$module$build$src$core$renderers$common$path_object),module$build$src$core$renderers$geras$path_object={};module$build$src$core$renderers$geras$path_object.PathObject=PathObject$$module$build$src$core$renderers$geras$path_object;var Renderer$$module$build$src$core$renderers$geras$renderer=/*#__PURE__*/function(_Renderer$$module$bui4){_inherits(Renderer$$module$build$src$core$renderers$geras$renderer,_Renderer$$module$bui4);var _super87=_createSuper(Renderer$$module$build$src$core$renderers$geras$renderer);function Renderer$$module$build$src$core$renderers$geras$renderer(a){var _this83;_classCallCheck(this,Renderer$$module$build$src$core$renderers$geras$renderer);_this83=_super87.call(this,a);_this83.highlightConstants_=null;return _this83;}_createClass(Renderer$$module$build$src$core$renderers$geras$renderer,[{key:"init",value:function init(a,b){_get(_getPrototypeOf(Renderer$$module$build$src$core$renderers$geras$renderer.prototype),"init",this).call(this,a,b);this.highlightConstants_=this.makeHighlightConstants_();this.highlightConstants_.init();}},{key:"refreshDom",value:function refreshDom(a,b){_get(_getPrototypeOf(Renderer$$module$build$src$core$renderers$geras$renderer.prototype),"refreshDom",this).call(this,a,b);this.getHighlightConstants().init();}},{key:"makeConstants_",value:function makeConstants_(){return new ConstantProvider$$module$build$src$core$renderers$geras$constants();}},{key:"makeRenderInfo_",value:function makeRenderInfo_(a){return new RenderInfo$$module$build$src$core$renderers$geras$info(this,a);}},{key:"makeDrawer_",value:function makeDrawer_(a,b){return new Drawer$$module$build$src$core$renderers$geras$drawer(a,b);}},{key:"makePathObject",value:function makePathObject(a,b){return new PathObject$$module$build$src$core$renderers$geras$path_object(a,b,this.getConstants());}},{key:"makeHighlightConstants_",value:function makeHighlightConstants_(){return new HighlightConstantProvider$$module$build$src$core$renderers$geras$highlight_constants(this.getConstants());}},{key:"getHighlightConstants",value:function getHighlightConstants(){if(!this.highlightConstants_)throw Error("Cannot access the highlight constants because init has not been called");return this.highlightConstants_;}}]);return Renderer$$module$build$src$core$renderers$geras$renderer;}(Renderer$$module$build$src$core$renderers$common$renderer);register$$module$build$src$core$renderers$common$block_rendering("geras",Renderer$$module$build$src$core$renderers$geras$renderer);var module$build$src$core$renderers$geras$renderer={};module$build$src$core$renderers$geras$renderer.Renderer=Renderer$$module$build$src$core$renderers$geras$renderer;var module$build$src$core$renderers$geras$geras={};module$build$src$core$renderers$geras$geras.ConstantProvider=ConstantProvider$$module$build$src$core$renderers$geras$constants;module$build$src$core$renderers$geras$geras.Drawer=Drawer$$module$build$src$core$renderers$geras$drawer;module$build$src$core$renderers$geras$geras.HighlightConstantProvider=HighlightConstantProvider$$module$build$src$core$renderers$geras$highlight_constants;module$build$src$core$renderers$geras$geras.Highlighter=Highlighter$$module$build$src$core$renderers$geras$highlighter;module$build$src$core$renderers$geras$geras.InlineInput=InlineInput$$module$build$src$core$renderers$geras$measurables$inline_input;module$build$src$core$renderers$geras$geras.PathObject=PathObject$$module$build$src$core$renderers$geras$path_object;module$build$src$core$renderers$geras$geras.RenderInfo=RenderInfo$$module$build$src$core$renderers$geras$info;module$build$src$core$renderers$geras$geras.Renderer=Renderer$$module$build$src$core$renderers$geras$renderer;module$build$src$core$renderers$geras$geras.StatementInput=StatementInput$$module$build$src$core$renderers$geras$measurables$statement_input;var WorkspaceDragSurfaceSvg$$module$build$src$core$workspace_drag_surface_svg=/*#__PURE__*/function(){function WorkspaceDragSurfaceSvg$$module$build$src$core$workspace_drag_surface_svg(a){_classCallCheck(this,WorkspaceDragSurfaceSvg$$module$build$src$core$workspace_drag_surface_svg);this.container=a;this.previousSibling=null;this.createDom();}_createClass(WorkspaceDragSurfaceSvg$$module$build$src$core$workspace_drag_surface_svg,[{key:"createDom",value:function createDom(){this.SVG||(this.SVG=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.SVG,{xmlns:SVG_NS$$module$build$src$core$utils$dom,"xmlns:html":HTML_NS$$module$build$src$core$utils$dom,"xmlns:xlink":XLINK_NS$$module$build$src$core$utils$dom,version:"1.1","class":"blocklyWsDragSurface blocklyOverflowVisible"}),this.container.appendChild(this.SVG));}},{key:"translateSurface",value:function translateSurface(a,b){a=Math.round(a);b=Math.round(b);this.SVG.style.display="block";setCssTransform$$module$build$src$core$utils$dom(this.SVG,"translate3d("+a+"px, "+b+"px, 0)");}},{key:"getSurfaceTranslation",value:function getSurfaceTranslation(){return getRelativeXY$$module$build$src$core$utils$svg_math(this.SVG);}},{key:"clearAndHide",value:function clearAndHide(a){if(!a)throw Error("Couldn't clear and hide the drag surface: missing new surface.");var b=this.SVG.childNodes[0],c=this.SVG.childNodes[1];if(!b||!c||!b.classList.contains("blocklyBlockCanvas")&&c.classList.contains("blocklyBubbleCanvas"))throw Error("Couldn't clear and hide the drag surface. A node was missing.");null!==this.previousSibling?insertAfter$$module$build$src$core$utils$dom(b,this.previousSibling):a.insertBefore(b,a.firstChild);insertAfter$$module$build$src$core$utils$dom(c,b);this.SVG.style.display="none";if(this.SVG.childNodes.length)throw Error("Drag surface was not cleared.");setCssTransform$$module$build$src$core$utils$dom(this.SVG,"");this.previousSibling=null;}},{key:"setContentsAndShow",value:function setContentsAndShow(a,b,c,d,e,f){if(this.SVG.childNodes.length)throw Error("Already dragging a block.");this.previousSibling=c;a.setAttribute("transform","translate(0, 0) scale("+f+")");b.setAttribute("transform","translate(0, 0) scale("+f+")");this.SVG.setAttribute("width",String(d));this.SVG.setAttribute("height",String(e));this.SVG.appendChild(a);this.SVG.appendChild(b);this.SVG.style.display="block";}}]);return WorkspaceDragSurfaceSvg$$module$build$src$core$workspace_drag_surface_svg;}(),module$build$src$core$workspace_drag_surface_svg={};module$build$src$core$workspace_drag_surface_svg.WorkspaceDragSurfaceSvg=WorkspaceDragSurfaceSvg$$module$build$src$core$workspace_drag_surface_svg;var BlockDragSurfaceSvg$$module$build$src$core$block_drag_surface=/*#__PURE__*/function(){function BlockDragSurfaceSvg$$module$build$src$core$block_drag_surface(a){_classCallCheck(this,BlockDragSurfaceSvg$$module$build$src$core$block_drag_surface);this.container=a;this.scale=1;this.surfaceXY=new Coordinate$$module$build$src$core$utils$coordinate(0,0);this.childSurfaceXY=new Coordinate$$module$build$src$core$utils$coordinate(0,0);this.svg=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.SVG,{xmlns:SVG_NS$$module$build$src$core$utils$dom,"xmlns:html":HTML_NS$$module$build$src$core$utils$dom,"xmlns:xlink":XLINK_NS$$module$build$src$core$utils$dom,version:"1.1","class":"blocklyBlockDragSurface"},this.container);this.dragGroup=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.G,{},this.svg);}_createClass(BlockDragSurfaceSvg$$module$build$src$core$block_drag_surface,[{key:"createDom",value:function createDom(){warn$$module$build$src$core$utils$deprecation("BlockDragSurfaceSvg createDom","June 2022","June 2023");}},{key:"setBlocksAndShow",value:function setBlocksAndShow(a){if(this.dragGroup.childNodes.length)throw Error("Already dragging a block.");this.dragGroup.appendChild(a);this.svg.style.display="block";this.surfaceXY=new Coordinate$$module$build$src$core$utils$coordinate(0,0);}},{key:"translateAndScaleGroup",value:function translateAndScaleGroup(a,b,c){this.scale=c;a=Math.round(a);b=Math.round(b);this.childSurfaceXY.x=a;this.childSurfaceXY.y=b;this.dragGroup.setAttribute("transform","translate("+a+","+b+") scale("+c+")");}},{key:"translateSurfaceInternal_",value:function translateSurfaceInternal_(){var a=Math.round(this.surfaceXY.x),b=Math.round(this.surfaceXY.y);this.svg.style.display="block";setCssTransform$$module$build$src$core$utils$dom(this.svg,"translate3d("+a+"px, "+b+"px, 0)");}},{key:"translateBy",value:function translateBy(a,b){this.surfaceXY=new Coordinate$$module$build$src$core$utils$coordinate(this.surfaceXY.x+a,this.surfaceXY.y+b);this.translateSurfaceInternal_();}},{key:"translateSurface",value:function translateSurface(a,b){this.surfaceXY=new Coordinate$$module$build$src$core$utils$coordinate(a*this.scale,b*this.scale);this.translateSurfaceInternal_();}},{key:"getSurfaceTranslation",value:function getSurfaceTranslation(){var a=getRelativeXY$$module$build$src$core$utils$svg_math(this.svg);return new Coordinate$$module$build$src$core$utils$coordinate(a.x/this.scale,a.y/this.scale);}},{key:"getGroup",value:function getGroup(){return this.dragGroup;}},{key:"getSvgRoot",value:function getSvgRoot(){return this.svg;}},{key:"getCurrentBlock",value:function getCurrentBlock(){return this.dragGroup.firstChild;}},{key:"getWsTranslation",value:function getWsTranslation(){return this.childSurfaceXY.clone();}},{key:"clearAndHide",value:function clearAndHide(a){var b=this.getCurrentBlock();b&&(a?a.appendChild(b):this.dragGroup.removeChild(b));this.svg.style.display="none";if(this.dragGroup.childNodes.length)throw Error("Drag group was not cleared.");this.surfaceXY=new Coordinate$$module$build$src$core$utils$coordinate(0,0);}}]);return BlockDragSurfaceSvg$$module$build$src$core$block_drag_surface;}(),module$build$src$core$block_drag_surface={};module$build$src$core$block_drag_surface.BlockDragSurfaceSvg=BlockDragSurfaceSvg$$module$build$src$core$block_drag_surface;var bumpIntoBounds$$module$build$src$core$bump_objects=bumpObjectIntoBounds$$module$build$src$core$bump_objects,module$build$src$core$bump_objects={};module$build$src$core$bump_objects.bumpIntoBounds=bumpObjectIntoBounds$$module$build$src$core$bump_objects;module$build$src$core$bump_objects.bumpIntoBoundsHandler=bumpIntoBoundsHandler$$module$build$src$core$bump_objects;module$build$src$core$bump_objects.bumpTopObjectsIntoBounds=bumpTopObjectsIntoBounds$$module$build$src$core$bump_objects;var ScrollbarPair$$module$build$src$core$scrollbar_pair=/*#__PURE__*/function(){function ScrollbarPair$$module$build$src$core$scrollbar_pair(a,b,c,d,e){_classCallCheck(this,ScrollbarPair$$module$build$src$core$scrollbar_pair);this.workspace=a;this.oldHostMetrics_=this.corner_=this.vScroll=this.hScroll=null;b=void 0===b?!0:b;c=void 0===c?!0:c;var f=b&&c;b&&(this.hScroll=new Scrollbar$$module$build$src$core$scrollbar(a,!0,f,d,e));c&&(this.vScroll=new Scrollbar$$module$build$src$core$scrollbar(a,!1,f,d,e));f&&(this.corner_=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.RECT,{height:Scrollbar$$module$build$src$core$scrollbar.scrollbarThickness,width:Scrollbar$$module$build$src$core$scrollbar.scrollbarThickness,"class":"blocklyScrollbarBackground"}),insertAfter$$module$build$src$core$utils$dom(this.corner_,a.getBubbleCanvas()));}_createClass(ScrollbarPair$$module$build$src$core$scrollbar_pair,[{key:"dispose",value:function dispose(){removeNode$$module$build$src$core$utils$dom(this.corner_);this.oldHostMetrics_=this.corner_=null;this.hScroll&&(this.hScroll.dispose(),this.hScroll=null);this.vScroll&&(this.vScroll.dispose(),this.vScroll=null);}},{key:"resize",value:function resize(){var a=this.workspace.getMetrics();if(a){var b=!1,c=!1;this.oldHostMetrics_&&this.oldHostMetrics_.viewWidth===a.viewWidth&&this.oldHostMetrics_.viewHeight===a.viewHeight&&this.oldHostMetrics_.absoluteTop===a.absoluteTop&&this.oldHostMetrics_.absoluteLeft===a.absoluteLeft?(this.oldHostMetrics_&&this.oldHostMetrics_.scrollWidth===a.scrollWidth&&this.oldHostMetrics_.viewLeft===a.viewLeft&&this.oldHostMetrics_.scrollLeft===a.scrollLeft||(b=!0),this.oldHostMetrics_&&this.oldHostMetrics_.scrollHeight===a.scrollHeight&&this.oldHostMetrics_.viewTop===a.viewTop&&this.oldHostMetrics_.scrollTop===a.scrollTop||(c=!0)):c=b=!0;if(b||c){try{disable$$module$build$src$core$events$utils(),this.hScroll&&b&&this.hScroll.resize(a),this.vScroll&&c&&this.vScroll.resize(a);}finally{enable$$module$build$src$core$events$utils();}this.workspace.maybeFireViewportChangeEvent();}if(this.hScroll&&this.vScroll){if(!this.oldHostMetrics_||this.oldHostMetrics_.viewWidth!==a.viewWidth||this.oldHostMetrics_.absoluteLeft!==a.absoluteLeft){var d;null==(d=this.corner_)||d.setAttribute("x",String(this.vScroll.position.x));}if(!this.oldHostMetrics_||this.oldHostMetrics_.viewHeight!==a.viewHeight||this.oldHostMetrics_.absoluteTop!==a.absoluteTop){var _d10;null==(_d10=this.corner_)||_d10.setAttribute("y",String(this.hScroll.position.y));}}this.oldHostMetrics_=a;}}},{key:"canScrollHorizontally",value:function canScrollHorizontally(){return!!this.hScroll;}},{key:"canScrollVertically",value:function canScrollVertically(){return!!this.vScroll;}},{key:"setOrigin",value:function setOrigin(a,b){this.hScroll&&this.hScroll.setOrigin(a,b);this.vScroll&&this.vScroll.setOrigin(a,b);}},{key:"set",value:function set(a,b,c){this.hScroll&&this.hScroll.set(a,!1);this.vScroll&&this.vScroll.set(b,!1);if(c||void 0===c)a={},this.hScroll&&(a.x=this.hScroll.getRatio_()),this.vScroll&&(a.y=this.vScroll.getRatio_()),this.workspace.setMetrics(a);}},{key:"setX",value:function setX(a){this.hScroll&&this.hScroll.set(a,!0);}},{key:"setY",value:function setY(a){this.vScroll&&this.vScroll.set(a,!0);}},{key:"setContainerVisible",value:function setContainerVisible(a){this.hScroll&&this.hScroll.setContainerVisible(a);this.vScroll&&this.vScroll.setContainerVisible(a);}},{key:"isVisible",value:function isVisible(){var a=!1;this.hScroll&&(a=this.hScroll.isVisible());this.vScroll&&(a=a||this.vScroll.isVisible());return a;}},{key:"resizeContent",value:function resizeContent(a){this.hScroll&&this.hScroll.resizeContentHorizontal(a);this.vScroll&&this.vScroll.resizeContentVertical(a);}},{key:"resizeView",value:function resizeView(a){this.hScroll&&this.hScroll.resizeViewHorizontal(a);this.vScroll&&this.vScroll.resizeViewVertical(a);}}]);return ScrollbarPair$$module$build$src$core$scrollbar_pair;}(),module$build$src$core$scrollbar_pair={};module$build$src$core$scrollbar_pair.ScrollbarPair=ScrollbarPair$$module$build$src$core$scrollbar_pair;var documentEventsBound$$module$build$src$core$inject=!1,module$build$src$core$inject={};module$build$src$core$inject.inject=inject$$module$build$src$core$inject;$.CodeGenerator$$module$build$src$core$generator=/*#__PURE__*/function(){function _class5(a){_classCallCheck(this,_class5);this.FUNCTION_NAME_PLACEHOLDER_="{leCUI8hutHZI4480Dc}";this.STATEMENT_SUFFIX=this.STATEMENT_PREFIX=this.INFINITE_LOOP_TRAP=null;this.INDENT="  ";this.COMMENT_WRAP=60;this.ORDER_OVERRIDES=[];this.isInitialized=null;this.RESERVED_WORDS_="";this.definitions_=Object.create(null);this.functionNames_=Object.create(null);this.nameDB_=void 0;this.name_=a;this.FUNCTION_NAME_PLACEHOLDER_REGEXP_=new RegExp(this.FUNCTION_NAME_PLACEHOLDER_,"g");}_createClass(_class5,[{key:"workspaceToCode",value:function workspaceToCode(a){a||(console.warn("No workspace specified in workspaceToCode call.  Guessing."),a=getMainWorkspace$$module$build$src$core$common());var b=[];this.init(a);a=a.getTopBlocks(!0);for(var c=0,d;d=a[c];c++){var e=this.blockToCode(d);Array.isArray(e)&&(e=e[0]);e&&(d.outputConnection&&(e=this.scrubNakedValue(e),this.STATEMENT_PREFIX&&!d.suppressPrefixSuffix&&(e=this.injectId(this.STATEMENT_PREFIX,d)+e),this.STATEMENT_SUFFIX&&!d.suppressPrefixSuffix&&(e+=this.injectId(this.STATEMENT_SUFFIX,d))),b.push(e));}b=b.join("\n");b=this.finish(b);b=b.replace(/^\s+\n/,"");b=b.replace(/\n\s+$/,"\n");return b=b.replace(/[ \t]+\n/g,"\n");}},{key:"prefixLines",value:function prefixLines(a,b){return b+a.replace(/(?!\n$)\n/g,"\n"+b);}},{key:"allNestedComments",value:function allNestedComments(a){var b=[];a=a.getDescendants(!0);for(var c=0;c<a.length;c++){var d=a[c].getCommentText();d&&b.push(d);}b.length&&b.push("");return b.join("\n");}},{key:"blockToCode",value:function blockToCode(a,b){!1===this.isInitialized&&console.warn("CodeGenerator init was not called before blockToCode was called.");if(!a)return"";if(!a.isEnabled())return b?"":this.blockToCode(a.getNextBlock());if(a.isInsertionMarker())return b?"":this.blockToCode(a.getChildren(!1)[0]);var c=this[a.type];if("function"!==typeof c)throw Error('Language "'+this.name_+'" does not know how to generate code for block type "'+a.type+'".');c=c.call(a,a);if(Array.isArray(c)){if(!a.outputConnection)throw TypeError("Expecting string from statement block: "+a.type);return[this.scrub_(a,c[0],b),c[1]];}if("string"===typeof c)return this.STATEMENT_PREFIX&&!a.suppressPrefixSuffix&&(c=this.injectId(this.STATEMENT_PREFIX,a)+c),this.STATEMENT_SUFFIX&&!a.suppressPrefixSuffix&&(c+=this.injectId(this.STATEMENT_SUFFIX,a)),this.scrub_(a,c,b);if(null===c)return"";throw SyntaxError("Invalid code generated: "+c);}},{key:"valueToCode",value:function valueToCode(a,b,c){if(isNaN(c))throw TypeError("Expecting valid order from block: "+a.type);var d=a.getInputTargetBlock(b);if(!d)return"";b=this.blockToCode(d);if(""===b)return"";if(!Array.isArray(b))throw TypeError("Expecting tuple from value block: "+d.type);a=b[0];b=b[1];if(isNaN(b))throw TypeError("Expecting valid order from value block: "+d.type);if(!a)return"";d=!1;var e=Math.floor(c);var f=Math.floor(b);if(e<=f&&(e!==f||0!==e&&99!==e))for(d=!0,e=0;e<this.ORDER_OVERRIDES.length;e++){if(this.ORDER_OVERRIDES[e][0]===c&&this.ORDER_OVERRIDES[e][1]===b){d=!1;break;}}d&&(a="("+a+")");return a;}},{key:"statementToCode",value:function statementToCode(a,b){a=a.getInputTargetBlock(b);b=this.blockToCode(a);if("string"!==typeof b)throw TypeError("Expecting code from statement block: "+(a&&a.type));b&&(b=this.prefixLines(b,this.INDENT));return b;}},{key:"addLoopTrap",value:function addLoopTrap(a,b){this.INFINITE_LOOP_TRAP&&(a=this.prefixLines(this.injectId(this.INFINITE_LOOP_TRAP,b),this.INDENT)+a);this.STATEMENT_SUFFIX&&!b.suppressPrefixSuffix&&(a=this.prefixLines(this.injectId(this.STATEMENT_SUFFIX,b),this.INDENT)+a);this.STATEMENT_PREFIX&&!b.suppressPrefixSuffix&&(a+=this.prefixLines(this.injectId(this.STATEMENT_PREFIX,b),this.INDENT));return a;}},{key:"injectId",value:function injectId(a,b){b=b.id.replace(/\$/g,"$$$$");return a.replace(/%1/g,"'"+b+"'");}},{key:"addReservedWords",value:function addReservedWords(a){this.RESERVED_WORDS_+=a+",";}},{key:"provideFunction_",value:function provideFunction_(a,b){if(!this.definitions_[a]){var c=this.nameDB_.getDistinctName(a,$.NameType$$module$build$src$core$names.PROCEDURE);this.functionNames_[a]=c;Array.isArray(b)&&(b=b.join("\n"));b=b.trim().replace(this.FUNCTION_NAME_PLACEHOLDER_REGEXP_,c);var d;for(;d!==b;){d=b,b=b.replace(/^(( {2})*) {2}/gm,"$1\x00");}b=b.replace(/\0/g,this.INDENT);this.definitions_[a]=b;}return this.functionNames_[a];}},{key:"init",value:function init(a){this.definitions_=Object.create(null);this.functionNames_=Object.create(null);}},{key:"scrub_",value:function scrub_(a,b,c){return b;}},{key:"finish",value:function finish(a){this.definitions_=Object.create(null);this.functionNames_=Object.create(null);return a;}},{key:"scrubNakedValue",value:function scrubNakedValue(a){return a;}}]);return _class5;}();Object.defineProperties($.CodeGenerator$$module$build$src$core$generator.prototype,{variableDB_:{get:function get(){warn$$module$build$src$core$utils$deprecation("variableDB_","version 9","version 10","nameDB_");return this.nameDB_;},set:function set(a){warn$$module$build$src$core$utils$deprecation("variableDB_","version 9","version 10","nameDB_");this.nameDB_=a;}}});var module$build$src$core$generator={};module$build$src$core$generator.CodeGenerator=$.CodeGenerator$$module$build$src$core$generator;var FlyoutButton$$module$build$src$core$flyout_button=/*#__PURE__*/function(){function FlyoutButton$$module$build$src$core$flyout_button(a,b,c,d){_classCallCheck(this,FlyoutButton$$module$build$src$core$flyout_button);this.workspace=a;this.targetWorkspace=b;this.isLabel_=d;this.onMouseUpWrapper_=null;this.height=this.width=0;this.svgText_=this.svgGroup_=null;this.text_=c.text;this.position_=new Coordinate$$module$build$src$core$utils$coordinate(0,0);this.callbackKey_=c.callbackKey||c.callbackkey;this.cssClass_=c["web-class"]||null;this.info=c;}_createClass(FlyoutButton$$module$build$src$core$flyout_button,[{key:"createDom",value:function createDom(){var a=this.isLabel_?"blocklyFlyoutLabel":"blocklyFlyoutButton";this.cssClass_&&(a+=" "+this.cssClass_);this.svgGroup_=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.G,{"class":a},this.workspace.getCanvas());var b;this.isLabel_||(b=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.RECT,{"class":"blocklyFlyoutButtonShadow",rx:4,ry:4,x:1,y:1},this.svgGroup_));a=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.RECT,{"class":this.isLabel_?"blocklyFlyoutLabelBackground":"blocklyFlyoutButtonBackground",rx:4,ry:4},this.svgGroup_);var c=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.TEXT,{"class":this.isLabel_?"blocklyFlyoutLabelText":"blocklyText",x:0,y:0,"text-anchor":"middle"},this.svgGroup_);var d=replaceMessageReferences$$module$build$src$core$utils$parsing(this.text_);this.workspace.RTL&&(d+="\u200F");c.textContent=d;this.isLabel_&&(this.svgText_=c,this.workspace.getThemeManager().subscribe(this.svgText_,"flyoutForegroundColour","fill"));var e=getComputedStyle$$module$build$src$core$utils$style(c,"fontSize"),f=getComputedStyle$$module$build$src$core$utils$style(c,"fontWeight"),g=getComputedStyle$$module$build$src$core$utils$style(c,"fontFamily");this.width=getFastTextWidthWithSizeString$$module$build$src$core$utils$dom(c,e,f,g);d=measureFontMetrics$$module$build$src$core$utils$dom(d,e,f,g);this.height=d.height;if(!this.isLabel_){this.width+=2*FlyoutButton$$module$build$src$core$flyout_button.TEXT_MARGIN_X;this.height+=2*FlyoutButton$$module$build$src$core$flyout_button.TEXT_MARGIN_Y;var h;null==(h=b)||h.setAttribute("width",this.width.toString());var k;null==(k=b)||k.setAttribute("height",this.height.toString());}a.setAttribute("width",this.width.toString());a.setAttribute("height",this.height.toString());c.setAttribute("x",(this.width/2).toString());c.setAttribute("y",(this.height/2-d.height/2+d.baseline).toString());this.updateTransform_();this.onMouseUpWrapper_=conditionalBind$$module$build$src$core$browser_events(this.svgGroup_,"mouseup",this,this.onMouseUp_);return this.svgGroup_;}},{key:"show",value:function show(){this.updateTransform_();this.svgGroup_.setAttribute("display","block");}},{key:"updateTransform_",value:function updateTransform_(){this.svgGroup_.setAttribute("transform","translate("+this.position_.x+","+this.position_.y+")");}},{key:"moveTo",value:function moveTo(a,b){this.position_.x=a;this.position_.y=b;this.updateTransform_();}},{key:"isLabel",value:function isLabel(){return this.isLabel_;}},{key:"getPosition",value:function getPosition(){return this.position_;}},{key:"getButtonText",value:function getButtonText(){return this.text_;}},{key:"getTargetWorkspace",value:function getTargetWorkspace(){return this.targetWorkspace;}},{key:"dispose",value:function dispose(){this.onMouseUpWrapper_&&unbind$$module$build$src$core$browser_events(this.onMouseUpWrapper_);this.svgGroup_&&removeNode$$module$build$src$core$utils$dom(this.svgGroup_);this.svgText_&&this.workspace.getThemeManager().unsubscribe(this.svgText_);}},{key:"onMouseUp_",value:function onMouseUp_(a){(a=this.targetWorkspace.getGesture(a))&&a.cancel();this.isLabel_&&this.callbackKey_?console.warn("Labels should not have callbacks. Label text: "+this.text_):this.isLabel_||this.callbackKey_&&this.targetWorkspace.getButtonCallback(this.callbackKey_)?this.isLabel_||(a=this.targetWorkspace.getButtonCallback(this.callbackKey_))&&a(this):console.warn("Buttons should have callbacks. Button text: "+this.text_);}}]);return FlyoutButton$$module$build$src$core$flyout_button;}();FlyoutButton$$module$build$src$core$flyout_button.TEXT_MARGIN_X=5;FlyoutButton$$module$build$src$core$flyout_button.TEXT_MARGIN_Y=2;register$$module$build$src$core$css("\n.blocklyFlyoutButton {\n  fill: #888;\n  cursor: default;\n}\n\n.blocklyFlyoutButtonShadow {\n  fill: #666;\n}\n\n.blocklyFlyoutButton:hover {\n  fill: #aaa;\n}\n\n.blocklyFlyoutLabel {\n  cursor: default;\n}\n\n.blocklyFlyoutLabelBackground {\n  opacity: 0;\n}\n");var module$build$src$core$flyout_button={};module$build$src$core$flyout_button.FlyoutButton=FlyoutButton$$module$build$src$core$flyout_button;var MetricsManager$$module$build$src$core$metrics_manager=/*#__PURE__*/function(){function MetricsManager$$module$build$src$core$metrics_manager(a){_classCallCheck(this,MetricsManager$$module$build$src$core$metrics_manager);this.workspace_=a;}_createClass(MetricsManager$$module$build$src$core$metrics_manager,[{key:"getDimensionsPx_",value:function getDimensionsPx_(a){var b=0,c=0;a&&(b=a.getWidth(),c=a.getHeight());return new Size$$module$build$src$core$utils$size(b,c);}},{key:"getFlyoutMetrics",value:function getFlyoutMetrics(a){a=this.getDimensionsPx_(this.workspace_.getFlyout(a));return{width:a.width,height:a.height,position:this.workspace_.toolboxPosition};}},{key:"getToolboxMetrics",value:function getToolboxMetrics(){var a=this.getDimensionsPx_(this.workspace_.getToolbox());return{width:a.width,height:a.height,position:this.workspace_.toolboxPosition};}},{key:"getSvgMetrics",value:function getSvgMetrics(){return this.workspace_.getCachedParentSvgSize();}},{key:"getAbsoluteMetrics",value:function getAbsoluteMetrics(){var a=0;var b=this.getToolboxMetrics(),c=this.getFlyoutMetrics(!0),d=!!this.workspace_.getToolbox(),e=!!this.workspace_.getFlyout(!0);var f=d?b.position:c.position,g=f===Position$$module$build$src$core$utils$toolbox.LEFT;f=f===Position$$module$build$src$core$utils$toolbox.TOP;d&&g?a=b.width:e&&g&&(a=c.width);g=0;d&&f?g=b.height:e&&f&&(g=c.height);return{top:g,left:a};}},{key:"getViewMetrics",value:function getViewMetrics(a){a=a?this.workspace_.scale:1;var b=this.getSvgMetrics(),c=this.getToolboxMetrics(),d=this.getFlyoutMetrics(!0),e=this.workspace_.getToolbox()?c.position:d.position;if(this.workspace_.getToolbox()){if(e===Position$$module$build$src$core$utils$toolbox.TOP||e===Position$$module$build$src$core$utils$toolbox.BOTTOM)b.height-=c.height;else{if(e===Position$$module$build$src$core$utils$toolbox.LEFT||e===Position$$module$build$src$core$utils$toolbox.RIGHT)b.width-=c.width;}}else if(this.workspace_.getFlyout(!0))if(e===Position$$module$build$src$core$utils$toolbox.TOP||e===Position$$module$build$src$core$utils$toolbox.BOTTOM)b.height-=d.height;else if(e===Position$$module$build$src$core$utils$toolbox.LEFT||e===Position$$module$build$src$core$utils$toolbox.RIGHT)b.width-=d.width;return{height:b.height/a,width:b.width/a,top:-this.workspace_.scrollY/a,left:-this.workspace_.scrollX/a};}},{key:"getContentMetrics",value:function getContentMetrics(a){a=a?1:this.workspace_.scale;var b=this.workspace_.getBlocksBoundingBox();return{height:(b.bottom-b.top)*a,width:(b.right-b.left)*a,top:b.top*a,left:b.left*a};}},{key:"hasFixedEdges",value:function hasFixedEdges(){return!this.workspace_.isMovableHorizontally()||!this.workspace_.isMovableVertically();}},{key:"getComputedFixedEdges_",value:function getComputedFixedEdges_(a){if(!this.hasFixedEdges())return{};var b=this.workspace_.isMovableHorizontally(),c=this.workspace_.isMovableVertically();a=a||this.getViewMetrics(!1);var d={};c||(d.top=a.top,d.bottom=a.top+a.height);b||(d.left=a.left,d.right=a.left+a.width);return d;}},{key:"getPaddedContent_",value:function getPaddedContent_(a,b){var c=b.top+b.height,d=b.left+b.width,e=a.width;a=a.height;var f=e/2,g=a/2;return{top:Math.min(b.top-g,c-a),bottom:Math.max(c+g,b.top+a),left:Math.min(b.left-f,d-e),right:Math.max(d+f,b.left+e)};}},{key:"getScrollMetrics",value:function getScrollMetrics(a,b,c){a=a?this.workspace_.scale:1;b=b||this.getViewMetrics(!1);var d=c||this.getContentMetrics();c=this.getComputedFixedEdges_(b);b=this.getPaddedContent_(b,d);d=void 0!==c.top?c.top:b.top;var e=void 0!==c.left?c.left:b.left;return{top:d/a,left:e/a,width:((void 0!==c.right?c.right:b.right)-e)/a,height:((void 0!==c.bottom?c.bottom:b.bottom)-d)/a};}},{key:"getUiMetrics",value:function getUiMetrics(){return{viewMetrics:this.getViewMetrics(),absoluteMetrics:this.getAbsoluteMetrics(),toolboxMetrics:this.getToolboxMetrics()};}},{key:"getMetrics",value:function getMetrics(){var a=this.getToolboxMetrics(),b=this.getFlyoutMetrics(!0),c=this.getSvgMetrics(),d=this.getAbsoluteMetrics(),e=this.getViewMetrics(),f=this.getContentMetrics(),g=this.getScrollMetrics(!1,e,f);return{contentHeight:f.height,contentWidth:f.width,contentTop:f.top,contentLeft:f.left,scrollHeight:g.height,scrollWidth:g.width,scrollTop:g.top,scrollLeft:g.left,viewHeight:e.height,viewWidth:e.width,viewTop:e.top,viewLeft:e.left,absoluteTop:d.top,absoluteLeft:d.left,svgHeight:c.height,svgWidth:c.width,toolboxWidth:a.width,toolboxHeight:a.height,toolboxPosition:a.position,flyoutWidth:b.width,flyoutHeight:b.height};}}]);return MetricsManager$$module$build$src$core$metrics_manager;}();register$$module$build$src$core$registry(Type$$module$build$src$core$registry.METRICS_MANAGER,DEFAULT$$module$build$src$core$registry,MetricsManager$$module$build$src$core$metrics_manager);var module$build$src$core$metrics_manager={};module$build$src$core$metrics_manager.MetricsManager=MetricsManager$$module$build$src$core$metrics_manager;var FlyoutMetricsManager$$module$build$src$core$flyout_metrics_manager=/*#__PURE__*/function(_MetricsManager$$modu){_inherits(FlyoutMetricsManager$$module$build$src$core$flyout_metrics_manager,_MetricsManager$$modu);var _super88=_createSuper(FlyoutMetricsManager$$module$build$src$core$flyout_metrics_manager);function FlyoutMetricsManager$$module$build$src$core$flyout_metrics_manager(a,b){var _this84;_classCallCheck(this,FlyoutMetricsManager$$module$build$src$core$flyout_metrics_manager);_this84=_super88.call(this,a);_this84.flyout_=b;return _this84;}_createClass(FlyoutMetricsManager$$module$build$src$core$flyout_metrics_manager,[{key:"getBoundingBox_",value:function getBoundingBox_(){var a;try{a=this.workspace_.getCanvas().getBBox();}catch(b){a={height:0,y:0,width:0,x:0};}return a;}},{key:"getContentMetrics",value:function getContentMetrics(a){var b=this.getBoundingBox_();a=a?1:this.workspace_.scale;return{height:b.height*a,width:b.width*a,top:b.y*a,left:b.x*a};}},{key:"getScrollMetrics",value:function getScrollMetrics(a,b,c){b=c||this.getContentMetrics();c=this.flyout_.MARGIN*this.workspace_.scale;a=a?this.workspace_.scale:1;return{height:(b.height+2*c)/a,width:(b.width+b.left+c)/a,top:0,left:0};}}]);return FlyoutMetricsManager$$module$build$src$core$flyout_metrics_manager;}(MetricsManager$$module$build$src$core$metrics_manager),module$build$src$core$flyout_metrics_manager={};module$build$src$core$flyout_metrics_manager.FlyoutMetricsManager=FlyoutMetricsManager$$module$build$src$core$flyout_metrics_manager;var FlyoutItemType$$module$build$src$core$flyout_base;(function(a){a.BLOCK="block";a.BUTTON="button";})(FlyoutItemType$$module$build$src$core$flyout_base||(FlyoutItemType$$module$build$src$core$flyout_base={}));var Flyout$$module$build$src$core$flyout_base=/*#__PURE__*/function(_DeleteArea$$module$b3){_inherits(Flyout$$module$build$src$core$flyout_base,_DeleteArea$$module$b3);var _super89=_createSuper(Flyout$$module$build$src$core$flyout_base);function Flyout$$module$build$src$core$flyout_base(a){var _this85;_classCallCheck(this,Flyout$$module$build$src$core$flyout_base);_this85=_super89.call(this);_this85.horizontalLayout=!1;_this85.eventWrappers_=[];_this85.filterWrapper_=_this85.reflowWrapper_=null;_this85.mats_=[];_this85.buttons_=[];_this85.listeners_=[];_this85.permanentlyDisabled_=[];_this85.recycledBlocks_=[];_this85.autoClose=!0;_this85.isVisible_=!1;_this85.containerVisible_=!0;_this85.CORNER_RADIUS=8;_this85.SCROLLBAR_MARGIN=2.5;_this85.height_=_this85.width_=0;_this85.dragAngleRange_=70;_this85.svgGroup_=_this85.svgBackground_=null;a.setMetrics=_this85.setMetrics_.bind(_assertThisInitialized(_this85));_this85.workspace_=new WorkspaceSvg$$module$build$src$core$workspace_svg(a);_this85.workspace_.setMetricsManager(new FlyoutMetricsManager$$module$build$src$core$flyout_metrics_manager(_this85.workspace_,_assertThisInitialized(_this85)));_this85.workspace_.internalIsFlyout=!0;_this85.workspace_.setVisible(_this85.isVisible_);_this85.id=genUid$$module$build$src$core$utils$idgenerator();_this85.RTL=!!a.RTL;_this85.toolboxPosition_=a.toolboxPosition;_this85.tabWidth_=_this85.workspace_.getRenderer().getConstants().TAB_WIDTH;_this85.rectMap_=new WeakMap();_this85.MARGIN=_this85.CORNER_RADIUS;_this85.GAP_X=3*_this85.MARGIN;_this85.GAP_Y=3*_this85.MARGIN;return _this85;}_createClass(Flyout$$module$build$src$core$flyout_base,[{key:"createDom",value:function createDom(a){this.svgGroup_=createSvgElement$$module$build$src$core$utils$dom(a,{"class":"blocklyFlyout",style:"display: none"});this.svgBackground_=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.PATH,{"class":"blocklyFlyoutBackground"},this.svgGroup_);this.svgGroup_.appendChild(this.workspace_.createDom());this.workspace_.getThemeManager().subscribe(this.svgBackground_,"flyoutBackgroundColour","fill");this.workspace_.getThemeManager().subscribe(this.svgBackground_,"flyoutOpacity","fill-opacity");return this.svgGroup_;}},{key:"init",value:function init(a){this.targetWorkspace=a;this.workspace_.targetWorkspace=a;this.workspace_.scrollbar=new ScrollbarPair$$module$build$src$core$scrollbar_pair(this.workspace_,this.horizontalLayout,!this.horizontalLayout,"blocklyFlyoutScrollbar",this.SCROLLBAR_MARGIN);this.hide();Array.prototype.push.apply(this.eventWrappers_,conditionalBind$$module$build$src$core$browser_events(this.svgGroup_,"wheel",this,this.wheel_));this.autoClose||(this.filterWrapper_=this.filterForCapacity_.bind(this),this.targetWorkspace.addChangeListener(this.filterWrapper_));Array.prototype.push.apply(this.eventWrappers_,conditionalBind$$module$build$src$core$browser_events(this.svgBackground_,"mousedown",this,this.onMouseDown_));this.workspace_.getGesture=this.targetWorkspace.getGesture.bind(this.targetWorkspace);this.workspace_.setVariableMap(this.targetWorkspace.getVariableMap());this.workspace_.createPotentialVariableMap();a.getComponentManager().addComponent({component:this,weight:1,capabilities:[ComponentManager$$module$build$src$core$component_manager.Capability.DELETE_AREA,ComponentManager$$module$build$src$core$component_manager.Capability.DRAG_TARGET]});}},{key:"dispose",value:function dispose(){this.hide();this.workspace_.getComponentManager().removeComponent(this.id);unbind$$module$build$src$core$browser_events(this.eventWrappers_);this.filterWrapper_&&(this.targetWorkspace.removeChangeListener(this.filterWrapper_),this.filterWrapper_=null);this.workspace_&&(this.workspace_.getThemeManager().unsubscribe(this.svgBackground_),this.workspace_.dispose());this.svgGroup_&&(removeNode$$module$build$src$core$utils$dom(this.svgGroup_),this.svgGroup_=null);this.svgBackground_=null;}},{key:"getWidth",value:function getWidth(){return this.width_;}},{key:"getHeight",value:function getHeight(){return this.height_;}},{key:"getFlyoutScale",value:function getFlyoutScale(){return this.targetWorkspace.scale;}},{key:"getWorkspace",value:function getWorkspace(){return this.workspace_;}},{key:"isVisible",value:function isVisible(){return this.isVisible_;}},{key:"setVisible",value:function setVisible(a){var b=a!==this.isVisible();this.isVisible_=a;b&&(this.autoClose||this.workspace_.recordDragTargets(),this.updateDisplay_());}},{key:"setContainerVisible",value:function setContainerVisible(a){var b=a!==this.containerVisible_;this.containerVisible_=a;b&&this.updateDisplay_();}},{key:"updateDisplay_",value:function updateDisplay_(){var a;a=this.containerVisible_?this.isVisible():!1;this.svgGroup_&&(this.svgGroup_.style.display=a?"block":"none");var b;null==(b=this.workspace_.scrollbar)||b.setContainerVisible(a);}},{key:"positionAt_",value:function positionAt_(a,b,c,d){var e;null==(e=this.svgGroup_)||e.setAttribute("width",a.toString());var f;null==(f=this.svgGroup_)||f.setAttribute("height",b.toString());this.workspace_.setCachedParentSvgSize(a,b);var g;if("svg"===(null==(g=this.svgGroup_)?void 0:g.tagName))setCssTransform$$module$build$src$core$utils$dom(this.svgGroup_,"translate("+c+"px,"+d+"px)");else{var h;null==(h=this.svgGroup_)||h.setAttribute("transform","translate("+c+","+d+")");}if(a=this.workspace_.scrollbar)a.setOrigin(c,d),a.resize(),a.hScroll&&a.hScroll.setPosition(a.hScroll.position.x,a.hScroll.position.y),a.vScroll&&a.vScroll.setPosition(a.vScroll.position.x,a.vScroll.position.y);}},{key:"hide",value:function hide(){if(this.isVisible()){this.setVisible(!1);for(var a=0,b;b=this.listeners_[a];a++){unbind$$module$build$src$core$browser_events(b);}this.listeners_.length=0;this.reflowWrapper_&&(this.workspace_.removeChangeListener(this.reflowWrapper_),this.reflowWrapper_=null);}}},{key:"show",value:function show(a){this.workspace_.setResizesEnabled(!1);this.hide();this.clearOldBlocks_();"string"===typeof a&&(a=this.getDynamicCategoryContents_(a));this.setVisible(!0);a=convertFlyoutDefToJsonArray$$module$build$src$core$utils$toolbox(a);a=this.createFlyoutInfo_(a);this.layout_(a.contents,a.gaps);this.listeners_.push(conditionalBind$$module$build$src$core$browser_events(this.svgBackground_,"mouseover",this,function(){var b=this.workspace_.getTopBlocks(!1);for(var c=0,d;d=b[c];c++){d.removeSelect();}}));this.horizontalLayout?this.height_=0:this.width_=0;this.workspace_.setResizesEnabled(!0);this.reflow();this.filterForCapacity_();this.position();this.reflowWrapper_=this.reflow.bind(this);this.workspace_.addChangeListener(this.reflowWrapper_);this.emptyRecycledBlocks_();}},{key:"createFlyoutInfo_",value:function createFlyoutInfo_(a){var b=[],c=[];this.permanentlyDisabled_.length=0;var d=this.horizontalLayout?this.GAP_X:this.GAP_Y;for(var f=0,g;g=a[f];f++){if("custom"in g){var e=this.getDynamicCategoryContents_(g.custom);e=convertFlyoutDefToJsonArray$$module$build$src$core$utils$toolbox(e);a.splice.apply(a,[f,1].concat(_toConsumableArray(e)));g=a[f];}switch(g.kind.toUpperCase()){case"BLOCK":e=g;var h=this.createFlyoutBlock_(e);b.push({type:FlyoutItemType$$module$build$src$core$flyout_base.BLOCK,block:h});this.addBlockGap_(e,c,d);break;case"SEP":this.addSeparatorGap_(g,c,d);break;case"LABEL":e=this.createButton_(g,!0);b.push({type:FlyoutItemType$$module$build$src$core$flyout_base.BUTTON,button:e});c.push(d);break;case"BUTTON":e=this.createButton_(g,!1),b.push({type:FlyoutItemType$$module$build$src$core$flyout_base.BUTTON,button:e}),c.push(d);}}return{contents:b,gaps:c};}},{key:"getDynamicCategoryContents_",value:function getDynamicCategoryContents_(a){a=this.workspace_.targetWorkspace.getToolboxCategoryCallback(a);if("function"!==typeof a)throw TypeError("Couldn't find a callback function when opening a toolbox category.");return a(this.workspace_.targetWorkspace);}},{key:"createButton_",value:function createButton_(a,b){return new FlyoutButton$$module$build$src$core$flyout_button(this.workspace_,this.targetWorkspace,a,b);}},{key:"createFlyoutBlock_",value:function createFlyoutBlock_(a){var b;a.blockxml?(a="string"===typeof a.blockxml?textToDom$$module$build$src$core$xml(a.blockxml):a.blockxml,(b=this.getRecycledBlock_(a.getAttribute("type")))||(b=domToBlock$$module$build$src$core$xml(a,this.workspace_))):(b=this.getRecycledBlock_(a.type),b||(void 0===a.enabled&&(a.enabled="true"!==a.disabled&&!0!==a.disabled),b=append$$module$build$src$core$serialization$blocks(a,this.workspace_)));b.isEnabled()||this.permanentlyDisabled_.push(b);return b;}},{key:"getRecycledBlock_",value:function getRecycledBlock_(a){var b=-1;for(var c=0;c<this.recycledBlocks_.length;c++){if(this.recycledBlocks_[c].type===a){b=c;break;}}return-1===b?void 0:this.recycledBlocks_.splice(b,1)[0];}},{key:"addBlockGap_",value:function addBlockGap_(a,b,c){var d;a.gap?d=parseInt(a.gap.toString()):a.blockxml&&(a="string"===typeof a.blockxml?textToDom$$module$build$src$core$xml(a.blockxml):a.blockxml,d=parseInt(a.getAttribute("gap")));b.push(!d||isNaN(d)?c:d);}},{key:"addSeparatorGap_",value:function addSeparatorGap_(a,b,c){a=parseInt(a.gap.toString());!isNaN(a)&&0<b.length?b[b.length-1]=a:b.push(c);}},{key:"clearOldBlocks_",value:function clearOldBlocks_(){var a=this.workspace_.getTopBlocks(!1);for(var c=0,d;d=a[c];c++){this.blockIsRecyclable_(d)?this.recycleBlock_(d):d.dispose(!1,!1);}for(a=0;a<this.mats_.length;a++){var _c10=this.mats_[a];_c10&&(unbindMouseEvents$$module$build$src$core$tooltip(_c10),removeNode$$module$build$src$core$utils$dom(_c10));}this.mats_.length=0;for(var _c11=0,_d11;_d11=this.buttons_[_c11];_c11++){_d11.dispose();}this.buttons_.length=0;var b;null==(b=this.workspace_.getPotentialVariableMap())||b.clear();}},{key:"emptyRecycledBlocks_",value:function emptyRecycledBlocks_(){for(var a=0;a<this.recycledBlocks_.length;a++){this.recycledBlocks_[a].dispose();}this.recycledBlocks_=[];}},{key:"blockIsRecyclable_",value:function blockIsRecyclable_(a){return!1;}},{key:"recycleBlock_",value:function recycleBlock_(a){var b=a.getRelativeToSurfaceXY();a.moveBy(-b.x,-b.y);this.recycledBlocks_.push(a);}},{key:"addBlockListeners_",value:function addBlockListeners_(a,b,c){this.listeners_.push(conditionalBind$$module$build$src$core$browser_events(a,"mousedown",null,this.blockMouseDown_(b)));this.listeners_.push(conditionalBind$$module$build$src$core$browser_events(c,"mousedown",null,this.blockMouseDown_(b)));this.listeners_.push(bind$$module$build$src$core$browser_events(a,"mouseenter",b,b.addSelect));this.listeners_.push(bind$$module$build$src$core$browser_events(a,"mouseleave",b,b.removeSelect));this.listeners_.push(bind$$module$build$src$core$browser_events(c,"mouseenter",b,b.addSelect));this.listeners_.push(bind$$module$build$src$core$browser_events(c,"mouseleave",b,b.removeSelect));}},{key:"blockMouseDown_",value:function blockMouseDown_(a){var _this86=this;return function(b){var c=_this86.targetWorkspace.getGesture(b);c&&(c.setStartBlock(a),c.handleFlyoutStart(b,_this86));};}},{key:"onMouseDown_",value:function onMouseDown_(a){var b=this.targetWorkspace.getGesture(a);b&&b.handleFlyoutStart(a,this);}},{key:"isBlockCreatable",value:function isBlockCreatable(a){return a.isEnabled();}},{key:"createBlock",value:function createBlock(a){var b=null;disable$$module$build$src$core$events$utils();var c=this.targetWorkspace.getAllVariables();this.targetWorkspace.setResizesEnabled(!1);try{b=this.placeNewBlock_(a);}finally{enable$$module$build$src$core$events$utils();}this.targetWorkspace.hideChaff();a=getAddedVariables$$module$build$src$core$variables(this.targetWorkspace,c);if(isEnabled$$module$build$src$core$events$utils()){setGroup$$module$build$src$core$events$utils(!0);for(c=0;c<a.length;c++){var d=a[c];fire$$module$build$src$core$events$utils(new(get$$module$build$src$core$events$utils(VAR_CREATE$$module$build$src$core$events$utils))(d));}fire$$module$build$src$core$events$utils(new(get$$module$build$src$core$events$utils(CREATE$$module$build$src$core$events$utils))(b));}this.autoClose?this.hide():this.filterForCapacity_();return b;}},{key:"initFlyoutButton_",value:function initFlyoutButton_(a,b,c){var d=a.createDom();a.moveTo(b,c);a.show();this.listeners_.push(conditionalBind$$module$build$src$core$browser_events(d,"mousedown",this,this.onMouseDown_));this.buttons_.push(a);}},{key:"createRect_",value:function createRect_(a,b,c,d,e){b=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.RECT,{"fill-opacity":0,x:b,y:c,height:d.height,width:d.width});b.tooltip=a;bindMouseEvents$$module$build$src$core$tooltip(b);this.workspace_.getCanvas().insertBefore(b,a.getSvgRoot());this.rectMap_.set(a,b);return this.mats_[e]=b;}},{key:"moveRectToBlock_",value:function moveRectToBlock_(a,b){var c=b.getHeightWidth();a.setAttribute("width",c.width.toString());a.setAttribute("height",c.height.toString());b=b.getRelativeToSurfaceXY();a.setAttribute("y",b.y.toString());a.setAttribute("x",(this.RTL?b.x-c.width:b.x).toString());}},{key:"filterForCapacity_",value:function filterForCapacity_(){var a=this.workspace_.getTopBlocks(!1);for(var b=0,c;c=a[b];b++){if(-1===this.permanentlyDisabled_.indexOf(c)){var d=this.targetWorkspace.isCapacityAvailable(getBlockTypeCounts$$module$build$src$core$common(c));for(;c;){c.setEnabled(d),c=c.getNextBlock();}}}}},{key:"reflow",value:function reflow(){this.reflowWrapper_&&this.workspace_.removeChangeListener(this.reflowWrapper_);this.reflowInternal_();this.reflowWrapper_&&this.workspace_.addChangeListener(this.reflowWrapper_);}},{key:"isScrollable",value:function isScrollable(){return this.workspace_.scrollbar?this.workspace_.scrollbar.isVisible():!1;}},{key:"placeNewBlock_",value:function placeNewBlock_(a){var b=this.targetWorkspace;if(!a.getSvgRoot())throw Error("oldBlock is not rendered.");var c=save$$module$build$src$core$serialization$blocks(a);b.setResizesEnabled(!1);b=append$$module$build$src$core$serialization$blocks(c,b);this.positionNewBlock_(a,b);return b;}},{key:"positionNewBlock_",value:function positionNewBlock_(a,b){var c=this.targetWorkspace;var d=c.getOriginOffsetInPixels(),e=this.workspace_.getOriginOffsetInPixels();a=a.getRelativeToSurfaceXY();a.scale(this.workspace_.scale);e=Coordinate$$module$build$src$core$utils$coordinate.sum(e,a);d=Coordinate$$module$build$src$core$utils$coordinate.difference(e,d);d.scale(1/c.scale);b.moveTo(new Coordinate$$module$build$src$core$utils$coordinate(d.x,d.y));}}]);return Flyout$$module$build$src$core$flyout_base;}(DeleteArea$$module$build$src$core$delete_area);Flyout$$module$build$src$core$flyout_base.FlyoutItemType=FlyoutItemType$$module$build$src$core$flyout_base;var module$build$src$core$flyout_base={};module$build$src$core$flyout_base.Flyout=Flyout$$module$build$src$core$flyout_base;var VerticalFlyout$$module$build$src$core$flyout_vertical=/*#__PURE__*/function(_Flyout$$module$build){_inherits(VerticalFlyout$$module$build$src$core$flyout_vertical,_Flyout$$module$build);var _super90=_createSuper(VerticalFlyout$$module$build$src$core$flyout_vertical);function VerticalFlyout$$module$build$src$core$flyout_vertical(a){_classCallCheck(this,VerticalFlyout$$module$build$src$core$flyout_vertical);return _super90.call(this,a);}_createClass(VerticalFlyout$$module$build$src$core$flyout_vertical,[{key:"setMetrics_",value:function setMetrics_(a){if(this.isVisible()){var b=this.workspace_.getMetricsManager(),c=b.getScrollMetrics(),d=b.getViewMetrics();b=b.getAbsoluteMetrics();"number"===typeof a.y&&(this.workspace_.scrollY=-(c.top+(c.height-d.height)*a.y));this.workspace_.translate(this.workspace_.scrollX+b.left,this.workspace_.scrollY+b.top);}}},{key:"getX",value:function getX(){if(!this.isVisible())return 0;var a=this.targetWorkspace.getMetricsManager();var b=a.getAbsoluteMetrics(),c=a.getViewMetrics();a=a.getToolboxMetrics();return this.targetWorkspace.toolboxPosition===this.toolboxPosition_?this.targetWorkspace.getToolbox()?this.toolboxPosition_===Position$$module$build$src$core$utils$toolbox.LEFT?a.width:c.width-this.width_:this.toolboxPosition_===Position$$module$build$src$core$utils$toolbox.LEFT?0:c.width:this.toolboxPosition_===Position$$module$build$src$core$utils$toolbox.LEFT?0:c.width+b.left-this.width_;}},{key:"getY",value:function getY(){return 0;}},{key:"position",value:function position(){if(this.isVisible()&&this.targetWorkspace.isVisible()){var a=this.targetWorkspace.getMetricsManager().getViewMetrics();this.height_=a.height;this.setBackgroundPath_(this.width_-this.CORNER_RADIUS,a.height-2*this.CORNER_RADIUS);a=this.getX();var b=this.getY();this.positionAt_(this.width_,this.height_,a,b);}}},{key:"setBackgroundPath_",value:function setBackgroundPath_(a,b){var c=this.toolboxPosition_===Position$$module$build$src$core$utils$toolbox.RIGHT;var d=a+this.CORNER_RADIUS;d=["M "+(c?d:0)+",0"];d.push("h",c?-a:a);d.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,c?0:1,c?-this.CORNER_RADIUS:this.CORNER_RADIUS,this.CORNER_RADIUS);d.push("v",Math.max(0,b));d.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,c?0:1,c?this.CORNER_RADIUS:-this.CORNER_RADIUS,this.CORNER_RADIUS);d.push("h",c?a:-a);d.push("z");this.svgBackground_.setAttribute("d",d.join(" "));}},{key:"scrollToStart",value:function scrollToStart(){var a;null==(a=this.workspace_.scrollbar)||a.setY(0);}},{key:"wheel_",value:function wheel_(a){var b=getScrollDeltaPixels$$module$build$src$core$browser_events(a);if(b.y){var c=this.workspace_.getMetricsManager(),d=c.getScrollMetrics();b=c.getViewMetrics().top-d.top+b.y;var e;null==(e=this.workspace_.scrollbar)||e.setY(b);hide$$module$build$src$core$widgetdiv();hideWithoutAnimation$$module$build$src$core$dropdowndiv();}a.preventDefault();a.stopPropagation();}},{key:"layout_",value:function layout_(a,b){this.workspace_.scale=this.targetWorkspace.scale;var c=this.MARGIN;var d=this.RTL?c:c+this.tabWidth_;for(var h=0,k;k=a[h];h++){if("block"===k.type){var e=k.block,f=e.getDescendants(!1);for(var m=0,n;n=f[m];m++){n.isInFlyout=!0;}e.render();f=e.getSvgRoot();var l=e.getHeightWidth();var g=e.outputConnection?d-this.tabWidth_:d;e.moveBy(g,c);g=this.createRect_(e,this.RTL?g-l.width:g,c,l,h);this.addBlockListeners_(f,e,g);c+=l.height+b[h];}else"button"===k.type&&(e=k.button,this.initFlyoutButton_(e,d,c),c+=e.height+b[h]);}}},{key:"isDragTowardWorkspace",value:function isDragTowardWorkspace(a){a=Math.atan2(a.y,a.x)/Math.PI*180;var b=this.dragAngleRange_;return a<b&&a>-b||a<-180+b||a>180-b?!0:!1;}},{key:"getClientRect",value:function getClientRect(){if(!this.svgGroup_||this.autoClose||!this.isVisible())return null;var a=this.svgGroup_.getBoundingClientRect(),b=a.left;return this.toolboxPosition_===Position$$module$build$src$core$utils$toolbox.LEFT?new Rect$$module$build$src$core$utils$rect(-1E9,1E9,-1E9,b+a.width):new Rect$$module$build$src$core$utils$rect(-1E9,1E9,b,1E9);}},{key:"reflowInternal_",value:function reflowInternal_(){this.workspace_.scale=this.getFlyoutScale();var a=0;var b=this.workspace_.getTopBlocks(!1);for(var d=0,e;e=b[d];d++){var c=e.getHeightWidth().width;e.outputConnection&&(c-=this.tabWidth_);a=Math.max(a,c);}for(var _d12=0,_e9;_e9=this.buttons_[_d12];_d12++){a=Math.max(a,_e9.width);}a+=1.5*this.MARGIN+this.tabWidth_;a*=this.workspace_.scale;a+=Scrollbar$$module$build$src$core$scrollbar.scrollbarThickness;if(this.width_!==a){for(var _d13=0,_e10;_e10=b[_d13];_d13++){if(this.RTL){c=_e10.getRelativeToSurfaceXY().x;var f=a/this.workspace_.scale-this.MARGIN;_e10.outputConnection||(f-=this.tabWidth_);_e10.moveBy(f-c,0);}this.rectMap_.has(_e10)&&this.moveRectToBlock_(this.rectMap_.get(_e10),_e10);}if(this.RTL)for(var _d14=0,_e11;_e11=this.buttons_[_d14];_d14++){b=_e11.getPosition().y,_e11.moveTo(a/this.workspace_.scale-_e11.width-this.MARGIN-this.tabWidth_,b);}this.targetWorkspace.toolboxPosition!==this.toolboxPosition_||this.toolboxPosition_!==Position$$module$build$src$core$utils$toolbox.LEFT||this.targetWorkspace.getToolbox()||this.targetWorkspace.translate(this.targetWorkspace.scrollX+a,this.targetWorkspace.scrollY);this.width_=a;this.position();this.targetWorkspace.recordDragTargets();}}}]);return VerticalFlyout$$module$build$src$core$flyout_vertical;}(Flyout$$module$build$src$core$flyout_base);VerticalFlyout$$module$build$src$core$flyout_vertical.registryName="verticalFlyout";register$$module$build$src$core$registry(Type$$module$build$src$core$registry.FLYOUTS_VERTICAL_TOOLBOX,DEFAULT$$module$build$src$core$registry,VerticalFlyout$$module$build$src$core$flyout_vertical);var module$build$src$core$flyout_vertical={};module$build$src$core$flyout_vertical.VerticalFlyout=VerticalFlyout$$module$build$src$core$flyout_vertical;var HorizontalFlyout$$module$build$src$core$flyout_horizontal=/*#__PURE__*/function(_Flyout$$module$build2){_inherits(HorizontalFlyout$$module$build$src$core$flyout_horizontal,_Flyout$$module$build2);var _super91=_createSuper(HorizontalFlyout$$module$build$src$core$flyout_horizontal);function HorizontalFlyout$$module$build$src$core$flyout_horizontal(a){var _this87;_classCallCheck(this,HorizontalFlyout$$module$build$src$core$flyout_horizontal);_this87=_super91.call(this,a);_this87.horizontalLayout=!0;return _this87;}_createClass(HorizontalFlyout$$module$build$src$core$flyout_horizontal,[{key:"setMetrics_",value:function setMetrics_(a){if(this.isVisible()){var b=this.workspace_.getMetricsManager(),c=b.getScrollMetrics(),d=b.getViewMetrics();b=b.getAbsoluteMetrics();"number"===typeof a.x&&(this.workspace_.scrollX=-(c.left+(c.width-d.width)*a.x));this.workspace_.translate(this.workspace_.scrollX+b.left,this.workspace_.scrollY+b.top);}}},{key:"getX",value:function getX(){return 0;}},{key:"getY",value:function getY(){if(!this.isVisible())return 0;var a=this.targetWorkspace.getMetricsManager();var b=a.getAbsoluteMetrics(),c=a.getViewMetrics();a=a.getToolboxMetrics();var d=this.toolboxPosition_===Position$$module$build$src$core$utils$toolbox.TOP;return this.targetWorkspace.toolboxPosition===this.toolboxPosition_?this.targetWorkspace.getToolbox()?d?a.height:c.height-this.height_:d?0:c.height:d?0:c.height+b.top-this.height_;}},{key:"position",value:function position(){if(this.isVisible()&&this.targetWorkspace.isVisible()){var a=this.targetWorkspace.getMetricsManager().getViewMetrics();this.width_=a.width;this.setBackgroundPath_(a.width-2*this.CORNER_RADIUS,this.height_-this.CORNER_RADIUS);a=this.getX();var b=this.getY();this.positionAt_(this.width_,this.height_,a,b);}}},{key:"setBackgroundPath_",value:function setBackgroundPath_(a,b){var c=this.toolboxPosition_===Position$$module$build$src$core$utils$toolbox.TOP,d=["M 0,"+(c?0:this.CORNER_RADIUS)];c?(d.push("h",a+2*this.CORNER_RADIUS),d.push("v",b),d.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,-this.CORNER_RADIUS,this.CORNER_RADIUS),d.push("h",-a),d.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,-this.CORNER_RADIUS,-this.CORNER_RADIUS)):(d.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,this.CORNER_RADIUS,-this.CORNER_RADIUS),d.push("h",a),d.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,this.CORNER_RADIUS,this.CORNER_RADIUS),d.push("v",b),d.push("h",-a-2*this.CORNER_RADIUS));d.push("z");this.svgBackground_.setAttribute("d",d.join(" "));}},{key:"scrollToStart",value:function scrollToStart(){var a;null==(a=this.workspace_.scrollbar)||a.setX(this.RTL?Infinity:0);}},{key:"wheel_",value:function wheel_(a){var b=getScrollDeltaPixels$$module$build$src$core$browser_events(a);if(b=b.x||b.y){var c=this.workspace_.getMetricsManager(),d=c.getScrollMetrics();b=c.getViewMetrics().left-d.left+b;var e;null==(e=this.workspace_.scrollbar)||e.setX(b);hide$$module$build$src$core$widgetdiv();hideWithoutAnimation$$module$build$src$core$dropdowndiv();}a.preventDefault();a.stopPropagation();}},{key:"layout_",value:function layout_(a,b){this.workspace_.scale=this.targetWorkspace.scale;var c=this.MARGIN;var d=c+this.tabWidth_;this.RTL&&(a=a.reverse());for(var h=0,k;k=a[h];h++){if("block"===k.type){var e=k.block,f=e.getDescendants(!1);for(var m=0,n;n=f[m];m++){n.isInFlyout=!0;}e.render();f=e.getSvgRoot();var l=e.getHeightWidth();var g=e.outputConnection?this.tabWidth_:0;g=this.RTL?d+l.width:d-g;e.moveBy(g,c);g=this.createRect_(e,g,c,l,h);d+=l.width+b[h];this.addBlockListeners_(f,e,g);}else"button"===k.type&&(e=k.button,this.initFlyoutButton_(e,d,c),d+=e.width+b[h]);}}},{key:"isDragTowardWorkspace",value:function isDragTowardWorkspace(a){a=Math.atan2(a.y,a.x)/Math.PI*180;var b=this.dragAngleRange_;return a<90+b&&a>90-b||a>-90-b&&a<-90+b?!0:!1;}},{key:"getClientRect",value:function getClientRect(){if(!this.svgGroup_||this.autoClose||!this.isVisible())return null;var a=this.svgGroup_.getBoundingClientRect(),b=a.top;return this.toolboxPosition_===Position$$module$build$src$core$utils$toolbox.TOP?new Rect$$module$build$src$core$utils$rect(-1E9,b+a.height,-1E9,1E9):new Rect$$module$build$src$core$utils$rect(b,1E9,-1E9,1E9);}},{key:"reflowInternal_",value:function reflowInternal_(){this.workspace_.scale=this.getFlyoutScale();var a=0;var b=this.workspace_.getTopBlocks(!1);for(var d=0,e;e=b[d];d++){a=Math.max(a,e.getHeightWidth().height);}var c=this.buttons_;for(var _d15=0,_e12;_e12=c[_d15];_d15++){a=Math.max(a,_e12.height);}a+=1.5*this.MARGIN;a*=this.workspace_.scale;a+=Scrollbar$$module$build$src$core$scrollbar.scrollbarThickness;if(this.height_!==a){for(var _d16=0,_e13;_e13=b[_d16];_d16++){this.rectMap_.has(_e13)&&this.moveRectToBlock_(this.rectMap_.get(_e13),_e13);}this.targetWorkspace.toolboxPosition!==this.toolboxPosition_||this.toolboxPosition_!==Position$$module$build$src$core$utils$toolbox.TOP||this.targetWorkspace.getToolbox()||this.targetWorkspace.translate(this.targetWorkspace.scrollX,this.targetWorkspace.scrollY+a);this.height_=a;this.position();this.targetWorkspace.recordDragTargets();}}}]);return HorizontalFlyout$$module$build$src$core$flyout_horizontal;}(Flyout$$module$build$src$core$flyout_base);register$$module$build$src$core$registry(Type$$module$build$src$core$registry.FLYOUTS_HORIZONTAL_TOOLBOX,DEFAULT$$module$build$src$core$registry,HorizontalFlyout$$module$build$src$core$flyout_horizontal);var module$build$src$core$flyout_horizontal={};module$build$src$core$flyout_horizontal.HorizontalFlyout=HorizontalFlyout$$module$build$src$core$flyout_horizontal;var FieldVariable$$module$build$src$core$field_variable=/*#__PURE__*/function(_FieldDropdown$$modul){_inherits(FieldVariable$$module$build$src$core$field_variable,_FieldDropdown$$modul);var _super92=_createSuper(FieldVariable$$module$build$src$core$field_variable);function FieldVariable$$module$build$src$core$field_variable(a,b,c,d,e){var _this88;_classCallCheck(this,FieldVariable$$module$build$src$core$field_variable);_this88=_super92.call(this,Field$$module$build$src$core$field.SKIP_SETUP);_this88.defaultType_="";_this88.variableTypes=[];_this88.variable_=null;_this88.SERIALIZABLE=!0;_this88.menuGenerator_=FieldVariable$$module$build$src$core$field_variable.dropdownCreate;_this88.defaultVariableName="string"===typeof a?a:"";_this88.size_=new Size$$module$build$src$core$utils$size(0,0);a!==Field$$module$build$src$core$field.SKIP_SETUP&&(e?_this88.configure_(e):_this88.setTypes_(c,d),b&&_this88.setValidator(b));return _this88;}_createClass(FieldVariable$$module$build$src$core$field_variable,[{key:"configure_",value:function configure_(a){_get(_getPrototypeOf(FieldVariable$$module$build$src$core$field_variable.prototype),"configure_",this).call(this,a);this.setTypes_(a.variableTypes,a.defaultType);}},{key:"initModel",value:function initModel(){var a=this.getSourceBlock();if(!a)throw new UnattachedFieldError$$module$build$src$core$field();this.variable_||(a=getOrCreateVariablePackage$$module$build$src$core$variables(a.workspace,null,this.defaultVariableName,this.defaultType_),this.doValueUpdate_(a.getId()));}},{key:"shouldAddBorderRect_",value:function shouldAddBorderRect_(){var a=this.getSourceBlock();if(!a)throw new UnattachedFieldError$$module$build$src$core$field();return _get(_getPrototypeOf(FieldVariable$$module$build$src$core$field_variable.prototype),"shouldAddBorderRect_",this).call(this)&&(!this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW||"variables_get"!==a.type);}},{key:"fromXml",value:function fromXml(a){var b=this.getSourceBlock();if(!b)throw new UnattachedFieldError$$module$build$src$core$field();var c=a.getAttribute("id"),d=a.textContent,e=a.getAttribute("variabletype")||a.getAttribute("variableType")||"";b=getOrCreateVariablePackage$$module$build$src$core$variables(b.workspace,c,d,e);if(null!==e&&e!==b.type)throw Error("Serialized variable type with id '"+b.getId()+"' had type "+b.type+", and does not match variable field that references it: "+domToText$$module$build$src$core$xml(a)+".");this.setValue(b.getId());}},{key:"toXml",value:function toXml(a){this.initModel();a.id=this.variable_.getId();a.textContent=this.variable_.name;this.variable_.type&&a.setAttribute("variabletype",this.variable_.type);return a;}},{key:"saveState",value:function saveState(a){var b=this.saveLegacyState(FieldVariable$$module$build$src$core$field_variable);if(null!==b)return b;this.initModel();b={id:this.variable_.getId()};a&&(b.name=this.variable_.name,b.type=this.variable_.type);return b;}},{key:"loadState",value:function loadState(a){var b=this.getSourceBlock();if(!b)throw new UnattachedFieldError$$module$build$src$core$field();this.loadLegacyState(FieldVariable$$module$build$src$core$field_variable,a)||(a=getOrCreateVariablePackage$$module$build$src$core$variables(b.workspace,a.id||null,a.name,a.type||""),this.setValue(a.getId()));}},{key:"setSourceBlock",value:function setSourceBlock(a){if(a.isShadow())throw Error("Variable fields are not allowed to exist on shadow blocks.");_get(_getPrototypeOf(FieldVariable$$module$build$src$core$field_variable.prototype),"setSourceBlock",this).call(this,a);}},{key:"getValue",value:function getValue(){return this.variable_?this.variable_.getId():null;}},{key:"getText",value:function getText(){return this.variable_?this.variable_.name:"";}},{key:"getVariable",value:function getVariable(){return this.variable_;}},{key:"getValidator",value:function getValidator(){return this.variable_?this.validator_:null;}},{key:"doClassValidation_",value:function doClassValidation_(a){if(null===a)return null;var b=this.getSourceBlock();if(!b)throw new UnattachedFieldError$$module$build$src$core$field();b=getVariable$$module$build$src$core$variables(b.workspace,a);if(!b)return console.warn("Variable id doesn't point to a real variable! ID was "+a),null;b=b.type;return this.typeIsAllowed_(b)?a:(console.warn("Variable type doesn't match this field!  Type was "+b),null);}},{key:"doValueUpdate_",value:function doValueUpdate_(a){var b=this.getSourceBlock();if(!b)throw new UnattachedFieldError$$module$build$src$core$field();this.variable_=getVariable$$module$build$src$core$variables(b.workspace,a);_get(_getPrototypeOf(FieldVariable$$module$build$src$core$field_variable.prototype),"doValueUpdate_",this).call(this,a);}},{key:"typeIsAllowed_",value:function typeIsAllowed_(a){var b=this.getVariableTypes_();if(!b)return!0;for(var c=0;c<b.length;c++){if(a===b[c])return!0;}return!1;}},{key:"getVariableTypes_",value:function getVariableTypes_(){var a=this.variableTypes;if(null===a&&this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying())return this.sourceBlock_.workspace.getVariableTypes();a=a||[""];if(0===a.length)throw a=this.getText(),Error("'variableTypes' of field variable "+a+" was an empty list");return a;}},{key:"setTypes_",value:function setTypes_(a,b){b=b||"";if(null===a||void 0===a)a=null;else if(Array.isArray(a)){var c=!1;for(var d=0;d<a.length;d++){a[d]===b&&(c=!0);}if(!c)throw Error("Invalid default type '"+b+"' in the definition of a FieldVariable");}else throw Error("'variableTypes' was not an array in the definition of a FieldVariable");this.defaultType_=b;this.variableTypes=a;}},{key:"refreshVariableName",value:function refreshVariableName(){this.forceRerender();}},{key:"onItemSelected_",value:function onItemSelected_(a,b){a=b.getValue();if(this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying()){if(a===RENAME_VARIABLE_ID$$module$build$src$core$internal_constants){renameVariable$$module$build$src$core$variables(this.sourceBlock_.workspace,this.variable_);return;}if(a===DELETE_VARIABLE_ID$$module$build$src$core$internal_constants){this.sourceBlock_.workspace.deleteVariableById(this.variable_.getId());return;}}this.setValue(a);}},{key:"referencesVariables",value:function referencesVariables(){return!0;}}],[{key:"fromJson",value:function fromJson(a){return new this(replaceMessageReferences$$module$build$src$core$utils$parsing(a.variable),void 0,void 0,void 0,a);}},{key:"dropdownCreate",value:function dropdownCreate(){if(!this.variable_)throw Error("Tried to call dropdownCreate on a variable field with no variable selected.");var a=this.getText();var b=[];if(this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying()){var c=this.getVariableTypes_();for(var d=0;d<c.length;d++){var e=this.sourceBlock_.workspace.getVariablesOfType(c[d]);b=b.concat(e);}}b.sort(VariableModel$$module$build$src$core$variable_model.compareByName);c=[];for(d=0;d<b.length;d++){c[d]=[b[d].name,b[d].getId()];}c.push([Msg$$module$build$src$core$msg.RENAME_VARIABLE,RENAME_VARIABLE_ID$$module$build$src$core$internal_constants]);Msg$$module$build$src$core$msg.DELETE_VARIABLE&&c.push([Msg$$module$build$src$core$msg.DELETE_VARIABLE.replace("%1",a),DELETE_VARIABLE_ID$$module$build$src$core$internal_constants]);return c;}}]);return FieldVariable$$module$build$src$core$field_variable;}(FieldDropdown$$module$build$src$core$field_dropdown);register$$module$build$src$core$field_registry("field_variable",FieldVariable$$module$build$src$core$field_variable);var module$build$src$core$field_variable={};module$build$src$core$field_variable.FieldVariable=FieldVariable$$module$build$src$core$field_variable;var FieldNumber$$module$build$src$core$field_number=/*#__PURE__*/function(_$$FieldTextInput$$mo){_inherits(FieldNumber$$module$build$src$core$field_number,_$$FieldTextInput$$mo);var _super93=_createSuper(FieldNumber$$module$build$src$core$field_number);function FieldNumber$$module$build$src$core$field_number(a,b,c,d,e,f){var _this89;_classCallCheck(this,FieldNumber$$module$build$src$core$field_number);_this89=_super93.call(this,Field$$module$build$src$core$field.SKIP_SETUP);_this89.min_=-Infinity;_this89.max_=Infinity;_this89.precision_=0;_this89.decimalPlaces_=null;_this89.SERIALIZABLE=!0;a!==Field$$module$build$src$core$field.SKIP_SETUP&&(f?_this89.configure_(f):_this89.setConstraints(b,c,d),_this89.setValue(a),e&&_this89.setValidator(e));return _this89;}_createClass(FieldNumber$$module$build$src$core$field_number,[{key:"configure_",value:function configure_(a){_get(_getPrototypeOf(FieldNumber$$module$build$src$core$field_number.prototype),"configure_",this).call(this,a);this.setMinInternal_(a.min);this.setMaxInternal_(a.max);this.setPrecisionInternal_(a.precision);}},{key:"setConstraints",value:function setConstraints(a,b,c){this.setMinInternal_(a);this.setMaxInternal_(b);this.setPrecisionInternal_(c);this.setValue(this.getValue());}},{key:"setMin",value:function setMin(a){this.setMinInternal_(a);this.setValue(this.getValue());}},{key:"setMinInternal_",value:function setMinInternal_(a){null==a?this.min_=-Infinity:(a=Number(a),isNaN(a)||(this.min_=a));}},{key:"getMin",value:function getMin(){return this.min_;}},{key:"setMax",value:function setMax(a){this.setMaxInternal_(a);this.setValue(this.getValue());}},{key:"setMaxInternal_",value:function setMaxInternal_(a){null==a?this.max_=Infinity:(a=Number(a),isNaN(a)||(this.max_=a));}},{key:"getMax",value:function getMax(){return this.max_;}},{key:"setPrecision",value:function setPrecision(a){this.setPrecisionInternal_(a);this.setValue(this.getValue());}},{key:"setPrecisionInternal_",value:function setPrecisionInternal_(a){this.precision_=Number(a)||0;var b=String(this.precision_);-1!==b.indexOf("e")&&(b=this.precision_.toLocaleString("en-US",{maximumFractionDigits:20}));var c=b.indexOf(".");this.decimalPlaces_=-1===c?a?0:null:b.length-c-1;}},{key:"getPrecision",value:function getPrecision(){return this.precision_;}},{key:"doClassValidation_",value:function doClassValidation_(a){if(null===a)return null;a=String(a);a=a.replace(/O/ig,"0");a=a.replace(/,/g,"");a=a.replace(/infinity/i,"Infinity");a=Number(a||0);if(isNaN(a))return null;a=Math.min(Math.max(a,this.min_),this.max_);this.precision_&&isFinite(a)&&(a=Math.round(a/this.precision_)*this.precision_);null!==this.decimalPlaces_&&(a=Number(a.toFixed(this.decimalPlaces_)));return a;}},{key:"widgetCreate_",value:function widgetCreate_(){var a=_get(_getPrototypeOf(FieldNumber$$module$build$src$core$field_number.prototype),"widgetCreate_",this).call(this);-Infinity<this.min_&&setState$$module$build$src$core$utils$aria(a,State$$module$build$src$core$utils$aria.VALUEMIN,this.min_);Infinity>this.max_&&setState$$module$build$src$core$utils$aria(a,State$$module$build$src$core$utils$aria.VALUEMAX,this.max_);return a;}}],[{key:"fromJson",value:function fromJson(a){return new this(a.value,void 0,void 0,void 0,void 0,a);}}]);return FieldNumber$$module$build$src$core$field_number;}($.FieldTextInput$$module$build$src$core$field_textinput);register$$module$build$src$core$field_registry("field_number",FieldNumber$$module$build$src$core$field_number);FieldNumber$$module$build$src$core$field_number.prototype.DEFAULT_VALUE=0;var module$build$src$core$field_number={};module$build$src$core$field_number.FieldNumber=FieldNumber$$module$build$src$core$field_number;var FieldMultilineInput$$module$build$src$core$field_multilineinput=/*#__PURE__*/function(_$$FieldTextInput$$mo2){_inherits(FieldMultilineInput$$module$build$src$core$field_multilineinput,_$$FieldTextInput$$mo2);var _super94=_createSuper(FieldMultilineInput$$module$build$src$core$field_multilineinput);function FieldMultilineInput$$module$build$src$core$field_multilineinput(a,b,c){var _this90;_classCallCheck(this,FieldMultilineInput$$module$build$src$core$field_multilineinput);_this90=_super94.call(this,Field$$module$build$src$core$field.SKIP_SETUP);_this90.textGroup_=null;_this90.maxLines_=Infinity;_this90.isOverflowedY_=!1;a!==Field$$module$build$src$core$field.SKIP_SETUP&&(c&&_this90.configure_(c),_this90.setValue(a),b&&_this90.setValidator(b));return _this90;}_createClass(FieldMultilineInput$$module$build$src$core$field_multilineinput,[{key:"configure_",value:function configure_(a){_get(_getPrototypeOf(FieldMultilineInput$$module$build$src$core$field_multilineinput.prototype),"configure_",this).call(this,a);a.maxLines&&this.setMaxLines(a.maxLines);}},{key:"toXml",value:function toXml(a){a.textContent=this.getValue().replace(/\n/g,"&#10;");return a;}},{key:"fromXml",value:function fromXml(a){this.setValue(a.textContent.replace(/&#10;/g,"\n"));}},{key:"saveState",value:function saveState(){var a=this.saveLegacyState(FieldMultilineInput$$module$build$src$core$field_multilineinput);return null!==a?a:this.getValue();}},{key:"loadState",value:function loadState(a){this.loadLegacyState(Field$$module$build$src$core$field,a)||this.setValue(a);}},{key:"initView",value:function initView(){this.createBorderRect_();this.textGroup_=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.G,{"class":"blocklyEditableText"},this.fieldGroup_);}},{key:"getDisplayText_",value:function getDisplayText_(){var a=this.getSourceBlock();if(!a)throw new UnattachedFieldError$$module$build$src$core$field();var b=this.getText();if(!b)return Field$$module$build$src$core$field.NBSP;var c=b.split("\n");b="";var d=this.isOverflowedY_?this.maxLines_:c.length;for(var e=0;e<d;e++){var f=c[e];f.length>this.maxDisplayLength?f=f.substring(0,this.maxDisplayLength-4)+"...":this.isOverflowedY_&&e===d-1&&(f=f.substring(0,f.length-3)+"...");f=f.replace(/\s/g,Field$$module$build$src$core$field.NBSP);b+=f;e!==d-1&&(b+="\n");}a.RTL&&(b+="\u200F");return b;}},{key:"doValueUpdate_",value:function doValueUpdate_(a){_get(_getPrototypeOf(FieldMultilineInput$$module$build$src$core$field_multilineinput.prototype),"doValueUpdate_",this).call(this,a);this.isOverflowedY_=this.value_.split("\n").length>this.maxLines_;}},{key:"render_",value:function render_(){var a=this.getSourceBlock();if(!a)throw new UnattachedFieldError$$module$build$src$core$field();for(var b;b=this.textGroup_.firstChild;){this.textGroup_.removeChild(b);}b=this.getDisplayText_().split("\n");var c=0;for(var d=0;d<b.length;d++){var e=this.getConstants().FIELD_TEXT_HEIGHT+this.getConstants().FIELD_BORDER_RECT_Y_PADDING;createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.TEXT,{"class":"blocklyText blocklyMultilineText",x:this.getConstants().FIELD_BORDER_RECT_X_PADDING,y:c+this.getConstants().FIELD_BORDER_RECT_Y_PADDING,dy:this.getConstants().FIELD_TEXT_BASELINE},this.textGroup_).appendChild(document.createTextNode(b[d]));c+=e;}this.isBeingEdited_&&(b=this.htmlInput_,this.isOverflowedY_?addClass$$module$build$src$core$utils$dom(b,"blocklyHtmlTextAreaInputOverflowedY"):removeClass$$module$build$src$core$utils$dom(b,"blocklyHtmlTextAreaInputOverflowedY"));this.updateSize_();this.isBeingEdited_&&(a.RTL?setTimeout(this.resizeEditor_.bind(this),0):this.resizeEditor_(),a=this.htmlInput_,this.isTextValid_?(removeClass$$module$build$src$core$utils$dom(a,"blocklyInvalidInput"),setState$$module$build$src$core$utils$aria(a,State$$module$build$src$core$utils$aria.INVALID,!1)):(addClass$$module$build$src$core$utils$dom(a,"blocklyInvalidInput"),setState$$module$build$src$core$utils$aria(a,State$$module$build$src$core$utils$aria.INVALID,!0)));}},{key:"updateSize_",value:function updateSize_(){var a=this.textGroup_.childNodes;var b=this.getConstants().FIELD_TEXT_FONTSIZE,c=this.getConstants().FIELD_TEXT_FONTWEIGHT,d=this.getConstants().FIELD_TEXT_FONTFAMILY;var e=0,f=0;for(var g=0;g<a.length;g++){var h=getFastTextWidth$$module$build$src$core$utils$dom(a[g],b,c,d);h>e&&(e=h);f+=this.getConstants().FIELD_TEXT_HEIGHT+(0<g?this.getConstants().FIELD_BORDER_RECT_Y_PADDING:0);}if(this.isBeingEdited_){a=this.value_.split("\n");g=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.TEXT,{"class":"blocklyText blocklyMultilineText"});for(h=0;h<a.length;h++){a[h].length>this.maxDisplayLength&&(a[h]=a[h].substring(0,this.maxDisplayLength));g.textContent=a[h];var k=getFastTextWidth$$module$build$src$core$utils$dom(g,b,c,d);k>e&&(e=k);}e+=this.htmlInput_.offsetWidth-this.htmlInput_.clientWidth;}this.borderRect_&&(f+=2*this.getConstants().FIELD_BORDER_RECT_Y_PADDING,e+=2*this.getConstants().FIELD_BORDER_RECT_X_PADDING,this.borderRect_.setAttribute("width",e),this.borderRect_.setAttribute("height",f));this.size_.width=e;this.size_.height=f;this.positionBorderRect_();}},{key:"showEditor_",value:function showEditor_(a,b){_get(_getPrototypeOf(FieldMultilineInput$$module$build$src$core$field_multilineinput.prototype),"showEditor_",this).call(this,a,b);this.forceRerender();}},{key:"widgetCreate_",value:function widgetCreate_(){var a=getDiv$$module$build$src$core$widgetdiv(),b=this.workspace_.getScale(),c=document.createElement("textarea");c.className="blocklyHtmlInput blocklyHtmlTextAreaInput";c.setAttribute("spellcheck",this.spellcheck_);var d=this.getConstants().FIELD_TEXT_FONTSIZE*b+"pt";a.style.fontSize=d;c.style.fontSize=d;c.style.borderRadius=$.FieldTextInput$$module$build$src$core$field_textinput.BORDERRADIUS*b+"px";d=this.getConstants().FIELD_BORDER_RECT_X_PADDING*b;var e=this.getConstants().FIELD_BORDER_RECT_Y_PADDING*b/2;c.style.padding=e+"px "+d+"px "+e+"px "+d+"px";d=this.getConstants().FIELD_TEXT_HEIGHT+this.getConstants().FIELD_BORDER_RECT_Y_PADDING;c.style.lineHeight=d*b+"px";a.appendChild(c);c.value=c.defaultValue=this.getEditorText_(this.value_);c.setAttribute("data-untyped-default-value",this.value_);c.setAttribute("data-old-value","");GECKO$$module$build$src$core$utils$useragent?setTimeout(this.resizeEditor_.bind(this),0):this.resizeEditor_();this.bindInputEvents_(c);return c;}},{key:"setMaxLines",value:function setMaxLines(a){"number"===typeof a&&0<a&&a!==this.maxLines_&&(this.maxLines_=a,this.forceRerender());}},{key:"getMaxLines",value:function getMaxLines(){return this.maxLines_;}},{key:"onHtmlInputKeyDown_",value:function onHtmlInputKeyDown_(a){if(a.keyCode!==KeyCodes$$module$build$src$core$utils$keycodes.ENTER)_get(_getPrototypeOf(FieldMultilineInput$$module$build$src$core$field_multilineinput.prototype),"onHtmlInputKeyDown_",this).call(this,a);}}],[{key:"fromJson",value:function fromJson(a){return new this(replaceMessageReferences$$module$build$src$core$utils$parsing(a.text),void 0,a);}}]);return FieldMultilineInput$$module$build$src$core$field_multilineinput;}($.FieldTextInput$$module$build$src$core$field_textinput);register$$module$build$src$core$css("\n.blocklyHtmlTextAreaInput {\n  font-family: monospace;\n  resize: none;\n  overflow: hidden;\n  height: 100%;\n  text-align: left;\n}\n\n.blocklyHtmlTextAreaInputOverflowedY {\n  overflow-y: scroll;\n}\n");register$$module$build$src$core$field_registry("field_multilinetext",FieldMultilineInput$$module$build$src$core$field_multilineinput);var module$build$src$core$field_multilineinput={};module$build$src$core$field_multilineinput.FieldMultilineInput=FieldMultilineInput$$module$build$src$core$field_multilineinput;var FieldLabelSerializable$$module$build$src$core$field_label_serializable=/*#__PURE__*/function(_$$FieldLabel$$module){_inherits(FieldLabelSerializable$$module$build$src$core$field_label_serializable,_$$FieldLabel$$module);var _super95=_createSuper(FieldLabelSerializable$$module$build$src$core$field_label_serializable);function FieldLabelSerializable$$module$build$src$core$field_label_serializable(a,b,c){var _this91;_classCallCheck(this,FieldLabelSerializable$$module$build$src$core$field_label_serializable);_this91=_super95.call(this,String(null!=a?a:""),b,c);_this91.EDITABLE=!1;_this91.SERIALIZABLE=!0;return _this91;}_createClass(FieldLabelSerializable$$module$build$src$core$field_label_serializable,null,[{key:"fromJson",value:function fromJson(a){return new this(replaceMessageReferences$$module$build$src$core$utils$parsing(a.text),void 0,a);}}]);return FieldLabelSerializable$$module$build$src$core$field_label_serializable;}($.FieldLabel$$module$build$src$core$field_label);register$$module$build$src$core$field_registry("field_label_serializable",FieldLabelSerializable$$module$build$src$core$field_label_serializable);var module$build$src$core$field_label_serializable={};module$build$src$core$field_label_serializable.FieldLabelSerializable=FieldLabelSerializable$$module$build$src$core$field_label_serializable;var FieldColour$$module$build$src$core$field_colour=/*#__PURE__*/function(_Field$$module$build$5){_inherits(FieldColour$$module$build$src$core$field_colour,_Field$$module$build$5);var _super96=_createSuper(FieldColour$$module$build$src$core$field_colour);function FieldColour$$module$build$src$core$field_colour(a,b,c){var _this92;_classCallCheck(this,FieldColour$$module$build$src$core$field_colour);_this92=_super96.call(this,Field$$module$build$src$core$field.SKIP_SETUP);_this92.onKeyDownWrapper_=_this92.onMouseLeaveWrapper_=_this92.onMouseEnterWrapper_=_this92.onMouseMoveWrapper_=_this92.onClickWrapper_=_this92.highlightedIndex_=_this92.picker_=null;_this92.SERIALIZABLE=!0;_this92.CURSOR="default";_this92.isDirty_=!1;_this92.titles_=_this92.colours_=null;_this92.columns_=0;a!==Field$$module$build$src$core$field.SKIP_SETUP&&(c&&_this92.configure_(c),_this92.setValue(a),b&&_this92.setValidator(b));return _this92;}_createClass(FieldColour$$module$build$src$core$field_colour,[{key:"configure_",value:function configure_(a){_get(_getPrototypeOf(FieldColour$$module$build$src$core$field_colour.prototype),"configure_",this).call(this,a);a.colourOptions&&(this.colours_=a.colourOptions);a.colourTitles&&(this.titles_=a.colourTitles);a.columns&&(this.columns_=a.columns);}},{key:"initView",value:function initView(){this.size_=new Size$$module$build$src$core$utils$size(this.getConstants().FIELD_COLOUR_DEFAULT_WIDTH,this.getConstants().FIELD_COLOUR_DEFAULT_HEIGHT);this.getConstants().FIELD_COLOUR_FULL_BLOCK?this.sourceBlock_ instanceof BlockSvg$$module$build$src$core$block_svg&&(this.clickTarget_=this.sourceBlock_.getSvgRoot()):(this.createBorderRect_(),this.getBorderRect().style.fillOpacity="1");}},{key:"applyColour",value:function applyColour(){this.getConstants().FIELD_COLOUR_FULL_BLOCK?this.sourceBlock_ instanceof BlockSvg$$module$build$src$core$block_svg&&(this.sourceBlock_.pathObject.svgPath.setAttribute("fill",this.getValue()),this.sourceBlock_.pathObject.svgPath.setAttribute("stroke","#fff")):this.borderRect_&&(this.borderRect_.style.fill=this.getValue());}},{key:"doClassValidation_",value:function doClassValidation_(a){return"string"!==typeof a?null:parse$$module$build$src$core$utils$colour(a);}},{key:"doValueUpdate_",value:function doValueUpdate_(a){this.value_=a;this.borderRect_?this.borderRect_.style.fill=a:this.sourceBlock_&&this.sourceBlock_.rendered&&this.sourceBlock_ instanceof BlockSvg$$module$build$src$core$block_svg&&(this.sourceBlock_.pathObject.svgPath.setAttribute("fill",a),this.sourceBlock_.pathObject.svgPath.setAttribute("stroke","#fff"));}},{key:"getText",value:function getText(){var a=this.value_;/^#(.)\1(.)\2(.)\3$/.test(a)&&(a="#"+a[1]+a[3]+a[5]);return a;}},{key:"setColours",value:function setColours(a,b){this.colours_=a;b&&(this.titles_=b);return this;}},{key:"setColumns",value:function setColumns(a){this.columns_=a;return this;}},{key:"showEditor_",value:function showEditor_(){this.dropdownCreate_();getContentDiv$$module$build$src$core$dropdowndiv().appendChild(this.picker_);showPositionedByField$$module$build$src$core$dropdowndiv(this,this.dropdownDispose_.bind(this));this.picker_.focus({preventScroll:!0});}},{key:"onClick_",value:function onClick_(a){a=(a=a.target)&&a.getAttribute("data-colour");null!==a&&(this.setValue(a),hideIfOwner$$module$build$src$core$dropdowndiv(this));}},{key:"onKeyDown_",value:function onKeyDown_(a){var b=!1;if(a.keyCode===KeyCodes$$module$build$src$core$utils$keycodes.UP)this.moveHighlightBy_(0,-1),b=!0;else if(a.keyCode===KeyCodes$$module$build$src$core$utils$keycodes.DOWN)this.moveHighlightBy_(0,1),b=!0;else if(a.keyCode===KeyCodes$$module$build$src$core$utils$keycodes.LEFT)this.moveHighlightBy_(-1,0),b=!0;else if(a.keyCode===KeyCodes$$module$build$src$core$utils$keycodes.RIGHT)this.moveHighlightBy_(1,0),b=!0;else if(a.keyCode===KeyCodes$$module$build$src$core$utils$keycodes.ENTER){if(b=this.getHighlighted_())b=b&&b.getAttribute("data-colour"),null!==b&&this.setValue(b);hideWithoutAnimation$$module$build$src$core$dropdowndiv();b=!0;}b&&a.stopPropagation();}},{key:"moveHighlightBy_",value:function moveHighlightBy_(a,b){if(this.highlightedIndex_){var c=this.colours_||FieldColour$$module$build$src$core$field_colour.COLOURS,d=this.columns_||FieldColour$$module$build$src$core$field_colour.COLUMNS,e=this.highlightedIndex_%d,f=Math.floor(this.highlightedIndex_/d);e+=a;f+=b;0>a?0>e&&0<f?(e=d-1,f--):0>e&&(e=0):0<a?e>d-1&&f<Math.floor(c.length/d)-1?(e=0,f++):e>d-1&&e--:0>b?0>f&&(f=0):0<b&&f>Math.floor(c.length/d)-1&&(f=Math.floor(c.length/d)-1);this.setHighlightedCell_(this.picker_.childNodes[f].childNodes[e],f*d+e);}}},{key:"onMouseMove_",value:function onMouseMove_(a){var b=(a=a.target)&&Number(a.getAttribute("data-index"));null!==b&&b!==this.highlightedIndex_&&this.setHighlightedCell_(a,b);}},{key:"onMouseEnter_",value:function onMouseEnter_(){this.picker_.focus({preventScroll:!0});}},{key:"onMouseLeave_",value:function onMouseLeave_(){this.picker_.blur();var a=this.getHighlighted_();a&&removeClass$$module$build$src$core$utils$dom(a,"blocklyColourHighlighted");}},{key:"getHighlighted_",value:function getHighlighted_(){if(!this.highlightedIndex_)return null;var a=this.columns_||FieldColour$$module$build$src$core$field_colour.COLUMNS,b=this.picker_.childNodes[Math.floor(this.highlightedIndex_/a)];return b?b.childNodes[this.highlightedIndex_%a]:null;}},{key:"setHighlightedCell_",value:function setHighlightedCell_(a,b){var c=this.getHighlighted_();c&&removeClass$$module$build$src$core$utils$dom(c,"blocklyColourHighlighted");addClass$$module$build$src$core$utils$dom(a,"blocklyColourHighlighted");this.highlightedIndex_=b;setState$$module$build$src$core$utils$aria(this.picker_,State$$module$build$src$core$utils$aria.ACTIVEDESCENDANT,a.getAttribute("id"));}},{key:"dropdownCreate_",value:function dropdownCreate_(){var a=this.columns_||FieldColour$$module$build$src$core$field_colour.COLUMNS,b=this.colours_||FieldColour$$module$build$src$core$field_colour.COLOURS,c=this.titles_||FieldColour$$module$build$src$core$field_colour.TITLES,d=this.getValue(),e=document.createElement("table");e.className="blocklyColourTable";e.tabIndex=0;e.dir="ltr";setRole$$module$build$src$core$utils$aria(e,Role$$module$build$src$core$utils$aria.GRID);setState$$module$build$src$core$utils$aria(e,State$$module$build$src$core$utils$aria.EXPANDED,!0);setState$$module$build$src$core$utils$aria(e,State$$module$build$src$core$utils$aria.ROWCOUNT,Math.floor(b.length/a));setState$$module$build$src$core$utils$aria(e,State$$module$build$src$core$utils$aria.COLCOUNT,a);var f;for(var g=0;g<b.length;g++){0===g%a&&(f=document.createElement("tr"),setRole$$module$build$src$core$utils$aria(f,Role$$module$build$src$core$utils$aria.ROW),e.appendChild(f));var h=document.createElement("td");f.appendChild(h);h.setAttribute("data-colour",b[g]);h.title=c[g]||b[g];h.id=getNextUniqueId$$module$build$src$core$utils$idgenerator();h.setAttribute("data-index",g);setRole$$module$build$src$core$utils$aria(h,Role$$module$build$src$core$utils$aria.GRIDCELL);setState$$module$build$src$core$utils$aria(h,State$$module$build$src$core$utils$aria.LABEL,b[g]);setState$$module$build$src$core$utils$aria(h,State$$module$build$src$core$utils$aria.SELECTED,b[g]===d);h.style.backgroundColor=b[g];b[g]===d&&(h.className="blocklyColourSelected",this.highlightedIndex_=g);}this.onClickWrapper_=conditionalBind$$module$build$src$core$browser_events(e,"click",this,this.onClick_,!0);this.onMouseMoveWrapper_=conditionalBind$$module$build$src$core$browser_events(e,"mousemove",this,this.onMouseMove_,!0);this.onMouseEnterWrapper_=conditionalBind$$module$build$src$core$browser_events(e,"mouseenter",this,this.onMouseEnter_,!0);this.onMouseLeaveWrapper_=conditionalBind$$module$build$src$core$browser_events(e,"mouseleave",this,this.onMouseLeave_,!0);this.onKeyDownWrapper_=conditionalBind$$module$build$src$core$browser_events(e,"keydown",this,this.onKeyDown_);this.picker_=e;}},{key:"dropdownDispose_",value:function dropdownDispose_(){this.onClickWrapper_&&(unbind$$module$build$src$core$browser_events(this.onClickWrapper_),this.onClickWrapper_=null);this.onMouseMoveWrapper_&&(unbind$$module$build$src$core$browser_events(this.onMouseMoveWrapper_),this.onMouseMoveWrapper_=null);this.onMouseEnterWrapper_&&(unbind$$module$build$src$core$browser_events(this.onMouseEnterWrapper_),this.onMouseEnterWrapper_=null);this.onMouseLeaveWrapper_&&(unbind$$module$build$src$core$browser_events(this.onMouseLeaveWrapper_),this.onMouseLeaveWrapper_=null);this.onKeyDownWrapper_&&(unbind$$module$build$src$core$browser_events(this.onKeyDownWrapper_),this.onKeyDownWrapper_=null);this.highlightedIndex_=this.picker_=null;}}],[{key:"fromJson",value:function fromJson(a){return new this(a.colour,void 0,a);}}]);return FieldColour$$module$build$src$core$field_colour;}(Field$$module$build$src$core$field);FieldColour$$module$build$src$core$field_colour.COLOURS="#ffffff #cccccc #c0c0c0 #999999 #666666 #333333 #000000 #ffcccc #ff6666 #ff0000 #cc0000 #990000 #660000 #330000 #ffcc99 #ff9966 #ff9900 #ff6600 #cc6600 #993300 #663300 #ffff99 #ffff66 #ffcc66 #ffcc33 #cc9933 #996633 #663333 #ffffcc #ffff33 #ffff00 #ffcc00 #999900 #666600 #333300 #99ff99 #66ff99 #33ff33 #33cc00 #009900 #006600 #003300 #99ffff #33ffff #66cccc #00cccc #339999 #336666 #003333 #ccffff #66ffff #33ccff #3366ff #3333ff #000099 #000066 #ccccff #9999ff #6666cc #6633ff #6600cc #333399 #330099 #ffccff #ff99ff #cc66cc #cc33cc #993399 #663366 #330033".split(" ");FieldColour$$module$build$src$core$field_colour.TITLES=[];FieldColour$$module$build$src$core$field_colour.COLUMNS=7;FieldColour$$module$build$src$core$field_colour.prototype.DEFAULT_VALUE=FieldColour$$module$build$src$core$field_colour.COLOURS[0];register$$module$build$src$core$css("\n.blocklyColourTable {\n  border-collapse: collapse;\n  display: block;\n  outline: none;\n  padding: 1px;\n}\n\n.blocklyColourTable>tr>td {\n  border: .5px solid #888;\n  box-sizing: border-box;\n  cursor: pointer;\n  display: inline-block;\n  height: 20px;\n  padding: 0;\n  width: 20px;\n}\n\n.blocklyColourTable>tr>td.blocklyColourHighlighted {\n  border-color: #eee;\n  box-shadow: 2px 2px 7px 2px rgba(0,0,0,.3);\n  position: relative;\n}\n\n.blocklyColourSelected, .blocklyColourSelected:hover {\n  border-color: #eee !important;\n  outline: 1px solid #333;\n  position: relative;\n}\n");register$$module$build$src$core$field_registry("field_colour",FieldColour$$module$build$src$core$field_colour);var module$build$src$core$field_colour={};module$build$src$core$field_colour.FieldColour=FieldColour$$module$build$src$core$field_colour;$.FieldCheckbox$$module$build$src$core$field_checkbox=/*#__PURE__*/function(_Field$$module$build$6){_inherits(_class6,_Field$$module$build$6);var _super97=_createSuper(_class6);function _class6(a,b,c){var _this93;_classCallCheck(this,_class6);_this93=_super97.call(this,Field$$module$build$src$core$field.SKIP_SETUP);_this93.SERIALIZABLE=!0;_this93.CURSOR="default";_this93.checkChar_=$.FieldCheckbox$$module$build$src$core$field_checkbox.CHECK_CHAR;a!==Field$$module$build$src$core$field.SKIP_SETUP&&(c&&_this93.configure_(c),_this93.setValue(a),b&&_this93.setValidator(b));return _this93;}_createClass(_class6,[{key:"configure_",value:function configure_(a){_get(_getPrototypeOf(_class6.prototype),"configure_",this).call(this,a);a.checkCharacter&&(this.checkChar_=a.checkCharacter);}},{key:"saveState",value:function saveState(){var a=this.saveLegacyState($.FieldCheckbox$$module$build$src$core$field_checkbox);return null!==a?a:this.getValueBoolean();}},{key:"initView",value:function initView(){_get(_getPrototypeOf(_class6.prototype),"initView",this).call(this);var a=this.getTextElement();addClass$$module$build$src$core$utils$dom(a,"blocklyCheckbox");a.style.display=this.value_?"block":"none";}},{key:"render_",value:function render_(){this.textContent_&&(this.textContent_.nodeValue=this.getDisplayText_());this.updateSize_(this.getConstants().FIELD_CHECKBOX_X_OFFSET);}},{key:"getDisplayText_",value:function getDisplayText_(){return this.checkChar_;}},{key:"setCheckCharacter",value:function setCheckCharacter(a){this.checkChar_=a||$.FieldCheckbox$$module$build$src$core$field_checkbox.CHECK_CHAR;this.forceRerender();}},{key:"showEditor_",value:function showEditor_(){this.setValue(!this.value_);}},{key:"doClassValidation_",value:function doClassValidation_(a){return!0===a||"TRUE"===a?"TRUE":!1===a||"FALSE"===a?"FALSE":null;}},{key:"doValueUpdate_",value:function doValueUpdate_(a){this.value_=this.convertValueToBool_(a);this.textElement_&&(this.textElement_.style.display=this.value_?"block":"none");}},{key:"getValue",value:function getValue(){return this.value_?"TRUE":"FALSE";}},{key:"getValueBoolean",value:function getValueBoolean(){return this.value_;}},{key:"getText",value:function getText(){return String(this.convertValueToBool_(this.value_));}},{key:"convertValueToBool_",value:function convertValueToBool_(a){return"string"===typeof a?"TRUE"===a:!!a;}}],[{key:"fromJson",value:function fromJson(a){return new this(a.checked,void 0,a);}}]);return _class6;}(Field$$module$build$src$core$field);$.FieldCheckbox$$module$build$src$core$field_checkbox.CHECK_CHAR="\u2713";register$$module$build$src$core$field_registry("field_checkbox",$.FieldCheckbox$$module$build$src$core$field_checkbox);$.FieldCheckbox$$module$build$src$core$field_checkbox.prototype.DEFAULT_VALUE=!1;var module$build$src$core$field_checkbox={};module$build$src$core$field_checkbox.FieldCheckbox=$.FieldCheckbox$$module$build$src$core$field_checkbox;var FieldAngle$$module$build$src$core$field_angle=/*#__PURE__*/function(_$$FieldTextInput$$mo3){_inherits(FieldAngle$$module$build$src$core$field_angle,_$$FieldTextInput$$mo3);var _super98=_createSuper(FieldAngle$$module$build$src$core$field_angle);function FieldAngle$$module$build$src$core$field_angle(a,b,c){var _this94;_classCallCheck(this,FieldAngle$$module$build$src$core$field_angle);_this94=_super98.call(this,Field$$module$build$src$core$field.SKIP_SETUP);_this94.clockwise_=FieldAngle$$module$build$src$core$field_angle.CLOCKWISE;_this94.offset_=FieldAngle$$module$build$src$core$field_angle.OFFSET;_this94.wrap_=FieldAngle$$module$build$src$core$field_angle.WRAP;_this94.round_=FieldAngle$$module$build$src$core$field_angle.ROUND;_this94.moveSurfaceWrapper_=_this94.clickSurfaceWrapper_=_this94.clickWrapper_=_this94.symbol_=_this94.line_=_this94.gauge_=_this94.editor_=null;_this94.SERIALIZABLE=!0;a!==Field$$module$build$src$core$field.SKIP_SETUP&&(c&&_this94.configure_(c),_this94.setValue(a),b&&_this94.setValidator(b));return _this94;}_createClass(FieldAngle$$module$build$src$core$field_angle,[{key:"configure_",value:function configure_(a){_get(_getPrototypeOf(FieldAngle$$module$build$src$core$field_angle.prototype),"configure_",this).call(this,a);switch(a.mode){case Mode$$module$build$src$core$field_angle.COMPASS:this.clockwise_=!0;this.offset_=90;break;case Mode$$module$build$src$core$field_angle.PROTRACTOR:this.clockwise_=!1,this.offset_=0;}a.clockwise&&(this.clockwise_=a.clockwise);a.offset&&(this.offset_=a.offset);a.wrap&&(this.wrap_=a.wrap);a.round&&(this.round_=a.round);}},{key:"initView",value:function initView(){_get(_getPrototypeOf(FieldAngle$$module$build$src$core$field_angle.prototype),"initView",this).call(this);this.symbol_=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.TSPAN,{});this.symbol_.appendChild(document.createTextNode("\xB0"));this.getTextElement().appendChild(this.symbol_);}},{key:"render_",value:function render_(){_get(_getPrototypeOf(FieldAngle$$module$build$src$core$field_angle.prototype),"render_",this).call(this);this.updateGraph_();}},{key:"showEditor_",value:function showEditor_(a){_get(_getPrototypeOf(FieldAngle$$module$build$src$core$field_angle.prototype),"showEditor_",this).call(this,a,MOBILE$$module$build$src$core$utils$useragent||ANDROID$$module$build$src$core$utils$useragent||IPAD$$module$build$src$core$utils$useragent);this.dropdownCreate_();getContentDiv$$module$build$src$core$dropdowndiv().appendChild(this.editor_);this.sourceBlock_ instanceof BlockSvg$$module$build$src$core$block_svg&&setColour$$module$build$src$core$dropdowndiv(this.sourceBlock_.style.colourPrimary,this.sourceBlock_.style.colourTertiary);showPositionedByField$$module$build$src$core$dropdowndiv(this,this.dropdownDispose_.bind(this));this.updateGraph_();}},{key:"dropdownCreate_",value:function dropdownCreate_(){var a=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.SVG,{xmlns:SVG_NS$$module$build$src$core$utils$dom,"xmlns:html":HTML_NS$$module$build$src$core$utils$dom,"xmlns:xlink":XLINK_NS$$module$build$src$core$utils$dom,version:"1.1",height:2*FieldAngle$$module$build$src$core$field_angle.HALF+"px",width:2*FieldAngle$$module$build$src$core$field_angle.HALF+"px",style:"touch-action: none"}),b=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.CIRCLE,{cx:FieldAngle$$module$build$src$core$field_angle.HALF,cy:FieldAngle$$module$build$src$core$field_angle.HALF,r:FieldAngle$$module$build$src$core$field_angle.RADIUS,"class":"blocklyAngleCircle"},a);this.gauge_=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.PATH,{"class":"blocklyAngleGauge"},a);this.line_=createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.LINE,{x1:FieldAngle$$module$build$src$core$field_angle.HALF,y1:FieldAngle$$module$build$src$core$field_angle.HALF,"class":"blocklyAngleLine"},a);for(var c=0;360>c;c+=15){createSvgElement$$module$build$src$core$utils$dom(Svg$$module$build$src$core$utils$svg.LINE,{x1:FieldAngle$$module$build$src$core$field_angle.HALF+FieldAngle$$module$build$src$core$field_angle.RADIUS,y1:FieldAngle$$module$build$src$core$field_angle.HALF,x2:FieldAngle$$module$build$src$core$field_angle.HALF+FieldAngle$$module$build$src$core$field_angle.RADIUS-(0===c%45?10:5),y2:FieldAngle$$module$build$src$core$field_angle.HALF,"class":"blocklyAngleMarks",transform:"rotate("+c+","+FieldAngle$$module$build$src$core$field_angle.HALF+","+FieldAngle$$module$build$src$core$field_angle.HALF+")"},a);}this.clickWrapper_=conditionalBind$$module$build$src$core$browser_events(a,"click",this,this.hide_);this.clickSurfaceWrapper_=conditionalBind$$module$build$src$core$browser_events(b,"click",this,this.onMouseMove_,!0,!0);this.moveSurfaceWrapper_=conditionalBind$$module$build$src$core$browser_events(b,"mousemove",this,this.onMouseMove_,!0,!0);this.editor_=a;}},{key:"dropdownDispose_",value:function dropdownDispose_(){this.clickWrapper_&&(unbind$$module$build$src$core$browser_events(this.clickWrapper_),this.clickWrapper_=null);this.clickSurfaceWrapper_&&(unbind$$module$build$src$core$browser_events(this.clickSurfaceWrapper_),this.clickSurfaceWrapper_=null);this.moveSurfaceWrapper_&&(unbind$$module$build$src$core$browser_events(this.moveSurfaceWrapper_),this.moveSurfaceWrapper_=null);this.line_=this.gauge_=null;}},{key:"hide_",value:function hide_(){hideIfOwner$$module$build$src$core$dropdowndiv(this);hide$$module$build$src$core$widgetdiv();}},{key:"onMouseMove_",value:function onMouseMove_(a){var b=this.gauge_.ownerSVGElement.getBoundingClientRect();var c=a.clientX-b.left-FieldAngle$$module$build$src$core$field_angle.HALF;a=a.clientY-b.top-FieldAngle$$module$build$src$core$field_angle.HALF;b=Math.atan(-a/c);isNaN(b)||(b=toDegrees$$module$build$src$core$utils$math(b),0>c?b+=180:0<a&&(b+=360),b=this.clockwise_?this.offset_+360-b:360-(this.offset_-b),this.displayMouseOrKeyboardValue_(b));}},{key:"displayMouseOrKeyboardValue_",value:function displayMouseOrKeyboardValue_(a){this.round_&&(a=Math.round(a/this.round_)*this.round_);a=this.wrapValue_(a);a!==this.value_&&this.setEditorValue_(a);}},{key:"updateGraph_",value:function updateGraph_(){if(this.gauge_){var a=Number(this.getText())+this.offset_,b=toRadians$$module$build$src$core$utils$math(a%360);a=["M ",FieldAngle$$module$build$src$core$field_angle.HALF,",",FieldAngle$$module$build$src$core$field_angle.HALF];var c=FieldAngle$$module$build$src$core$field_angle.HALF,d=FieldAngle$$module$build$src$core$field_angle.HALF;if(!isNaN(b)){var e=Number(this.clockwise_),f=toRadians$$module$build$src$core$utils$math(this.offset_),g=Math.cos(f)*FieldAngle$$module$build$src$core$field_angle.RADIUS,h=Math.sin(f)*-FieldAngle$$module$build$src$core$field_angle.RADIUS;e&&(b=2*f-b);c+=Math.cos(b)*FieldAngle$$module$build$src$core$field_angle.RADIUS;d-=Math.sin(b)*FieldAngle$$module$build$src$core$field_angle.RADIUS;b=Math.abs(Math.floor((b-f)/Math.PI)%2);e&&(b=1-b);a.push(" l ",g,",",h," A ",FieldAngle$$module$build$src$core$field_angle.RADIUS,",",FieldAngle$$module$build$src$core$field_angle.RADIUS," 0 ",b," ",e," ",c,",",d," z");}this.gauge_.setAttribute("d",a.join(""));this.line_.setAttribute("x2",c);this.line_.setAttribute("y2",d);}}},{key:"onHtmlInputKeyDown_",value:function onHtmlInputKeyDown_(a){_get(_getPrototypeOf(FieldAngle$$module$build$src$core$field_angle.prototype),"onHtmlInputKeyDown_",this).call(this,a);var b=this.getSourceBlock();if(!b)throw new UnattachedFieldError$$module$build$src$core$field();var c;a.keyCode===KeyCodes$$module$build$src$core$utils$keycodes.LEFT?c=b.RTL?1:-1:a.keyCode===KeyCodes$$module$build$src$core$utils$keycodes.RIGHT?c=b.RTL?-1:1:a.keyCode===KeyCodes$$module$build$src$core$utils$keycodes.DOWN?c=-1:a.keyCode===KeyCodes$$module$build$src$core$utils$keycodes.UP&&(c=1);c&&(b=this.getValue(),this.displayMouseOrKeyboardValue_(b+c*this.round_),a.preventDefault(),a.stopPropagation());}},{key:"doClassValidation_",value:function doClassValidation_(a){a=Number(a);return isNaN(a)||!isFinite(a)?null:this.wrapValue_(a);}},{key:"wrapValue_",value:function wrapValue_(a){a%=360;0>a&&(a+=360);a>this.wrap_&&(a-=360);return a;}}],[{key:"fromJson",value:function fromJson(a){return new this(a.angle,void 0,a);}}]);return FieldAngle$$module$build$src$core$field_angle;}($.FieldTextInput$$module$build$src$core$field_textinput);FieldAngle$$module$build$src$core$field_angle.ROUND=15;FieldAngle$$module$build$src$core$field_angle.HALF=50;FieldAngle$$module$build$src$core$field_angle.CLOCKWISE=!1;FieldAngle$$module$build$src$core$field_angle.OFFSET=0;FieldAngle$$module$build$src$core$field_angle.WRAP=360;FieldAngle$$module$build$src$core$field_angle.RADIUS=FieldAngle$$module$build$src$core$field_angle.HALF-1;register$$module$build$src$core$css("\n.blocklyAngleCircle {\n  stroke: #444;\n  stroke-width: 1;\n  fill: #ddd;\n  fill-opacity: .8;\n}\n\n.blocklyAngleMarks {\n  stroke: #444;\n  stroke-width: 1;\n}\n\n.blocklyAngleGauge {\n  fill: #f88;\n  fill-opacity: .8;\n  pointer-events: none;\n}\n\n.blocklyAngleLine {\n  stroke: #f00;\n  stroke-width: 2;\n  stroke-linecap: round;\n  pointer-events: none;\n}\n");register$$module$build$src$core$field_registry("field_angle",FieldAngle$$module$build$src$core$field_angle);FieldAngle$$module$build$src$core$field_angle.prototype.DEFAULT_VALUE=0;var Mode$$module$build$src$core$field_angle;(function(a){a.COMPASS="compass";a.PROTRACTOR="protractor";})(Mode$$module$build$src$core$field_angle||(Mode$$module$build$src$core$field_angle={}));var module$build$src$core$field_angle={};module$build$src$core$field_angle.FieldAngle=FieldAngle$$module$build$src$core$field_angle;module$build$src$core$field_angle.Mode=Mode$$module$build$src$core$field_angle;var BlockMove$$module$build$src$core$events$events_block_move=/*#__PURE__*/function(_BlockBase$$module$bu4){_inherits(BlockMove$$module$build$src$core$events$events_block_move,_BlockBase$$module$bu4);var _super99=_createSuper(BlockMove$$module$build$src$core$events$events_block_move);function BlockMove$$module$build$src$core$events$events_block_move(a){var _this95;_classCallCheck(this,BlockMove$$module$build$src$core$events$events_block_move);_this95=_super99.call(this,a);_this95.type=MOVE$$module$build$src$core$events$utils;a&&(a.isShadow()&&(_this95.recordUndo=!1),a=_this95.currentLocation_(),_this95.oldParentId=a.parentId,_this95.oldInputName=a.inputName,_this95.oldCoordinate=a.coordinate);return _this95;}_createClass(BlockMove$$module$build$src$core$events$events_block_move,[{key:"toJson",value:function toJson(){var a=_get(_getPrototypeOf(BlockMove$$module$build$src$core$events$events_block_move.prototype),"toJson",this).call(this);a.newParentId=this.newParentId;a.newInputName=this.newInputName;this.newCoordinate&&(a.newCoordinate="".concat(Math.round(this.newCoordinate.x),", ")+"".concat(Math.round(this.newCoordinate.y)));this.recordUndo||(a.recordUndo=this.recordUndo);return a;}},{key:"fromJson",value:function fromJson(a){_get(_getPrototypeOf(BlockMove$$module$build$src$core$events$events_block_move.prototype),"fromJson",this).call(this,a);this.newParentId=a.newParentId;this.newInputName=a.newInputName;if(a.newCoordinate){var b=a.newCoordinate.split(",");this.newCoordinate=new Coordinate$$module$build$src$core$utils$coordinate(Number(b[0]),Number(b[1]));}void 0!==a.recordUndo&&(this.recordUndo=a.recordUndo);}},{key:"recordNew",value:function recordNew(){var a=this.currentLocation_();this.newParentId=a.parentId;this.newInputName=a.inputName;this.newCoordinate=a.coordinate;}},{key:"currentLocation_",value:function currentLocation_(){var a=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");var b=a.getBlockById(this.blockId);if(!b)throw Error("The block associated with the block move event could not be found");a={};var c=b.getParent();if(c){if(a.parentId=c.id,b=c.getInputWithBlock(b))a.inputName=b.name;}else a.coordinate=b.getRelativeToSurfaceXY();return a;}},{key:"isNull",value:function isNull(){return this.oldParentId===this.newParentId&&this.oldInputName===this.newInputName&&Coordinate$$module$build$src$core$utils$coordinate.equals(this.oldCoordinate,this.newCoordinate);}},{key:"run",value:function run(a){var b=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");var c=b.getBlockById(this.blockId);if(c){var d=a?this.newParentId:this.oldParentId,e=a?this.newInputName:this.oldInputName;a=a?this.newCoordinate:this.oldCoordinate;if(d){var f=b.getBlockById(d);if(!f){console.warn("Can't connect to non-existent block: "+d);return;}}c.getParent()&&c.unplug();if(a)e=c.getRelativeToSurfaceXY(),c.moveBy(a.x-e.x,a.y-e.y);else{b=c.outputConnection;if(!b||c.previousConnection&&c.previousConnection.isConnected())b=c.previousConnection;var g;c=b.type;if(e){if(c=f.getInput(e))g=c.connection;}else c===ConnectionType$$module$build$src$core$connection_type.PREVIOUS_STATEMENT&&(g=f.nextConnection);g?b.connect(g):console.warn("Can't connect to non-existent input: "+e);}}else console.warn("Can't move non-existent block: "+this.blockId);}}]);return BlockMove$$module$build$src$core$events$events_block_move;}(BlockBase$$module$build$src$core$events$events_block_base);register$$module$build$src$core$registry(Type$$module$build$src$core$registry.EVENT,MOVE$$module$build$src$core$events$utils,BlockMove$$module$build$src$core$events$events_block_move);var module$build$src$core$events$events_block_move={};module$build$src$core$events$events_block_move.BlockMove=BlockMove$$module$build$src$core$events$events_block_move;var CommentBase$$module$build$src$core$events$events_comment_base=/*#__PURE__*/function(_Abstract$$module$bui4){_inherits(CommentBase$$module$build$src$core$events$events_comment_base,_Abstract$$module$bui4);var _super100=_createSuper(CommentBase$$module$build$src$core$events$events_comment_base);function CommentBase$$module$build$src$core$events$events_comment_base(a){var _this96;_classCallCheck(this,CommentBase$$module$build$src$core$events$events_comment_base);_this96=_super100.call(this);_this96.isBlank=!a;a&&(_this96.commentId=a.id,_this96.workspaceId=a.workspace.id,_this96.group=getGroup$$module$build$src$core$events$utils(),_this96.recordUndo=getRecordUndo$$module$build$src$core$events$utils());return _this96;}_createClass(CommentBase$$module$build$src$core$events$events_comment_base,[{key:"toJson",value:function toJson(){var a=_get(_getPrototypeOf(CommentBase$$module$build$src$core$events$events_comment_base.prototype),"toJson",this).call(this);if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");a.commentId=this.commentId;return a;}},{key:"fromJson",value:function fromJson(a){_get(_getPrototypeOf(CommentBase$$module$build$src$core$events$events_comment_base.prototype),"fromJson",this).call(this,a);this.commentId=a.commentId;}}],[{key:"CommentCreateDeleteHelper",value:function CommentCreateDeleteHelper(a,b){var c=a.getEventWorkspace_();if(b){b=createElement$$module$build$src$core$utils$xml("xml");if(!a.xml)throw Error("Ecountered a comment event without proper xml");b.appendChild(a.xml);domToWorkspace$$module$build$src$core$xml(b,c);}else{if(!a.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");(c=c.getCommentById(a.commentId))?c.dispose():console.warn("Can't uncreate non-existent comment: "+a.commentId);}}}]);return CommentBase$$module$build$src$core$events$events_comment_base;}(Abstract$$module$build$src$core$events$events_abstract),module$build$src$core$events$events_comment_base={};module$build$src$core$events$events_comment_base.CommentBase=CommentBase$$module$build$src$core$events$events_comment_base;var CommentChange$$module$build$src$core$events$events_comment_change=/*#__PURE__*/function(_CommentBase$$module$){_inherits(CommentChange$$module$build$src$core$events$events_comment_change,_CommentBase$$module$);var _super101=_createSuper(CommentChange$$module$build$src$core$events$events_comment_change);function CommentChange$$module$build$src$core$events$events_comment_change(a,b,c){var _this97;_classCallCheck(this,CommentChange$$module$build$src$core$events$events_comment_change);_this97=_super101.call(this,a);_this97.type=COMMENT_CHANGE$$module$build$src$core$events$utils;a&&(_this97.oldContents_="undefined"===typeof b?"":b,_this97.newContents_="undefined"===typeof c?"":c);return _this97;}_createClass(CommentChange$$module$build$src$core$events$events_comment_change,[{key:"toJson",value:function toJson(){var a=_get(_getPrototypeOf(CommentChange$$module$build$src$core$events$events_comment_change.prototype),"toJson",this).call(this);if(!this.oldContents_)throw Error("The old contents is undefined. Either pass a value to the constructor, or call fromJson");if(!this.newContents_)throw Error("The new contents is undefined. Either pass a value to the constructor, or call fromJson");a.oldContents=this.oldContents_;a.newContents=this.newContents_;return a;}},{key:"fromJson",value:function fromJson(a){_get(_getPrototypeOf(CommentChange$$module$build$src$core$events$events_comment_change.prototype),"fromJson",this).call(this,a);this.oldContents_=a.oldContents;this.newContents_=a.newContents;}},{key:"isNull",value:function isNull(){return this.oldContents_===this.newContents_;}},{key:"run",value:function run(a){var b=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");if(b=b.getCommentById(this.commentId)){var c=a?this.newContents_:this.oldContents_;if(!c){if(a)throw Error("The new contents is undefined. Either pass a value to the constructor, or call fromJson");throw Error("The old contents is undefined. Either pass a value to the constructor, or call fromJson");}b.setContent(c);}else console.warn("Can't change non-existent comment: "+this.commentId);}}]);return CommentChange$$module$build$src$core$events$events_comment_change;}(CommentBase$$module$build$src$core$events$events_comment_base);register$$module$build$src$core$registry(Type$$module$build$src$core$registry.EVENT,COMMENT_CHANGE$$module$build$src$core$events$utils,CommentChange$$module$build$src$core$events$events_comment_change);var module$build$src$core$events$events_comment_change={};module$build$src$core$events$events_comment_change.CommentChange=CommentChange$$module$build$src$core$events$events_comment_change;var CommentCreate$$module$build$src$core$events$events_comment_create=/*#__PURE__*/function(_CommentBase$$module$2){_inherits(CommentCreate$$module$build$src$core$events$events_comment_create,_CommentBase$$module$2);var _super102=_createSuper(CommentCreate$$module$build$src$core$events$events_comment_create);function CommentCreate$$module$build$src$core$events$events_comment_create(a){var _this98;_classCallCheck(this,CommentCreate$$module$build$src$core$events$events_comment_create);_this98=_super102.call(this,a);_this98.type=COMMENT_CREATE$$module$build$src$core$events$utils;a&&(_this98.xml=a.toXmlWithXY());return _this98;}_createClass(CommentCreate$$module$build$src$core$events$events_comment_create,[{key:"toJson",value:function toJson(){var a=_get(_getPrototypeOf(CommentCreate$$module$build$src$core$events$events_comment_create.prototype),"toJson",this).call(this);if(!this.xml)throw Error("The comment XML is undefined. Either pass a comment to the constructor, or call fromJson");a.xml=domToText$$module$build$src$core$xml(this.xml);return a;}},{key:"fromJson",value:function fromJson(a){_get(_getPrototypeOf(CommentCreate$$module$build$src$core$events$events_comment_create.prototype),"fromJson",this).call(this,a);this.xml=textToDom$$module$build$src$core$xml(a.xml);}},{key:"run",value:function run(a){CommentBase$$module$build$src$core$events$events_comment_base.CommentCreateDeleteHelper(this,a);}}]);return CommentCreate$$module$build$src$core$events$events_comment_create;}(CommentBase$$module$build$src$core$events$events_comment_base);register$$module$build$src$core$registry(Type$$module$build$src$core$registry.EVENT,COMMENT_CREATE$$module$build$src$core$events$utils,CommentCreate$$module$build$src$core$events$events_comment_create);var module$build$src$core$events$events_comment_create={};module$build$src$core$events$events_comment_create.CommentCreate=CommentCreate$$module$build$src$core$events$events_comment_create;var CommentDelete$$module$build$src$core$events$events_comment_delete=/*#__PURE__*/function(_CommentBase$$module$3){_inherits(CommentDelete$$module$build$src$core$events$events_comment_delete,_CommentBase$$module$3);var _super103=_createSuper(CommentDelete$$module$build$src$core$events$events_comment_delete);function CommentDelete$$module$build$src$core$events$events_comment_delete(a){var _this99;_classCallCheck(this,CommentDelete$$module$build$src$core$events$events_comment_delete);_this99=_super103.call(this,a);_this99.type=COMMENT_DELETE$$module$build$src$core$events$utils;a&&(_this99.xml=a.toXmlWithXY());return _this99;}_createClass(CommentDelete$$module$build$src$core$events$events_comment_delete,[{key:"run",value:function run(a){CommentBase$$module$build$src$core$events$events_comment_base.CommentCreateDeleteHelper(this,!a);}}]);return CommentDelete$$module$build$src$core$events$events_comment_delete;}(CommentBase$$module$build$src$core$events$events_comment_base);register$$module$build$src$core$registry(Type$$module$build$src$core$registry.EVENT,COMMENT_DELETE$$module$build$src$core$events$utils,CommentDelete$$module$build$src$core$events$events_comment_delete);var module$build$src$core$events$events_comment_delete={};module$build$src$core$events$events_comment_delete.CommentDelete=CommentDelete$$module$build$src$core$events$events_comment_delete;var CommentMove$$module$build$src$core$events$events_comment_move=/*#__PURE__*/function(_CommentBase$$module$4){_inherits(CommentMove$$module$build$src$core$events$events_comment_move,_CommentBase$$module$4);var _super104=_createSuper(CommentMove$$module$build$src$core$events$events_comment_move);function CommentMove$$module$build$src$core$events$events_comment_move(a){var _this100;_classCallCheck(this,CommentMove$$module$build$src$core$events$events_comment_move);_this100=_super104.call(this,a);_this100.type=COMMENT_MOVE$$module$build$src$core$events$utils;a&&(_this100.comment_=a,_this100.oldCoordinate_=a.getXY());return _this100;}_createClass(CommentMove$$module$build$src$core$events$events_comment_move,[{key:"recordNew",value:function recordNew(){if(this.newCoordinate_)throw Error("Tried to record the new position of a comment on the same event twice.");if(!this.comment_)throw Error("The comment is undefined. Pass a comment to the constructor if you want to use the record functionality");this.newCoordinate_=this.comment_.getXY();}},{key:"setOldCoordinate",value:function setOldCoordinate(a){this.oldCoordinate_=a;}},{key:"toJson",value:function toJson(){var a=_get(_getPrototypeOf(CommentMove$$module$build$src$core$events$events_comment_move.prototype),"toJson",this).call(this);if(!this.oldCoordinate_)throw Error("The old comment position is undefined. Either pass a comment to the constructor, or call fromJson");if(!this.newCoordinate_)throw Error("The new comment position is undefined. Either call recordNew, or call fromJson");a.oldCoordinate="".concat(Math.round(this.oldCoordinate_.x),", ")+"".concat(Math.round(this.oldCoordinate_.y));a.newCoordinate=Math.round(this.newCoordinate_.x)+","+Math.round(this.newCoordinate_.y);return a;}},{key:"fromJson",value:function fromJson(a){_get(_getPrototypeOf(CommentMove$$module$build$src$core$events$events_comment_move.prototype),"fromJson",this).call(this,a);var b=a.oldCoordinate.split(",");this.oldCoordinate_=new Coordinate$$module$build$src$core$utils$coordinate(Number(b[0]),Number(b[1]));b=a.newCoordinate.split(",");this.newCoordinate_=new Coordinate$$module$build$src$core$utils$coordinate(Number(b[0]),Number(b[1]));}},{key:"isNull",value:function isNull(){return Coordinate$$module$build$src$core$utils$coordinate.equals(this.oldCoordinate_,this.newCoordinate_);}},{key:"run",value:function run(a){var b=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");if(b=b.getCommentById(this.commentId)){a=a?this.newCoordinate_:this.oldCoordinate_;if(!a)throw Error("Either oldCoordinate_ or newCoordinate_ is undefined. Either pass a comment to the constructor and call recordNew, or call fromJson");var c=b.getXY();b.moveBy(a.x-c.x,a.y-c.y);}else console.warn("Can't move non-existent comment: "+this.commentId);}}]);return CommentMove$$module$build$src$core$events$events_comment_move;}(CommentBase$$module$build$src$core$events$events_comment_base);register$$module$build$src$core$registry(Type$$module$build$src$core$registry.EVENT,COMMENT_MOVE$$module$build$src$core$events$utils,CommentMove$$module$build$src$core$events$events_comment_move);var module$build$src$core$events$events_comment_move={};module$build$src$core$events$events_comment_move.CommentMove=CommentMove$$module$build$src$core$events$events_comment_move;var BlockDrag$$module$build$src$core$events$events_block_drag=/*#__PURE__*/function(_UiBase$$module$build9){_inherits(BlockDrag$$module$build$src$core$events$events_block_drag,_UiBase$$module$build9);var _super105=_createSuper(BlockDrag$$module$build$src$core$events$events_block_drag);function BlockDrag$$module$build$src$core$events$events_block_drag(a,b,c){var _this101;_classCallCheck(this,BlockDrag$$module$build$src$core$events$events_block_drag);_this101=_super105.call(this,a?a.workspace.id:void 0);_this101.type=BLOCK_DRAG$$module$build$src$core$events$utils;a&&(_this101.blockId=a.id,_this101.isStart=b,_this101.blocks=c);return _this101;}_createClass(BlockDrag$$module$build$src$core$events$events_block_drag,[{key:"toJson",value:function toJson(){var a=_get(_getPrototypeOf(BlockDrag$$module$build$src$core$events$events_block_drag.prototype),"toJson",this).call(this);if(void 0===this.isStart)throw Error("Whether this event is the start of a drag is undefined. Either pass the value to the constructor, or call fromJson");if(void 0===this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");a.isStart=this.isStart;a.blockId=this.blockId;a.blocks=this.blocks;return a;}},{key:"fromJson",value:function fromJson(a){_get(_getPrototypeOf(BlockDrag$$module$build$src$core$events$events_block_drag.prototype),"fromJson",this).call(this,a);this.isStart=a.isStart;this.blockId=a.blockId;this.blocks=a.blocks;}}]);return BlockDrag$$module$build$src$core$events$events_block_drag;}(UiBase$$module$build$src$core$events$events_ui_base);register$$module$build$src$core$registry(Type$$module$build$src$core$registry.EVENT,BLOCK_DRAG$$module$build$src$core$events$utils,BlockDrag$$module$build$src$core$events$events_block_drag);var module$build$src$core$events$events_block_drag={};module$build$src$core$events$events_block_drag.BlockDrag=BlockDrag$$module$build$src$core$events$events_block_drag;var Ui$$module$build$src$core$events$events_ui=/*#__PURE__*/function(_UiBase$$module$build10){_inherits(Ui$$module$build$src$core$events$events_ui,_UiBase$$module$build10);var _super106=_createSuper(Ui$$module$build$src$core$events$events_ui);function Ui$$module$build$src$core$events$events_ui(a,b,c,d){var _this102;_classCallCheck(this,Ui$$module$build$src$core$events$events_ui);_this102=_super106.call(this,a?a.workspace.id:void 0);_this102.type=UI$$module$build$src$core$events$utils;_this102.blockId=a?a.id:null;_this102.element="undefined"===typeof b?"":b;_this102.oldValue="undefined"===typeof c?"":c;_this102.newValue="undefined"===typeof d?"":d;return _this102;}_createClass(Ui$$module$build$src$core$events$events_ui,[{key:"toJson",value:function toJson(){var a=_get(_getPrototypeOf(Ui$$module$build$src$core$events$events_ui.prototype),"toJson",this).call(this);a.element=this.element;void 0!==this.newValue&&(a.newValue=this.newValue);this.blockId&&(a.blockId=this.blockId);return a;}},{key:"fromJson",value:function fromJson(a){_get(_getPrototypeOf(Ui$$module$build$src$core$events$events_ui.prototype),"fromJson",this).call(this,a);this.element=a.element;this.newValue=a.newValue;this.blockId=a.blockId;}}]);return Ui$$module$build$src$core$events$events_ui;}(UiBase$$module$build$src$core$events$events_ui_base);register$$module$build$src$core$registry(Type$$module$build$src$core$registry.EVENT,UI$$module$build$src$core$events$utils,Ui$$module$build$src$core$events$events_ui);var module$build$src$core$events$events_ui={};module$build$src$core$events$events_ui.Ui=Ui$$module$build$src$core$events$events_ui;var FinishedLoading$$module$build$src$core$events$workspace_events=/*#__PURE__*/function(_Abstract$$module$bui5){_inherits(FinishedLoading$$module$build$src$core$events$workspace_events,_Abstract$$module$bui5);var _super107=_createSuper(FinishedLoading$$module$build$src$core$events$workspace_events);function FinishedLoading$$module$build$src$core$events$workspace_events(a){var _this103;_classCallCheck(this,FinishedLoading$$module$build$src$core$events$workspace_events);_this103=_super107.call(this);_this103.isBlank=!0;_this103.recordUndo=!1;_this103.type=FINISHED_LOADING$$module$build$src$core$events$utils;_this103.isBlank=!!a;a&&(_this103.workspaceId=a.id);return _this103;}_createClass(FinishedLoading$$module$build$src$core$events$workspace_events,[{key:"toJson",value:function toJson(){var a=_get(_getPrototypeOf(FinishedLoading$$module$build$src$core$events$workspace_events.prototype),"toJson",this).call(this);if(!this.workspaceId)throw Error("The workspace ID is undefined. Either pass a workspace to the constructor, or call fromJson");a.workspaceId=this.workspaceId;return a;}},{key:"fromJson",value:function fromJson(a){_get(_getPrototypeOf(FinishedLoading$$module$build$src$core$events$workspace_events.prototype),"fromJson",this).call(this,a);this.workspaceId=a.workspaceId;}}]);return FinishedLoading$$module$build$src$core$events$workspace_events;}(Abstract$$module$build$src$core$events$events_abstract);register$$module$build$src$core$registry(Type$$module$build$src$core$registry.EVENT,FINISHED_LOADING$$module$build$src$core$events$utils,FinishedLoading$$module$build$src$core$events$workspace_events);var module$build$src$core$events$workspace_events={};module$build$src$core$events$workspace_events.FinishedLoading=FinishedLoading$$module$build$src$core$events$workspace_events;var Abstract$$module$build$src$core$events$events,BLOCK_CHANGE$$module$build$src$core$events$events,BLOCK_CREATE$$module$build$src$core$events$events,BLOCK_DELETE$$module$build$src$core$events$events,BLOCK_DRAG$$module$build$src$core$events$events,BLOCK_MOVE$$module$build$src$core$events$events,BUBBLE_OPEN$$module$build$src$core$events$events,BUMP_EVENTS$$module$build$src$core$events$events,CHANGE$$module$build$src$core$events$events,CLICK$$module$build$src$core$events$events,COMMENT_CHANGE$$module$build$src$core$events$events,COMMENT_CREATE$$module$build$src$core$events$events,COMMENT_DELETE$$module$build$src$core$events$events,COMMENT_MOVE$$module$build$src$core$events$events,CREATE$$module$build$src$core$events$events,DELETE$$module$build$src$core$events$events,FINISHED_LOADING$$module$build$src$core$events$events,MARKER_MOVE$$module$build$src$core$events$events,MOVE$$module$build$src$core$events$events,SELECTED$$module$build$src$core$events$events,THEME_CHANGE$$module$build$src$core$events$events,TOOLBOX_ITEM_SELECT$$module$build$src$core$events$events,TRASHCAN_OPEN$$module$build$src$core$events$events,UI$$module$build$src$core$events$events,VAR_CREATE$$module$build$src$core$events$events,VAR_DELETE$$module$build$src$core$events$events,VAR_RENAME$$module$build$src$core$events$events,VIEWPORT_CHANGE$$module$build$src$core$events$events,clearPendingUndo$$module$build$src$core$events$events,disable$$module$build$src$core$events$events,enable$$module$build$src$core$events$events,filter$$module$build$src$core$events$events,fire$$module$build$src$core$events$events,fromJson$$module$build$src$core$events$events,getDescendantIds$$module$build$src$core$events$events,get$$module$build$src$core$events$events,getGroup$$module$build$src$core$events$events,getRecordUndo$$module$build$src$core$events$events,isEnabled$$module$build$src$core$events$events,setGroup$$module$build$src$core$events$events,setRecordUndo$$module$build$src$core$events$events,disableOrphans$$module$build$src$core$events$events;Abstract$$module$build$src$core$events$events=Abstract$$module$build$src$core$events$events_abstract;BLOCK_CHANGE$$module$build$src$core$events$events=CHANGE$$module$build$src$core$events$utils;BLOCK_CREATE$$module$build$src$core$events$events=CREATE$$module$build$src$core$events$utils;BLOCK_DELETE$$module$build$src$core$events$events=DELETE$$module$build$src$core$events$utils;BLOCK_DRAG$$module$build$src$core$events$events=BLOCK_DRAG$$module$build$src$core$events$utils;BLOCK_MOVE$$module$build$src$core$events$events=MOVE$$module$build$src$core$events$utils;BUBBLE_OPEN$$module$build$src$core$events$events=BUBBLE_OPEN$$module$build$src$core$events$utils;BUMP_EVENTS$$module$build$src$core$events$events=BUMP_EVENTS$$module$build$src$core$events$utils;CHANGE$$module$build$src$core$events$events=CHANGE$$module$build$src$core$events$utils;CLICK$$module$build$src$core$events$events=CLICK$$module$build$src$core$events$utils;COMMENT_CHANGE$$module$build$src$core$events$events=COMMENT_CHANGE$$module$build$src$core$events$utils;COMMENT_CREATE$$module$build$src$core$events$events=COMMENT_CREATE$$module$build$src$core$events$utils;COMMENT_DELETE$$module$build$src$core$events$events=COMMENT_DELETE$$module$build$src$core$events$utils;COMMENT_MOVE$$module$build$src$core$events$events=COMMENT_MOVE$$module$build$src$core$events$utils;CREATE$$module$build$src$core$events$events=CREATE$$module$build$src$core$events$utils;DELETE$$module$build$src$core$events$events=DELETE$$module$build$src$core$events$utils;FINISHED_LOADING$$module$build$src$core$events$events=FINISHED_LOADING$$module$build$src$core$events$utils;MARKER_MOVE$$module$build$src$core$events$events=MARKER_MOVE$$module$build$src$core$events$utils;MOVE$$module$build$src$core$events$events=MOVE$$module$build$src$core$events$utils;SELECTED$$module$build$src$core$events$events=SELECTED$$module$build$src$core$events$utils;THEME_CHANGE$$module$build$src$core$events$events=THEME_CHANGE$$module$build$src$core$events$utils;TOOLBOX_ITEM_SELECT$$module$build$src$core$events$events=TOOLBOX_ITEM_SELECT$$module$build$src$core$events$utils;TRASHCAN_OPEN$$module$build$src$core$events$events=TRASHCAN_OPEN$$module$build$src$core$events$utils;UI$$module$build$src$core$events$events=UI$$module$build$src$core$events$utils;VAR_CREATE$$module$build$src$core$events$events=VAR_CREATE$$module$build$src$core$events$utils;VAR_DELETE$$module$build$src$core$events$events=VAR_DELETE$$module$build$src$core$events$utils;VAR_RENAME$$module$build$src$core$events$events=VAR_RENAME$$module$build$src$core$events$utils;VIEWPORT_CHANGE$$module$build$src$core$events$events=VIEWPORT_CHANGE$$module$build$src$core$events$utils;clearPendingUndo$$module$build$src$core$events$events=clearPendingUndo$$module$build$src$core$events$utils;disable$$module$build$src$core$events$events=disable$$module$build$src$core$events$utils;enable$$module$build$src$core$events$events=enable$$module$build$src$core$events$utils;filter$$module$build$src$core$events$events=filter$$module$build$src$core$events$utils;fire$$module$build$src$core$events$events=fire$$module$build$src$core$events$utils;fromJson$$module$build$src$core$events$events=fromJson$$module$build$src$core$events$utils;getDescendantIds$$module$build$src$core$events$events=getDescendantIds$$module$build$src$core$events$utils;get$$module$build$src$core$events$events=get$$module$build$src$core$events$utils;getGroup$$module$build$src$core$events$events=getGroup$$module$build$src$core$events$utils;getRecordUndo$$module$build$src$core$events$events=getRecordUndo$$module$build$src$core$events$utils;isEnabled$$module$build$src$core$events$events=isEnabled$$module$build$src$core$events$utils;setGroup$$module$build$src$core$events$events=setGroup$$module$build$src$core$events$utils;setRecordUndo$$module$build$src$core$events$events=setRecordUndo$$module$build$src$core$events$utils;disableOrphans$$module$build$src$core$events$events=disableOrphans$$module$build$src$core$events$utils;$.module$build$src$core$events$events={};$.module$build$src$core$events$events.Abstract=Abstract$$module$build$src$core$events$events_abstract;$.module$build$src$core$events$events.BLOCK_CHANGE=CHANGE$$module$build$src$core$events$utils;$.module$build$src$core$events$events.BLOCK_CREATE=CREATE$$module$build$src$core$events$utils;$.module$build$src$core$events$events.BLOCK_DELETE=DELETE$$module$build$src$core$events$utils;$.module$build$src$core$events$events.BLOCK_DRAG=BLOCK_DRAG$$module$build$src$core$events$utils;$.module$build$src$core$events$events.BLOCK_MOVE=MOVE$$module$build$src$core$events$utils;$.module$build$src$core$events$events.BUBBLE_OPEN=BUBBLE_OPEN$$module$build$src$core$events$utils;$.module$build$src$core$events$events.BUMP_EVENTS=BUMP_EVENTS$$module$build$src$core$events$utils;$.module$build$src$core$events$events.BlockBase=BlockBase$$module$build$src$core$events$events_block_base;$.module$build$src$core$events$events.BlockChange=BlockChange$$module$build$src$core$events$events_block_change;$.module$build$src$core$events$events.BlockCreate=BlockCreate$$module$build$src$core$events$events_block_create;$.module$build$src$core$events$events.BlockDelete=BlockDelete$$module$build$src$core$events$events_block_delete;$.module$build$src$core$events$events.BlockDrag=BlockDrag$$module$build$src$core$events$events_block_drag;$.module$build$src$core$events$events.BlockMove=BlockMove$$module$build$src$core$events$events_block_move;$.module$build$src$core$events$events.BubbleOpen=BubbleOpen$$module$build$src$core$events$events_bubble_open;$.module$build$src$core$events$events.BubbleType=BubbleType$$module$build$src$core$events$events_bubble_open;$.module$build$src$core$events$events.CHANGE=CHANGE$$module$build$src$core$events$utils;$.module$build$src$core$events$events.CLICK=CLICK$$module$build$src$core$events$utils;$.module$build$src$core$events$events.COMMENT_CHANGE=COMMENT_CHANGE$$module$build$src$core$events$utils;$.module$build$src$core$events$events.COMMENT_CREATE=COMMENT_CREATE$$module$build$src$core$events$utils;$.module$build$src$core$events$events.COMMENT_DELETE=COMMENT_DELETE$$module$build$src$core$events$utils;$.module$build$src$core$events$events.COMMENT_MOVE=COMMENT_MOVE$$module$build$src$core$events$utils;$.module$build$src$core$events$events.CREATE=CREATE$$module$build$src$core$events$utils;$.module$build$src$core$events$events.Click=Click$$module$build$src$core$events$events_click;$.module$build$src$core$events$events.ClickTarget=ClickTarget$$module$build$src$core$events$events_click;$.module$build$src$core$events$events.CommentBase=CommentBase$$module$build$src$core$events$events_comment_base;$.module$build$src$core$events$events.CommentChange=CommentChange$$module$build$src$core$events$events_comment_change;$.module$build$src$core$events$events.CommentCreate=CommentCreate$$module$build$src$core$events$events_comment_create;$.module$build$src$core$events$events.CommentDelete=CommentDelete$$module$build$src$core$events$events_comment_delete;$.module$build$src$core$events$events.CommentMove=CommentMove$$module$build$src$core$events$events_comment_move;$.module$build$src$core$events$events.DELETE=DELETE$$module$build$src$core$events$utils;$.module$build$src$core$events$events.FINISHED_LOADING=FINISHED_LOADING$$module$build$src$core$events$utils;$.module$build$src$core$events$events.FinishedLoading=FinishedLoading$$module$build$src$core$events$workspace_events;$.module$build$src$core$events$events.MARKER_MOVE=MARKER_MOVE$$module$build$src$core$events$utils;$.module$build$src$core$events$events.MOVE=MOVE$$module$build$src$core$events$utils;$.module$build$src$core$events$events.MarkerMove=MarkerMove$$module$build$src$core$events$events_marker_move;$.module$build$src$core$events$events.SELECTED=SELECTED$$module$build$src$core$events$utils;$.module$build$src$core$events$events.Selected=Selected$$module$build$src$core$events$events_selected;$.module$build$src$core$events$events.THEME_CHANGE=THEME_CHANGE$$module$build$src$core$events$utils;$.module$build$src$core$events$events.TOOLBOX_ITEM_SELECT=TOOLBOX_ITEM_SELECT$$module$build$src$core$events$utils;$.module$build$src$core$events$events.TRASHCAN_OPEN=TRASHCAN_OPEN$$module$build$src$core$events$utils;$.module$build$src$core$events$events.ThemeChange=ThemeChange$$module$build$src$core$events$events_theme_change;$.module$build$src$core$events$events.ToolboxItemSelect=ToolboxItemSelect$$module$build$src$core$events$events_toolbox_item_select;$.module$build$src$core$events$events.TrashcanOpen=TrashcanOpen$$module$build$src$core$events$events_trashcan_open;$.module$build$src$core$events$events.UI=UI$$module$build$src$core$events$utils;$.module$build$src$core$events$events.Ui=Ui$$module$build$src$core$events$events_ui;$.module$build$src$core$events$events.UiBase=UiBase$$module$build$src$core$events$events_ui_base;$.module$build$src$core$events$events.VAR_CREATE=VAR_CREATE$$module$build$src$core$events$utils;$.module$build$src$core$events$events.VAR_DELETE=VAR_DELETE$$module$build$src$core$events$utils;$.module$build$src$core$events$events.VAR_RENAME=VAR_RENAME$$module$build$src$core$events$utils;$.module$build$src$core$events$events.VIEWPORT_CHANGE=VIEWPORT_CHANGE$$module$build$src$core$events$utils;$.module$build$src$core$events$events.VarBase=VarBase$$module$build$src$core$events$events_var_base;$.module$build$src$core$events$events.VarCreate=VarCreate$$module$build$src$core$events$events_var_create;$.module$build$src$core$events$events.VarDelete=VarDelete$$module$build$src$core$events$events_var_delete;$.module$build$src$core$events$events.VarRename=VarRename$$module$build$src$core$events$events_var_rename;$.module$build$src$core$events$events.ViewportChange=ViewportChange$$module$build$src$core$events$events_viewport;$.module$build$src$core$events$events.clearPendingUndo=clearPendingUndo$$module$build$src$core$events$utils;$.module$build$src$core$events$events.disable=disable$$module$build$src$core$events$utils;$.module$build$src$core$events$events.disableOrphans=disableOrphans$$module$build$src$core$events$utils;$.module$build$src$core$events$events.enable=enable$$module$build$src$core$events$utils;$.module$build$src$core$events$events.filter=filter$$module$build$src$core$events$utils;$.module$build$src$core$events$events.fire=fire$$module$build$src$core$events$utils;$.module$build$src$core$events$events.fromJson=fromJson$$module$build$src$core$events$utils;$.module$build$src$core$events$events.get=get$$module$build$src$core$events$utils;$.module$build$src$core$events$events.getDescendantIds=getDescendantIds$$module$build$src$core$events$utils;$.module$build$src$core$events$events.getGroup=getGroup$$module$build$src$core$events$utils;$.module$build$src$core$events$events.getRecordUndo=getRecordUndo$$module$build$src$core$events$utils;$.module$build$src$core$events$events.isEnabled=isEnabled$$module$build$src$core$events$utils;$.module$build$src$core$events$events.setGroup=setGroup$$module$build$src$core$events$utils;$.module$build$src$core$events$events.setRecordUndo=setRecordUndo$$module$build$src$core$events$utils;registerDefaultOptions$$module$build$src$core$contextmenu_items();var module$build$src$core$contextmenu_items={};module$build$src$core$contextmenu_items.registerCleanup=registerCleanup$$module$build$src$core$contextmenu_items;module$build$src$core$contextmenu_items.registerCollapse=registerCollapse$$module$build$src$core$contextmenu_items;module$build$src$core$contextmenu_items.registerCollapseExpandBlock=registerCollapseExpandBlock$$module$build$src$core$contextmenu_items;module$build$src$core$contextmenu_items.registerComment=registerComment$$module$build$src$core$contextmenu_items;module$build$src$core$contextmenu_items.registerDefaultOptions=registerDefaultOptions$$module$build$src$core$contextmenu_items;module$build$src$core$contextmenu_items.registerDelete=registerDelete$$module$build$src$core$contextmenu_items;module$build$src$core$contextmenu_items.registerDeleteAll=registerDeleteAll$$module$build$src$core$contextmenu_items;module$build$src$core$contextmenu_items.registerDisable=registerDisable$$module$build$src$core$contextmenu_items;module$build$src$core$contextmenu_items.registerDuplicate=registerDuplicate$$module$build$src$core$contextmenu_items;module$build$src$core$contextmenu_items.registerExpand=registerExpand$$module$build$src$core$contextmenu_items;module$build$src$core$contextmenu_items.registerHelp=registerHelp$$module$build$src$core$contextmenu_items;module$build$src$core$contextmenu_items.registerInline=registerInline$$module$build$src$core$contextmenu_items;module$build$src$core$contextmenu_items.registerRedo=registerRedo$$module$build$src$core$contextmenu_items;module$build$src$core$contextmenu_items.registerUndo=registerUndo$$module$build$src$core$contextmenu_items;var BlockDragger$$module$build$src$core$block_dragger=/*#__PURE__*/function(){function BlockDragger$$module$build$src$core$block_dragger(a,b){_classCallCheck(this,BlockDragger$$module$build$src$core$block_dragger);this.dragTarget_=null;this.wouldDeleteBlock_=!1;this.draggingBlock_=a;this.draggedConnectionManager_=new _InsertionMarkerManager$$module$build$src$core$insertion_marker_manager(this.draggingBlock_);this.workspace_=b;this.startXY_=this.draggingBlock_.getRelativeToSurfaceXY();this.dragIconData_=initIconData$$module$build$src$core$block_dragger(a);}_createClass(BlockDragger$$module$build$src$core$block_dragger,[{key:"dispose",value:function dispose(){this.dragIconData_.length=0;this.draggedConnectionManager_&&this.draggedConnectionManager_.dispose();}},{key:"startDrag",value:function startDrag(a,b){getGroup$$module$build$src$core$events$utils()||setGroup$$module$build$src$core$events$utils(!0);this.fireDragStartEvent_();this.workspace_.isMutator&&this.draggingBlock_.bringToFront();startTextWidthCache$$module$build$src$core$utils$dom();this.workspace_.setResizesEnabled(!1);disconnectUiStop$$module$build$src$core$block_animations();this.shouldDisconnect_(b)&&this.disconnectBlock_(b,a);this.draggingBlock_.setDragging(!0);this.draggingBlock_.moveToDragSurface();}},{key:"shouldDisconnect_",value:function shouldDisconnect_(a){return!!(this.draggingBlock_.getParent()||a&&this.draggingBlock_.nextConnection&&this.draggingBlock_.nextConnection.targetBlock());}},{key:"disconnectBlock_",value:function disconnectBlock_(a,b){this.draggingBlock_.unplug(a);a=this.pixelsToWorkspaceUnits_(b);a=Coordinate$$module$build$src$core$utils$coordinate.sum(this.startXY_,a);this.draggingBlock_.translate(a.x,a.y);disconnectUiEffect$$module$build$src$core$block_animations(this.draggingBlock_);this.draggedConnectionManager_.updateAvailableConnections();}},{key:"fireDragStartEvent_",value:function fireDragStartEvent_(){var a=new(get$$module$build$src$core$events$utils(BLOCK_DRAG$$module$build$src$core$events$utils))(this.draggingBlock_,!0,this.draggingBlock_.getDescendants(!1));fire$$module$build$src$core$events$utils(a);}},{key:"drag",value:function drag(a,b){b=this.pixelsToWorkspaceUnits_(b);var c=Coordinate$$module$build$src$core$utils$coordinate.sum(this.startXY_,b);this.draggingBlock_.moveDuringDrag(c);this.dragIcons_(b);c=this.dragTarget_;this.dragTarget_=this.workspace_.getDragTarget(a);this.draggedConnectionManager_.update(b,this.dragTarget_);a=this.wouldDeleteBlock_;this.wouldDeleteBlock_=this.draggedConnectionManager_.wouldDeleteBlock();a!==this.wouldDeleteBlock_&&this.updateCursorDuringBlockDrag_();this.dragTarget_!==c&&(c&&c.onDragExit(this.draggingBlock_),this.dragTarget_&&this.dragTarget_.onDragEnter(this.draggingBlock_));this.dragTarget_&&this.dragTarget_.onDragOver(this.draggingBlock_);}},{key:"endDrag",value:function endDrag(a,b){this.drag(a,b);this.dragIconData_=[];this.fireDragEndEvent_();stopTextWidthCache$$module$build$src$core$utils$dom();disconnectUiStop$$module$build$src$core$block_animations();a=null;this.dragTarget_&&this.dragTarget_.shouldPreventMove(this.draggingBlock_)?b=this.startXY_:(b=this.getNewLocationAfterDrag_(b),a=b.delta,b=b.newLocation);this.draggingBlock_.moveOffDragSurface(b);if(this.dragTarget_)this.dragTarget_.onDrop(this.draggingBlock_);this.maybeDeleteBlock_()||(this.draggingBlock_.setDragging(!1),a?this.updateBlockAfterMove_(a):bumpObjectIntoBounds$$module$build$src$core$bump_objects(this.draggingBlock_.workspace,this.workspace_.getMetricsManager().getScrollMetrics(!0),this.draggingBlock_));this.workspace_.setResizesEnabled(!0);setGroup$$module$build$src$core$events$utils(!1);}},{key:"getNewLocationAfterDrag_",value:function getNewLocationAfterDrag_(a){a=this.pixelsToWorkspaceUnits_(a);var b=Coordinate$$module$build$src$core$utils$coordinate.sum(this.startXY_,a);return{delta:a,newLocation:b};}},{key:"maybeDeleteBlock_",value:function maybeDeleteBlock_(){return this.wouldDeleteBlock_?(this.fireMoveEvent_(),this.draggingBlock_.dispose(!1,!0),draggingConnections$$module$build$src$core$common.length=0,!0):!1;}},{key:"updateBlockAfterMove_",value:function updateBlockAfterMove_(a){this.draggingBlock_.moveConnections(a.x,a.y);this.fireMoveEvent_();this.draggedConnectionManager_.wouldConnectBlock()?this.draggedConnectionManager_.applyConnections():this.draggingBlock_.render();this.draggingBlock_.scheduleSnapAndBump();}},{key:"fireDragEndEvent_",value:function fireDragEndEvent_(){var a=new(get$$module$build$src$core$events$utils(BLOCK_DRAG$$module$build$src$core$events$utils))(this.draggingBlock_,!1,this.draggingBlock_.getDescendants(!1));fire$$module$build$src$core$events$utils(a);}},{key:"updateToolboxStyle_",value:function updateToolboxStyle_(a){var b=this.workspace_.getToolbox();if(b){var c=this.draggingBlock_.isDeletable()?"blocklyToolboxDelete":"blocklyToolboxGrab";a&&"function"===typeof b.removeStyle?b.removeStyle(c):a||"function"!==typeof b.addStyle||b.addStyle(c);}}},{key:"fireMoveEvent_",value:function fireMoveEvent_(){var a=new(get$$module$build$src$core$events$utils(MOVE$$module$build$src$core$events$utils))(this.draggingBlock_);a.oldCoordinate=this.startXY_;a.recordNew();fire$$module$build$src$core$events$utils(a);}},{key:"updateCursorDuringBlockDrag_",value:function updateCursorDuringBlockDrag_(){this.draggingBlock_.setDeleteStyle(this.wouldDeleteBlock_);}},{key:"pixelsToWorkspaceUnits_",value:function pixelsToWorkspaceUnits_(a){a=new Coordinate$$module$build$src$core$utils$coordinate(a.x/this.workspace_.scale,a.y/this.workspace_.scale);this.workspace_.isMutator&&a.scale(1/this.workspace_.options.parentWorkspace.scale);return a;}},{key:"dragIcons_",value:function dragIcons_(a){for(var b=0;b<this.dragIconData_.length;b++){var c=this.dragIconData_[b];c.icon.setIconLocation(Coordinate$$module$build$src$core$utils$coordinate.sum(c.location,a));}}},{key:"getInsertionMarkers",value:function getInsertionMarkers(){return this.draggedConnectionManager_&&this.draggedConnectionManager_.getInsertionMarkers?this.draggedConnectionManager_.getInsertionMarkers():[];}}]);return BlockDragger$$module$build$src$core$block_dragger;}();register$$module$build$src$core$registry(Type$$module$build$src$core$registry.BLOCK_DRAGGER,DEFAULT$$module$build$src$core$registry,BlockDragger$$module$build$src$core$block_dragger);var module$build$src$core$block_dragger={};module$build$src$core$block_dragger.BlockDragger=BlockDragger$$module$build$src$core$block_dragger;var VERSION$$module$build$src$core$blockly="9.1.0",ALIGN_LEFT$$module$build$src$core$blockly=$.Align$$module$build$src$core$input.LEFT,ALIGN_CENTRE$$module$build$src$core$blockly=$.Align$$module$build$src$core$input.CENTRE,ALIGN_RIGHT$$module$build$src$core$blockly=$.Align$$module$build$src$core$input.RIGHT,INPUT_VALUE$$module$build$src$core$blockly=ConnectionType$$module$build$src$core$connection_type.INPUT_VALUE,OUTPUT_VALUE$$module$build$src$core$blockly=ConnectionType$$module$build$src$core$connection_type.OUTPUT_VALUE,NEXT_STATEMENT$$module$build$src$core$blockly=ConnectionType$$module$build$src$core$connection_type.NEXT_STATEMENT,PREVIOUS_STATEMENT$$module$build$src$core$blockly=ConnectionType$$module$build$src$core$connection_type.PREVIOUS_STATEMENT,DUMMY_INPUT$$module$build$src$core$blockly=inputTypes$$module$build$src$core$input_types.DUMMY,TOOLBOX_AT_TOP$$module$build$src$core$blockly=Position$$module$build$src$core$utils$toolbox.TOP,TOOLBOX_AT_BOTTOM$$module$build$src$core$blockly=Position$$module$build$src$core$utils$toolbox.BOTTOM,TOOLBOX_AT_LEFT$$module$build$src$core$blockly=Position$$module$build$src$core$utils$toolbox.LEFT,TOOLBOX_AT_RIGHT$$module$build$src$core$blockly=Position$$module$build$src$core$utils$toolbox.RIGHT,svgResize$$module$build$src$core$blockly=svgResize$$module$build$src$core$common,getMainWorkspace$$module$build$src$core$blockly=getMainWorkspace$$module$build$src$core$common,getSelected$$module$build$src$core$blockly=getSelected$$module$build$src$core$common,defineBlocksWithJsonArray$$module$build$src$core$blockly=defineBlocksWithJsonArray$$module$build$src$core$common,setParentContainer$$module$build$src$core$blockly=setParentContainer$$module$build$src$core$common,resizeSvgContents$$module$build$src$core$blockly=resizeSvgContentsLocal$$module$build$src$core$blockly,COLLAPSE_CHARS$$module$build$src$core$blockly=COLLAPSE_CHARS$$module$build$src$core$internal_constants,DRAG_STACK$$module$build$src$core$blockly=DRAG_STACK$$module$build$src$core$internal_constants,OPPOSITE_TYPE$$module$build$src$core$blockly=OPPOSITE_TYPE$$module$build$src$core$internal_constants,RENAME_VARIABLE_ID$$module$build$src$core$blockly=RENAME_VARIABLE_ID$$module$build$src$core$internal_constants,DELETE_VARIABLE_ID$$module$build$src$core$blockly=DELETE_VARIABLE_ID$$module$build$src$core$internal_constants,COLLAPSED_INPUT_NAME$$module$build$src$core$blockly=COLLAPSED_INPUT_NAME$$module$build$src$core$constants,COLLAPSED_FIELD_NAME$$module$build$src$core$blockly=COLLAPSED_FIELD_NAME$$module$build$src$core$constants,VARIABLE_CATEGORY_NAME$$module$build$src$core$blockly=CATEGORY_NAME$$module$build$src$core$variables,VARIABLE_DYNAMIC_CATEGORY_NAME$$module$build$src$core$blockly=CATEGORY_NAME$$module$build$src$core$variables_dynamic,PROCEDURE_CATEGORY_NAME$$module$build$src$core$blockly=CATEGORY_NAME$$module$build$src$core$procedures;Workspace$$module$build$src$core$workspace.prototype.newBlock=function(a,b){return new Block$$module$build$src$core$block(this,a,b);};WorkspaceSvg$$module$build$src$core$workspace_svg.prototype.newBlock=function(a,b){return new BlockSvg$$module$build$src$core$block_svg(this,a,b);};WorkspaceSvg$$module$build$src$core$workspace_svg.newTrashcan=function(a){return new Trashcan$$module$build$src$core$trashcan(a);};WorkspaceCommentSvg$$module$build$src$core$workspace_comment_svg.prototype.showContextMenu=function(a){if(!this.workspace.options.readOnly){var b=[];this.isDeletable()&&this.isMovable()&&(b.push(commentDuplicateOption$$module$build$src$core$contextmenu(this)),b.push(commentDeleteOption$$module$build$src$core$contextmenu(this)));show$$module$build$src$core$contextmenu(a,b,this.RTL);}};$.Mutator$$module$build$src$core$mutator.prototype.newWorkspaceSvg=function(a){return new WorkspaceSvg$$module$build$src$core$workspace_svg(a);};Names$$module$build$src$core$names.prototype.populateProcedures=function(a){a=allProcedures$$module$build$src$core$procedures(a);a=a[0].concat(a[1]);for(var b=0;b<a.length;b++){this.getName(a[b][0],Names$$module$build$src$core$names.NameType.PROCEDURE);}};var DropDownDiv$$module$build$src$core$blockly=module$build$src$core$dropdowndiv,connectionTypes$$module$build$src$core$blockly=ConnectionType$$module$build$src$core$connection_type,module$build$src$core$blockly={};module$build$src$core$blockly.ALIGN_CENTRE=ALIGN_CENTRE$$module$build$src$core$blockly;module$build$src$core$blockly.ALIGN_LEFT=ALIGN_LEFT$$module$build$src$core$blockly;module$build$src$core$blockly.ALIGN_RIGHT=ALIGN_RIGHT$$module$build$src$core$blockly;module$build$src$core$blockly.ASTNode=_ASTNode$$module$build$src$core$keyboard_nav$ast_node;module$build$src$core$blockly.BasicCursor=BasicCursor$$module$build$src$core$keyboard_nav$basic_cursor;module$build$src$core$blockly.Block=Block$$module$build$src$core$block;module$build$src$core$blockly.BlockDragSurfaceSvg=BlockDragSurfaceSvg$$module$build$src$core$block_drag_surface;module$build$src$core$blockly.BlockDragger=BlockDragger$$module$build$src$core$block_dragger;module$build$src$core$blockly.BlockSvg=BlockSvg$$module$build$src$core$block_svg;module$build$src$core$blockly.Blocks=Blocks$$module$build$src$core$blocks;module$build$src$core$blockly.Bubble=Bubble$$module$build$src$core$bubble;module$build$src$core$blockly.BubbleDragger=BubbleDragger$$module$build$src$core$bubble_dragger;module$build$src$core$blockly.COLLAPSED_FIELD_NAME=COLLAPSED_FIELD_NAME$$module$build$src$core$constants;module$build$src$core$blockly.COLLAPSED_INPUT_NAME=COLLAPSED_INPUT_NAME$$module$build$src$core$constants;module$build$src$core$blockly.COLLAPSE_CHARS=COLLAPSE_CHARS$$module$build$src$core$internal_constants;module$build$src$core$blockly.CodeGenerator=$.CodeGenerator$$module$build$src$core$generator;module$build$src$core$blockly.CollapsibleToolboxCategory=CollapsibleToolboxCategory$$module$build$src$core$toolbox$collapsible_category;module$build$src$core$blockly.Comment=Comment$$module$build$src$core$comment;module$build$src$core$blockly.ComponentManager=ComponentManager$$module$build$src$core$component_manager;module$build$src$core$blockly.Connection=Connection$$module$build$src$core$connection;module$build$src$core$blockly.ConnectionChecker=ConnectionChecker$$module$build$src$core$connection_checker;module$build$src$core$blockly.ConnectionDB=ConnectionDB$$module$build$src$core$connection_db;module$build$src$core$blockly.ConnectionType=ConnectionType$$module$build$src$core$connection_type;module$build$src$core$blockly.ContextMenu=$.module$build$src$core$contextmenu;module$build$src$core$blockly.ContextMenuItems=module$build$src$core$contextmenu_items;module$build$src$core$blockly.ContextMenuRegistry=ContextMenuRegistry$$module$build$src$core$contextmenu_registry;module$build$src$core$blockly.Css=module$build$src$core$css;module$build$src$core$blockly.Cursor=Cursor$$module$build$src$core$keyboard_nav$cursor;module$build$src$core$blockly.DELETE_VARIABLE_ID=DELETE_VARIABLE_ID$$module$build$src$core$internal_constants;module$build$src$core$blockly.DRAG_STACK=DRAG_STACK$$module$build$src$core$internal_constants;module$build$src$core$blockly.DUMMY_INPUT=DUMMY_INPUT$$module$build$src$core$blockly;module$build$src$core$blockly.DeleteArea=DeleteArea$$module$build$src$core$delete_area;module$build$src$core$blockly.DragTarget=DragTarget$$module$build$src$core$drag_target;module$build$src$core$blockly.DropDownDiv=module$build$src$core$dropdowndiv;module$build$src$core$blockly.Events=$.module$build$src$core$events$events;module$build$src$core$blockly.Extensions=$.module$build$src$core$extensions;module$build$src$core$blockly.Field=Field$$module$build$src$core$field;module$build$src$core$blockly.FieldAngle=FieldAngle$$module$build$src$core$field_angle;module$build$src$core$blockly.FieldCheckbox=$.FieldCheckbox$$module$build$src$core$field_checkbox;module$build$src$core$blockly.FieldColour=FieldColour$$module$build$src$core$field_colour;module$build$src$core$blockly.FieldDropdown=FieldDropdown$$module$build$src$core$field_dropdown;module$build$src$core$blockly.FieldImage=$.FieldImage$$module$build$src$core$field_image;module$build$src$core$blockly.FieldLabel=$.FieldLabel$$module$build$src$core$field_label;module$build$src$core$blockly.FieldLabelSerializable=FieldLabelSerializable$$module$build$src$core$field_label_serializable;module$build$src$core$blockly.FieldMultilineInput=FieldMultilineInput$$module$build$src$core$field_multilineinput;module$build$src$core$blockly.FieldNumber=FieldNumber$$module$build$src$core$field_number;module$build$src$core$blockly.FieldTextInput=$.FieldTextInput$$module$build$src$core$field_textinput;module$build$src$core$blockly.FieldVariable=FieldVariable$$module$build$src$core$field_variable;module$build$src$core$blockly.Flyout=Flyout$$module$build$src$core$flyout_base;module$build$src$core$blockly.FlyoutButton=FlyoutButton$$module$build$src$core$flyout_button;module$build$src$core$blockly.FlyoutMetricsManager=FlyoutMetricsManager$$module$build$src$core$flyout_metrics_manager;module$build$src$core$blockly.Generator=$.CodeGenerator$$module$build$src$core$generator;module$build$src$core$blockly.Gesture=Gesture$$module$build$src$core$gesture;module$build$src$core$blockly.Grid=Grid$$module$build$src$core$grid;module$build$src$core$blockly.HorizontalFlyout=HorizontalFlyout$$module$build$src$core$flyout_horizontal;module$build$src$core$blockly.INPUT_VALUE=INPUT_VALUE$$module$build$src$core$blockly;module$build$src$core$blockly.Icon=Icon$$module$build$src$core$icon;module$build$src$core$blockly.Input=Input$$module$build$src$core$input;module$build$src$core$blockly.InsertionMarkerManager=_InsertionMarkerManager$$module$build$src$core$insertion_marker_manager;module$build$src$core$blockly.Marker=Marker$$module$build$src$core$keyboard_nav$marker;module$build$src$core$blockly.MarkerManager=MarkerManager$$module$build$src$core$marker_manager;module$build$src$core$blockly.Menu=Menu$$module$build$src$core$menu;module$build$src$core$blockly.MenuItem=MenuItem$$module$build$src$core$menuitem;module$build$src$core$blockly.MetricsManager=MetricsManager$$module$build$src$core$metrics_manager;module$build$src$core$blockly.Msg=Msg$$module$build$src$core$msg;module$build$src$core$blockly.Mutator=$.Mutator$$module$build$src$core$mutator;module$build$src$core$blockly.NEXT_STATEMENT=NEXT_STATEMENT$$module$build$src$core$blockly;module$build$src$core$blockly.Names=Names$$module$build$src$core$names;module$build$src$core$blockly.OPPOSITE_TYPE=OPPOSITE_TYPE$$module$build$src$core$internal_constants;module$build$src$core$blockly.OUTPUT_VALUE=OUTPUT_VALUE$$module$build$src$core$blockly;module$build$src$core$blockly.Options=Options$$module$build$src$core$options;module$build$src$core$blockly.PREVIOUS_STATEMENT=PREVIOUS_STATEMENT$$module$build$src$core$blockly;module$build$src$core$blockly.PROCEDURE_CATEGORY_NAME=CATEGORY_NAME$$module$build$src$core$procedures;module$build$src$core$blockly.Procedures=$.module$build$src$core$procedures;module$build$src$core$blockly.RENAME_VARIABLE_ID=RENAME_VARIABLE_ID$$module$build$src$core$internal_constants;module$build$src$core$blockly.RenderedConnection=_RenderedConnection$$module$build$src$core$rendered_connection;module$build$src$core$blockly.Scrollbar=Scrollbar$$module$build$src$core$scrollbar;module$build$src$core$blockly.ScrollbarPair=ScrollbarPair$$module$build$src$core$scrollbar_pair;module$build$src$core$blockly.ShortcutItems=module$build$src$core$shortcut_items;module$build$src$core$blockly.ShortcutRegistry=_ShortcutRegistry$$module$build$src$core$shortcut_registry;module$build$src$core$blockly.TOOLBOX_AT_BOTTOM=TOOLBOX_AT_BOTTOM$$module$build$src$core$blockly;module$build$src$core$blockly.TOOLBOX_AT_LEFT=TOOLBOX_AT_LEFT$$module$build$src$core$blockly;module$build$src$core$blockly.TOOLBOX_AT_RIGHT=TOOLBOX_AT_RIGHT$$module$build$src$core$blockly;module$build$src$core$blockly.TOOLBOX_AT_TOP=TOOLBOX_AT_TOP$$module$build$src$core$blockly;module$build$src$core$blockly.TabNavigateCursor=TabNavigateCursor$$module$build$src$core$keyboard_nav$tab_navigate_cursor;module$build$src$core$blockly.Theme=Theme$$module$build$src$core$theme;module$build$src$core$blockly.ThemeManager=ThemeManager$$module$build$src$core$theme_manager;module$build$src$core$blockly.Themes=module$build$src$core$theme$themes;module$build$src$core$blockly.Toolbox=Toolbox$$module$build$src$core$toolbox$toolbox;module$build$src$core$blockly.ToolboxCategory=ToolboxCategory$$module$build$src$core$toolbox$category;module$build$src$core$blockly.ToolboxItem=ToolboxItem$$module$build$src$core$toolbox$toolbox_item;module$build$src$core$blockly.ToolboxSeparator=ToolboxSeparator$$module$build$src$core$toolbox$separator;module$build$src$core$blockly.Tooltip=module$build$src$core$tooltip;module$build$src$core$blockly.Touch=module$build$src$core$touch;module$build$src$core$blockly.TouchGesture=TouchGesture$$module$build$src$core$touch_gesture;module$build$src$core$blockly.Trashcan=Trashcan$$module$build$src$core$trashcan;module$build$src$core$blockly.VARIABLE_CATEGORY_NAME=CATEGORY_NAME$$module$build$src$core$variables;module$build$src$core$blockly.VARIABLE_DYNAMIC_CATEGORY_NAME=CATEGORY_NAME$$module$build$src$core$variables_dynamic;module$build$src$core$blockly.VERSION=VERSION$$module$build$src$core$blockly;module$build$src$core$blockly.VariableMap=VariableMap$$module$build$src$core$variable_map;module$build$src$core$blockly.VariableModel=VariableModel$$module$build$src$core$variable_model;module$build$src$core$blockly.Variables=$.module$build$src$core$variables;module$build$src$core$blockly.VariablesDynamic=module$build$src$core$variables_dynamic;module$build$src$core$blockly.VerticalFlyout=VerticalFlyout$$module$build$src$core$flyout_vertical;module$build$src$core$blockly.Warning=Warning$$module$build$src$core$warning;module$build$src$core$blockly.WidgetDiv=module$build$src$core$widgetdiv;module$build$src$core$blockly.Workspace=Workspace$$module$build$src$core$workspace;module$build$src$core$blockly.WorkspaceAudio=WorkspaceAudio$$module$build$src$core$workspace_audio;module$build$src$core$blockly.WorkspaceComment=WorkspaceComment$$module$build$src$core$workspace_comment;module$build$src$core$blockly.WorkspaceCommentSvg=WorkspaceCommentSvg$$module$build$src$core$workspace_comment_svg;module$build$src$core$blockly.WorkspaceDragSurfaceSvg=WorkspaceDragSurfaceSvg$$module$build$src$core$workspace_drag_surface_svg;module$build$src$core$blockly.WorkspaceDragger=WorkspaceDragger$$module$build$src$core$workspace_dragger;module$build$src$core$blockly.WorkspaceSvg=WorkspaceSvg$$module$build$src$core$workspace_svg;module$build$src$core$blockly.Xml=$.module$build$src$core$xml;module$build$src$core$blockly.ZoomControls=ZoomControls$$module$build$src$core$zoom_controls;module$build$src$core$blockly.bindEventWithChecks_=bindEventWithChecks_$$module$build$src$core$blockly;module$build$src$core$blockly.bindEvent_=bindEvent_$$module$build$src$core$blockly;module$build$src$core$blockly.blockAnimations=module$build$src$core$block_animations;module$build$src$core$blockly.blockRendering=module$build$src$core$renderers$common$block_rendering;module$build$src$core$blockly.browserEvents=module$build$src$core$browser_events;module$build$src$core$blockly.bumpObjects=module$build$src$core$bump_objects;module$build$src$core$blockly.clipboard=module$build$src$core$clipboard;module$build$src$core$blockly.common=$.module$build$src$core$common;module$build$src$core$blockly.config=$.config$$module$build$src$core$config;module$build$src$core$blockly.connectionTypes=connectionTypes$$module$build$src$core$blockly;module$build$src$core$blockly.constants=module$build$src$core$constants;module$build$src$core$blockly.copy=copy$$module$build$src$core$blockly;module$build$src$core$blockly.defineBlocksWithJsonArray=defineBlocksWithJsonArray$$module$build$src$core$common;module$build$src$core$blockly.dialog=module$build$src$core$dialog;module$build$src$core$blockly.duplicate=duplicate$$module$build$src$core$blockly;module$build$src$core$blockly.fieldRegistry=module$build$src$core$field_registry;module$build$src$core$blockly.geras=module$build$src$core$renderers$geras$geras;module$build$src$core$blockly.getMainWorkspace=getMainWorkspace$$module$build$src$core$common;module$build$src$core$blockly.getSelected=getSelected$$module$build$src$core$common;module$build$src$core$blockly.hideChaff=hideChaff$$module$build$src$core$blockly;module$build$src$core$blockly.hueToHex=hueToHex$$module$build$src$core$blockly;module$build$src$core$blockly.inject=inject$$module$build$src$core$inject;module$build$src$core$blockly.inputTypes=inputTypes$$module$build$src$core$input_types;module$build$src$core$blockly.isNumber=isNumber$$module$build$src$core$blockly;module$build$src$core$blockly.minimalist=module$build$src$core$renderers$minimalist$minimalist;module$build$src$core$blockly.paste=paste$$module$build$src$core$blockly;module$build$src$core$blockly.procedures=$.module$build$src$core$procedures;module$build$src$core$blockly.registry=module$build$src$core$registry;module$build$src$core$blockly.resizeSvgContents=resizeSvgContentsLocal$$module$build$src$core$blockly;module$build$src$core$blockly.serialization=module$build$src$core$serialization;module$build$src$core$blockly.setLocale=setLocale$$module$build$src$core$msg;module$build$src$core$blockly.setParentContainer=setParentContainer$$module$build$src$core$common;module$build$src$core$blockly.svgResize=svgResize$$module$build$src$core$common;module$build$src$core$blockly.thrasos=module$build$src$core$renderers$thrasos$thrasos;module$build$src$core$blockly.uiPosition=module$build$src$core$positionable_helpers;module$build$src$core$blockly.unbindEvent_=unbindEvent_$$module$build$src$core$blockly;module$build$src$core$blockly.utils=module$build$src$core$utils;module$build$src$core$blockly.zelos=module$build$src$core$renderers$zelos$zelos;var module$exports$Blockly$main={},module$contents$Blockly$main_Blockly=module$build$src$core$blockly,module$contents$Blockly$main_ContextMenu=$.module$build$src$core$contextmenu,module$contents$Blockly$main_Events=$.module$build$src$core$events$events,module$contents$Blockly$main_Msg=$.module$build$src$core$msg,module$contents$Blockly$main_Tooltip=module$build$src$core$tooltip,module$contents$Blockly$main_WidgetDiv=module$build$src$core$widgetdiv,module$contents$Blockly$main_colour=module$build$src$core$utils$colour,module$contents$Blockly$main_common=$.module$build$src$core$common,module$contents$Blockly$main_deprecation=module$build$src$core$utils$deprecation,module$contents$Blockly$main_dialog=module$build$src$core$dialog,module$contents$Blockly$main_eventUtils=module$build$src$core$events$utils;Object.defineProperties(module$build$src$core$blockly,{alert:{set:function set(a){module$build$src$core$utils$deprecation.warn("Blockly.alert","December 2021","December 2022");module$build$src$core$dialog.setAlert(a);},get:function get(){module$build$src$core$utils$deprecation.warn("Blockly.alert","December 2021","December 2022","Blockly.dialog.alert()");return module$build$src$core$dialog.alert;}},confirm:{set:function set(a){module$build$src$core$utils$deprecation.warn("Blockly.confirm","December 2021","December 2022");module$build$src$core$dialog.setConfirm(a);},get:function get(){module$build$src$core$utils$deprecation.warn("Blockly.confirm","December 2021","December 2022","Blockly.dialog.confirm()");return module$build$src$core$dialog.confirm;}},mainWorkspace:{set:function set(a){module$build$src$core$utils$deprecation.warn("Blockly.mainWorkspace","version 9","version 10","Blockly.getMainWorkspace");$.module$build$src$core$common.setMainWorkspace(a);},get:function get(){module$build$src$core$utils$deprecation.warn("Blockly.mainWorkspace","version 9","version 10","Blockly.getMainWorkspace");return $.module$build$src$core$common.getMainWorkspace();}},prompt:{set:function set(a){module$build$src$core$utils$deprecation.warn("Blockly.prompt","December 2021","December 2022");module$build$src$core$dialog.setPrompt(a);},get:function get(){module$build$src$core$utils$deprecation.warn("Blockly.prompt","December 2021","December 2022","Blockly.dialog.prompt()");return module$build$src$core$dialog.prompt;}},selected:{get:function get(){module$build$src$core$utils$deprecation.warn("Blockly.selected","version 9","version 10","Blockly.getSelected");return $.module$build$src$core$common.getSelected();},set:function set(a){module$build$src$core$utils$deprecation.warn("Blockly.selected","version 9","version 10","Blockly.getSelected");$.module$build$src$core$common.setSelected(a);}},HSV_SATURATION:{get:function get(){return module$build$src$core$utils$colour.getHsvSaturation();},set:function set(a){module$build$src$core$utils$colour.setHsvSaturation(a);}},HSV_VALUE:{get:function get(){return module$build$src$core$utils$colour.getHsvValue();},set:function set(a){module$build$src$core$utils$colour.setHsvValue(a);}}});Object.defineProperties($.module$build$src$core$contextmenu,{currentBlock:{get:function get(){module$build$src$core$utils$deprecation.warn("Blockly.ContextMenu.currentBlock","September 2021","September 2022","Blockly.Tooltip.getCurrentBlock()");return $.module$build$src$core$contextmenu.getCurrentBlock();},set:function set(a){module$build$src$core$utils$deprecation.warn("Blockly.ContextMenu.currentBlock","September 2021","September 2022","Blockly.Tooltip.setCurrentBlock(block)");$.module$build$src$core$contextmenu.setCurrentBlock(a);}}});Object.defineProperties($.module$build$src$core$events$events,{recordUndo:{get:function get(){module$build$src$core$utils$deprecation.warn("Blockly.Events.recordUndo","September 2021","September 2022","Blockly.Events.getRecordUndo()");return module$build$src$core$events$utils.getRecordUndo();},set:function set(a){module$build$src$core$utils$deprecation.warn("Blockly.Events.recordUndo","September 2021","September 2022","Blockly.Events.setRecordUndo()");module$build$src$core$events$utils.setRecordUndo(a);}}});Object.defineProperties(module$build$src$core$tooltip,{visible:{get:function get(){module$build$src$core$utils$deprecation.warn("Blockly.Tooltip.visible","September 2021","September 2022","Blockly.Tooltip.isVisible()");return module$build$src$core$tooltip.isVisible();}},DIV:{get:function get(){module$build$src$core$utils$deprecation.warn("Blockly.Tooltip.DIV","September 2021","September 2022","Blockly.Tooltip.getDiv()");return module$build$src$core$tooltip.getDiv();}}});Object.defineProperties(module$build$src$core$widgetdiv,{DIV:{get:function get(){module$build$src$core$utils$deprecation.warn("Blockly.WidgetDiv.DIV","September 2021","September 2022","Blockly.WidgetDiv.getDiv()");return module$build$src$core$widgetdiv.getDiv();}}});"Blockly"in globalThis||(globalThis.Blockly={Msg:$.module$build$src$core$msg});module$build$src$core$blockly.__namespace__=$;return module$build$src$core$blockly;});

/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The module cache
/******/ 	var __webpack_module_cache__ = {};
/******/ 	
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/ 		// Check if module is in cache
/******/ 		var cachedModule = __webpack_module_cache__[moduleId];
/******/ 		if (cachedModule !== undefined) {
/******/ 			return cachedModule.exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = __webpack_module_cache__[moduleId] = {
/******/ 			// no module.id needed
/******/ 			// no module.loaded needed
/******/ 			exports: {}
/******/ 		};
/******/ 	
/******/ 		// Execute the module function
/******/ 		__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/ 	
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/ 	
/************************************************************************/
/******/ 	/* webpack/runtime/global */
/******/ 	(() => {
/******/ 		__webpack_require__.g = (function() {
/******/ 			if (typeof globalThis === 'object') return globalThis;
/******/ 			try {
/******/ 				return this || new Function('return this')();
/******/ 			} catch (e) {
/******/ 				if (typeof window === 'object') return window;
/******/ 			}
/******/ 		})();
/******/ 	})();
/******/ 	
/************************************************************************/
/******/ 	
/******/ 	// startup
/******/ 	// Load entry module and return exports
/******/ 	// This entry module is referenced by other modules so it can't be inlined
/******/ 	var __webpack_exports__ = __webpack_require__("./resources/js/blockly/blockly_compressed.js");
/******/ 	
/******/ })()
;